<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>记录 on 狼的公告板 ver.Hugo</title><link>https://blog.tama.guru/categories/%E8%AE%B0%E5%BD%95.html</link><description>Recent content in 记录 on 狼的公告板 ver.Hugo</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>tamakyi</copyright><lastBuildDate>Tue, 09 Sep 2025 18:18:35 +0800</lastBuildDate><atom:link href="https://blog.tama.guru/categories/%E8%AE%B0%E5%BD%95/index.xml" rel="self" type="application/rss+xml"/><item><title>使用Alpine linux在爱快中作为虚拟机运行Docker</title><link>https://blog.tama.guru/record/alpine_docker_on_ikuai.html</link><pubDate>Tue, 09 Sep 2025 15:09:11 +0800</pubDate><guid>https://blog.tama.guru/record/alpine_docker_on_ikuai.html</guid><description>&lt;img src="https://images.337845818.best/20250806/6b0378c33ae92cb2cc02a8a7bce5a2fa.webp" alt="Featured image of post 使用Alpine linux在爱快中作为虚拟机运行Docker" />&lt;p>[TOC]&lt;/p>
&lt;h4 id="前言">前言
&lt;/h4>&lt;p>  自从爱快添加Docker插件之后我有第一时间就安装，使用一段时间后感觉这玩意问题蛮多的，首先就是功能残废，系统提供的界面只能实现修改镜像源、配置存储位置这些基础功能（修改镜像源还是最近几个版本才添加，原来直连官方国内已经无法访问）；然后就是访问异常，我使用Chromium内核的浏览器（包括但不限于Chrome、Edge）访问Docker的管理页面，总是会莫名其妙的跳出来，每点一下就跳一次，拉个镜像配置完参数硬是要花我几分钟时间。而且Docker功能需要到云服务端去手动开启，一直搞不懂为什么要这样。&lt;br>
  但是现在多个路子，就是通过自带的虚拟机虚拟linux环境专门来跑docker，听说它自带的虚拟机也有一些问题，长期使用会影响到宿主系统的性能，但是我使用一段时间之后并没有感觉，日常使用占用CPU最多也就跑到40%，内存我限制了1G，感觉基本够用了。
  我使用的是某鱼上购入的双网口j1900+4G+32G MSata主板作为旁路由，原来用的是基于openwrt的istore，功能很全面，使用起来也很简单，日常维护甚至不需要进ssh，但是我监控家中的网络时发现这个软路由总是莫名其妙的掉线，好在下级做过故障转移，旁路由挂的时候AP能够直接过光猫，不然家里老人断网了我都不知道怎么和他们解释。&lt;br>
  之所以用Alpine是因为它有专门针对虚拟机的版本，体积仅有65M，安装完占用硬盘不到300M，但是能全功能安装Docker甚至其他软件，对于j1900+4G这种配置再合适不过了。&lt;/p>
&lt;h4 id="准备工作">准备工作
&lt;/h4>&lt;h5 id="分区">分区
&lt;/h5>&lt;p>  &lt;strong>建议先对爱快分区内的文件备份，因为需要单独给Alpine配置一个分区。&lt;/strong>
&lt;img src="https://images.337845818.best/20250909/24e29e18086aec5ed47a7b556c3d1d00.webp" alt="image" />
  因为硬盘只有32G，我打算分成三块，4G给系统日志绰绰有余，12G分配做普通存储，用自带的Docker还有存放一些文件的时候使用，剩下的全部都留作Alpine的分区。注意的是Alpine的分区不需要绑定业务，也无需挂载，格式化好之后放着就行。&lt;/p>
&lt;h5 id="上传镜像">上传镜像
&lt;/h5>&lt;p>  刚才我们分配做普通存储的分区下新建一个文件夹ISO，然后到https://www.alpinelinux.org/downloads/找到Virtual下的x86_64（如果是arm系统就下载arm/aarch），下载针对虚拟机的最新版本ISO，目前最新的是：https://dl-cdn.alpinelinux.org/alpine/v3.22/releases/x86_64/alpine-virt-3.22.1-x86_64.iso存放到ISO文件夹，或者不限难看直接放在根目录也行。
&lt;img src="https://images.337845818.best/20250909/b02c4936ba10bc89580509147ced1b26.png" alt="image" />&lt;br>
&lt;img src="https://images.337845818.best/20250909/55c9379571902c138c6999b5f74770c1.webp" alt="image" />
  找到文件后点击查看路径并复制路径备用。&lt;/p>
&lt;h4 id="新增虚拟机">新增虚拟机
&lt;/h4>&lt;h5 id="配置虚拟机">配置虚拟机
&lt;/h5>&lt;p>  在高级应用-虚拟机下选择添加。
&lt;img src="https://images.337845818.best/20250909/de7110d9c3da17a3fc3926ded449caa2.png" alt="image" />
  配置方面根据自己的实际情况添加即可，虚拟机名称任意天蝎，系统类型选Linux，CPU使用率我只给80%，核心数给2，内存分配1024M。
&lt;img src="https://images.337845818.best/20250909/9bf9b8e560fc1bff3574ddb9ec5d5c61.png" alt="image" />
  设备管理需要手工添加一个分区，设备类型为磁盘，磁盘类型选引用分区，勾选半虚拟化，分区名称选择前面我们分区时没格式化的那个，我这里显示的是sda7。
&lt;img src="https://images.337845818.best/20250909/dbe4e032b6f92242beb2ab24ac18c362.png" alt="image" />
  下面虚拟机光驱就填写前面我们的ISO文件路径，VNC外部访问一定要打开，密码和端口任意，下面的开机自启、UEFI启动和硬件加速也打开，然后保存。
&lt;img src="https://images.337845818.best/20250909/ee42a0298af19eac928e89e946144893.webp" alt="webp-virtual-2" />&lt;/p>
&lt;h5 id="安装alpine">安装Alpine
&lt;/h5>&lt;p>  启动虚拟机，返回上一层的操作部分点击VNC，输入之前配置的密码，进入到系统安装界面。
&lt;img src="https://images.337845818.best/20250909/1ae4dc97b71036f4fa51d9d00683e534.png" alt="8f0b0496-59b7-469f-843f-730d4fa95a16" />
  默认的用户名是&lt;code>root&lt;/code>，没有密码直接回车。
  然后按提示进行配置：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">localhost:~# setup-alpine &lt;span class="c1">#执行安装脚本&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Select keyboard layout:&lt;span class="o">[&lt;/span>none&lt;span class="o">]&lt;/span> us &lt;span class="c1">#选择键盘布局，选us即可&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Select variant &lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;abort&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>: us-intl &lt;span class="c1">#选择布局变种，我是随便选的&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter system hostname &lt;span class="o">(&lt;/span>fully qualified from, e.g. &lt;span class="s1">&amp;#39;foo.example.org&amp;#39;&lt;/span>&lt;span class="o">)[&lt;/span>localhost&lt;span class="o">]&lt;/span> &lt;span class="c1">#系统名，一般直接保持localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Which one &lt;span class="k">do&lt;/span> you want to initialize? &lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span> or &lt;span class="s1">&amp;#39;done&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>eth0&lt;span class="o">]&lt;/span> &lt;span class="c1">#选择网卡，一般默认eth0即可，如果有另外添加网卡或其他特殊情况再调整&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ip address &lt;span class="k">for&lt;/span> eth0?&lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;dhcp&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span>&lt;span class="o">)[&lt;/span>dhcp&lt;span class="o">]&lt;/span>192.168.233.233 &lt;span class="c1">#获取eth0网卡IP的方式，默认dhcp，但是我爱快没开dhcp，配置的静态路由，所以我填写爱快网段内任意一个没占用的IP。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Do you want to &lt;span class="k">do&lt;/span> any manual network configuration?&lt;span class="o">(&lt;/span>y/n&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>n&lt;span class="o">]&lt;/span> &lt;span class="c1">#是否需要手动设置网络，y则进入vi界面编辑网络配置文件，如无需要直接n&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">New Password: &lt;span class="c1">#设置root用户的密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Retype password: &lt;span class="c1">#再输入一次&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Which timezone are you in? &lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span> or &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>UTC&lt;span class="o">]&lt;/span> Asia &lt;span class="c1">#选择时区&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">What sub-timezone of &lt;span class="s1">&amp;#39;Asia&amp;#39;&lt;/span> are you in? &lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> Shanghai &lt;span class="c1">#选择子时区&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP/FTP proxy URL? &lt;span class="o">(&lt;/span>e.g. &lt;span class="s1">&amp;#39;http://proxy:8080&amp;#39;&lt;/span>, or &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>none&lt;span class="o">]&lt;/span> &lt;span class="c1">#是否需要代理访问网络&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Which NTP client to run? &lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;busybox&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;openntpd&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;chrony&amp;#39;&lt;/span> or &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>busybox&lt;span class="o">]&lt;/span> &lt;span class="c1">#用哪个作为ntp终端，默认即可&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter mirror number or URL: &lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> f &lt;span class="c1">#选择软件源，最好选择第一项，即f，会遍历所有镜像留下最快的那个&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Setup a user? &lt;span class="o">(&lt;/span>enter a lower-case loginname, or &lt;span class="s1">&amp;#39;no&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>no&lt;span class="o">]&lt;/span> alpine &lt;span class="c1">#是否新建各一般用户，是则输入用户名，否则no&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Full name &lt;span class="k">for&lt;/span> user alpine &lt;span class="o">[&lt;/span>alpine&lt;span class="o">]&lt;/span> &lt;span class="c1">#新用户的全名&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">New Password: &lt;span class="c1">#设置root用户的密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Retype password: &lt;span class="c1">#再输入一次&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter ssh key or URL &lt;span class="k">for&lt;/span> alpine &lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>none&lt;span class="o">]&lt;/span> &lt;span class="c1">#输入新用户的ssh key，直接回车给它自己处理&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Which ssh server?&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;openssh&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;dropbear&amp;#39;&lt;/span> or &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>openssh&lt;span class="o">]&lt;/span> &lt;span class="c1">#选择默认的ssh服务，一般都是用openssh，直接回车&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Which disk&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span> you like to use &lt;span class="o">(&lt;/span>or &lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nb">help&lt;/span> or &lt;span class="s1">&amp;#39;none&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>none&lt;span class="o">]&lt;/span> vda2 &lt;span class="c1">#要安装在哪个硬盘。如果前面没有手工把sda7分区添加进来这里则是空的，我这边系统中显示这个分区是vda2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">How would you like to use it? &lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;sys&amp;#39;&amp;#39;, &amp;#39;&lt;/span>data&lt;span class="s1">&amp;#39;, &amp;#39;&lt;/span>lvm&lt;span class="s1">&amp;#39; or &amp;#39;&lt;/span>?&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nb">help&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>?&lt;span class="o">]&lt;/span> sys &lt;span class="c1">#要怎么使用这个硬盘，一般选sys即可，所有文件都放在这个分区上，如果挂了多个分区可以分别配置&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Erase the above disk&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span> and &lt;span class="k">continue&lt;/span>? &lt;span class="o">[&lt;/span>y/N&lt;span class="o">]&lt;/span>: y &lt;span class="c1">#是否要格式化硬盘&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Installation is complete. Please reboot. reboot &lt;span class="c1">#是否重启&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h5 id="配置必要环境和docker">配置必要环境和Docker
&lt;/h5>&lt;p>  重启后可以直接用ssh连接alpine了，不需要再使用VNC。首先把软件包升级，Aplnes的安装器是apk，有点抽象。
  先执行&lt;code>su -&lt;/code>和&lt;code>apk update&lt;/code>拉取索引，然后用&lt;code>apk add sudo&lt;/code>安装sudo包，如果提示：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">localhost:~# apk add sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ERROR: unable to &lt;span class="k">select&lt;/span> packages:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo &lt;span class="o">(&lt;/span>no such package&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> required by: world&lt;span class="o">[&lt;/span>sudo&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>  可能是dns的问题，需要手动调整dns：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">localhost:~# vi /etc/resolv.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 223.5.5.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>  然后再重新安装sudo:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">localhost:~# apk add sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:~# vi /etc/sudoers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root &lt;span class="nv">ALL&lt;/span>&lt;span class="o">=(&lt;/span>ALL:ALL&lt;span class="o">)&lt;/span> ALL
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">alpine &lt;span class="nv">ALL&lt;/span>&lt;span class="o">=(&lt;/span>ALL:ALL&lt;span class="o">)&lt;/span> ALL &lt;span class="c1">#添加这行到上面那行下面，alpine换成实际用户名&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>  接下来安装Docker：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">localhost:~# apk add docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:~# rc-update add docker boot &lt;span class="c1">#添加docker到开机自启动&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:~# service docker start &lt;span class="c1">#启动docker服务&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:~# docker -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Docker version 28.3.3, build 980b85681696fbd95927fd8ded8f6d91bdca95b0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>  还可以给自己新增的一般用户增加docker权限：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">localhost:~# apk add shadow &lt;span class="c1">#因为alpine默认没有usermod，需要手动安装&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:~# usermod -aG docker alpine &lt;span class="c1">#alpine换成实际用户名&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:~# newgrp docker &lt;span class="c1">#重新登录用户，也可以直接注销会话再登录&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>[好软推荐] Cloudpaste-开源在线文本/文件分享平台</title><link>https://blog.tama.guru/record/cloudpaste.html</link><pubDate>Fri, 18 Jul 2025 10:21:11 +0800</pubDate><guid>https://blog.tama.guru/record/cloudpaste.html</guid><description>&lt;img src="https://images.337845818.best/20250806/6b0378c33ae92cb2cc02a8a7bce5a2fa.webp" alt="Featured image of post [好软推荐] Cloudpaste-开源在线文本/文件分享平台" />&lt;p>之前看到有人推荐了&lt;a class="link" href="https://github.com/ling-drag0n/CloudPaste" target="_blank" rel="noopener"
>cloudpaste&lt;/a>这个项目，主要作用是能够提供简单的文本及文件分享服务，前后端部分使用GitHub Action+Cloudflare Worker，存储桶部分使用Cloudflare R2等免费服务，即可实现免费使用。除了在国内因为众所周知的原因Worker域名无法访问，需要自行配置域名。&lt;/p>
&lt;p>前后端配置基本可以直接参照项目内文档：&lt;/p>
&lt;h5 id="github-仓库fork和后端配置">GitHub 仓库fork和后端配置
&lt;/h5>&lt;p>受限要将仓库fork下来，然后为fork的仓库添加变量，具体路径为仓库的&lt;code>Settings-Secrets and variables-Actions-New repository secrets&lt;/code>。添加的secrets为：&lt;/p>
&lt;ul>
&lt;li>CLOUDFLARE_API_TOKEN&lt;/li>
&lt;li>CLOUDFLARE_ACCOUNT_ID&lt;/li>
&lt;li>ENCRYPTION_SECRET&lt;/li>
&lt;/ul>
&lt;p>前面两个参数在后面获取到，后面的ENCRYPTION_SECRET可以选填，如果没有会自动生成。&lt;/p>
&lt;h5 id="cloudflare-token配置">CloudFlare TOKEN配置
&lt;/h5>&lt;p>登录CloudFlare后访问&lt;a class="link" href="https://dash.cloudflare.com/profile/api-tokens" target="_blank" rel="noopener"
>API令牌管理&lt;/a>界面，创建一个新的API令牌，模版选择&amp;quot;Cloudflare Workers&amp;quot;，并编辑内容添加D1数据库编辑权限，记录下TOKEN，即为后面要用到的&lt;code>CLOUDFLARE_API_TOKEN&lt;/code>。
&lt;code>CLOUDFLARE_ACCOUNT_ID&lt;/code>位于Cloudflare主界面的右侧。&lt;/p>
&lt;h5 id="开通d1和r2并配置pages">开通D1和R2，并配置Pages
&lt;/h5>&lt;p>D1位于左侧的存储和数据库下，的D1 SQL数据库；R2位于左侧的R2对象存储。两者都是需要点进去开通即可，其他不需要动。
D1和R2都有免费额度，可以大胆使用。&lt;/p>
&lt;h5 id="github-配置actions前端自动部署">GitHub 配置Actions前端自动部署
&lt;/h5>&lt;p>返回到GitHub仓库页，找到Actions，运行&lt;code>deploy-front-cloudflare.yml&lt;/code>这个工作流，初次运行会进行D1数据库和Pages的创建。&lt;/p>
&lt;h5 id="配置cloudflare-workers">配置CloudFlare Workers
&lt;/h5>&lt;p>Pages现在已经移动到&lt;code>计算（Workers）&lt;/code>下，找到&lt;code>Workers和Pages&lt;/code>，此时应该会看到刚才工作流创建的Pages，我的前端名称是&lt;code>cloudpaste-frontend&lt;/code>，后端为&lt;code>cloudpaste-backend&lt;/code>。
先配置&lt;code>cloudpaste-backend&lt;/code>，在项目内的&lt;code>设置-变量和机密&lt;/code>，添加一个文本类型的变量，变量名是&lt;code>ENCRYPTION_SECRET&lt;/code>，值即之前我们自己填的或者自动生成的。然后要配置&lt;code>域和路由&lt;/code>，添加一个自定义域，这里最好设置一个自己的域名（例如https://backend.tama.guru），因为默认分配的workers.dev这个域名无法直接访问，使用部分功能时会受限。
然后到配置&lt;code>cloudpaste-frontend&lt;/code>这边，也是进到&lt;code>设置&lt;/code>，找到&lt;code>变量和机密&lt;/code>，添加一个文本类型的变量，变量名是&lt;code>VITE_BACKEND_URL&lt;/code>，对应的值是刚才在&lt;code>cloudpaste-backend&lt;/code>中的&lt;code>workers.dev&lt;/code>域名或自定义的域名，注意填写末尾不带&amp;quot;/&amp;quot;。同样的，还需要在&lt;code>cloudpaste-frontend&lt;/code>的自定义域配置一个自己的域名（例如https://frontend.tama.guru），并配置好解析。&lt;/p>
&lt;h5 id="重新运行前端工作流">重新运行前端工作流
&lt;/h5>&lt;p>返回到GitHub仓库页，找到Actions，再次运行&lt;code>deploy-front-cloudflare.yml&lt;/code>这个工作流。运行完成之后之前的配置才回生效，此时可以通过https://frontend.tama.guru访问前端，而对应的后端则是https://backend.tama.guru。&lt;/p>
&lt;h5 id="完成初步配置工作">完成初步配置工作
&lt;/h5>&lt;p>访问前端地址登录后台，默认的管理员信息是：&lt;strong>用户名: admin, 密码: admin123&lt;/strong>，登录后请马上修改。&lt;/p>
&lt;h5 id="挂载s3存储">挂载S3存储
&lt;/h5>&lt;p>完成以上工作后仅能实现文本分享和编辑的功能，如果需要实现文件分享还需要配置S3存储，目前建议使用的包括R2、B2、七牛云三个，三个都有免费额度，且经过一段时间的试用相关功能都是正常的。&lt;/p>
&lt;h6 id="挂载r2存储桶">挂载R2存储桶
&lt;/h6>&lt;p>打开CloudFlare R2对象存储页面，新建一个存储桶，比如我命名为&lt;code>cloudpaste-r2&lt;/code>，并添加一个API令牌。令牌权限为读和写，制定存储桶为&lt;code>cloudpaste-r2&lt;/code>，其他不用动，保存并记录API令牌，然后点进&lt;code>cloudpaste-r2&lt;/code>存储桶，在设置下找到&lt;code>CORS策略&lt;/code>，点击编辑，内容为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;AllowedOrigins&amp;#34;: [&amp;#34;http://localhost:3000&amp;#34;, &amp;#34;https://根据自己的前端域名来替代，比如我的https://frontend.tama.guru&amp;#34;],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;AllowedMethods&amp;#34;: [&amp;#34;GET&amp;#34;, &amp;#34;PUT&amp;#34;, &amp;#34;POST&amp;#34;, &amp;#34;DELETE&amp;#34;, &amp;#34;HEAD&amp;#34;],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;AllowedHeaders&amp;#34;: [&amp;#34;*&amp;#34;],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;ExposeHeaders&amp;#34;: [&amp;#34;ETag&amp;#34;],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;MaxAgeSeconds&amp;#34;: 3600
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后回到前端页面的后台，在S3存储配置下添加一个新配置，&lt;code>配置名称&lt;/code>任意，为了区分我起名和r2存储桶一样的名字&lt;code>cloudpaste-r2&lt;/code>，&lt;code>提供商&lt;/code>为&lt;code>Cloudflare R2&lt;/code>，&lt;code>存储桶名称&lt;/code>即&lt;code>cloudpaste-r2&lt;/code>，&lt;code>存储容量&lt;/code>最好就保留10G，好像就免费10G？&lt;code>端点URL&lt;/code>按要求的格式填写&lt;code>https://&amp;lt;accountid&amp;gt;.r2.cloudflarestorage.com&lt;/code>，&lt;code>accountid&lt;/code>在cloudflare页面下可以找到，也就是前面所说的&lt;code>CLOUDFLARE_ACCOUNT_ID&lt;/code>。&lt;code>区域&lt;/code>根据建桶时所选的位置，我选的亚太，这里就填apac，默认填auto也可以。&lt;code>访问密钥 ID&lt;/code>和&lt;code>秘密访问密钥&lt;/code>即上面申请到的&lt;code>API令牌信息&lt;/code>，其他可以保持默认不变，保存即可。此时点击&lt;code>测试连接&lt;/code>，应该会提示：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">配置完全可用
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">✓ 读权限正常 ✓ 写权限正常 ✓ CORS 配置正确 ✓ 前端上传模拟成功
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果没有配置CORS，这里会提示CORS配置不正确，上传文件时也会报错。&lt;/p>
&lt;p>最后到&lt;code>挂载管理&lt;/code>处，选择&lt;code>新建挂载点&lt;/code>，&lt;code>挂载点名称&lt;/code>也是任意的，为保持一致我使用&lt;code>cloudpaste-r2&lt;/code>，&lt;code>存储类型&lt;/code>为S3存储，&lt;code>S3存储配置&lt;/code>选择刚才创建的&lt;code>cloudpaste-r2(Cloudflare R2)&lt;/code>，&lt;code>挂载路径&lt;/code>我填写的是&lt;code>/r2&lt;/code>，根据个人情况填写即可，最后&lt;code>勾选启用状态&lt;/code>，选择创建即可。 此时在文件上传页面和挂载浏览页面都可以看到这个&lt;code>r2&lt;/code>挂载点了，可以尝试上传文件，如果提示大小超限需要到后台的&lt;code>系统设置&lt;/code>中调整&lt;code>最大上传文件大小&lt;/code>，并更新设置，该选项默认为100MB。&lt;/p>
&lt;h6 id="挂载七牛云对象存储kodo">挂载七牛云对象存储kodo
&lt;/h6>&lt;p>我以七牛云作为兼容S3标准的代表，在七牛云的对象存储中选择空间管理-新建空间，存储空间名称和R2中存储桶名称意义一致，我填写的是&lt;code>cloudpaste-qiniu&lt;/code>，存储区域选择国外任意地点（选择国内需要实名），我选择北美-洛杉矶，访问控制选择为私有。还需要配置CORS规则，点进&lt;code>cloudpaste-qiniu&lt;/code>这个桶的&lt;code>空间设置&lt;/code>，&lt;code>跨域设置&lt;/code>内&lt;code>新增规则&lt;/code>，&lt;code>来源&lt;/code>填写我们的&lt;code>前端域名https://frontend.tama.guru&lt;/code>，&lt;code>允许 Methods&lt;/code>我全勾选了，然后保存。
七牛云并没有针对存储桶有单独的API密钥，需要到&lt;code>个人中心&lt;/code>中的&lt;code>密钥管理&lt;/code>，打开&lt;code>密钥访问权限&lt;/code>，并新增一组AccessKey/SecretKey，保存好这组AK和SK。
回到网站后台，操作和前面一样，只不过提供商类型要选择其他S3兼容服务，端点URL为：&lt;code>http://存储空间名称.s3.存储区域名称.qiniucs.com&lt;/code>，根据上述配置我这里对应的是&lt;code>http://cloudpaste-qiniu.s3.us-north-1.qiniucs.com&lt;/code>，访问密钥即前面的AK，秘密访问密钥即SK，保存即可，其他参照R2的添加步骤即可。
需要注意的是，七牛云的免费套餐只支持http。&lt;/p></description></item><item><title>成功考取业余无线电B证</title><link>https://blog.tama.guru/record/ham-rank-b.html</link><pubDate>Wed, 02 Jul 2025 16:08:54 +0800</pubDate><guid>https://blog.tama.guru/record/ham-rank-b.html</guid><description>&lt;img src="https://images.337845818.best/20250806/6b0378c33ae92cb2cc02a8a7bce5a2fa.webp" alt="Featured image of post 成功考取业余无线电B证" />&lt;p>去年6月的时候看到市里有这个考试，当时也经常刷到网上经常有人晒无线电通联的相关消息，觉得超酷的，买了个欧迅UV9DP，并在考试后一个月成功拿到执照。小地方也不愧是小地方，在后来这段时间里我经常拿不是很合法的设备全频段扫描，基本上除了业务波段之外就都是杂音，还买了拉伸天线、八木天线，一年到头也没碰到过人（就算有也只有偷听铁路联控和FM广播的时候），后来调查了下市里是没有中继台的，周围又都是山，要么跑到山顶上，不然通讯范围基本被限制很死。还印了点QSL卡片，看这样子怕是这辈子都发不出去。&lt;br>&lt;/p>
&lt;p>正好过一年，闲得没事的时候刷到二季度考试开始报名，而且智谱APP下线了在线考试功能，有人推测是要换题库了，而且往后会更难，赶紧进行一个报名。&lt;br>&lt;/p>
&lt;p>B类的题目其实相当一部分在A类都见过，变化的地方主要是Q码简称变多了，并新增了一些物理学计算和电路判断的题目，我主要是靠前花几天时间用电脑刷题、看看大纲、总结规律，这次也顺利考过了。&lt;br>&lt;/p>
&lt;p>接下来可以考虑整点大功率设备搞点远距离通联，毕竟小小手台功率摆在那里，希望今年能在某个时候CQ到活人吧。&lt;/p></description></item><item><title>再见了 TypeCho</title><link>https://blog.tama.guru/new-record/typecho.html</link><pubDate>Tue, 01 Jul 2025 21:46:00 +0800</pubDate><guid>https://blog.tama.guru/new-record/typecho.html</guid><description>&lt;img src="https://images.337845818.best/20250806/6b0378c33ae92cb2cc02a8a7bce5a2fa.webp" alt="Featured image of post 再见了 TypeCho" />&lt;p>在经历过wordpress、zblog等一系列重型动态博客后，我切换到typecho并持续使用了很长一段时间。
typecho很好，它很轻量，超棒的插件和主题到处都是，我甚至入正了handsome主题。&lt;br>
但是，typecho更新实在太慢，属于是没有重大BUG几年不见更新一次那种，在我升级到php8.x之后经常冒出莫名其妙的错误，再加上驱动typecho需要nginx+php+mysql环境，对我的小鸡来说负担太重了，而且网站的访问量并不大，没必要占用这么大服务器资源，如果只是为了时不时写点东西，那还不如用静态博客好了。&lt;br>
hexo用过一段时间，现在的导航页就是基于hexo搭建的，这次尝试一下hugo。&lt;br>
总而言之，文章基本都迁移过来了，剩下的评论再看看怎么导入waline，就基本完成了迁移工作。&lt;br>
也许以后不会再见，还是谢谢你两年的陪伴。&lt;/p></description></item></channel></rss>