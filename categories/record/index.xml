<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Record on 狼的公告板 ver.Hugo</title><link>https://blog.tama.guru/categories/record.html</link><description>Recent content in Record on 狼的公告板 ver.Hugo</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>tamakyi</copyright><lastBuildDate>Sat, 16 Aug 2025 01:54:20 +0000</lastBuildDate><atom:link href="https://blog.tama.guru/categories/record/index.xml" rel="self" type="application/rss+xml"/><item><title>[好软推荐] 盖世游戏-意外好用的windows游戏模拟器</title><link>https://blog.tama.guru/record/gamehub.html</link><pubDate>Wed, 07 May 2025 00:26:00 +0800</pubDate><guid>https://blog.tama.guru/record/gamehub.html</guid><description>&lt;img src="https://r2.337845818.best/tamabox/2025/07/02/686410ca3aae0.png" alt="Featured image of post [好软推荐] 盖世游戏-意外好用的windows游戏模拟器" />&lt;h4 id="前言">前言
&lt;/h4>&lt;p>放以前啊，如果要在手机上玩galgame，基本都要等krkr ons Artemis这类能够移植到多平台的引起。再后来出现了exgear、winlator等一系列模拟器，通过wine环境模拟windows运行的必要组件实现galgame的运行，但这类软件总是有一些问题，最常见的就是缺少运行库、没有中文字体等，需要自己手动打补丁，因此也有很多网友制作了“整合包”，比如[post cid=&amp;ldquo;345&amp;rdquo; /]这里提供的7.1汉化整合包，能够满足部分游戏的运行要求。但是wine哪怕不同版本，不同系统也经常有一台手机能跑另一台又跑不了的情况，而这个盖世游戏能够提供不少环境组合，貌似是目前的最优解。&lt;/p>
&lt;h4 id="软件介绍">软件介绍
&lt;/h4>&lt;p>提起盖世大家应该多少听说过小鸡模拟器这东西，后面还做了手柄啥的，我手里的g3s从大一买到现在都还能用,个人对这个牌子还挺有好感的。
那什么是盖世游戏？&lt;/p>
&lt;blockquote>
&lt;p>盖世游戏是一款多功能游戏平台，支持PC模拟器、云游戏和游戏串流。它允许用户使用手柄或触摸操作进行游戏，满足各种游戏需求。&lt;/p>&lt;/blockquote>
&lt;p>是的，除了模拟之外这玩意还能弄串流，最新版本甚至还能登录steam玩上面的游戏，但我没试过，&lt;del>也不想试&lt;/del>。
软件官网：&lt;a class="link" href="https://gamehub.xiaoji.com/zh-cn" target="_blank" rel="noopener"
>https://gamehub.xiaoji.com/zh-cn&lt;/a>
目前是免费的，不知道啥时候会收费。&lt;/p>
&lt;h4 id="软件使用">软件使用
&lt;/h4>&lt;p>安装完就是我们熟悉的注册登录环节了。。。没错，这玩意要注册才能用，但也就只需要手机号验证而已，目前不知道有什么必要，但是国产软件嘛。。。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724b0317d.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b0317d.jpg" alt="主界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b0317d.jpg"
loading="lazy"
alt="主界面"
>
主界面不算花里胡哨，基本上都是些串流的游戏，感兴趣可以自己试，我就主要说兼容层等的安装。点击左上角头像的位置（那个流汗黄豆），找到游戏库，然后到PC游戏这个地方，有个运行时，这里可以选择兼容层、转译器、GPU驱动、DXVK、VKD3D等内容的安装。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724b98007.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b98007.jpg" alt="运行时维护" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b98007.jpg"
loading="lazy"
alt="运行时维护"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724bce214.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724bce214.jpg" alt="兼容层" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724bce214.jpg"
loading="lazy"
alt="兼容层"
>
以兼容层举例，截至2025年5月6日能够支持wine9.5-10以及proton x64和arm64，这就是重点的地方了，我们跑游戏如果闪退或者碰到奇奇怪怪的地方，可以直接在这里切换兼容层、GPU驱动等内容，相比winlator要到处找包好多了，毕竟手机推galgame真的是需要多次尝试。
接下来我就拿saga的花之天使的夏日恋歌举例，把所有文件移动到手机上后，在游戏库的PC游戏这里有个加号，直接选中游戏的运行文件，即&lt;code>SiglusEngineCHS.exe&lt;/code>，之后会在PC游戏这里生成一个快捷方式，运气好的话直接点击立即游戏就能跑起来了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724bdfc98.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724bdfc98.jpg" alt="花之天使的夏日恋歌" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724bdfc98.jpg"
loading="lazy"
alt="花之天使的夏日恋歌"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724b4db06.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b4db06.jpg" alt="游戏运行主界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b4db06.jpg"
loading="lazy"
alt="游戏运行主界面"
>
有时候碰到闪退，或是花屏等问题，这就需要手动调整运行参数，具体就是点击立即游戏旁边的小齿轮，找到游戏设置。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724c18507.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c18507.jpg" alt="兼容性设置" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c18507.jpg"
loading="lazy"
alt="兼容性设置"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724c18daf.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c18daf.jpg" alt="组件设置1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c18daf.jpg"
loading="lazy"
alt="组件设置1"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724b202f3.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b202f3.jpg" alt="组件设置2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724b202f3.jpg"
loading="lazy"
alt="组件设置2"
>
需要动的基本就是兼容性设置和组件设置这两个位置，其中兼容性设置选择就是上面我们配置运行时维护安装的兼容层等配置的组合。比如说wine9.5+box64_0.32.1跑不动，就切换到proton兼容层试试，还不行？那试试换个GPU驱动。而如果进入游戏的时候提示缺少xxx组件（比如说dx组件），那就要到组件依赖这里，通过安装新组件的方式手动给当前兼容层环境打组件补丁。（注意组件依赖貌似服务器在国外，部分组件下载极度缓慢，建议尝试多个网络或者干脆挂个梯子）在多次尝试之后，游戏基本都能跑起来。
经过尝试，我使用OnePlus13+ColorOS15，在8e CPU+24G运存下目前玩的几款游戏都能完美运行：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724c49f99.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c49f99.jpg" alt="花天使" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c49f99.jpg"
loading="lazy"
alt="花天使"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724c66488.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c66488.jpg" alt="战国兰斯" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724c66488.jpg"
loading="lazy"
alt="战国兰斯"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/tamabox/2025/05/07/681b724e4fc72.jpg">
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724e4fc72.jpg" alt="你的眼眸命中我心头" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/tamabox/2025/05/07/681b724e4fc72.jpg"
loading="lazy"
alt="你的眼眸命中我心头"
>
之前还玩过几个忘记了，现在想起来写文章就把最近玩的放上来。&lt;/p>
&lt;h4 id="总结">总结
&lt;/h4>&lt;p>总的来说，盖世游戏能够提供多种兼容层组合方便切换，这是我选择它最主要的原因，而且它提供的组件依赖也比较完善，说到底就是把原来复杂的操作给简单化、图形化了，能一步到位何乐而不为？
个人评价优缺点：
优点：&lt;/p>
&lt;ul>
&lt;li>界面相对友好，白痴化操作&lt;/li>
&lt;li>提供多种兼容层和组件依赖，一步安装&lt;/li>
&lt;li>提供官方的虚拟键盘，也可以映射到实体手柄上&lt;/li>
&lt;/ul>
&lt;p>缺点：&lt;/p>
&lt;ul>
&lt;li>需要注册才能使用（关键也没什么需要注册才能用的地方），有精神洁癖估计受不了&lt;/li>
&lt;li>按国内软件的尿性保不齐啥时候就需要开始收费了&lt;/li>
&lt;li>烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫烫&lt;/li>
&lt;/ul></description></item><item><title>关于AcFun礼物统计网页的说明</title><link>https://blog.tama.guru/record/acfun-gift-count.html</link><pubDate>Sun, 04 May 2025 04:11:00 +0800</pubDate><guid>https://blog.tama.guru/record/acfun-gift-count.html</guid><description>&lt;p>服务地址：&lt;a class="link" href="http://acfun.tama.guru/acfun-tools/acfun-gift.html" target="_blank" rel="noopener"
>AcFun礼物统计&lt;/a>&lt;/p>
&lt;p>注意！！！网站不需要你提供账号密码或cookie等隐私信息，网站也不存储用户提供的任何信息，请做好个人隐私保护！！！&lt;/p>
&lt;h4 id="前言">前言
&lt;/h4>&lt;p>前面基本都是废话，请直接跳转到&lt;a class="link" href="#main" >第二部分&lt;/a>。&lt;/p>
&lt;p>&lt;del>因为基本没人给我打赏所以不怎么关注&lt;/del>，但是上次群里有在说原来的acfun统计插件无法使用了，我检查了一下发现确实是没办法正常使用。虽然通过打开插件开发者设置+全局挂梯子还可以继续安装，但是在实际使用环节中是获取不到数据的，具体问题是&lt;strong>获取收到/送出礼物失败&lt;/strong>，懒得去看是啥原因了，毕竟最近浏览器对插件的管控貌似越来越严格。
但是，经过对原插件的分析，法院获取数据源是通过&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-javascript" data-lang="javascript">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ACFUN_MOBILE_SERVER&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">URLS&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WALLET&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">SEND_GIFT&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>实现的，也就是对应的:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">https://m.acfun.cn
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">/rest/apph5-direct/pay/reward/giveRecords
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/rest/apph5-direct/pay/reward/receiveRecords
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>经过访问发现API没换，能正常访问，那只能说明是插件端的问题，希望作者修修了。&lt;/p>
&lt;h4 id="教程部分">&lt;span id="main">教程部分&lt;/span>
&lt;/h4>&lt;p>目前做了个网页，目的是让用户自己复制礼物数据提交给网站处理输出内容，虽然只是临时方案，&lt;del>有总比没有好&lt;/del>。
前提只要确保：&lt;/p>
&lt;ul>
&lt;li>正常登录了AcFun网页端&lt;/li>
&lt;/ul>
&lt;p>然后访问对应的网址，如果是&lt;strong>查询收到礼物&lt;/strong>则在登录了AcFun的同一浏览器访问：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">https://m.acfun.cn/rest/apph5-direct/pay/reward/receiveRecords
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>查询送出的礼物则是：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">https://m.acfun.cn/rest/apph5-direct/pay/reward/giveRecords
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>网页输出的内容近似于：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>&lt;span class="nt">&amp;#34;result&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;pcursor&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;*********&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;host-name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;hb2-acfun-kce-node26.aliyun&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;records&amp;#34;&lt;/span>&lt;span class="p">:[{&lt;/span>&lt;span class="nt">&amp;#34;giftCount&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;createTime&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1711986490403&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;userId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">46213698&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;giftName&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;桃子&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;azuanAmount&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;userName&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;七耳兔软糖72two&amp;#34;&lt;/span>&lt;span class="p">},{&lt;/span>&lt;span class="nt">&amp;#34;giftCount&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;createTime&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1711986486397&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;userId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">46213698&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;giftName&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;桃子&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;azuanAmount&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">480&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nt">&amp;#34;userName&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;七耳兔软糖72two&amp;#34;&lt;/span>&lt;span class="p">}]}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这样输出的结果会很乱，一是因为需要手工转换时间戳，二是API不提供按时间筛选的功能，三是它只会输出明细，所以这个网页只是为了帮你解决以上三个问题。
&lt;strong>你需要做的是&lt;/strong>：&lt;/p>
&lt;ul>
&lt;li>直接把所有内容复制过来，粘贴到网页数据输入区域。&lt;/li>
&lt;li>选择统计开始时间和结束时间，不选择的话就默认输出所有时间。&lt;/li>
&lt;li>点击获取结果。&lt;/li>
&lt;/ul>
&lt;p>最后会按UID汇总礼物信息，后附明细数据。&lt;/p>
&lt;h4 id="样例">样例
&lt;/h4>&lt;p>汇总统计：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">UID&lt;/th>
&lt;th style="text-align: center">用户名&lt;/th>
&lt;th style="text-align: center">总礼物数&lt;/th>
&lt;th style="text-align: center">总钻石数&lt;/th>
&lt;th style="text-align: center">打赏金额（元）&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">46213698&lt;/td>
&lt;td style="text-align: center">七耳兔软糖72two&lt;/td>
&lt;td style="text-align: center">7&lt;/td>
&lt;td style="text-align: center">560&lt;/td>
&lt;td style="text-align: center">0.70&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>明细数据：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">UID&lt;/th>
&lt;th style="text-align: center">用户名&lt;/th>
&lt;th style="text-align: center">礼物名称&lt;/th>
&lt;th style="text-align: center">数量&lt;/th>
&lt;th style="text-align: center">时间&lt;/th>
&lt;th style="text-align: center">钻石数&lt;/th>
&lt;th style="text-align: center">打赏金额（元）&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">46213698&lt;/td>
&lt;td style="text-align: center">七耳兔软糖72two&lt;/td>
&lt;td style="text-align: center">桃子&lt;/td>
&lt;td style="text-align: center">1&lt;/td>
&lt;td style="text-align: center">2024/4/1 23:48:10&lt;/td>
&lt;td style="text-align: center">80&lt;/td>
&lt;td style="text-align: center">0.10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">46213698&lt;/td>
&lt;td style="text-align: center">七耳兔软糖72two&lt;/td>
&lt;td style="text-align: center">桃子&lt;/td>
&lt;td style="text-align: center">6&lt;/td>
&lt;td style="text-align: center">2024/4/1 23:48:06&lt;/td>
&lt;td style="text-align: center">480&lt;/td>
&lt;td style="text-align: center">0.60&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>如何避免大数字自动安装大数字看图(360AlbumViewer)</title><link>https://blog.tama.guru/record/anti-360albumviewer.html</link><pubDate>Fri, 25 Apr 2025 14:52:00 +0800</pubDate><guid>https://blog.tama.guru/record/anti-360albumviewer.html</guid><description>&lt;p>单位电脑上强制要使用大数字，自从某数字推出了极速版，相比起原版的臃肿倒是简洁了不少，把一些选项关掉后还真就老老实实干活基本上没出现过什么问题。但是从上个月开始，右键菜单就多了个&amp;quot;360看图&amp;quot;的选项，可真是恶心人。而且这玩意不会出现在开始菜单里面，需要到控制面板里面找出来卸载掉，问题是卸载了下次不知道啥时候就会突然冒出来（至今我也没找到到底是点了什么地方导致的），只能先按照对付其他流氓软件的方法处理了。&lt;/p>
&lt;p>软件的安装目录位于&lt;code>C:\Program Files (x86)\360AlbumViewer&lt;/code>，使用控制面板卸载该软件后会残留一个垃圾文件，卸载完后软件是无法直接删除这个文件夹的，会显示被占用，需要手动重启（普通模式或者安全模式都可以）后会自动删除。&lt;/p>
&lt;p>然后我们需要在原位置下新建一个&lt;code>360AlbumViewer&lt;/code>文件夹，右键属性切换安全选项卡，点击高级，把所有者修改为你当前的用户名（找不到就点高级-立即查找），把文件夹及其继承全部修改掉再应用确认。此时安全选项卡下得组或用户名应该只剩下当前用户名这一个选项，点击编辑，把所有权限给拒绝掉，然后保存，现在这个文件夹的读写权限就都没了。&lt;/p>
&lt;p>目前还没死灰复燃，如果有情况再更新。&lt;/p>
&lt;p>需要注意的是以下路径会有一些残余垃圾，建议手动删除:
&lt;code>C:\Program Files (x86)\360\360Safe\Utils\360AlbumViewer&lt;/code>
&lt;code>C:\Users\admin\AppData\Roaming\360Safe\360AlbumViewer64Ex&lt;/code>
注册表里就算卸载了还有很多不干净的东西，查找&lt;code>360AlbumViewer&lt;/code>都删掉吧。&lt;/p>
&lt;p>也顺便记录一下大数字极速版一些该关掉的东西：&lt;/p>
&lt;ul>
&lt;li>软件设置内
&lt;ol>
&lt;li>基本设置-&lt;code>用户体验改善计划&lt;/code>&lt;/li>
&lt;li>弹窗设置-&lt;code>网购安全提示&lt;/code>、&lt;code>邮件安全提示&lt;/code>、&lt;code>聊天安全提示&lt;/code>、&lt;code>下载安全提示（可选）&lt;/code>、&lt;code>WIFI安全提示&lt;/code>、&lt;code>垃圾清理提示（空闲提醒、软件卸载残留提醒）&lt;/code>、&lt;code>硬件驱动提示&lt;/code>、&lt;code>游戏优化结果提醒&lt;/code>、&lt;code>性能模式&lt;/code>、&lt;code>资讯推荐&lt;/code>、&lt;code>AI办公推荐&lt;/code>。基本上这里都要关掉，除非有需求的功能再单个开启。&lt;/li>
&lt;li>开机小助手-&lt;code>取消所有勾选&lt;/code>&lt;/li>
&lt;li>安全防护中心-&lt;code>看片安全防护&lt;/code>、&lt;code>搜索安全防护&lt;/code>，应用防护-&lt;code>文档图片防护&lt;/code>（可能是这个东西导致&lt;code>360AlbumViewer&lt;/code>被安装？待核实）&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>软件管家设置内
&lt;ol>
&lt;li>安装升级-升级设置-&lt;code>开启智能升级提醒功能&lt;/code>&lt;/li>
&lt;li>卸载设置-&lt;code>强力卸载-根据需求该关的关&lt;/code>&lt;/li>
&lt;li>快捷设置-快捷方式-关掉“&lt;code>在桌面上添加大数字软件管家的快捷方式&lt;/code>和&lt;code>定期修复大数字软件管家的桌面快捷方式&lt;/code>&lt;/li>
&lt;li>其他设置-未知文件设置-&lt;code>当您打开位置文件时，为您推荐适合软件&lt;/code>和&lt;code>智能推荐设置-通过智能分析，为您提供问题解决方案和产品功能&lt;/code>&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;p>还有浏览器极速版，现在也变得乱七八糟的了，也写一下：&lt;/p>
&lt;ul>
&lt;li>选项内
&lt;ol>
&lt;li>基本选项-搜索-&lt;code>在被选中文本的右上角显示“划词搜索工具条”&lt;/code>、&lt;code>启用搜索栏的热搜词推荐功能&lt;/code>和&lt;code>地址栏搜索展示联想词&lt;/code>。&lt;/li>
&lt;li>界面设置-工具栏-显示头像&lt;/li>
&lt;li>高级设置-后台应用-&lt;code>最小化浏览器到系统托盘&lt;/code>、&lt;code>关闭浏览器后最小化到系统托盘&lt;/code>、&lt;code>保护您和您的设备不受危险网站的侵害&lt;/code>。&lt;/li>
&lt;li>实验室-AI大会员-&lt;code>在浏览器工具栏显示“360AI大会员”按钮&lt;/code>，后台加速-&lt;code>关闭浏览器后，后台最少进程运行，实现加速启动浏览器&lt;/code>。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul></description></item><item><title>搭建自己的轨迹记录程序 Traccar</title><link>https://blog.tama.guru/record/traccar.html</link><pubDate>Sun, 20 Apr 2025 05:57:00 +0800</pubDate><guid>https://blog.tama.guru/record/traccar.html</guid><description>&lt;p>今天外出玩耍的时候突发奇想我能不能每天记录一下自己每天的生活轨迹，百度了下已经有很多成熟的应用了，但是这种比较私密的数据要发送到别人的服务器上说实话我是不太想的，然后去github上找了下，发现了好几个方案，都尝试了一遍，主要是&lt;a class="link" href="https://github.com/cctyl/TrackRecord" target="_blank" rel="noopener"
>https://github.com/cctyl/TrackRecord&lt;/a>，搭完发现太简陋了，不适合我，其他几个更是已经几年没更新了，最后尝试了下traccar，感觉算是比较成熟的方案，也符合我的需求。&lt;/p>
&lt;h4 id="正常安装">正常安装
&lt;/h4>&lt;p>其官网位于：&lt;a class="link" href="https://www.traccar.org/" target="_blank" rel="noopener"
>https://www.traccar.org/&lt;/a>，项目主要仓库在Github上：&lt;a class="link" href="https://github.com/traccar/traccar" target="_blank" rel="noopener"
>https://github.com/traccar/traccar&lt;/a>。直接去release上根据服务器类型下载对应的文件就行了，目前linux支持arm和x64，windows仅支持x64。以我在树莓派上运行为例，下载之后解压执行就能自动配置好：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">wget https://bgithub.xyz/traccar/traccar/releases/download/v6.6/traccar-linux-arm-6.6.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip traccar-linux-arm-6.6.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./traccar.run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl start traccar.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>再等个几分钟（树莓派太慢了，所以会很久），就可以访问&lt;code>设备IP:8082&lt;/code>进入管理界面。初次使用需要配置服务名称、邮箱和密码，然后使用邮箱和密码登录即可。&lt;/p>
&lt;h4 id="使用docker安装">使用docker安装
&lt;/h4>&lt;p>首先执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run --rm --entrypoint cat traccar/traccar:latest /opt/traccar/conf/traccar.xml &amp;gt; /root/traccar/traccar.xml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中&lt;code>/root/traccar/traccar.xml&lt;/code>根据实际情况配置，我的配置文件放在&lt;code>/root/traccar&lt;/code>下所以这么弄了。
然后执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run -d --restart always --name traccar --hostname traccar -p 8082:8082 -p 5023:5023 -p 5023:5023/udp -p 5055:5055 -p 5055:5055/udp -v /root/traccar/traccar/logs:/opt/traccar/logs:rw -v /root/traccar/traccar.xml:/opt/traccar/conf/traccar.xml:ro -v /root/traccar/templates:/opt/traccar/templates/short -e &lt;span class="nv">TZ&lt;/span>&lt;span class="o">=&lt;/span>Asia/Shanghai traccar/traccar:latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里所有的&lt;code>/root/traccar&lt;/code>都要根据实际情况修改，然后确保&lt;code>8082 5023 5055&lt;/code>这三个端口都是没有被占用的，有的话改到其他端口下。
同样再等个几分钟，就可以访问&lt;code>设备IP:8082&lt;/code>进入管理界面。初次使用需要配置服务名称、邮箱和密码，然后使用邮箱和密码登录即可。&lt;/p>
&lt;h4 id="修改数据库">修改数据库
&lt;/h4>&lt;p>默认情况下它使用的是h2作为数据库，这是一种开源的关系型数据库，采用Java语言编写，数据存储于内存内，为了保证数据安全建议修改为mysql连接方式。
具体操作是修改数据目录下的&lt;code>traccar.xml&lt;/code>文件，原内容是：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;lt;?xml &lt;span class="nv">version&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span> &lt;span class="nv">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;UTF-8&amp;#34;&lt;/span>?&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;!DOCTYPE properties SYSTEM &lt;span class="s1">&amp;#39;http://java.sun.com/dtd/properties.dtd&amp;#39;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;properties&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;!-- Documentation: https://www.traccar.org/configuration-file/ --&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.driver&amp;#39;&lt;/span>&amp;gt;org.h2.Driver&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.url&amp;#39;&lt;/span>&amp;gt;jdbc:h2:./data/database&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.user&amp;#39;&lt;/span>&amp;gt;sa&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.password&amp;#39;&lt;/span>&amp;gt;&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;/properties&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;lt;?xml &lt;span class="nv">version&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span> &lt;span class="nv">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;UTF-8&amp;#34;&lt;/span>?&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;!DOCTYPE properties SYSTEM &lt;span class="s1">&amp;#39;http://java.sun.com/dtd/properties.dtd&amp;#39;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;properties&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;!-- Documentation: https://www.traccar.org/configuration-file/ --&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.driver&amp;#39;&lt;/span>&amp;gt;com.mysql.cj.jdbc.Driver&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.url&amp;#39;&lt;/span>&amp;gt;jdbc:mysql://sql地址:端口/数据库名称?zeroDateTimeBehavior&lt;span class="o">=&lt;/span>round&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">serverTimezone&lt;/span>&lt;span class="o">=&lt;/span>UTC&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">allowPublicKeyRetrieval&lt;/span>&lt;span class="o">=&lt;/span>true&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">useSSL&lt;/span>&lt;span class="o">=&lt;/span>false&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">allowMultiQueries&lt;/span>&lt;span class="o">=&lt;/span>true&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">autoReconnect&lt;/span>&lt;span class="o">=&lt;/span>true&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">useUnicode&lt;/span>&lt;span class="o">=&lt;/span>yes&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">characterEncoding&lt;/span>&lt;span class="o">=&lt;/span>UTF-8&lt;span class="p">&amp;amp;&lt;/span>a&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.user&amp;#39;&lt;/span>&amp;gt;数据库用户名&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.password&amp;#39;&lt;/span>&amp;gt;数据库密码&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;/properties&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存文件，如果使用正常方式安装的执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl restart traccar.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果使用的是docker则执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker restart 容器ID
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>需要注意的是修改数据库不会把h2上的数据迁移过去，所以需要重新设置密码。&lt;/p>
&lt;h4 id="添加设备">添加设备
&lt;/h4>&lt;p>Github上提供了编译好的APP，支持IOS和安卓，可以直接下载安装。
下载完后需要添加好定位权限并锁定后台，然后在APP中修改服务器地址，比如服务器IP是&lt;code>192.168.50.121&lt;/code>，那这里就要填写&lt;code>http://192.168.50.121:5055&lt;/code>。当然，这是针对没有公网的情况，如果需要在外网访问就自行做穿透。
然后记录下显示的&lt;code>设备编码&lt;/code>，是个6位数字。
&lt;code>精度&lt;/code>可选高中低，应该是越高耗电越多。
&lt;code>定位频率&lt;/code>：多久一次上报位置信息，我设置了1200秒，不需要太高。
后面&lt;code>距离&lt;/code>、&lt;code>角度&lt;/code>等我没调整。&lt;/p>
&lt;h4 id="网页端使用">网页端使用
&lt;/h4>&lt;p>要做的主要就是连接设备和配置地图信息了。&lt;/p>
&lt;h5 id="连接设备">连接设备
&lt;/h5>&lt;p>点击&lt;code>左上角的加号&lt;/code>，会跳转到&lt;code>设备页面&lt;/code>，要求的必填项有&lt;code>名称&lt;/code>和&lt;code>标识符&lt;/code>，&lt;code>名称&lt;/code>可以随意填写，&lt;code>标识符&lt;/code>就是刚才我们手机上的六位数字，如果手机端配置地址无误，几秒钟之后手机的位置和电量就显示在网页上了。可以查看到详细的经纬度、海拔和轨迹信息。&lt;/p>
&lt;h5 id="配置地图信息">配置地图信息
&lt;/h5>&lt;p>设置里的首选项第一行的地图中可选的地图很多，红色需要添加key或者付费，免费的支持LocatioIQ、谷歌、高德等地图，但是高德会因为你知道的原因产生偏移，可以通过修改编译原文件的方式解决，但我就算了，不一定用高德其他效果也还不错。&lt;/p>
&lt;h4 id="其他">其他
&lt;/h4>&lt;h5 id="添加两步验证">添加两步验证
&lt;/h5>&lt;p>如果要暴露在公网上，建议还是添加个2FA保护登录信息，具体操作是在设置的服务器选项下的属性，点击添加，属性选择启用一次性密码，然后确认添加，在出现的启用一次性密码复选框上打勾，此时到设置的账户界面会多一行一次性密码密钥，点击里面有个刷新按钮，然后就弹出密钥了，把它复制到那些两步验证APP上保存即可，网页端也要记得点击保存。&lt;/p>
&lt;h5 id="感想">感想
&lt;/h5>&lt;p>这个东西整体基本符合我的要求，该有的功能都有了，配置里还有很多个性化玩法，也看到有好多人把这东西接入hass或者rednode，后面我也会研究研究。
当然该吐槽的也要吐槽，基于JAVA的东西是真吃内存啊，光容器就吃掉了800M+的内存，mysql那边也盯着内存不放，还好树莓派买的4G版，不然真不敢玩。&lt;/p></description></item><item><title>[软件推荐]Next-terminal堡垒机</title><link>https://blog.tama.guru/record/next-terminal.html</link><pubDate>Mon, 14 Apr 2025 20:49:20 +0800</pubDate><guid>https://blog.tama.guru/record/next-terminal.html</guid><description>&lt;p>说说一直在用的这个堡垒机软件，官网是：&lt;a class="link" href="https://docs.next-terminal.typesafe.cn/" target="_blank" rel="noopener"
>https://docs.next-terminal.typesafe.cn/&lt;/a>，提供了开源和付费两个版本，开源版本完全够用，但是在此基础上有更高需求的可以考虑专业版，之前我都是白嫖，但今天我看了下单用户专业版永久限时只要177，马上就买了。
先上点图：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2025/04/14/67fd024ba4c24.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2025/04/14/67fd024ba4c24.png" alt="主界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2025/04/14/67fd024ba4c24.png"
loading="lazy"
alt="主界面"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2025/04/14/67fd027c2a792.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2025/04/14/67fd027c2a792.png" alt="资产管理" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2025/04/14/67fd027c2a792.png"
loading="lazy"
alt="资产管理"
>
界面很简洁很直观，支持OTP，安全性是有保证的。&lt;/p>
&lt;h4 id="安装和使用">安装和使用
&lt;/h4>&lt;p>我是从1.x版本升级上来的，官方文档表示两者并不完全兼容，因此我使用2.x版本的时候直接选择重新搭建了。
官方推荐使用的方式是Docker允许，分为PostgreSQL + Next Terminal和Mysql + Next Terminal以及原生安装三种模式，使用docker最大的好处就是一步到位，不用做很多事，但是因为我自身的原因不得不选择原生安装的方式。
原生安装直接参照官方的文档：&lt;a class="link" href="https://docs.next-terminal.typesafe.cn/install/native-install.html" target="_blank" rel="noopener"
>https://docs.next-terminal.typesafe.cn/install/native-install.html&lt;/a>
需要注意的是安装 Next Terminal这里执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tar -zxvf next-terminal.tar.gz -C /usr/local/next-terminal
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>后，需要到&lt;code>/usr/local/next-terminal&lt;/code>内修改配置文件，主要是&lt;code>数据库&lt;/code>和&lt;code>guacd&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">database:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> enabled: &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type: sqlite &lt;span class="c1"># 可选 mysql,sqlite,postgres 选择对应的数据库类型之后，请填写对应的数据库配置&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sqlite:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: ./data/nt.db
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># postgres:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># hostname: localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># port: 5432&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># username: next-terminal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># password: next-terminal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># database: next-terminal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># mysql:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># hostname: localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># port: 3306&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># username: terminal-new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># password: terminal-new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># database: terminal-new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> guacd:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> drive: &lt;span class="s2">&amp;#34;/usr/local/next-terminal/data/drive&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> hosts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - hostname: 127.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> port: &lt;span class="m">4822&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> weight: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>主要就是根据数据库的类型修改type，然后把对应的注释删掉，填写信息就行了，&lt;code>guacd&lt;/code>这里需要把&lt;code>hostname&lt;/code>修改一下，原来的内容是&lt;code>guacd&lt;/code>，手动改成&lt;code>127.0.0.1&lt;/code>，不然后面RDP跑不起来。&lt;/p></description></item><item><title>使用tinystatus构建一个轻量化的状态监测站</title><link>https://blog.tama.guru/record/tinystatus.html</link><pubDate>Sat, 29 Mar 2025 12:26:33 +0800</pubDate><guid>https://blog.tama.guru/record/tinystatus.html</guid><description>&lt;p>本站之前基本上都是使用site-status+UptimeRobot这样的监控方案，算是常用且成熟的一种方式了，界面也美观，但问题是，它太大了，几个js+css轻松干到500k。放在本地占用带宽是个问题，放在oss上如果被无聊的人拿来做坏事也不是很好玩，于是还是要从源头解决，换用一个更小的方案，即目前的tinystatus方案。&lt;/p>
&lt;p>官方提供的demo:&lt;a class="link" href="https://lab.bdro.fr/tinystatus/" target="_blank" rel="noopener"
>here&lt;/a>&lt;/p>
&lt;p>tinystatus的构成包括三个文件：&lt;code>tinystatus&lt;/code>、&lt;code>checks.csv&lt;/code>、&lt;code>incidents.txt&lt;/code>。&lt;/p>
&lt;p>&lt;code>checks.csv&lt;/code>是需要监控的服务列表，格式为:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Command, Expected Code, Status Text, Host to check
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>
&lt;p>Command：监控服务类型，支持http ping port三种类型，可指定使用IPv4或IPv6监控，比如http4 http6。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Expected Code：返回的正常值，比如http服务返回200时为正常&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Status Text：服务的名称&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Host to check：服务的链接/IP/端口&lt;/p>
&lt;p>&lt;code>incidents.txt&lt;/code>可以手工写入事件等信息，没有格式要求。&lt;/p>
&lt;p>&lt;code>tinystatus&lt;/code>即主程序，一个简单的脚本，通过&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>&lt;code>tinystatus&lt;/code>即主程序，很简单的一个脚本，作用就是通过&lt;code>nc&lt;/code> &lt;code>curl&lt;/code> &lt;code>ping&lt;/code>三个命令实现对&lt;code>checks.csv&lt;/code>内进行监控然后通过内置的html模版输出成html文件，因此它只有一个用法：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./tinystatus
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>或者&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./tinystatus &amp;gt; index.html
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>输出的html大小在3k左右，可以说是非常小了。&lt;/p>
&lt;p>原版非常简单，我在原版的基础上稍微美化了下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/env sh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Configuration variables&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">TITLE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;狼的状态板 3.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">HEADER&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;全局状态&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CHECKS_FILE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="k">:-&lt;/span>&lt;span class="nv">checks&lt;/span>&lt;span class="p">.csv&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="c1">#读取监控列表&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">INCIDENTS_FILE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">2&lt;/span>&lt;span class="k">:-&lt;/span>&lt;span class="nv">incidents&lt;/span>&lt;span class="p">.txt&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="c1">#读取公告文件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">OUTAGE_RC&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">TIMEOUT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">USER_AGENT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;User-Agent: Mozilla/5.0 (X11; Linux x86_64; Debian) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>mktemp -d&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">command_exists&lt;span class="o">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> ! &lt;span class="nb">command&lt;/span> -v &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;/dev/null 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>1&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="s2">&amp;#34;错误:未找到组件 &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> ,请自行安装&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">get_element&lt;span class="o">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">2&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> awk -v &lt;span class="nv">col&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -F&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;{gsub(/^[ \t]+|[ \t]+$/, &amp;#34;&amp;#34;, $col); print $col}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">check&lt;span class="o">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">check&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">2&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">3&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">expected_rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">4&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">5&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">ipversion&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">check&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> grep -o &lt;span class="s1">&amp;#39;[46]$&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">check&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> http*&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>curl -&lt;span class="si">${&lt;/span>&lt;span class="nv">ipversion&lt;/span>&lt;span class="si">}&lt;/span>sSkLo /dev/null -H &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">USER_AGENT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -m &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TIMEOUT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -w &lt;span class="s2">&amp;#34;%{http_code}&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">host&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> 2&amp;gt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko.info&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -s &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko.info&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sed -e &lt;span class="s1">&amp;#39;s,curl: ([0-9]*) ,,&amp;#39;&lt;/span> -i &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko.info&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Status code: &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">, expected: &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">expected_rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko.info&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>&lt;span class="p">;;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ping*&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ping -&lt;span class="si">${&lt;/span>&lt;span class="nv">ipversion&lt;/span>&lt;span class="si">}&lt;/span>W &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TIMEOUT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -c &lt;span class="m">1&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">host&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;/dev/null 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -ne &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">expected_rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;Host unreachable&amp;#39;&lt;/span> &amp;gt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko.info&amp;#34;&lt;/span>&lt;span class="p">;;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> port*&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">error&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>nc -&lt;span class="si">${&lt;/span>&lt;span class="nv">ipversion&lt;/span>&lt;span class="si">}&lt;/span>w &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TIMEOUT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -zv &lt;span class="si">${&lt;/span>&lt;span class="nv">host&lt;/span>&lt;span class="si">}&lt;/span> 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>1&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -ne &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">expected_rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">error&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> sed -e &lt;span class="s1">&amp;#39;s,nc: ,,&amp;#39;&lt;/span> &amp;gt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko.info&amp;#34;&lt;/span>&lt;span class="p">;;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">esac&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># verity status and write files&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -eq &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">expected_rc&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ok&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.ko&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Verify requirements&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">command_exists &lt;span class="s1">&amp;#39;curl&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">command_exists &lt;span class="s1">&amp;#39;nc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">command_exists &lt;span class="s1">&amp;#39;ping&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir -p &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Execute checks&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="nv">IFS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>&lt;span class="nb">printf&lt;/span> &lt;span class="s1">&amp;#39;\n&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="nb">read&lt;/span> -r line&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">check&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>get_element &lt;span class="m">1&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">line&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>get_element &lt;span class="m">2&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">line&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>get_element &lt;span class="m">3&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">line&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>get_element &lt;span class="m">4&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">line&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> check &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">check&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">host&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">code&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> : &lt;span class="k">$((&lt;/span>id++&lt;span class="k">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span> &amp;lt; &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">CHECKS_FILE&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">wait&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">OUTAGES_COUNT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>ls &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&amp;#34;&lt;/span>*.ko &lt;span class="p">|&lt;/span> wc -l&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Generate HTML&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &lt;span class="s">&amp;lt;&amp;lt; EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;!DOCTYPE html&amp;gt;&amp;lt;html lang=&amp;#34;zh_CN&amp;#34;&amp;gt;&amp;lt;head&amp;gt;&amp;lt;meta charset=&amp;#34;utf-8&amp;#34;&amp;gt;&amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1, shrink-to-fit=no&amp;#34;&amp;gt;&amp;lt;title&amp;gt;${TITLE}&amp;lt;/title&amp;gt;&amp;lt;style&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">body { font-family: segoe ui,Roboto,Oxygen-Sans,Ubuntu,Cantarell,helvetica neue,Verdana,sans-serif;background-image: url(&amp;#39;background.png&amp;#39;);background-size: cover;background-position: center;background-repeat: no-repeat;}
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">h1 { margin-top: 30px; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">ul { padding: 0px; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">li { list-style: none; margin-bottom: 2px; padding: 5px; border-bottom: 1px solid #ddd; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.container { max-width: 600px; width: 100%; margin: 15px auto; background-color: rgba(0, 0, 0, 0.5); padding: 20px; border-radius: 10px; color: white; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.panel { text-align: center; padding: 10px; border: 0px; border-radius: 5px; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.failed-bg { color: white; background-color: #E25D6A; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.success-bg { color: white; background-color: #52B86A; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.failed { color: #E25D6A; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.success { color: #52B86A; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.small { font-size: 80%; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.status { float: right; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.footer { text-align: center; margin-top: 20px; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">.footer a { text-decoration: none; color: #52B86A; text-shadow: 1px 1px 2px black; }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;/style&amp;gt;&amp;lt;/head&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;body&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;div class=&amp;#39;container&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;h1&amp;gt;${HEADER}&amp;lt;/h1&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">OUTAGES_COUNT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -ne &lt;span class="m">0&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;ul&amp;gt;&amp;lt;li class=&amp;#39;panel failed-bg&amp;#39;&amp;gt;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">OUTAGES_COUNT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> 个服务中断&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;ul&amp;gt;&amp;lt;li class=&amp;#39;panel success-bg&amp;#39;&amp;gt;所有服务运行正常&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &lt;span class="s">&amp;lt;&amp;lt; EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;h1&amp;gt;服务&amp;lt;/h1&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;ul&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> file in &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&amp;#34;&lt;/span>*.ko&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> -e &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="k">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;li&amp;gt;&lt;/span>&lt;span class="k">$(&lt;/span>cat &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2"> &amp;lt;span class=&amp;#39;small failed&amp;#39;&amp;gt;(&lt;/span>&lt;span class="k">$(&lt;/span>cat &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">.info&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">)&amp;lt;/span&amp;gt;&amp;lt;span class=&amp;#39;status failed&amp;#39;&amp;gt;已中断&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> file in &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&amp;#34;&lt;/span>*.ok&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> -e &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="k">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;li&amp;gt;&lt;/span>&lt;span class="k">$(&lt;/span>cat &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2"> &amp;lt;span class=&amp;#39;status success&amp;#39;&amp;gt;正常运作&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &lt;span class="s">&amp;lt;&amp;lt; EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;/ul&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;p class=small&amp;gt; 最后检查时间: $(date +%FT%T%z)&amp;lt;/p&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -f &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">INCIDENTS_FILE&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;h1&amp;gt;事件&amp;lt;/h1&amp;gt;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -s &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">INCIDENTS_FILE&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sed &lt;span class="s1">&amp;#39;s|^\(.*\)$|&amp;lt;p&amp;gt;\1&amp;lt;/p&amp;gt;|&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">INCIDENTS_FILE&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;p&amp;gt;没有事件需要通报 ;)&amp;lt;/p&amp;gt;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &lt;span class="s">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;div class=&amp;#39;footer&amp;#39;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;lt;a href=&amp;#34;https://blog.tama.guru&amp;#34;&amp;gt;公告板&amp;lt;/a&amp;gt; |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;lt;a href=&amp;#34;https://box.tama.guru&amp;#34;&amp;gt;提问箱&amp;lt;/a&amp;gt; |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;lt;a href=&amp;#34;https://share.tama.guru&amp;#34;&amp;gt;盘&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;/div&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Cleanup and exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -r &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">TMP_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">OUTAGE_RC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">OUTAGES_COUNT&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>主要就是&lt;del>汉化了&lt;/del>添加了背景，添加了一点css和footer。&lt;/p>
&lt;p>需要注意的是nc命令可能不是默认安装的，需要手工安装&lt;code>netcat&lt;/code>才能正常运行。&lt;/p>
&lt;p>最后可以通过crontab来定时执行，实现自动刷新：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">10　　*　　*　　*　　*　　&lt;span class="nv">$tinystatus目录&lt;/span>/tinystatus &amp;gt; $网页目录/index.html
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>又或者可以直接整合进脚本里。&lt;/p></description></item><item><title>使用vercel+neon方案搭建无需服务器的umami统计服务</title><link>https://blog.tama.guru/record/umami.html</link><pubDate>Wed, 26 Mar 2025 12:23:06 +0800</pubDate><guid>https://blog.tama.guru/record/umami.html</guid><description>&lt;h5 id="为什么要用umami">为什么要用umami
&lt;/h5>&lt;p>在此之前，本站及相关网站服务需要用到统计的地方，都用的是自建的matomo，这是个非常强大的网页统计服务，强大到有些臃肿，这次大搬家我就在想，我真的有必要耗费有限的服务器资源来实现到头来可能一次都用不到的功能吗？答案当然是不，经过一番对比，最终我决定换用ackee或者umami。这两个统计工具都支持无服务器部署，但我还是选择了umami。以下是umami和matomo的一些区别：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">对比项目&lt;/th>
&lt;th style="text-align: center">matomo&lt;/th>
&lt;th style="text-align: center">umami&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">项目大小&lt;/td>
&lt;td style="text-align: center">26MB（5.3.1）&lt;/td>
&lt;td style="text-align: center">1.83MB（github仓库）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">JS文件大小&lt;/td>
&lt;td style="text-align: center">67460 bytes&lt;/td>
&lt;td style="text-align: center">2,713 bytes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">支持serverless&lt;/td>
&lt;td style="text-align: center">理论上支持&lt;/td>
&lt;td style="text-align: center">支持&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">支持2FA&lt;/td>
&lt;td style="text-align: center">是&lt;/td>
&lt;td style="text-align: center">否&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">可定制化JS名称&lt;/td>
&lt;td style="text-align: center">否&lt;/td>
&lt;td style="text-align: center">是&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">使用数据库&lt;/td>
&lt;td style="text-align: center">mysql&lt;/td>
&lt;td style="text-align: center">mysql/PostgreSQL&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">API丰富程度&lt;/td>
&lt;td style="text-align: center">非常丰富&lt;/td>
&lt;td style="text-align: center">无&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>从文件大小上来看umami真的是轻量化了很多，对网站速度都有很大优化。不支持2FA是个扣分项，但服务和数据库都在云端，不需要登录服务器使用，算是没太大影响。数据库这方面使用neon提供的免费Postgre套餐可以满足项目使用需求，所以理论上是不需要投入任何费用的。至于API，仅有官方服务的会提供，自建的版本是没有的。&lt;/p>
&lt;h5 id="vercel部署和neon数据库">vercel部署和neon数据库
&lt;/h5>&lt;p>先去&lt;a class="link" href="https://console.neon.tech" target="_blank" rel="noopener"
>neon&lt;/a>使用github或者google账号登录，首次登录会要求新建项目(&lt;code>Create Project&lt;/code>)，只需要输入项目名称(&lt;code>Project Name&lt;/code>)、数据库名称(&lt;code>Database name&lt;/code>)并选择地域(&lt;code>Region&lt;/code>)，前两项根据自己需求填写，地域根据vercel分配一般选择AWS US三个中的一个即可。&lt;/p>
&lt;p>新建完先要点进项目，左侧&lt;code>Project&lt;/code>下有个&lt;code>Branches&lt;/code>，点击&lt;code>Primary compute&lt;/code>下方的蓝字，默认是0.25-2CU，点进去把&lt;code>Configure the autoscaling range&lt;/code>拖动到只有0.25，并点击&lt;code>SAVE&lt;/code>。之所以要这么做，是因为neon的免费套餐包含0.5G的存储、0.5G的每月数据传输、10个项目和每个项目10个分支、10000的最大并发数，&lt;strong>190的计算时长&lt;/strong>。这里的计算时长(compute hours)关联的是运行的CPU数据、服务器运行时长，比如CU是2，每天运行24小时，一个月的计算时长=2x24x30=1440，这对190来说显然是超出太多了，而调整成0.25则=0.25x24*30=180，正好够用。虽然他支持0.25-2之间的动态调整，谁知道什么情况下突然拉起来，这个情况下数据库就被停了，所以最好调整下。&lt;/p>
&lt;p>然后回到项目页面，找到&lt;code>Connect&lt;/code>，点进去把左下角的&lt;code>Show Passowrd&lt;/code>点开，然后复制&lt;code>Connect to your database&lt;/code>的内容备用。&lt;/p>
&lt;p>注册vercel账号并使用github登录，按照官方文档&lt;a class="link" href="https://umami.is/docs/guides/running-on-vercel" target="_blank" rel="noopener"
>官方文档&lt;/a>直接把项目仓库Fork到自己的github并登录vercel导入这个仓库，或者直接&lt;a class="link" href="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fumami-software%2Fumami&amp;amp;env=DATABASE_URL" target="_blank" rel="noopener"
>一键Deploy&lt;/a>。在&lt;code>New Project&lt;/code>页面输入&lt;code>Private Repository Name&lt;/code>，随意即可，再点&lt;code>Create&lt;/code>。&lt;/p>
&lt;p>然后配置环境变量，一般只需要三个：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">变量名称&lt;/th>
&lt;th style="text-align: center">含义&lt;/th>
&lt;th style="text-align: center">必须&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">DATABASE_URL&lt;/td>
&lt;td style="text-align: center">数据库地址，即上面使用neon拿到的&lt;code>Connect to your database&lt;/code>的内容。如果是mysql格式为:mysql://username:mypassword@localhost:3306/数据库名称&lt;/td>
&lt;td style="text-align: center">是&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">HASH_SALT&lt;/td>
&lt;td style="text-align: center">一串随机字符串&lt;/td>
&lt;td style="text-align: center">否&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TRACKER_SCRIPT_NAME&lt;/td>
&lt;td style="text-align: center">追踪JS文件的名称，不设置默认是umami.js&lt;/td>
&lt;td style="text-align: center">否&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>再点击&lt;code>Deploy&lt;/code>，等待2~3分钟即完成部署。&lt;/p>
&lt;p>因为vercel提供的vercel.app域名在国内无法解析，部署完成后点进项目的&lt;code>Settings&lt;/code>下的&lt;code>Domains&lt;/code>，选择&lt;code>Add&lt;/code>，在&lt;code>Domain&lt;/code>输入你自己的域名，点&lt;code>Add Domain&lt;/code>保存。至于域名从哪来，可以去一些提供免费二级域名的服务商获取。然后去服务商CNAME解析域名到cname.vercel-dns.com保存，一两分钟后会自动申请好SSL证书，就可以通过自己的域名访问了。&lt;/p>
&lt;h5 id="umami设置">umami设置
&lt;/h5>&lt;p>umami部署后默认的用户名密码是admin/umami，登录进去在个人资料可以修改语言成中文，在设置下的用户可以修改和添加用户名和密码。&lt;/p>
&lt;p>在网站页面点击添加网站，输入名称和域名，完成后点击域名的设置，在跟踪代码下可以找到那串script，放到网页的**&lt;/head>**之前即可。&lt;/p>
&lt;p>完成之后刷新一下访问统计就出来了。&lt;/p>
&lt;h5 id="感觉">感觉
&lt;/h5>&lt;p>因为直接使用vercel的cdn，访问速度真的很快，而且也没有什么多余的东西。使用matomo的时候不知道是不是我的配置问题访问来源一直出不来，现在也能显示了。虽然没有独立app，直接使用网页访问也是非常顺滑的，而且他没有办法显示访客的具体机型、浏览器版本、系统版本等信息，比如matomo下会显示为&lt;code>Xiaomi 15, Chrome 117.xx.xx, Android 15&lt;/code>，umami就只有&lt;code>Android, Chrome&lt;/code>这种信息，对我来说意义不大。&lt;/p></description></item><item><title>使用fruity-pikvm实现在64位raspios上运行pikvm</title><link>https://blog.tama.guru/record/fruity-pikvm.html</link><pubDate>Sat, 08 Feb 2025 11:35:42 +0800</pubDate><guid>https://blog.tama.guru/record/fruity-pikvm.html</guid><description>&lt;p>我这个树莓派4买了好多年，基本上是吃灰的状态。因为自从我买了一套pikvm外设装上去之后，基本上就只能跑pikvm的那个魔改archlinux，我就是感觉各种别扭。一方面32位的arm系统并不能发挥PI4的性能，很多软件（包括一些容器）最低也需要aarch；另一方面，pikvm软件源在国内的访问速度简直就是一坨**，就算是挂了梯子都不一定能连的上，更不用说更新软件了。&lt;/p>
&lt;p>今天偶然发现fruity-pikvm这个项目（https://github.com/jacobbar/fruity-pikvm），看介绍能够&amp;quot;将 PiKVM 安装移植到其他 SBC，如 OrangePi、BananaPi、MangoPi 等。且已在已在 OrangePi Zero 2 上进行了测试，目前，此脚本支持架构 &lt;strong>arm64/aarch64&lt;/strong> 和 armhf/armv7l，并且应该适用于任何基于 Debian 的发行版，例如 Ubuntu、&lt;strong>Debian&lt;/strong>、Armbian 等&amp;hellip;&amp;hellip;&amp;quot;&lt;/p>
&lt;p>哦？&lt;/p>
&lt;p>我直接跑回家下了坨2024-11-19的raspios刷上去，配置完环境之后直接按照步骤执行fruity-pikvm安装:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo apt install -y git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ git clone https://kkgithub.com/jacobbar/fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ &lt;span class="nb">cd&lt;/span> fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ sudo ./install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装过程只需要按一下y，其他都是在编译、安装和测试过程。但是最后安装fruity-pikvm时出现了错误：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">--&amp;gt;&amp;gt; installing fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Selecting previously unselected package fruity-pikvm.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dpkg: regarding fruity-pikvm_0.2_arm64.deb containing fruity-pikvm, pre-dependency problem:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fruity-pikvm pre-depends on iptables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> iptables is not installed.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dpkg: error processing archive fruity-pikvm_0.2_arm64.deb &lt;span class="o">(&lt;/span>--install&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pre-dependency problem - not installing fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Errors were encountered &lt;span class="k">while&lt;/span> processing:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo: kvmd: &lt;span class="nb">command&lt;/span> not found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reboot and enjoy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>他依赖iptables，但是raspiso默认没有，那装一个完了再重新安装fruity-pikvm就是了：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ wget https://github.com/jacobbar/fruity-pikvm/releases/download/debfile/fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ sudo dpkg -i fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>接着继续报错，但是整体是能安装了：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ sudo dpkg -i fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>Reading database ... &lt;span class="m">133479&lt;/span> files and directories currently installed.&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Preparing to unpack fruity-pikvm_0.2_arm64.deb ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Unpacking fruity-pikvm &lt;span class="o">(&lt;/span>0.2&lt;span class="o">)&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Setting up fruity-pikvm &lt;span class="o">(&lt;/span>0.2&lt;span class="o">)&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Ensuring KVMD users and groups ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd&amp;#39;&lt;/span> with GID 991.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-pst&amp;#39;&lt;/span> with GID 990.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-ipmi&amp;#39;&lt;/span> with GID 989.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-vnc&amp;#39;&lt;/span> with GID 988.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-nginx&amp;#39;&lt;/span> with GID 987.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-janus&amp;#39;&lt;/span> with GID 986.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-certbot&amp;#39;&lt;/span> with GID 985.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - The main daemon&lt;span class="o">)&lt;/span> with UID &lt;span class="m">991&lt;/span> and GID 991.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-pst&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - Persistent storage&lt;span class="o">)&lt;/span> with UID &lt;span class="m">990&lt;/span> and GID 990.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-ipmi&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - IPMI to KVMD proxy&lt;span class="o">)&lt;/span> with UID &lt;span class="m">989&lt;/span> and GID 989.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-vnc&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - VNC to KVMD/Streamer proxy&lt;span class="o">)&lt;/span> with UID &lt;span class="m">988&lt;/span> and GID 988.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-nginx&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - HTTP entrypoint&lt;span class="o">)&lt;/span> with UID &lt;span class="m">987&lt;/span> and GID 987.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-janus&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - Janus WebRTC Gateway&lt;span class="o">)&lt;/span> with UID &lt;span class="m">986&lt;/span> and GID 986.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-certbot&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - Certbot-Renew &lt;span class="k">for&lt;/span> KVMD-Nginx&lt;span class="o">)&lt;/span> with UID &lt;span class="m">985&lt;/span> and GID 985.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Generating KVMD-Nginx certificate ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ mkdir -p /etc/kvmd/nginx/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ rm -f &lt;span class="s1">&amp;#39;/etc/kvmd/nginx/ssl/*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ &lt;span class="nb">cd&lt;/span> /etc/kvmd/nginx/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl ecparam -out server.key -name prime256v1 -genkey
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl req -new -x509 -sha256 -nodes -key server.key -out server.crt -days &lt;span class="m">3650&lt;/span> -subj /C&lt;span class="o">=&lt;/span>RU/ST&lt;span class="o">=&lt;/span>Moscow/L&lt;span class="o">=&lt;/span>Moscow/O&lt;span class="o">=&lt;/span>PiKVM/OU&lt;span class="o">=&lt;/span>PiKVM/CN&lt;span class="o">=&lt;/span>localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chown root:kvmd-nginx /etc/kvmd/nginx/ssl/server.crt /etc/kvmd/nginx/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">440&lt;/span> /etc/kvmd/nginx/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">444&lt;/span> /etc/kvmd/nginx/ssl/server.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">755&lt;/span> /etc/kvmd/nginx/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Generating KVMD-VNC certificate ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ mkdir -p /etc/kvmd/vnc/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ rm -f &lt;span class="s1">&amp;#39;/etc/kvmd/vnc/ssl/*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ &lt;span class="nb">cd&lt;/span> /etc/kvmd/vnc/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl ecparam -out server.key -name prime256v1 -genkey
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl req -new -x509 -sha256 -nodes -key server.key -out server.crt -days &lt;span class="m">3650&lt;/span> -subj /C&lt;span class="o">=&lt;/span>RU/ST&lt;span class="o">=&lt;/span>Moscow/L&lt;span class="o">=&lt;/span>Moscow/O&lt;span class="o">=&lt;/span>PiKVM/OU&lt;span class="o">=&lt;/span>PiKVM/CN&lt;span class="o">=&lt;/span>localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chown root:kvmd-vnc /etc/kvmd/vnc/ssl/server.crt /etc/kvmd/vnc/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">440&lt;/span> /etc/kvmd/vnc/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">444&lt;/span> /etc/kvmd/vnc/ssl/server.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">755&lt;/span> /etc/kvmd/vnc/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Disabling nginx service, so that we can use kvmd-nginx instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Synchronizing state of nginx.service with SysV service script with /lib/systemd/systemd-sysv-install.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Executing: /lib/systemd/systemd-sysv-install disable nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Removed &lt;span class="s2">&amp;#34;/etc/systemd/system/multi-user.target.wants/nginx.service&amp;#34;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Disabling janus service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Synchronizing state of janus.service with SysV service script with /lib/systemd/systemd-sysv-install.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Executing: /lib/systemd/systemd-sysv-install disable janus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Removed &lt;span class="s2">&amp;#34;/etc/systemd/system/multi-user.target.wants/janus.service&amp;#34;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Ensuring KVMD-Webterm users and groups ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-webterm&amp;#39;&lt;/span> with GID 984.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-webterm&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>Pi-KVM - Web terminal&lt;span class="o">)&lt;/span> with UID &lt;span class="m">984&lt;/span> and GID 984.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Making tesseract data &lt;span class="nv">link&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Creating symlinks &lt;span class="k">for&lt;/span> use with kvmd python &lt;span class="nv">scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Adding path to python &lt;span class="k">for&lt;/span> KVMD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/lib/dpkg/info/fruity-pikvm.postinst: line 76: /usr/local/lib/python3.10/dist-packages/site-packages.pth: No such file or &lt;span class="nv">directory&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Fixing armbian otg &lt;span class="nv">takeover&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Enabling kvmd-nginx kvmd-webterm kvmd-otg and kvmd services, but &lt;span class="k">do&lt;/span> not start them.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-nginx.service → /lib/systemd/system/kvmd-nginx.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-webterm.service → /lib/systemd/system/kvmd-webterm.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-otg.service → /lib/systemd/system/kvmd-otg.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd.service → /lib/systemd/system/kvmd.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-fix.service → /lib/systemd/system/kvmd-fix.service.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里报错的&lt;code>/usr/local/lib/python3.10/dist-packages/site-packages.pth: No such file or directory&lt;/code>在项目的issus中有类似表述：（&lt;a class="link" href="https://github.com/jacobbar/fruity-pikvm/issues/5" target="_blank" rel="noopener"
>Use a release with preinstalled python 3.10 for easier installation · Issue #5 · jacobbar/fruity-pikvm&lt;/a>），也就是python库默认没有添加kvmd-packages这个问题，检测是否真的出现可以使用&lt;code>kvmd -m&lt;/code>命令测试，通常会提示&lt;code>No module named 'kvmd'&lt;/code>。解决办法就是手动添加路径到默认库：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /usr/local/lib/python3.10/site-packages/kvmd.pth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#写入内容：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/local/lib/python3.10/kvmd-packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#保存&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /usr/local/lib/python3.10/dist-packages/site-packages.pth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#写入内容：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/local/lib/python3.10/kvmd-packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#保存&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>/usr/local/lib/python3.10/dist-packages/&lt;/code>这个路径可能不存在，可以手动创建。&lt;/p>
&lt;p>完成之后重启PI，使用IP访问，发现提示500 ISE，检查kvmd-nginx进程发现丢失&lt;code>kvmd.sock&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo systemctl status kvmd-nginx.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect&lt;span class="o">()&lt;/span> to unix:/run/kvmd/kvmd.sock failed &lt;span class="o">(&lt;/span>2: No such file or directory&lt;span class="o">)&lt;/span> &lt;span class="k">while&lt;/span> connecting to upstream, client: *.0.0.*, server: localhost, request: &lt;span class="s2">&amp;#34;GET / HTTP/2.0&amp;#34;&lt;/span>, subrequest: &lt;span class="s2">&amp;#34;/auth_check&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这个问题在上面的issus上也有提到，但是只说了python库默认没有添加kvmd-packages这个问题如何解决，500报错并没有解决。然后我继续检查日志：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/bin/kvmd&amp;#34;&lt;/span>, line 9, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: main&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/__init__.py&amp;#34;&lt;/span>, line 75, in main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: KvmdServer&lt;span class="o">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/server.py&amp;#34;&lt;/span>, line 263, in run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: comp.sysprep&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/plugins/hid/otg/__init__.py&amp;#34;&lt;/span>, line 114, in sysprep
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: &lt;span class="nv">udc&lt;/span> &lt;span class="o">=&lt;/span> usb.find_udc&lt;span class="o">(&lt;/span>self.__udc&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/usb.py&amp;#34;&lt;/span>, line 34, in find_udc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: raise RuntimeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Can&amp;#39;t find any UDC&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: RuntimeError: Can&lt;span class="err">&amp;#39;&lt;/span>t find any UDC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里抛出一个&lt;code>Can't find any UDC&lt;/code>的错误，UDC我查了下应该指的是&lt;code>USB Device Controller&lt;/code>，检查是否有相关设备：&lt;code>lsmod | grep usb&lt;/code>发现返回确实是空值。搜了下这个关键词，在&lt;a class="link" href="https://techblog.jeppson.org/2022/03/fix-kvmd-not-starting-after-updating-pikvm/" target="_blank" rel="noopener"
>Fix KVMD not starting after updating piKVM - Technicus&lt;/a>这篇文章中发现有人提到在PI4上也出现了这个问题，然后我按照他在文章说的修改config.txt配置文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /boot/firmware/config.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#添加以下内容到最后&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>tc358743
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>disable-bt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>dwc2,dr_mode&lt;span class="o">=&lt;/span>peripheral
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#结束&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后再执行&lt;code>lsmod | grep usb&lt;/code>，发现能检测到设备了。作者应该是对照了pikvm官方系统的配置文件和raspios的配置文件发现差异。&lt;/p>
&lt;p>在这个issus下也有相关讨论：&lt;a class="link" href="https://kkgithub.com/Prototyped/pikvm-container/issues/1" target="_blank" rel="noopener"
>RuntimeError：找不到任何 UDC ·问题 #1 ·原型/pikvm 容器&lt;/a>，这里的操作是：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo /usr/sbin/modprobe libcomposite
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /etc/modules-load.d/kvmd.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#添加以下内容&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dwc2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">libcomposite
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#保存&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这个方法选择不动&lt;code>config.txt&lt;/code>配置文件，看上去也更安全，但是我用的是第一种方法，第二种并没有效果。&lt;/p>
&lt;p>到这里的时候网页端已经能够使用admin/admin访问了，但是进入kvm页面发现无法显示，然后检查日志的时候发现疯狂报错：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer ERROR --- Unexpected streamer error: &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2793&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/streamer.py&amp;#34;&lt;/span>, line 428, in __streamer_task_loop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> raise RuntimeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Streamer unexpectedly died&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RuntimeError: Streamer unexpectedly died
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.info.system ERROR --- Can&lt;span class="err">&amp;#39;&lt;/span>t parse streamer features
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/info/system.py&amp;#34;&lt;/span>, line 69, in __get_streamer_info
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>status, name&lt;span class="o">)&lt;/span> &lt;span class="o">=&lt;/span> map&lt;span class="o">(&lt;/span>str.strip, line.split&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ValueError: not enough values to unpack &lt;span class="o">(&lt;/span>expected 2, got 1&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer INFO --- Started streamer &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>2835: /usr/bin/ustreamer --device&lt;span class="o">=&lt;/span>/dev/kvmd-video --persistent --format&lt;span class="o">=&lt;/span>mjpeg --resolution&lt;span class="o">=&lt;/span>1920x1080 --desired-fps&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> --drop-same-frames&lt;span class="o">=&lt;/span>&lt;span class="m">30&lt;/span> --last-as-blank&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --unix&lt;span class="o">=&lt;/span>/run/kvmd/ustreamer.sock --unix-rm --unix-mode&lt;span class="o">=&lt;/span>&lt;span class="m">0660&lt;/span> --exit-on-parent-death --process-name-prefix&lt;span class="o">=&lt;/span>kvmd/streamer --notify-parent --no-log-colors --sink&lt;span class="o">=&lt;/span>kvmd::ustreamer::jpeg --sink-mode&lt;span class="o">=&lt;/span>&lt;span class="m">0660&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; /usr/bin/ustreamer: error &lt;span class="k">while&lt;/span> loading shared libraries: libjpeg.so.8: cannot open shared object file: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer ERROR --- Unexpected streamer error: &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2835&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>他要&lt;code>libjpeg.so.8&lt;/code>这个东西，但很明显我没有：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo find / -name libjpeg*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/aarch64-linux-gnu/libjpeg.so.62
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/aarch64-linux-gnu/libjpegxr.so.1.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/aarch64-linux-gnu/libjpeg.so.62.3.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在https://github.com/jacobbar/fruity-pikvm/issues/5中，他简单粗暴的从5.4的镜像里面提取出libjpeg.so.8和libjpeg.so.8.2.2两个文件扔到系统的&lt;code>/usr/lib/aarch64-linux-gnu&lt;/code>里。现在版本都飞到6.6.74了，肯定是没5.4，那只能自己编译个：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.4.290.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ tar xvf linux-5.4.290.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ &lt;span class="nb">cd&lt;/span> linux-5.4.290
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ cp /boot/config-&lt;span class="k">$(&lt;/span>uname -r&lt;span class="k">)&lt;/span> .config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ nano .config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#把 #CONFIG_TRUSTED_KEYS is not set 修改为 CONFIG_TRUSTED_KEYS=&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel/linux-5.4.290 $ make menuconfig &lt;span class="c1">#需要调整配置用&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ make -j4 &lt;span class="c1">#四线程编译&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果怕跑到半掉了可以开个screen。&lt;/p>
&lt;p>&lt;strong>但是！我发现另一台不记得是香蕉还是香橙的PI的docker内居然找到了这玩意，反正一样是aarch，直接狠狠替换。&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> tamakyi@akarinbot-arm64:~$ sudo find / -name libjpeg*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>sudo&lt;span class="o">]&lt;/span> tamakyi 的密码：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/lib/docker/overlay2/001ccded49667e443e6b0d924d49a33745a8cf2634056ada168e84a81aeae3ac/diff/usr/lib/libjpeg.so.8.2.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/lib/docker/overlay2/001ccded49667e443e6b0d924d49a33745a8cf2634056ada168e84a81aeae3ac/diff/usr/lib/libjpeg.so.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>还是不行，再看一下日志：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:06 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: RuntimeError: Streamer unexpectedly died
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- Started streamer &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>2914: /usr/bin/ustreamer --device&lt;span class="o">=&lt;/span>/dev/kvmd-video --persistent --format&lt;span class="o">=&lt;/span>mjpeg --resolution&lt;span class="o">=&lt;/span>1920x1080 --desired-fps&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> --drop-same-frames&lt;span class="o">=&lt;/span>&lt;span class="m">30&lt;/span> --last-as-blank&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --unix&lt;span class="o">=&lt;/span>/run/kvmd/ustreamer.sock --unix-rm --unix-mode&lt;span class="o">=&lt;/span>0660&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; /usr/bin/ustreamer: error &lt;span class="k">while&lt;/span> loading shared libraries: libc.musl-aarch64.so.1: cannot open shared object file: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer ERROR --- Unexpected streamer error: &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2914&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/streamer.py&amp;#34;&lt;/span>, line 428, in __streamer_task_loop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: raise RuntimeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Streamer unexpectedly died&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>又缺个&lt;code>libc.musl-aarch64.so.1&lt;/code>，去网上找了下，没有提到这个文件的信息，但是有&lt;code>libc.musl-x86_64.so.1&lt;/code>，换汤不换药嘛，那就&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo apt install musl musl-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo ln -s /usr/lib/aarch64-linux-musl/libc.so /lib/libc.musl-aarch64.so.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo systemctl restart kvmd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>现在登陆进去没异常了，但是提示&lt;code>No Singal&lt;/code>，再看看日志文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- Starting streamer ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- Started streamer &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>8263: /usr/bin/ustreamer --device&lt;span class="o">=&lt;/span>/dev/kvmd-video --persistent --format&lt;span class="o">=&lt;/span>mjpeg --resolution&lt;span class="o">=&lt;/span>1920x1080 --desired-fps&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> --drop-same-frames&lt;span class="o">=&lt;/span>&lt;span class="m">30&lt;/span> --last-&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.203 main&lt;span class="o">]&lt;/span> -- Starting PiKVM uStreamer 5.37 ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 main&lt;span class="o">]&lt;/span> -- Using internal blank placeholder
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 main&lt;span class="o">]&lt;/span> -- Using JPEG-sink: kvmd::ustreamer::jpeg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 main&lt;span class="o">]&lt;/span> -- Listening HTTP on UNIX socket &lt;span class="s1">&amp;#39;/run/kvmd/ustreamer.sock&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 stream&lt;span class="o">]&lt;/span> -- Using V4L2 device: /dev/kvmd-video
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 stream&lt;span class="o">]&lt;/span> -- Using desired FPS: &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; &lt;span class="o">================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- ERROR &lt;span class="o">[&lt;/span>1037.205 stream&lt;span class="o">]&lt;/span> -- Can&lt;span class="s1">&amp;#39;t access device: No such file or directory
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">2月 07 17:13:30 akarinbot kvmd[7433]: kvmd.apps.kvmd.streamer INFO --- =&amp;gt; -- INFO [1037.205 stream] -- Waiting for the device access ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">2月 07 17:13:30 akarinbot kvmd[7433]: kvmd.apps.kvmd.streamer INFO --- =&amp;gt; -- INFO [1037.206 http] -- Starting HTTP eventloop ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">2月 07 17:13:31 akarinbot kvmd[7433]: aiohttp.access INFO --- [admin (token) / -] &amp;#39;&lt;/span>GET /auth/check HTTP/1.0&lt;span class="s1">&amp;#39; =&amp;gt; 200; size=194 --- referer=&amp;#39;&lt;/span>https://*.*.*.*/kvm/&lt;span class="s1">&amp;#39;; user_agent=&amp;#39;&lt;/span>Mozilla/5.0 &lt;span class="o">(&lt;/span>Linux&lt;span class="p">;&lt;/span> Android 10&lt;span class="p">;&lt;/span> K&lt;span class="o">)&lt;/span> AppleWebKit/537&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:31 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1038.367 http&lt;span class="o">]&lt;/span> -- HTTP: NEW client &lt;span class="o">(&lt;/span>&lt;span class="nv">now&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">)&lt;/span>: &lt;span class="o">[&lt;/span>100.74.203.35&lt;span class="o">]&lt;/span>:0, &lt;span class="nv">id&lt;/span>&lt;span class="o">=&lt;/span>bad9da595991fbbf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>基本上正常了，但还有一个&lt;code>Can't access device: No such file or directory&lt;/code>，总之先保证能跑起来了，真是心累。&lt;/p></description></item><item><title>狼的日记本 上线了</title><link>https://blog.tama.guru/record/dairy.html</link><pubDate>Mon, 30 Dec 2024 22:29:00 +0800</pubDate><guid>https://blog.tama.guru/record/dairy.html</guid><description>&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772ae9f88f02.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772ae9f88f02.png" alt="主界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772ae9f88f02.png"
loading="lazy"
alt="主界面"
>
是的，又搭怪东西了，这次上线的是&lt;a class="link" href="https://diary.tama.guru/diary" target="_blank" rel="noopener"
>日记&lt;/a>。
搭这玩意完全是因为昨晚上准备睡觉前突发奇想，我要不要记一下每天的生活和杂事，省得哪天突然会忘记什么重要的事情。但是日记这东西属于是比较隐私的东西，肯定不能直接往博客里扔，一是时间一长不打理后台会变得乱糟糟的，另一方面我不可能每次都要给文章上密码，就为了写几个字，那样太费劲了。我也曾想过去应用商店找一些APP，但很多都只提供云端备份服务，没办法本地导出，这意味着我需要注册一个账号，提供邮箱甚至手机号等信息，然后还要把我那些屁话上传，反正我是有点精神洁癖，不希望我比较隐私的数据不被自己管控。当然，最重要的一点是&lt;del>鸿蒙Next用户没那么多选择&lt;/del>。所以，我的需求就成了：&lt;/p>
&lt;ul>
&lt;li>多平台。&lt;/li>
&lt;li>数据不依赖云端，要么就是能自己管控。&lt;/li>
&lt;/ul>
&lt;p>按这个要求最佳的选择自然就是使用浏览器的开源程序了，服务直接放在自己的服务器上自己也放心，而且浏览器就不会有什么客户端的限制了，也非常符合我能用网页绝对不多安装个程序的原则。
一开始我找到的是&lt;a class="link" href="https://gitee.com/Yu-core/SwashbucklerDiary" target="_blank" rel="noopener"
>侠客日记&lt;/a>，看上去功能很强大，但是去看了下源码居然是用.NET的，直接就放弃了，最后选择的是&lt;a class="link" href="https://github.com/KyleBing/diary" target="_blank" rel="noopener"
>标题日记&lt;/a>。前端&lt;code>vue3&lt;/code>+&lt;code>ts&lt;/code>+&lt;code>vite&lt;/code>，后端&lt;code>nodejs&lt;/code>，运行起来占用非常小，非常适合我这种买不起大鸡的小站长:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> root@*:~# ps aux &lt;span class="p">|&lt;/span> grep npm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root &lt;span class="m">2057203&lt;/span> 0.0 1.7 &lt;span class="m">720260&lt;/span> &lt;span class="m">64948&lt;/span> pts/5 Sl+ 16:53 0:00 npm run serve
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root &lt;span class="m">2068496&lt;/span> 0.0 0.0 &lt;span class="m">6240&lt;/span> &lt;span class="m">648&lt;/span> pts/0 S+ 21:38 0:00 grep npm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>搭建很简单，前后端都有很详细的文档，如果有需要建议直接去项目下面一步一步跟着做。
功能基本上能满足我的要求：&lt;/p>
&lt;h4 id="日记撰写">日记撰写
&lt;/h4>&lt;p>默认提供了很多分类和时间天气等信息的记录，而且支持MD格式写作。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a4d7d791b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a4d7d791b.png" alt="选项" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a4d7d791b.png"
loading="lazy"
alt="选项"
>
虽然不支持直接上传图片，但是借助第三方图床工具也能实现图片显示。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a5ac4353b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a5ac4353b.png" alt="支持MD和HTML格式" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a5ac4353b.png"
loading="lazy"
alt="支持MD和HTML格式"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a5c87b729.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a5c87b729.png" alt="显示效果" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a5c87b729.png"
loading="lazy"
alt="显示效果"
>&lt;/p>
&lt;h4 id="附属功能">附属功能
&lt;/h4>&lt;p>附属功能目前包含四个&lt;/p>
&lt;ul>
&lt;li>银行卡信息记录功能&lt;/li>
&lt;li>记账单&lt;/li>
&lt;li>待办事项记录&lt;/li>
&lt;li>&lt;del>经期记录&lt;/del>&lt;/li>
&lt;/ul>
&lt;p>第一个功能先不说了，谁会把这东西放到网上啊&amp;hellip;姑且也写一下用法，就直接生成一个名为&lt;code>我的银行卡列表&lt;/code>的文章，内容按照下面的格式记录，就能得到银行卡信息界面：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Markdown" data-lang="Markdown">&lt;span class="line">&lt;span class="cl">银行：民生银行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">卡号：6*** &lt;span class="ge">**&lt;/span>** &lt;span class="ge">**&lt;/span>** &lt;span class="ge">**&lt;/span>**
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">类别：储蓄卡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">开户行：山东济南办卡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">刷卡次数：5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">银行：民生银行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">卡号：6*** &lt;span class="ge">**&lt;/span>** &lt;span class="ge">**&lt;/span>** &lt;span class="ge">**&lt;/span>**
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">类别：信用卡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">开户行：山东济南办卡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">额度：20000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">验证码：123/4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">到期日：2029-08-10
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772aa5a7de36.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772aa5a7de36.png" alt="银行卡" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772aa5a7de36.png"
loading="lazy"
alt="银行卡"
>&lt;/p>
&lt;p>第二个倒是挺实用，直接在账单分类下按这样的格式记录信息，就能形成日账单记录：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Markdown" data-lang="Markdown">&lt;span class="line">&lt;span class="cl">买菜 -330
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">吃饭 -120
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">敲诈勒索 +200
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a70da04f4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a70da04f4.png" alt="账单信息汇总" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a70da04f4.png"
loading="lazy"
alt="账单信息汇总"
>
第三个功能也差不多，类似这样的格式:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-Markdown" data-lang="Markdown">&lt;span class="line">&lt;span class="cl">&lt;span class="k">-&lt;/span> 阿巴阿巴
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">= 买大疆 Mavic Classic 3 #￥9000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">= 坐飞机
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>即可获得这样的效果：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a9b331b9b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a9b331b9b.png" alt="待办事项" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772a9b331b9b.png"
loading="lazy"
alt="待办事项"
>&lt;/p>
&lt;p>第四个，经期记录，我看了测试站，貌似是在&lt;code>备忘&lt;/code>下生成一个经期记录的标题，内容是:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">2024-12-20, 2024-12-26
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2024-11-22, 2024-11-28
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>即可在日历界面生成&lt;del>不安全的日子&lt;/del>：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/30/6772ac1d5223a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772ac1d5223a.png" alt="经期记录" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/30/6772ac1d5223a.png"
loading="lazy"
alt="经期记录"
>&lt;/p>
&lt;p>其他还有一些小功能，比如：&lt;/p>
&lt;ol>
&lt;li>配置好所在城市后会自动填写当天的天气（根据和风天气API获取）&lt;/li>
&lt;li>前台显示、隐藏文章内容&lt;/li>
&lt;li>支持csv、json、txt、sql格式数据导出和账户注销&lt;/li>
&lt;li>单篇日记内容分享&lt;/li>
&lt;/ol>
&lt;p>当然，这半天的使用我也发现了一些小问题，比如：&lt;/p>
&lt;ol>
&lt;li>后台总会有奇奇怪怪的报错，这个后续再研究&lt;/li>
&lt;li>支持上传头像，但是只支持七牛云，而七牛云不备案域名是没办法开启HTTPS的，而且临时域名会在30天后过期，对于常年全站HTTPS的站长真的折磨。&lt;/li>
&lt;/ol></description></item><item><title>鸿蒙Next居然兼容安卓了？</title><link>https://blog.tama.guru/record/android-on-harmony.html</link><pubDate>Tue, 03 Dec 2024 23:03:56 +0800</pubDate><guid>https://blog.tama.guru/record/android-on-harmony.html</guid><description>&lt;p>昨天，有消息称Next的应用商店上架了出境易，用过华子的都知道这玩意可以用过某些&lt;del>不可告人&lt;/del>的方式来实现对某些国外应用的安装和使用，所以这次上架就有意思了,因为这上面的几乎所有应用目前基本上不会为Next做适配，那就说明它会通过某种方法来兼容安卓应用来实现运行如上应用的能力。&lt;/p>
&lt;h4 id="出境易">出境易
&lt;/h4>&lt;p>安装过程就不介绍了，首次运行的时候需要下载将近600M的数据并且重启系统，一开始我也以为是个虚拟机，但后面tg上有人放出一张截图，疑似是通过lxc来跑安卓容器实现的。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f145f185fa.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f145f185fa.png" alt="疑似容器" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f145f185fa.png"
loading="lazy"
alt="疑似容器"
>
出境易内置了一个microG套件，G家软件基本上都可以使用了，如果是市场里没有的应用可以从GPlay检索获取，但是有一些不是很正规的应用很明显是没办法直接在市场里面找到的。
市场内可以找到edge浏览器，安装后基本上能够正常使用（存在一些小问题，比如掉帧和莫名的黑屏），然后我去找到个clash的安装包，edge下载之后会调用出境易安装，居然成功了&amp;hellip;
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f16631ec7d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f16631ec7d.png" alt="clash安装成功" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f16631ec7d.png"
loading="lazy"
alt="clash安装成功"
>
然后我再试着安装其他应用，却显示&amp;quot;该应用未与出境易达成合作，暂不支持安装&amp;quot;
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f16966d219.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f16966d219.png" alt="其他应用却无法安装" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f16966d219.png"
loading="lazy"
alt="其他应用却无法安装"
>
看来正如网上说，出境易是有一套应用白名单的，匹配到的应用才会允许安装。但我尝试去telegram官网下载安装，一样会提示&amp;quot;该应用未与出境易达成合作，暂不支持安装&amp;quot;，而出境易市场内的telegram却能正常安装，我暂且蒙在鼓里。&lt;/p>
&lt;h4 id="卓易通">卓易通
&lt;/h4>&lt;p>安装出境易之后还带了另一个叫卓易通的应用，这东西默认是隐藏的，需要手动启用。
具体操作是使用出境易下载程序管理类应用来手动启用。
比如我是出境易日区的市场，可以找到一个设备信息的应用：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f1909ea64e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f1909ea64e.png" alt="Device Info" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f1909ea64e.png"
loading="lazy"
alt="Device Info"
>
安装之后切换到应用程序页面的系统菜单项，找到卓易通和文件共享，点开之后点开右上角的小齿轮，选择启用即可。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f19687820e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f19687820e.png" alt="激活应用" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f19687820e.png"
loading="lazy"
alt="激活应用"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f198a1881e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f198a1881e.png" alt="激活应用2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f198a1881e.png"
loading="lazy"
alt="激活应用2"
>
然后我们回到Device Info，找到文件共享这个应用，点开选择发动，就会进入一个类似文件管理器的界面，再这个地方可以选择下载好的apk调用卓易通安装了。
如果上面的界面无法显示应用，也没有弹窗申请授权获取应用列表的话，需要手动到出境易里面找到Device Info授权。
卓易通可以安装大部分的应用，但不是全部，因为卓易通和出境易恰恰相反，卓易通采用的是黑名单机制，在黑名单上的应用都无法安装，除此之外一些盗版应用和涩涩应用也无法安装，比如eh&amp;hellip;
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/12/03/674f1b7540bf0.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f1b7540bf0.png" alt="ehviewer" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/12/03/674f1b7540bf0.png"
loading="lazy"
alt="ehviewer"
>&lt;/p>
&lt;h4 id="总结">总结
&lt;/h4>&lt;p>上架出境易这个应用无疑是能缓解目前Next应用不足且质量参差不齐的情况，这也是鸿蒙生态目前最大的问题，但这次改变会让我留在Next吗？不会，原因如下：&lt;/p>
&lt;ul>
&lt;li>操作繁琐。上面使用卓易通安装需要每次都要从Device Info进入文件共享。&lt;/li>
&lt;li>别扭。总感觉后台多了个容器，耗电会有所增加。而且每次切到后台再切回去有大概率应用会重启，后台驻留能力超弱&amp;hellip;&lt;/li>
&lt;li>BUG多。目前我碰到的问题包括但不限于：Edge切换页面时的短暂黑屏、视频类应用顶部的大白边、无法调用系统相册（即使授权了）等。&lt;/li>
&lt;li>搞不来涩涩。&lt;/li>
&lt;/ul></description></item><item><title>3D打印初体验 - 拓竹P1SC</title><link>https://blog.tama.guru/record/p1sc.html</link><pubDate>Mon, 28 Oct 2024 17:53:30 +0800</pubDate><guid>https://blog.tama.guru/record/p1sc.html</guid><description>&lt;h4 id="前言">前言
&lt;/h4>&lt;p>其实想买个打印机好久了，但一直没下定决心，一方面是现实里事务繁忙，无心去细细了解，另一方面则是这类东西价格都挺高的，动不动大几千。虽然某鱼上几百块的DIY打印机倒是很多，我是不想初体验就花大量时间去调这调那，影响体验。于是在今年双十一前夕某天在对照了猫狗多三个平台之后，以4199的价格购入拓竹P1SC。（其实开始是想直接买A1的，然后感觉买都买了为什么不彩打，就去看了A1SC，又看到A1SC是开放式结构，打印某些耗材需要封箱，而且稳定性也不好，看着看着就看到P1SC去了&amp;hellip;而且事后刷贴吧发现有人在叠加政府补贴之后只需要三千六七就拿到了，那叫一个恨呐&amp;hellip;）&lt;/p>
&lt;p>我写的地址是公司，所以一开始的时候看商品参数是说尺寸389x389x458mm，重量12.95kg的时候，还觉得不过如此，一个手推车轻轻松松拿回家，直到看到SF的收寄信息显示重量22kg，心凉了半截，难不成还打木箱？拿到货的时候本来计划是一个咩子拉回家，实际上放上去之后我根本没地方坐&amp;hellip;只能叫taxi拉回去。&lt;/p>
&lt;h4 id="打印前准备">打印前准备
&lt;/h4>&lt;p>开箱和组装其实蛮简单的，箱子里面就一个打印机主机，AMS固定放置在打印机内部，还送了三卷官方PLA耗材（透明、橙色、绿色），一个替换热端和散热硅脂等等七七八八的东西。按说明书（这个说明书有好多地方其实说的不是很清楚，需要自己上网找视频对照来做）把AMS从箱内拆出来，接上线，把耗材放AMS里，然后开机配置网络等信息，进行初次校准，最后把底部的泡沫拿出来，就可以准备打印了。&lt;/p>
&lt;p>初次打印时APP总是提示&lt;code>耗材从工具头退回AMS失败&lt;/code>，去看了官方WIKI也看不出什么问题，最后把耗材拔出来重新接AMS里面就能打印了&amp;hellip;&lt;/p>
&lt;p>官方是自带一个创意工坊，有很多人会在上面共享模型，在PC上可以下载模型并调整或者二创再上传，内容覆盖面也挺广，可爱的不可爱的，健全的和看上去能让你进橘子的都有。&lt;/p>
&lt;h4 id="打印过程中">打印过程中
&lt;/h4>&lt;p>打印可以通过手机APP或者PC来控制，两者都支持远程控制，但是PC端能够设置的项目会多很多。比如说耗材这一项，如果使用的是第三方耗材，通常会用不同的参数来调教，否则打印时可能会堵头或者拉丝，这些参数配置只能在PC上调整，但是调整好之后参数会同步到APP端，后面APP端打印时也可以调用这个参数。&lt;/p>
&lt;p>为保证打印出来的成品良好，建议每次打印都把自动调平打开。打印时如果耗材和预设颜色、材质不匹配的话可以逐项替换，但是注意要选择对应的打印配置，而且&lt;strong>不应该把多种材料混着打&lt;/strong>（因为涉及的参数不一样，如果直接混用可能会造成堵头和拉丝），选择好模型和材料之后就可以上传到打印机了。&lt;/p>
&lt;p>我初次打印的是clannad的团子，因为手头耗材颜色不够，弄了个橙色+绿色的搭配，打出来的成品奇丑无比&amp;hellip;&lt;/p>
&lt;h4 id="打印后">打印后
&lt;/h4>&lt;p>打印成功后可以把板子取出，如果刚打印完机箱内部还很热，需要放置一段时间，大概50℃左右就可以取出了。取出之后打印件是站在底板上面的，如果没办法取下来，可以放在室温下一段时间等自动冷却，或是找一些类似刀片的物体慢慢刮下来。打印完之后应做好板子的清洁工作，不然下次打印的时候表面坑坑洼洼的很容易出问题。&lt;/p>
&lt;h4 id="感想">感想
&lt;/h4>&lt;p>作为第一次实际上手打印的机器，拓竹P1SC无疑是对小白很友好的，接上耗材，导入模型，选择耗材，开始打印，基本上没有什么复杂的环节。而且操作过程中自带的低帧机内摄像头可以实时检查箱内情况，并生成延时视频（这里吐槽一下生成的视频格式是avi，剪辑的时候需要转码，直接用mp4不好吗），进一步提高了可玩性。目前最大的槽点应该就是耗材的价格吧，一卷PLA第三方也要三四十，官方耗材更是不敢想象，只能搞点二十几块的PETG过日子。还有就是AMS打印的废料，多色打印的时候每换一个颜色就会把耗材挤出来一部分排到后面的废料箱，如果一个平面有多个颜色，打起来是真的很浪费，而且挤出废料的时候会出现废料没有老老实实顺着后面掉下去而是弹到打印板上的情况，如果掉落的区域正好是打印的落点，轻者这块打印件就废了，严重情况下如果打印面板间隙不是很大有可能就把热端给顶歪了&amp;hellip;&lt;/p>
&lt;p>刚开始的时候还是很喜欢去创意工坊找别人做的模型来打着玩，目前打了平面、团子、锉刀、龙、狐狸、花盆，接下来还想打印点大件，等到后面有想法了再学学建模吧！&lt;/p>
&lt;h4 id="注意事项汇总">注意事项汇总
&lt;/h4>&lt;h5 id="打印前">打印前
&lt;/h5>&lt;ul>
&lt;li>检查耗材是否充足，打印板是否清洁，箱内是否有异物，热端是否有堵头，AMS箱中耗材是否受潮&lt;/li>
&lt;li>打印配置是否与耗材一致&lt;/li>
&lt;li>是否有把多种耗材混着打&lt;/li>
&lt;/ul>
&lt;h5 id="打印中">打印中
&lt;/h5>&lt;ul>
&lt;li>AMS是否有绞线，是否有废料跳到打印板上&lt;/li>
&lt;li>温度、散热是否合适，如果有拉丝要适当调整&lt;/li>
&lt;/ul>
&lt;h5 id="打印后-1">打印后
&lt;/h5>&lt;ul>
&lt;li>温度下降后再取出打印板&lt;/li>
&lt;li>做好热端和箱内的清洁&lt;/li>
&lt;/ul>
&lt;h4 id="耗材参数">耗材参数
&lt;/h4>&lt;p>以下是一些我购买过的耗材和对应的配置参数，经过实验之后打印效果较好，在此记录。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">品牌&lt;/th>
&lt;th style="text-align: center">基础参数&lt;/th>
&lt;th style="text-align: center">型号&lt;/th>
&lt;th style="text-align: center">热床温度&lt;/th>
&lt;th style="text-align: center">喷嘴温度&lt;/th>
&lt;th style="text-align: center">回抽长度&lt;/th>
&lt;th style="text-align: center">回抽速度&lt;/th>
&lt;th style="text-align: center">风扇速度&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">拓竹&lt;/td>
&lt;td style="text-align: center">Bambu PLA-S/PLA&lt;/td>
&lt;td style="text-align: center">PLA-S/PLA&lt;/td>
&lt;td style="text-align: center">默认&lt;/td>
&lt;td style="text-align: center">默认&lt;/td>
&lt;td style="text-align: center">默认&lt;/td>
&lt;td style="text-align: center">默认&lt;/td>
&lt;td style="text-align: center">默认&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">JAYO&lt;/td>
&lt;td style="text-align: center">Bambu PETG basic&lt;/td>
&lt;td style="text-align: center">PETG&lt;/td>
&lt;td style="text-align: center">70&lt;/td>
&lt;td style="text-align: center">230&lt;/td>
&lt;td style="text-align: center">1.2&lt;/td>
&lt;td style="text-align: center">50&lt;/td>
&lt;td style="text-align: center">60%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>本站即将迁移至tma.moe</title><link>https://blog.tama.guru/record/tma-moe.html</link><pubDate>Sat, 01 Jun 2024 01:58:00 +0800</pubDate><guid>https://blog.tama.guru/record/tma-moe.html</guid><description>&lt;p>在了解到目前使用的两个域名到期后续费的金额后，我决定停止tama.guru和i-tama.website的续费并于近期切换到tma.moe，作出这一决定是出于原则性考虑（大雾）。后续本站域名将更改为https://blog.tma.moe，一段时间内将对旧域名做跳转。&lt;/p>
&lt;p>以下是迁移计划和完成进度：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">模块&lt;/th>
&lt;th style="text-align: center">进度&lt;/th>
&lt;th style="text-align: center">备注&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">API&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">图床&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">已添加授权&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">公告板&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">提问箱&lt;/td>
&lt;td style="text-align: center">反代&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">导航页&lt;/td>
&lt;td style="text-align: center">部分迁移&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">index&lt;/td>
&lt;td style="text-align: center">√&lt;/td>
&lt;td style="text-align: center">部分域名未完成迁移&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">R2&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">未配置自定义域&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">STATUS&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>使用Cloudflare的SaaS实现自选IP</title><link>https://blog.tama.guru/record/Cloudflare_SaaS.html</link><pubDate>Fri, 31 May 2024 23:59:00 +0800</pubDate><guid>https://blog.tama.guru/record/Cloudflare_SaaS.html</guid><description>&lt;p>前几天闲的没事查一下目前几个域名的续费价格，发现动不动都是几百一年&amp;hellip;如果现有的优惠到期之后我多半是不会再继续用了，趁此机会我购入了一个新的域名，够短，也挺有个性&amp;ndash;&amp;gt;&lt;a class="link" href="http://tma.moe" target="_blank" rel="noopener"
>tma.moe&lt;/a>&amp;lt;&amp;ndash; 不要无端联想某视频番号。因为迁移需要一定时间，目前我打算套个CF用。但是很早之前partner就已经用不了了&amp;hellip;(虽然我还有个域名能用，但是那玩意到期之后也很贵）&lt;/p>
&lt;p>目前网上的方法基本上是使用SaaS这个功能来实现的，通过这个方式套在一些对国内有特殊优化的网站来借用它们的服务进行解析。我尝试了下确实能用，但目前还找不到一个好的域名能套，目前国内还是一片红&amp;hellip;&lt;/p>
&lt;h3 id="前期准备">前期准备
&lt;/h3>&lt;ol>
&lt;li>准备两个域名，一个是我们对外提供访问服务的网站，假设为&lt;code>a.com&lt;/code>，&lt;code>a.com&lt;/code>把DNS解析到DNSPOD上。以及一个解析在Cloudflare上并完成解析的&lt;code>b.com&lt;/code>。&lt;/li>
&lt;li>Cloudflare绑定了外币卡并开通SaaS服务，具体流程自己百度。&lt;/li>
&lt;/ol>
&lt;h3 id="cloudflare准备">Cloudflare准备
&lt;/h3>&lt;ol>
&lt;li>先在Cloudflare的DNS上新增一个A记录，这个域名将作为我们的回源域名，记录值是真实的服务器IP，可以用二级域名，也可以直接用一级，假设我这里留下的&lt;code>back.b.com&lt;/code>，解析到真实服务器IP&lt;code>114.51.4.191&lt;/code>。&lt;/li>
&lt;li>然后在左侧的&lt;code>SSL/TLS&lt;/code>下的自定义主机名下新增一个回退源，回退源即为刚才我们配置的&lt;code>back.b.com&lt;/code>，保存之后等待回退源状态显示为：&lt;code>有效&lt;/code>。
然后点击&lt;code>添加自定义主机名&lt;/code>，自定义主机名内容为我们需要外部访问的&lt;code>a.com&lt;/code>及其二级域名，假设我这里需要外部访问的域名为&lt;code>new.a.com&lt;/code>，就将这个网站填入自定义主机名，其他配置保留原样，然后点击&lt;code>添加自定义主机名&lt;/code>。此时会生成一个TXT主机记录和TXT记录值，假如主机记录是&lt;code>_cf-custom-hostname.new.a.com&lt;/code>，记录值是&lt;code>11233444-eeee-ffff-gggg-3rcfffsdsd&lt;/code>，记住这两个值，至此CF配置完成。&lt;/li>
&lt;/ol>
&lt;h3 id="dnspod准备">DNSPOD准备
&lt;/h3>&lt;ol>
&lt;li>首先在&lt;code>a.com&lt;/code>下的记录管理添加一个TXT记录，记录名为&lt;code>_cf-custom-hostname.new&lt;/code>&lt;strong>注意这里只填写前面部分&lt;/strong>，记录值为&lt;code>11233444-eeee-ffff-gggg-3rcfffsdsd&lt;/code>，等待该记录生效。&lt;/li>
&lt;li>接下来就是实现优选IP的最重要一步：在&lt;code>a.com&lt;/code>下的记录管理添加一或两个记录，可以是A，也可以是CNAME，两个主机记录都是&lt;code>new&lt;/code>，一个线路是境内，一个线路放境外（如果只加一个这里留默认就行了，主要是针对不同线路有不同优化需求的，如果还希望针对不同运营商进行优化，这里还可以细化）。境外随便一个CF的IP基本上都能正常访问，建议放个&lt;code>1.0.0.5&lt;/code>。
境内这里就要留心了，这里优选域名/ip选不好就很容易一片红。自用线路建议使用&lt;code>[CloudflareST][2]&lt;/code>测试速度最优的IP，也可以用&lt;a class="link" href="https://vps789.com/hostmonitor/?hostProvider=CF%E4%BC%98%E9%80%89IP" target="_blank" rel="noopener"
>CF优选IP&lt;/a>这样的网站查看一些CF域名/IP的运营商访问速度。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f0e45bb4e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f0e45bb4e.png" alt="像第一个三网都还行，第三个移动访问就经常挂了。" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f0e45bb4e.png"
loading="lazy"
alt="像第一个三网都还行，第三个移动访问就经常挂了。"
>
我们可以使用CNAME套在这些域名上来实现“借用”他们的解析来优化我们的访问。
我们可以使用&lt;a class="link" href="https://ping.cn" target="_blank" rel="noopener"
>ping.cn&lt;/a>来测试速度：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f22dee158.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f22dee158.png" alt="国内速度，看起来还行" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f22dee158.png"
loading="lazy"
alt="国内速度，看起来还行"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f24ba9923.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f24ba9923.png" alt="境外速度，没什么好说的" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/05/31/6659f24ba9923.png"
loading="lazy"
alt="境外速度，没什么好说的"
>
看起来还行。&lt;/li>
&lt;/ol>
&lt;h3 id="总结">总结
&lt;/h3>&lt;p>这样做说实话确实挺麻烦的，首先是每次添加域名都需要在CF上设置一次SaaS添加自定义主机名，然后再在DNSPOD上添加TXT、配置优选解析，而且免费SaaS有上限，虽然那个上限一般人也达不到就是了。而且这样做可以直接使用CF的SSL证书，不用担心免费证书过期的事了。&lt;/p></description></item><item><title>使用acme.sh申请通配ssl证书</title><link>https://blog.tama.guru/record/acme-sh_zerossl.html</link><pubDate>Mon, 20 May 2024 21:04:00 +0800</pubDate><guid>https://blog.tama.guru/record/acme-sh_zerossl.html</guid><description>&lt;p>从今年3-4月起，国内主流的域名平台都开始把原来一年期的免费证书调整成三个月（参见：&lt;a class="link" href="https://help.aliyun.com/zh/ssl-certificate/user-guide/upgrade-a-free-certificate-upgrade-a-free-certificate" target="_blank" rel="noopener"
>免费版SSL证书升级指南&lt;/a>），但是阿里另外给了个解决方案，单域名一年缴68元可以获得原来一样的一年证书。&lt;/p>
&lt;blockquote>
&lt;p>尊敬的阿里云用户：
接收到厂商关于免费证书服务收费策略调整的通知，我们将在2023年11月14号开始生效厂商策略。在策略生效后，免费证书规则如下：
对于免费领取的SSL证书，签发后的证书有效期统一变更为3个月。如果您希望继续使用12个月有效期的免费证书，则需收取相关服务费，费用为68元/张/年。&lt;/p>&lt;/blockquote>
&lt;p>对于我们这些白嫖用户来说这就非常难搞了，证书时间大幅缩短意味着一年要申请四次，而且如果域名很多的话每个还需要单独申请，想想都很酸爽&amp;hellip;但是花钱是不可能的，单个证书68对我们来说也是一笔不小的开销，对我们这种小站站长确实不值得。&lt;/p>
&lt;p>那么现在摆在我们面前的有两条路：
&lt;del>1.关站跑路&lt;/del>
2.想办法做自动化申请替换。&lt;/p>
&lt;p>比较常见的方法就是&lt;a class="link" href="https://github.com/acmesh-official/acme.sh" target="_blank" rel="noopener"
>acme.sh&lt;/a>，这是个可以申请签发、部署管理、ssl证书的脚本，操作起来也比较方便，甚至可以通过corntab之类的工具实现自动续期，算是当前状况下一个解决方案了。&lt;/p>
&lt;p>而证书提供商我推荐使用&lt;a class="link" href="https://zerossl.com" target="_blank" rel="noopener"
>zerossl&lt;/a>，最主要的是它能提供免费的范域名甚至是IP证书，虽然只有三个月，但是结合acme.sh就能实现自动续签，相当于无限续期。&lt;/p>
&lt;h3 id="正常操作流程">正常操作流程
&lt;/h3>&lt;p>首先肯定是先去zerossl申请一个账号，这个不多说了。
接下来安装acme.sh
如果服务器在国外的，直接使用官方的
curl &lt;a class="link" href="https://get.acme.sh" target="_blank" rel="noopener"
>https://get.acme.sh&lt;/a> | sh
即可，如果服务器在国内的，考虑到直连github可能会抽风，建议使用
curl &lt;a class="link" href="https://gitee.com/acmesh-offical/acme.sh/raw/master/acme.sh" target="_blank" rel="noopener"
>https://gitee.com/acmesh-offical/acme.sh/raw/master/acme.sh&lt;/a> | sh -s &lt;a class="link" href="mailto:email=your@zerosslaccount.com" >email=your@zerosslaccount.com&lt;/a>
其中&lt;code>your@zerosslaccount.com&lt;/code>换成自己申请zerossl账号用的邮箱。
然后使环境生效：
source ~/.bashrc
使用第一种方法会安装到&lt;code>~/.acme.sh/&lt;/code>下，不执行环境变量生效的可以手动在文件夹内执行脚本。
然后把zerossl配置为默认的ca服务：
acme.sh &amp;ndash;set-default-ca &amp;ndash;server zerossl
因为当前我使用的是DNSPOD的解析，需要先去&lt;a class="link" href="https://console.dnspod.cn/account/token/token" target="_blank" rel="noopener"
>DNSPOD Token&lt;/a>页面生成一组密钥，生成之后页面会生成一个ID和TOKEN，假设：
ID=XXXXXX
TOKEN=QWERTYUIOPASADFGHJKL
那么需要配置以下内容到环境变量：
export DP_Id=&amp;ldquo;XXXXXX&amp;rdquo;
export DP_Key=&amp;ldquo;QWERTYUIOPASADFGHJKL&amp;rdquo;
这里的DP指的是DNSPOD，如果使用的是其他服务商可以参考&lt;a class="link" href="https://github.com/acmesh-official/acme.sh/tree/master/dnsapi" target="_blank" rel="noopener"
>dnsapi文档&lt;/a>和&lt;a class="link" href="https://github.com/acmesh-official/acme.sh/wiki" target="_blank" rel="noopener"
>acme.sh wiki&lt;/a>。
然后配置zerossl的账号信息到acme.sh:
acme.sh &amp;ndash;register-account -m &lt;a class="link" href="mailto:your@zerosslaccount.com" >your@zerosslaccount.com&lt;/a> &amp;ndash;server zerossl
这里会生成一个&lt;code>ACCOUNT_THUMBPRINT&lt;/code>，一般用不到，可以忽略。
到此就可以进行证书申请操作了：
比如我要申请的证书域名是&lt;code>*.tama.guru&lt;/code>，那么需要执行：
acme.sh &amp;ndash;dns dns_dp &amp;ndash;issue -d *.tama.guru -d tama.guru
如果执行过程中报错可以执行：
acme.sh &amp;ndash;dns dns_dp &amp;ndash;issue -d *.tama.guru -d tama.guru &amp;ndash;debug
来检查是什么步骤报错。
如果没有任何错误，目录结构应该如下：&lt;/p>
&lt;pre>&lt;code>-********- 8 root root 187 May 20 17:17 .
-********- 24 root root 4096 May 20 20:28 ..
-********- 1 root root 433 May 20 16:56 account.conf
-********- 1 root root 223427 May 20 16:29 acme.sh
-********- 1 root root 78 May 20 16:29 acme.sh.env
-********- 3 root root 30 May 20 16:48 ca
-********- 2 root root 4096 May 20 16:29 deploy
-********- 2 root root 8192 May 20 16:29 dnsapi
-********- 1 root root 221 May 20 17:17 fetch.sh
-********- 1 root root 393 May 20 16:56 http.header
-********- 2 root root 4096 May 20 16:29 notify
-********- 2 root root 162 May 20 16:56 '*.tama.guru_ecc'
&lt;/code>&lt;/pre>
&lt;p>我们的证书就保存在&lt;code>'*.tama.guru_ecc'&lt;/code>内，配置&lt;code>*.tama.guru.key&lt;/code>和&lt;code>fullchain.cer&lt;/code>到nginx/apache上即可。&lt;/p>
&lt;h3 id="自动化">自动化
&lt;/h3>&lt;p>根据上面的步骤基本上就知道自动化脚本怎么写了:
# nano /root/.acme.sh/autocert.sh&lt;/p>
&lt;pre>&lt;code>#!/bin/bash
cd /root/.acme.sh #根据acme安装路径选择
export DP_Id=&amp;quot;XXXXXX&amp;quot;
export DP_Key=&amp;quot;QWERTYUIOPASADFGHJKL&amp;quot;
#./acme.sh --register-account -m your@zerosslaccount.com --server zerossl
./acme.sh --dns dns_dp --issue -d *.tama.guru -d tama.guru
&lt;/code>&lt;/pre>
&lt;p>然后添加到crontab:
0 23 1 * * sh nano /root/.acme.sh/autocert.sh #每月1号的23点执行以上脚本
如果acme.sh所在机器就是网站服务器，可以参照&lt;a class="link" href="https://www.rmedgar.com/blog/using-acme-sh-with-nginx/" target="_blank" rel="noopener"
>Using acme.sh with nginx&lt;/a>把应用证书的工作也交给服务器自动完成，更简单的方法就是先指定输出文件位置然后直接在nginx的配置文件里面修改:
#导出文件
acme.sh &amp;ndash;install-cert -d tama.guru &amp;ndash;key-file /path/to/keyfile/tama.guru.pem &amp;ndash;fullchain-file /path/to/fullchain/tama.guru.cer &amp;ndash;reloadcmd &amp;ldquo;service nginx force-reload&amp;rdquo;
#修改nginx配置文件
ssl_certificate /path/to/fullchain/tama.guru.cer;
ssl_certificate_key /path/to/keyfile/tama.guru.pem;&lt;/p>
&lt;h3 id="其他">其他
&lt;/h3>&lt;p>Q：我不想敲一堆命令，有更直观的方法吗？
A：可以使用开源工具&lt;a class="link" href="https://github.com/certd/certd" target="_blank" rel="noopener"
>certd&lt;/a>，该工具提供了一个网页前端供用户配置自动化流水线申请证书。
Q：那你为什么不用？
A：它只支持Let&amp;rsquo;s encrypt证书。&lt;/p></description></item><item><title>一些系统及应用的去广告和隐私选项推荐(持续更新)</title><link>https://blog.tama.guru/record/app-anti-ad.html</link><pubDate>Sun, 28 Apr 2024 11:26:00 +0800</pubDate><guid>https://blog.tama.guru/record/app-anti-ad.html</guid><description>&lt;p>有些app的广告实在是太多了，而且关掉的地方都隐藏的很深以至于我需要专门拿个文章记录一下，后续每找一种方法都会在这里更新，并根据不同的软件类型进行分类，以便快速查找。
按设想会分为系统类，第三方软件类，在各个大类下再进行细分。&lt;/p>
&lt;h2 id="系统类">系统类
&lt;/h2>&lt;h3 id="pc端">PC端
&lt;/h3>&lt;h3 id="aosp">AOSP
&lt;/h3>&lt;h4 id="harmonyos-4x">HarmonyOS 4.X
&lt;/h4>&lt;p>系统版本4.2.0.120，仅针对我常用的软件，一些从来没点过的就不写了。
1、文件管理：我的&amp;ndash;设置&amp;ndash;个性化&amp;ndash;关闭个性化广告。
2、设置&amp;ndash;华为账号&amp;ndash;隐私中心&amp;ndash;管理您的个人偏好&amp;ndash;广告偏好设置，关掉华为智慧助手·今天和华为浏览器的勾选项。
3、设置-智慧助手-右上角体验增强与改进&amp;ndash;个性化推荐服务和个性化广告，关掉个性化广告功能。
4、设置&amp;ndash;HMS Core&amp;ndash;分析服务&amp;ndash;勾选限制三方共享信息。
5、设置&amp;ndash;隐私&amp;ndash;底部的华为广告&amp;ndash;关闭智能推荐服务。
6、负一屏&amp;ndash;今天（点击头像）&amp;ndash;设置&amp;ndash;关闭搜索热词、个性化推荐所有选项、消息通知、今天改进计划、发现
7、应用市场&amp;ndash;我的&amp;ndash;设置&amp;ndash;消息通知管理（关闭总开关）数据与隐私（关闭游戏服务内开关、内容推荐服务的个性化推荐）。
8、华为钱包&amp;ndash;我的&amp;ndash;设置&amp;ndash;更多设置&amp;ndash;关闭个性化推荐和个性化广告。
9、会员中心&amp;ndash;我的&amp;ndash;设置&amp;ndash;关闭接收系统消息、众测辅助功能、位置信息授权、消息推送社会设置内的所有选项。
10、设置&amp;ndash;华为账号&amp;ndash;云空间&amp;ndash;右上角更多设置&amp;ndash;个性化&amp;ndash;个性化广告关闭。（如果需要关闭任务中心也可以在更多设置这一级设置，就是那个让你下几个app送你一个月会员的）
11、主题&amp;ndash;我的&amp;ndash;设置&amp;ndash;内容推荐服务（关闭主题内容推荐服务、音乐内容推荐服务）、广告（关闭个性化广告）、关闭首页显示甄选主题栏目、关闭接受推送通知、消息设置内的相关选项。
12、我的华为&amp;ndash;我的&amp;ndash;设置&amp;ndash;关闭接收短信和邮件、关闭接收消息、关闭个性化推荐服务底部的个性化推荐、关闭用户体验改进计划和推广信息显示。&lt;/p>
&lt;h3 id="ios端">iOS端
&lt;/h3>&lt;h2 id="第三方软件类">第三方软件类
&lt;/h2>&lt;h3 id="社交支付类">社交支付类
&lt;/h3>&lt;h4 id="支付宝">支付宝
&lt;/h4>&lt;h5 id="关闭首页推荐广告">关闭首页推荐广告
&lt;/h5>&lt;p>版本号：10.5.66
路径：设置&amp;ndash;通用&amp;ndash;管理主页&amp;ndash;推荐卡片&amp;ndash;把所有的选项关闭。
效果：首页底部不再显示相关内容，取而代之的是一段话“上拉进入休闲空间”。
其实设置&amp;ndash;通用这个路径下还有“管理视频页”、“管理信息页”、“管理我的页面”几个选项，里面可以把相关内容选择性关闭。&lt;/p>
&lt;h5 id="关闭垃圾消息推送">关闭垃圾消息推送
&lt;/h5>&lt;p>版本号：10.5.66
路径：设置&amp;ndash;新消息通知&amp;ndash;关闭服务通知和活动通知，朋友消息提醒看有无社交需求，没有的也可以关闭。
效果：通知栏不再显示相关信息推送。&lt;/p>
&lt;h5 id="隐私设置建议">隐私设置建议
&lt;/h5>&lt;p>版本号：10.5.66
路径：
（1）设置&amp;ndash;隐私&amp;ndash;系统权限管理：这里可以配置整个APP是否能获取系统的位置、相机等权限，不需要的权限可以设置“拒绝访问”。
（2）设置&amp;ndash;隐私&amp;ndash;个人信息授权管理：这里会展示授权其他平台获取支付宝账号信息，可以在这里解除授权。
（3）设置&amp;ndash;隐私&amp;ndash;常用隐私设置：可以设置查找/添加/展示真实姓名的相关设置。
（4）设置&amp;ndash;隐私&amp;ndash;个性化广告、推荐设置：这里可以设置广告推荐类型，注意只是类型，开启设置后只会&lt;strong>减少推荐相关性&lt;/strong>，并不能减少广告。&lt;/p>
&lt;h3 id="影音类">影音类
&lt;/h3>&lt;h4 id="网易云音乐">网易云音乐
&lt;/h4>&lt;h5 id="简化页面内容">简化页面内容
&lt;/h5>&lt;p>版本号：9.0.40.181620
路径：设置&amp;ndash;关闭直播内容推荐和个性化广告推荐，底部导航设置仅保留发现、我的和关注。
效果:减少首页底部和直播等垃圾功能。&lt;/p>
&lt;h5 id="减少垃圾消息">减少垃圾消息
&lt;/h5>&lt;p>版本号：9.0.40.181620
路径：设置&amp;ndash;消息和隐私设置&amp;ndash;关闭第三方推送服务开关、关闭提醒设置两个选项和隐私设置按需关闭。
效果:减少横幅广告和应用内广告弹出、无用消息推送。&lt;/p>
&lt;p>什么？你说开屏广告？这东西开会员都去不掉。&lt;/p></description></item><item><title>在docker里运行火狐浏览器</title><link>https://blog.tama.guru/record/firefox-on-docker.html</link><pubDate>Fri, 26 Apr 2024 15:53:00 +0800</pubDate><guid>https://blog.tama.guru/record/firefox-on-docker.html</guid><description>&lt;p>有时候我会需要在远程计算机上使用浏览器进行一些操作，但是存在一些问题。一是远程计算机本身空间容量/配置较低，预装的是core系统，因为使用个浏览器去安装整个桌面环境有点浪费了，也不利于系统稳定；二是软件可能会破坏原有的依赖，轻则软件报错，重则无法启动，这个就很难绷了。
好在docker能实现把远程的浏览器套到本地浏览器运行，看样子是一个webvnc，但是只能打开浏览器。项目是&lt;code>https://github.com/jlesage/firefox&lt;/code>，方法也很简单，直接执行：&lt;/p>
&lt;pre>&lt;code>docker run -d \
--name=firefox \
-p 5800:5800 \
-v /home/tamakyi/firefox/config:/config:rw \
jlesage/firefox
&lt;/code>&lt;/pre>
&lt;p>然后到ip:5800端口就能打开远端的火狐浏览器了。但是这样仅能保证运行，会发现中文字体全部都变成方块了，因此需要调整成：&lt;/p>
&lt;pre>&lt;code>docker run -d \
--name=firefox \
-p 5800:5800 \
-v /home/tamakyi/firefox/config:/config:rw \
-e TZ=Asia/Hong_Kong \
-e KEEP_APP_RUNNING=1 \
-e ENABLE_CJK_FONT=1 \
jlesage/firefox
&lt;/code>&lt;/pre>
&lt;p>其中&lt;code>/home/tamakyi/firefox/config&lt;/code>为宿主机的配置文件目录，需要自行修改，&lt;code>KEEP_APP_RUNNING=1&lt;/code>标明关掉本地浏览器页面保持远端浏览器运行，&lt;code>ENABLE_CJK_FONT=1&lt;/code>标明开启中文字体支持。
到这里其实已经能够正常运行了，完整的配置可以参考:&lt;/p>
&lt;pre>&lt;code>docker run -d \
--name=firefox \
-p 5800:5800 \
-v /home/tamakyi/firefox/config:/config:rw \
-e TZ=Asia/Hong_Kong \
-e KEEP_APP_RUNNING=1 \
-e ENABLE_CJK_FONT=1 \
-e DISPLAY_WIDTH=1920 \
-e DISPLAY_HEIGHT=1080 \
-e SECURE_CONNECTION=1 \
--shm-size 2g \
jlesage/firefox
&lt;/code>&lt;/pre>
&lt;p>其他可选性包括：
&lt;code>DISPLAY_WIDTH&lt;/code>和&lt;code>DISPLAY_HEIGHT&lt;/code>：生成浏览器的分辨率，如果配置不高的机器建议不要太高。
&lt;code>SECURE_CONNECTION&lt;/code>：开启https
&lt;code>shm-size&lt;/code>：配置容器内存使用上限。
执行之后并不会像项目下的源码下能直接访问，会报错，原因可以通过查询docker的运行日志找到：&lt;/p>
&lt;pre>&lt;code>[init ] container is starting...
[cont-env ] loading container environment variables...
...
[cont-init ] 15-cjk-font.sh: installing CJK font...
[cont-init ] 15-cjk-font.sh: fetch https://dl-cdn.alpinelinux.org/alpine/edge/community/aarch64/APKINDEX.tar.gz
[cont-init ] 15-cjk-font.sh: fetch https://dl-cdn.alpinelinux.org/alpine/v3.19/main/aarch64/APKINDEX.tar.gz
[cont-init ] 15-cjk-font.sh: fetch https://dl-cdn.alpinelinux.org/alpine/v3.19/community/aarch64/APKINDEX.tar.gz
[cont-init ] 15-cjk-font.sh: (1/1) Installing font-wqy-zenhei (0.9.45-r3)
...
╭――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――╮
│ │
│ Application: Firefox │
│ Application Version: 124.0.1-r0 │
│ Docker Image Version: 24.04.1 │
│ Docker Image Platform: linux/arm64 │
│ │
╰――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――╯
...
[app ] Mozilla Firefox 124.0.1
[supervisor ] all services started.
&lt;/code>&lt;/pre>
&lt;p>一般会在&lt;code>15-cjk-font.sh&lt;/code>这个步骤停留一段时间，需要下载挺多的数据，具体与网络有关。等到提示&lt;code>all services started&lt;/code>此时才能正常访问。&lt;/p>
&lt;p>&lt;strong>注意&lt;/strong>：如果你部署在公网服务器上，此时是可以直接通过ip+端口的方式访问的，及其不安全，且默认iptables防火墙无法配置该端口的访问权限&amp;hellip;（网上说的方法都试过了，没用）。因此，我建议再套一层firewall-cmd：&lt;/p>
&lt;pre>&lt;code>apt install firewalld
&lt;/code>&lt;/pre>
&lt;p>安装完记得配置常用端口的开启：&lt;/p>
&lt;pre>&lt;code>firewall-cmd --zone=public --add-port=YOUR_PORT/tcp --permanent
firewall-cmd --reload
&lt;/code>&lt;/pre>
&lt;p>这样虽然麻烦了点，但是安全性显著提高了。但是有一个问题，就是docker容器&lt;strong>无法联网&lt;/strong>了，估计是什么地方冲突，后面再检查。
最后还是&lt;strong>即开即用，用完就关&lt;/strong>。&lt;/p></description></item><item><title>在局域网内安装去广告插件的几种方法(pihole和adguardhome)</title><link>https://blog.tama.guru/record/ad-plugin.html</link><pubDate>Sat, 13 Apr 2024 23:37:00 +0800</pubDate><guid>https://blog.tama.guru/record/ad-plugin.html</guid><description>&lt;p>这东西我主要是放在家里给老人用的，最开始是他们手机碰上七七八八的问题找我解决，然后点开一个个浏览器和应用，卧槽，这能用的下去？横幅的横幅，弹窗的弹窗，真的看不下去，正好家里整了一个24小时开机的J1900双网口软路由，于是想了想在上面安装个插件算了，怎样都比原来好。&lt;/p>
&lt;h3 id="pihole-on-docker">PiHole on Docker
&lt;/h3>&lt;h4 id="安装之前">安装之前
&lt;/h4>&lt;p>首先需要打开主机的ssh，执行
&lt;code>ip link set eth0 promisc on&lt;/code>
打开网卡混杂模式，这个步骤是必须的，不然不能接收到域名解析请求。
然后新建一个网络，网段和网关要和主机所在的网段一致。比如说宿主机的IP是&lt;code>192.168.101.232&lt;/code>，那么新建的网络子网则为&lt;code>192.168.101.0/24&lt;/code>，网关为&lt;code>192.168.101.1&lt;/code>，还需要把驱动器切换成&lt;code>MAC VLAN&lt;/code>，基设备修改成&lt;code>br-lan&lt;/code>，其它可以不变，&lt;code>IPV6&lt;/code>打不打开都可以，打开之后需要配置和宿主机同级的IPV6的网段和网关。
创建好网络之后下一步就是下载镜像和新建容器，镜像直接拉取&lt;code>pihole/pihole&lt;/code>，最新的。
然后在主机上随便一个目标下新建&lt;code>config&lt;/code>和&lt;code>data&lt;/code>文件夹，用于存储pihole的相关数据。比如&lt;code>/opt/pihole/data&lt;/code>和&lt;code>/opt/pihole/config&lt;/code>。
接下来新建容器，选择pihole的镜像和前面新建的网络，分配一个网段内不冲突的地址，比如&lt;code>192.168.101.102&lt;/code>，并添加如下绑定挂载：&lt;/p>
&lt;pre>&lt;code>/opt/pihole/config:/etc/pihole
/opt/pihole/data:/etc/dnsmasq.d
&lt;/code>&lt;/pre>
&lt;p>然后提交并启动。
点击容器后面的编辑-&amp;gt;控制台-&amp;gt;连接，输入&lt;/p>
&lt;pre>&lt;code>sudo pihole -a -p
&lt;/code>&lt;/pre>
&lt;p>给pihole配置密码，然后访问&lt;code>192.168.101.103/admin&lt;/code>看看是否能访问。&lt;/p>
&lt;h4 id="配置pi-hole">配置Pi-Hole
&lt;/h4>&lt;p>一般情况下这里要做的就是三件事：&lt;/p>
&lt;h5 id="修改上游dns">修改上游DNS
&lt;/h5>&lt;p>位于&lt;code>settings/dns&lt;/code>下的&lt;code>Upstream DNS Servers Custom 1 (IPv4)&lt;/code>和&lt;code>Custom 2 (IPv4)&lt;/code>，一般填写光猫获取到的运营商DNS，也可以写&lt;code>8.8.8.8&lt;/code>这类，只要访问快就行，改完记得滑到底部点击&lt;code>save&lt;/code>。&lt;/p>
&lt;h5 id="添加拦截规则">添加拦截规则
&lt;/h5>&lt;p>位于&lt;code>adlists&lt;/code>下，直接把拦截规则放进&lt;code>address&lt;/code>下点击&lt;code>add&lt;/code>即可。一般推荐&lt;/p>
&lt;pre>&lt;code>https://anti-ad.net/domains.txt
https://raw.githubusercontents.com/StevenBlack/hosts/master/hosts
&lt;/code>&lt;/pre>
&lt;p>这两个，第二个是pihole自带的，但是github部分地区无法访问，建议删掉原来的，再把上面这个镜像地址添加进去。添加完之后不会自动下载，需要到&lt;code>tools/update gravity&lt;/code>下点击&lt;code>update&lt;/code>手动更新一次。&lt;/p>
&lt;h5 id="导入解析">导入解析
&lt;/h5>&lt;p>如果是单个设备，直接到对应的连接选项从DHCP改成静态再把下面把DNS改成&lt;code>192.168.101.103&lt;/code>即可。
如果是路由器（我的网络是光猫-软路由-硬路由），我用的是梅林，直接在内部网络(lan)下的 基本设置改成静态IP，配置好IP地址和网关，DNS服务器则修改成&lt;code>192.168.101.103&lt;/code>保存即可。
如果成功了，Dashboard和Query Log应该能看到解析记录。&lt;/p>
&lt;h4 id="这样做有什么好处">这样做有什么好处
&lt;/h4>&lt;p>docker环境相对于直接在硬路由/软路由上搭建最大的好处就是不用担心53端口冲突，这点就够了&lt;/p>
&lt;h3 id="pi-hole-hardware">Pi-hole Hardware
&lt;/h3>&lt;h4 id="安装之前-1">安装之前
&lt;/h4>&lt;p>我的测试环境是安装过宝塔php8.1+8.2的64位树莓派raspios。如果是全新安装的可能有些步骤是不必要的。
安装前一定要确保机器能够访问到Github，如果不能请配置好代理。例如我在&lt;code>192.168.118.214&lt;/code>上搭建了3proxy建议代理服务，端口分别是： &lt;code>1079: http/https 1080:socks5&lt;/code>，因此需要配置临时代理：&lt;/p>
&lt;pre>&lt;code>export https_proxy=http://192.168.118.214:1079 http_proxy=http://192.168.118.214:1079 all_proxy=socks5://192.168.118.214:1080
&lt;/code>&lt;/pre>
&lt;p>然后就可以执行安装了：&lt;/p>
&lt;pre>&lt;code>curl -sSL https://install.pi-hole.net | sudo bash
&lt;/code>&lt;/pre>
&lt;p>脚本执行时会安装一系列的依赖，需要注意像php这类的软件包部分源只提供了最新版本，比如原来我只安装有8.1，结果在安装：&lt;/p>
&lt;pre>&lt;code>[i] Checking for php8.1-common (will be installed)
[i] Checking for php8.1-cgi (will be installed)
[i] Checking for php8.1-sqlite3 (will be installed)
[i] Checking for php8.1-xml (will be installed)
[i] Checking for php8.1-intl (will be installed)
&lt;/code>&lt;/pre>
&lt;p>的时候全部都找不到，然后脚本就退出了&amp;hellip;执行&lt;/p>
&lt;pre>&lt;code>sudo apt search php8.*
&lt;/code>&lt;/pre>
&lt;p>可以看到很多都是8.2的包了&amp;hellip;灰溜溜的去宝塔重新编译安装一个再重新执行脚本：&lt;/p>
&lt;pre>&lt;code>php8.2/stable,stable,stable-security,stable-security 8.2.7-1~deb12u1 all
server-side, HTML-embedded scripting language (metapackage)
php8.2-amqp/stable 1.11.0-5 arm64
AMQP extension for PHP
php8.2-apcu/stable 5.1.22+4.0.11-2 arm64
APC User Cache for PHP
...
&lt;/code>&lt;/pre>
&lt;p>安装过程有个简单的交互，无非就是问你是不是真的要安装，使用哪个网卡，使用哪个DNS，要不要装个lighthttp实现网页端管理这类的，基本上全部选是就对了。安装完成后会提示管理网页地址和默认密码，可以使用&lt;code>pihole -a -p&lt;/code>命令更改：&lt;/p>
&lt;pre>&lt;code> [i] Pi-hole blocking will be enabled
[i] Enabling blocking
[✓] Reloading DNS lists
[✓] Pi-hole Enabled
[i] Web Interface password: CPlutkpL
[i] This can be changed using 'pihole -a -p'
[i] View the web interface at http://pi.hole/admin or http://192.168.118.164/admin
[i] You may now configure your devices to use the Pi-hole as their DNS server
[i] Pi-hole DNS (IPv4): 192.168.118.164
[i] Pi-hole DNS (IPv6): 2***********34
[i] If you have not done so already, the above IP should be set to static.
[i] The install log is located at: /etc/pihole/install.log
[✓] Installation complete!
&lt;/code>&lt;/pre>
&lt;p>到这里就算安装完成了。&lt;/p>
&lt;h4 id="一些问题">一些问题
&lt;/h4>&lt;p>一般情况下现在就可以直接访问pihole了，但是你可能会发现管理页面报错404，如果你有安装过lnmp环境，这可能是80端口冲突导致lighthttp无法启动：&lt;/p>
&lt;pre>&lt;code>root@akarinbot:~# systemctl status lighttpd.service
× lighttpd.service - Lighttpd Daemon
Loaded: loaded (/lib/systemd/system/lighttpd.service; enabled; preset: enabled)
Active: failed (Result: exit-code) since Mon 2024-04-15 23:09:25 CST; 5min ago
Duration: 476ms
Process: 173339 ExecStartPre=/usr/sbin/lighttpd -tt -f /etc/lighttpd/lighttpd.conf (code=exited, status=0/SUCCESS)
Process: 173342 ExecStart=/usr/sbin/lighttpd -D -f /etc/lighttpd/lighttpd.conf (code=exited, status=255/EXCEPTION)
Main PID: 173342 (code=exited, status=255/EXCEPTION)
CPU: 886ms
4月 15 23:09:25 akarinbot systemd[1]: lighttpd.service: Scheduled restart job, restart counter is at 7.
4月 15 23:09:25 akarinbot systemd[1]: Stopped lighttpd.service - Lighttpd Daemon.
4月 15 23:09:25 akarinbot systemd[1]: lighttpd.service: Start request repeated too quickly.
4月 15 23:09:25 akarinbot systemd[1]: lighttpd.service: Failed with result 'exit-code'.
4月 15 23:09:25 akarinbot systemd[1]: Failed to start lighttpd.service - Lighttpd Daemon.
&lt;/code>&lt;/pre>
&lt;p>所以我们需要手动修改lighthttp的配置文件：
root@akarinbot:~# nano /etc/lighttpd/lighttpd.conf
&amp;hellip;
#server.port = 80
server.port = 88 #这里改成80外的其他端口
&amp;hellip;&lt;/p>
&lt;p>然后重启lighthttp服务：&lt;/p>
&lt;pre>&lt;code>root@akarinbot:~# systemctl restart lighttpd.service
&lt;/code>&lt;/pre>
&lt;p>检查服务状态：&lt;/p>
&lt;pre>&lt;code>root@akarinbot:~# systemctl status lighttpd.service
&lt;/code>&lt;/pre>
&lt;p>如果提示active (running)此时应该就完成了。如果timeout了，建议检查防火墙配置，要注意53端口的TCP/UDP都要打开哦。&lt;/p>
&lt;h3 id="adguardhome-on-hardware">AdGuardHome on Hardware
&lt;/h3>&lt;h4 id="安装之前-2">安装之前
&lt;/h4>&lt;p>需要注意的是，这个方法适用于使用openwrt的系统，并且支持安装luci软件包。
下载：&lt;/p>
&lt;pre>&lt;code>https://github.com/rufengsuixing/luci-app-adguardhome/releases/download/1.8-11/luci-app-adguardhome_1.8-11_all.ipk
&lt;/code>&lt;/pre>
&lt;p>到本地，在openwrt内的&lt;code>系统-软件包&lt;/code>下选择上传该软件包，无视警告并安装，然后刷新页面。
到：&lt;/p>
&lt;pre>&lt;code>https://github.com/AdguardTeam/AdGuardHome/releases
&lt;/code>&lt;/pre>
&lt;p>下载适合自己系统版本的软件包。比如X86架构linux的：&lt;/p>
&lt;pre>&lt;code>https://github.com/AdguardTeam/AdGuardHome/releases/download/v0.107.48/AdGuardHome_linux_amd64.tar.gz
&lt;/code>&lt;/pre>
&lt;p>下载后解压到任意目录，解压并增加相关工作目录：&lt;/p>
&lt;pre>&lt;code>cd ~
wget https://github.com/AdguardTeam/AdGuardHome/releases/download/v0.107.48/AdGuardHome_linux_amd64.tar.gz
tar zxvf AdGuardHome_linux_amd64.tar.gz
mkdir conf &amp;amp;&amp;amp; mkdir data
&lt;/code>&lt;/pre>
&lt;p>此时Adguard的路径应该为&lt;code>/root/AdGuardHome&lt;/code>。&lt;/p>
&lt;h4 id="配置adguardhome-luci和adguardhome">配置AdguardHome luci和AdguardHome
&lt;/h4>&lt;p>管理界面下的&lt;code>服务-AdGuard Home&lt;/code>，把以下项目修改：&lt;/p>
&lt;pre>&lt;code>6060重定向--&amp;gt;作为dnsmasq的上游服务器
执行文件路径-&amp;gt;/root/AdGuardHome/AdGuardHome
配置文件路径-&amp;gt;/root/AdGuardHome/conf/AdGuardHome.yaml
工作目录-&amp;gt;/root/AdGuardHome
运行日志-&amp;gt;/root/AdGuardHome/data
&lt;/code>&lt;/pre>
&lt;p>然后保存并应用，再勾选启用，再次保存，进入路由器IP:3000，配置AdGuardHome。
需要注意的是一般情况下53端口是被占用了，建议修改成5553。
进入AdGuardHome之后在&lt;code>设置-DNS设置&lt;/code>下面把上游DNS服务器修改成：&lt;/p>
&lt;pre>&lt;code>https://dns.alidns.com/dns-query
tls://dns.alidns.com
223.5.5.5
&lt;/code>&lt;/pre>
&lt;p>以上都是阿里云的DNS，实测我的网络解析速度还行。
Bootstrap DNS 服务器则修改为：&lt;/p>
&lt;pre>&lt;code>223.5.5.5
223.6.6.6
114.114.114.114
8.8.8.8
&lt;/code>&lt;/pre>
&lt;p>保存之后再去&lt;code>过滤器-DNS黑名单&lt;/code>下启用需要的规则就行了，自带的几个都不错，打勾就能下载。&lt;/p>
&lt;h5 id="导入解析-1">导入解析
&lt;/h5>&lt;p>此步骤和使用PiHole一模一样。&lt;/p></description></item><item><title>记录一次在鸿蒙4.0安装GMS套件的过程</title><link>https://blog.tama.guru/record/homo4-0-gms.html</link><pubDate>Fri, 12 Apr 2024 00:06:00 +0800</pubDate><guid>https://blog.tama.guru/record/homo4-0-gms.html</guid><description>&lt;p>换了华子之后，平时我需要用到的那些G系软件基本上都是通过Gspace这类的软件去实现的，但是有一些特殊的软件就无法使用了&amp;hellip;比如litchi这个第三方无人机飞控软件，如果使用gspace去安装，手机在连接遥控器的时候就不会跳转到litchi，图像也没有，结果就是我没提前发现这个问题，某次飞行前东西都准备好了，然后我也崩溃了&amp;hellip;&lt;/p>
&lt;p>[scode type=&amp;ldquo;red&amp;rdquo;]经测试，安装了GMS之后Litchi依旧无法正常运行，甚至用官方的DJI Fly都无法正常连接，症状为不弹出USB调试提示窗/不启动APP/启动APP后无法连接到遥控器。[/scode]&lt;/p>
&lt;p>本文的教程主要参考：&lt;a class="link" href="https://toalan.com/archives/36/" target="_blank" rel="noopener"
>https://toalan.com/archives/36/&lt;/a>。该教程提供了一个adb+手机联动安装的方式，看评论成功率还挺高的。以下根据文中的步骤一步步去执行并记录差异。&lt;/p>
&lt;h3 id="-1其他准备工作">-1.其他准备工作
&lt;/h3>&lt;p>安装了最新鸿蒙4.0的Mate60Pro一台（版本号4.2.110，nolog的beta通道）。
稳定的网络环境（指能连接外面的世界）。
下载好文中所需的文件。
安装好adb套件并事前做好认证。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/04/11/6617f95f42316.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/11/6617f95f42316.png" alt="我已事前做好授权，因此可能部分步骤与文中不一致。" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/11/6617f95f42316.png"
loading="lazy"
alt="我已事前做好授权，因此可能部分步骤与文中不一致。"
>&lt;/p>
&lt;h3 id="0事前准备">0.事前准备
&lt;/h3>&lt;p>&amp;ldquo;设置-系统和更新-系统导航方式-更多-悬浮导航&amp;rdquo;:关闭悬浮导航
&amp;ldquo;设置-系统和更新-纯净模式&amp;rdquo;:关闭增强防护
&amp;ldquo;设置-隐私-隐私空间&amp;rdquo;:关闭隐私空间
&amp;ldquo;设置-应用和服务-应用分身&amp;rdquo;:关闭应用分身
&lt;strong>以上功能我均没有使用，因此跳过了。&lt;/strong>&lt;/p>
&lt;p>解压压缩包,将Backup文件夹复制到手机存储空间里的/Huawei 的目录里,压缩包里目录里的软件对应接下来的步骤,按步骤安装!
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/04/11/6617faf43512f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/11/6617faf43512f.png" alt="文件复制好的话在/内部存储&amp;gt;backup&amp;gt;backupFiles&amp;gt;2019-12-07_02-08-38-841文件夹应该能看到以下文件" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/11/6617faf43512f.png"
loading="lazy"
alt="文件复制好的话在/内部存储&amp;gt;backup&amp;gt;backupFiles&amp;gt;2019-12-07_02-08-38-841文件夹应该能看到以下文件"
>&lt;/p>
&lt;h3 id="1-清除谷歌应用数据">1. 清除谷歌应用数据
&lt;/h3>&lt;p>清除以下app的数据：&lt;/p>
&lt;blockquote>
&lt;p>Google Play商店
Google通讯录同步
Google Play服务
Google服务框架
Google账户管理程序
com.google.android.gms.policy_sidecar_aps
SharedLibrary
谷歌服务助手&lt;/p>&lt;/blockquote>
&lt;p>打开”设置”-“应用和服务”-“应用管理”,点击右上角四个点,点击显示系统程序,然后搜索手机里是否有以上软件,若有则删除.
&lt;strong>因为我之前没有安装过，此步骤省略。&lt;/strong>&lt;/p>
&lt;h3 id="2-修改系统时间到2019年12月7日">2. 修改系统时间到2019年12月7日
&lt;/h3>&lt;p>“设置”-“系统和更新”-“日期和时间”&lt;/p>
&lt;p>将自动设置关闭,并修改日期到2019年12月7日&lt;/p>
&lt;h3 id="3-打开备份从内部存储恢复">3. 打开备份,从内部存储恢复
&lt;/h3>&lt;p>“设置”-“系统和更新”-“备份和恢复”&lt;/p>
&lt;p>右上角四个点选择”从内部存储恢复”,选择 toalan.com 备份,输入密码恢复(如果没有,就是backup导入没有成功)&lt;/p>
&lt;blockquote>
&lt;p>如果这里没有”从内部存储恢复”，点击从“外部存储”，然后把权限全部打开。返回重新进入，就会有了。
&lt;strong>符合预期&lt;/strong>&lt;/p>&lt;/blockquote>
&lt;h3 id="4-激活谷歌服务助手">4. 激活谷歌服务助手
&lt;/h3>&lt;p>“设置”-“系统和更新”-“日期和时间”-将自动设置打开
从桌面打开谷歌服务助手,点击激活,并给权限
激活后不需要点击”开始下载”,直接返回桌面&lt;/p>
&lt;blockquote>
&lt;p>🚨如果打开提示“当前设备不支持”，那就可以放弃治疗了&lt;/p>&lt;/blockquote>
&lt;p>&lt;strong>注意：此时我已经连接到了国际互联网，并且为了保证稳定，我使用的是移动网络+V*N的方式，而不是在路由搭建全局网络。&lt;/strong>&lt;/p>
&lt;h3 id="5-安装microg且登录谷歌账号此处对应文件夹的第五步">5. 安装MicroG,且登录谷歌账号（此处对应文件夹的“第五步”）
&lt;/h3>&lt;p>安装MicroG,打开后点击”Account”,点击右下角”sign in”,登录自己的谷歌账号(此过程可能会闪退一两次, 重试即可)
&lt;strong>注意：安装完要立即打开，因为这东西不知道为什么不显示在我的桌面上。若是闪退了可以在设置&amp;gt;应用和服务&amp;gt;应用管理找到MicroG点开之后强行停止上方有个小齿轮，点开就进应用了。如果登录过程中一直停留在&lt;code>Just a sec...&lt;/code>，建议换用其它网络和科学软件或者强行停止MicroG并重新进入。&lt;/strong>&lt;/p>
&lt;h4 id="6-安装多个谷歌软件">6. 安装多个谷歌软件
&lt;/h4>&lt;p>安装1,2,3,4
再安装5-1,安装完打开后,点击上面的系统,可以看见兼容的安卓版本
若是Android10及以下,则安装5-2,若是Android12及以上,则安装5-3
&lt;strong>符合预期&lt;/strong>&lt;/p>
&lt;h4 id="7-卸载microg安装drvice-id">7. 卸载MicroG、安装Drvice ID
&lt;/h4>&lt;p>设置-应用和服务-应用管理-搜索 microG 卸载
安装第七步 Device ID
&lt;strong>符合预期&lt;/strong>&lt;/p>
&lt;h4 id="8-安装play服务">8. 安装Play服务
&lt;/h4>&lt;p>安装Play服务,安装完之后,十秒左右状态栏便会报错(&amp;ldquo;此设备未获得Play保护机制认证&amp;rdquo;),不用管.（&lt;strong>如果不弹窗，请检查网络是否正常，这个很重要！&lt;/strong>）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/04/12/661809d6e3525.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/661809d6e3525.png" alt="弹窗了说明操作正确" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/661809d6e3525.png"
loading="lazy"
alt="弹窗了说明操作正确"
>
&lt;strong>符合预期&lt;/strong>&lt;/p>
&lt;h4 id="9-下载edge浏览器设备注册">9. 下载Edge浏览器、设备注册
&lt;/h4>&lt;p>华为应用商店搜索 Edge ，下载并安装。
不要用 华为浏览器 、夸克 、QQ浏览器、UC浏览器 等其他毒瘤浏览器，会导致不跳转。
打开 Device ID 复制&amp;quot;Google Service Framework(GSF)&amp;ldquo;下面的数据
打开 Edge 进入 &lt;a class="link" href="https://www.google.com/android/uncertified/" target="_blank" rel="noopener"
>https://www.google.com/android/uncertified/&lt;/a> 网站，登录自己Google账号，将数据粘贴进去-注册！
&lt;strong>符合预期&lt;/strong>&lt;/p>
&lt;h4 id="10-通过adb停用gsf重要步骤-注此处我直接用cmd调用adb命令了">10. 通过ADB停用GSF【重要步骤！】 注：此处我直接用cmd调用adb命令了
&lt;/h4>&lt;p>1.准备一台PC电脑（win系统）和数据线。
2.下载&lt;a class="link" href="https://developer.android.google.cn/tools/releases/platform-tools?hl=zh-cn" target="_blank" rel="noopener"
>adb工具套件&lt;/a>。
3.手机端操作：
3.1打开 开发者模式（设置-关于手机-连点7次HarmonyOS版本-输入密码)
3.2开启 USB调试 和 &amp;ldquo;仅充电&amp;quot;模式下允许ADB调试 （设置-系统和更新-开发者人员选项）
3.3手机通过数据线到电脑，允许与电脑链接（不弹窗可忽略）
3.4下滑通知栏，点击 正在通过USB充电,选择 传输文件模式 &lt;strong>其实仅充电也可以的。&lt;/strong>
4电脑端操作:
4.1.1解压adb套件压缩包到任意目录并添加到环境变量。
4.1.2打开cmd，输入&lt;code>adb device&lt;/code>在手机上授权。
4.2如果一切正常，打开这个界面。（如果你连接有问题， 界面都不会弹出，怎么解决链接问题看弹窗提示帮助或者点击这里跳转）
5.注意！下面的操作是很关键的，请仔细阅读。！！！重要！！！请阅读完剩余步骤，理解后再操作。
5.1ADB终端内输入命令：adb shell pm disable-user &amp;ndash;user 0 com.google.android.gsf &lt;strong>注意！不要回车执行操作！只是粘贴上去好准备。&lt;/strong>
5.2手机安装第八步的 8.play商店 。
5.3安装完打开后,会提示&amp;quot;我们正在为您更新Google Play&amp;rdquo;,当跳出可以前往google商店的选项后，直接前往商店，取消更新。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a07754c1.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a07754c1.png" alt="直接进入商店即可" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a07754c1.png"
loading="lazy"
alt="直接进入商店即可"
>
5.4如果商店可以正常打开加载数据，关闭play商店后台运行。注意，在教程没有结束之前，不要通过play下载任何应用。
5.5禁用GSF并且留住FCM功能操作。
5.5.1手机复制链接 &lt;a class="link" href="https://play.google.com/store/apps/details?id=com.google.android.gms" target="_blank" rel="noopener"
>https://play.google.com/store/apps/details?id=com.google.android.gms&lt;/a> 到 Edge 打开。
5.5.2下方提示 外部应用打开，打开paly商店开应用详情页。
5.5.3点击更新，要注意下载的进度条，当进度条超过50%以后，立马用 搞机工具箱 禁用。忽略提示信息，继续卸载。（注意：如果下载卡在等待中，建议去应用管理把Google Play服务和Play Store后台进程都杀掉，然后换用其它梯子，重新回到5.5.1，又或者直接把梯子关了等一段时间再打开，然后重新下载即可。）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a36b8cbb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a36b8cbb.png" alt="网很快的话这个过程可能就几秒，因此提前要做好准备。" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a36b8cbb.png"
loading="lazy"
alt="网很快的话这个过程可能就几秒，因此提前要做好准备。"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a71cf920.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a71cf920.png" alt="下载进度超50后电脑上同时执行预先准备好的这个指令。" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/04/12/66180a71cf920.png"
loading="lazy"
alt="下载进度超50后电脑上同时执行预先准备好的这个指令。"
>&lt;/p>
&lt;p>更新完成后，play服务弹窗就会消失，消失后关掉play商店后台，重新打开，随便下载一个应用，正常下载继续11步。
&lt;strong>符合预期&lt;/strong>&lt;/p>
&lt;h4 id="11检查fcm是否开启">11.检查FCM是否开启
&lt;/h4>&lt;p>确保网络畅通可访问谷歌
打开 电话，输入 &lt;code>*#*#426#*#*&lt;/code> 跳转到FCM日志
提示 Connected 表示已连接，即成功。&lt;/p>
&lt;pre>&lt;code>Server:Connected
Host:mtalk.google.com/28.0.0.5
Port:5228
Time Connected:00:01
&lt;/code>&lt;/pre>
&lt;p>如果Host和Port有数据，而Server提示No Connected，请重启手机
如Play商店不能正常加载数据和使用FCM，从第八部开始重新操作。
&lt;strong>符合预期&lt;/strong>&lt;/p>
&lt;h4 id="后附">后附
&lt;/h4>&lt;p>按照该教程，基本上可以实现正常使用且不会弹窗（至少目前不会），以上经测试商店相关的功能都没问题，后续如果有什么变数再更新。
再次感谢原作者。&lt;/p></description></item><item><title>在静态网站上使用waline评论系统</title><link>https://blog.tama.guru/record/waline-on-html.html</link><pubDate>Sun, 10 Mar 2024 01:24:00 +0800</pubDate><guid>https://blog.tama.guru/record/waline-on-html.html</guid><description>&lt;h4 id="waline是什么">Waline是什么
&lt;/h4>&lt;blockquote>
&lt;p>一款从 Valine 衍生的带后端评论系统。可以将 Waline 等价成 With backend Valine.&lt;/p>&lt;/blockquote>
&lt;p>简单来说，Waline可以引入到任意网站上，比如hugo等搭建的静态博客系统。&lt;/p>
&lt;h4 id="为什么要用waline">为什么要用Waline
&lt;/h4>&lt;p>看到这个的第一眼我就心想：卧槽，我也要整一个！&lt;/p>
&lt;center>![文章反应功能][1]&lt;/center>
于是现在已经加入到提问箱首页了：[狼的提问箱][2]。
&lt;h4 id="怎么搭建呢">怎么搭建呢？
&lt;/h4>&lt;p>直接参考&lt;a class="link" href="https://waline.js.org/" target="_blank" rel="noopener"
>官网&lt;/a>即可，文档较为完善。推荐使用vercel+LeanCloud，可以实现无服务器搭建，当然访问速度有一些慢。&lt;/p>
&lt;h4 id="需要注意什么">需要注意什么？
&lt;/h4>&lt;p>Waline主要分为三个部分进行配置：&lt;/p>
&lt;h5 id="vercel环境变量">vercel环境变量
&lt;/h5>&lt;p>配置地址:https://vercel.com/%username%s-projects/%project_name%/settings/environment-variables
配置文档:&lt;a class="link" href="https://waline.js.org/reference/server/env.html" target="_blank" rel="noopener"
>https://waline.js.org/reference/server/env.html&lt;/a>
描述：一些全局性的配置
具体可配置项目如下：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">环境变量名称&lt;/th>
&lt;th style="text-align: center">默认值&lt;/th>
&lt;th style="text-align: center">备注&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">LEAN_ID&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">LeanCloud 应用的 App ID&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">LEAN_KEY&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">LeanCloud 应用的 App Key&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">LEAN_MASTER_KEY&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">LeanCloud 应用的 Master Key 用于后台修改数据&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">LEAN_SERVER&lt;/td>
&lt;td style="text-align: center">-&lt;/td>
&lt;td style="text-align: center">LeanCloud 服务地址，国内版用户需要配置此项&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SITE_NAME&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">博客名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SITE_URL&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">博客地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">LOGIN&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">当设置为 LOGIN=force 时会要求登录才能评论&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">DISABLE_USERAGENT&lt;/td>
&lt;td style="text-align: center">false&lt;/td>
&lt;td style="text-align: center">是否隐藏评论者的 UA，默认为否&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">DISABLE_REGION&lt;/td>
&lt;td style="text-align: center">false&lt;/td>
&lt;td style="text-align: center">是否隐藏评论者的归属地&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">DISABLE_AUTHOR_NOTIFY&lt;/td>
&lt;td style="text-align: center">false&lt;/td>
&lt;td style="text-align: center">是否禁止新评论通知&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">AVATAR_PROXY&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://avatar.75cdn.workers.dev" target="_blank" rel="noopener"
>https://avatar.75cdn.workers.dev&lt;/a>&lt;/td>
&lt;td style="text-align: center">头像的代理地址，设置 false 关闭代理&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">GRAVATAR_STR&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://seccdn.libravatar.org/avatar/%7b%7bmail" target="_blank" rel="noopener"
>https://seccdn.libravatar.org/avatar/{{mail&lt;/a>\md5}}&lt;/td>
&lt;td style="text-align: center">Gravatar 头像的地址，基于 nunjucks 语法&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">LEVELS&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">设置后会根据评论数为每个用户提供等级标签&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">IPQPS&lt;/td>
&lt;td style="text-align: center">60&lt;/td>
&lt;td style="text-align: center">基于 IP 的评论发布频率限制，单位为秒。设置为 0 不限制&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SECURE_DOMAINS&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">安全域名配置，支持逗号分隔配置多个域名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">AKISMET_KEY&lt;/td>
&lt;td style="text-align: center">70542d86693e&lt;/td>
&lt;td style="text-align: center">Akismet 反垃圾评论服务 Key (默认开启，不用请设置为 false)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">COMMENT_AUDIT&lt;/td>
&lt;td style="text-align: center">false&lt;/td>
&lt;td style="text-align: center">评论发布审核开关。开启后评论需要经过管理员审核后才能显示，所以建议在评论框默认文字上提供提示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">RECAPTCHA_V3_KEY&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">reCAPTCHA V3 key，须与客户端同时配置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">RECAPTCHA_V3_SECRET&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">reCAPTCHA V3 secret，服务端使用，不可泄漏&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TURNSTILE_KEY&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">Turnstile key，须与客户端同时配置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TURNSTILE_SECRET&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">Turnstile secret，服务端使用，不可泄漏&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_CONFIG&lt;/td>
&lt;td style="text-align: center">{}&lt;/td>
&lt;td style="text-align: center">MarkdownIt 配置&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_HIGHLIGHT&lt;/td>
&lt;td style="text-align: center">true&lt;/td>
&lt;td style="text-align: center">是否启用高亮&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_EMOJI&lt;/td>
&lt;td style="text-align: center">true&lt;/td>
&lt;td style="text-align: center">是否启用 Emoji 缩写支持&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_SUB&lt;/td>
&lt;td style="text-align: center">true&lt;/td>
&lt;td style="text-align: center">是否启用下角标支持&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_SUP&lt;/td>
&lt;td style="text-align: center">true&lt;/td>
&lt;td style="text-align: center">是否启用上角标支持&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_TEX&lt;/td>
&lt;td style="text-align: center">mathjax&lt;/td>
&lt;td style="text-align: center">解析 TeX 的服务，支持 mathjax、katex、false&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_MATHJAX&lt;/td>
&lt;td style="text-align: center">{}&lt;/td>
&lt;td style="text-align: center">MathJax 选项&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MARKDOWN_KATEX&lt;/td>
&lt;td style="text-align: center">{}&lt;/td>
&lt;td style="text-align: center">KaTeX 选项&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SMTP_SERVICE&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">SMTP 邮件发送服务提供商&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SMTP_HOST&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">SMTP 服务器地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SMTP_PORT&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">SMTP 服务器端口。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SMTP_USER&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">SMTP 用户名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SMTP_PASS&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">SMTP 密码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SMTP_SECURE&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">是否使用 SSL 连接 SMTP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SENDER_NAME&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">自定义发送邮件的发件人&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SENDER_EMAIL&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">自定义发送邮件的发件地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_DB&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MongoDB 数据库名称&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_USER&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MongoDB 服务的用户名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_PASSWORD&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MongoDB 服务的密码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_HOST&lt;/td>
&lt;td style="text-align: center">127.0.0.1&lt;/td>
&lt;td style="text-align: center">MongoDB 服务的地址，支持数组格式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_PORT&lt;/td>
&lt;td style="text-align: center">27017&lt;/td>
&lt;td style="text-align: center">MongoDB 服务的端口，支持数组格式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_REPLICASET&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MongoDB 集群&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_AUTHSOURCE&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MongoDB 认证源&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MONGO_OPT_SSL&lt;/td>
&lt;td style="text-align: center">FALSE&lt;/td>
&lt;td style="text-align: center">是否使用 SSL 进行连接&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_DB&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MySQL 数据库库名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_USER&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MySQL 数据库的用户名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_PASSWORD&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">MySQL 数据库的密码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_HOST&lt;/td>
&lt;td style="text-align: center">127.0.0.1&lt;/td>
&lt;td style="text-align: center">MySQL 服务的地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_PORT&lt;/td>
&lt;td style="text-align: center">3306&lt;/td>
&lt;td style="text-align: center">MySQL 服务的端口&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_PREFIX&lt;/td>
&lt;td style="text-align: center">wl_&lt;/td>
&lt;td style="text-align: center">MySQL 数据表的表前缀&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_CHARSET&lt;/td>
&lt;td style="text-align: center">utf8mb4&lt;/td>
&lt;td style="text-align: center">MySQL 数据表的字符集&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">MYSQL_SSL&lt;/td>
&lt;td style="text-align: center">FALSE&lt;/td>
&lt;td style="text-align: center">是否使用 SSL MYSQL 连接数据库&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_DB&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">TiDB 数据库库名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_USER&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">TiDB 数据库的用户名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_PASSWORD&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">TiDB 数据库的密码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_HOST&lt;/td>
&lt;td style="text-align: center">127.0.0.1&lt;/td>
&lt;td style="text-align: center">TiDB 服务的地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_PORT&lt;/td>
&lt;td style="text-align: center">4000&lt;/td>
&lt;td style="text-align: center">TiDB 服务的端口&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_PREFIX&lt;/td>
&lt;td style="text-align: center">wl_&lt;/td>
&lt;td style="text-align: center">TiDB 数据表的表前缀&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TIDB_CHARSET&lt;/td>
&lt;td style="text-align: center">utf8mb4&lt;/td>
&lt;td style="text-align: center">TiDB 数据表的字符集&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SQLITE_PATH&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">SQLite 数据库文件的路径，该路径不包含文件名本身&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">JWT_TOKEN&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">用户登录密钥，随机字符串即可&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SQLITE_DB&lt;/td>
&lt;td style="text-align: center">waline&lt;/td>
&lt;td style="text-align: center">SQLite 数据库文件名，若文件名变化需要修改该字段值&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SQLITE_PREFIX&lt;/td>
&lt;td style="text-align: center">wl_&lt;/td>
&lt;td style="text-align: center">SQLite 数据表的表前缀&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_DB&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">PostgreSQL 数据库库名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_USER&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">PostgreSQL 数据库的用户名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_PASSWORD&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">PostgreSQL 数据库的密码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_HOST&lt;/td>
&lt;td style="text-align: center">127.0.0.1&lt;/td>
&lt;td style="text-align: center">PostgreSQL 服务的地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_PORT&lt;/td>
&lt;td style="text-align: center">3211&lt;/td>
&lt;td style="text-align: center">PostgreSQL 服务的端口&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_PREFIX&lt;/td>
&lt;td style="text-align: center">wl_&lt;/td>
&lt;td style="text-align: center">PostgreSQL 数据表的表前缀&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PG_SSL&lt;/td>
&lt;td style="text-align: center">FALSE&lt;/td>
&lt;td style="text-align: center">是否使用 SSL 连接 PostgreSQL 数据库&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_DATABASE&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">同 PG_DB&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_USER&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">同 PG_USER&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_PASSWORD&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">同 PG_PASSWORD&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_HOST&lt;/td>
&lt;td style="text-align: center">127.0.0.1&lt;/td>
&lt;td style="text-align: center">同 PG_HOST&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_PORT&lt;/td>
&lt;td style="text-align: center">3211&lt;/td>
&lt;td style="text-align: center">同 PG_PORT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_PREFIX&lt;/td>
&lt;td style="text-align: center">wl_&lt;/td>
&lt;td style="text-align: center">同 PG_PREFIX&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">POSTGRES_SSL&lt;/td>
&lt;td style="text-align: center">FALSE&lt;/td>
&lt;td style="text-align: center">同 POSTGRES_SSL&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TCB_ENV&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">腾讯云开发环境 ID&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TCB_ID&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">腾讯云 API 密钥 ID&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TCB_KEY&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">腾讯云 API 密钥 Key&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">JWT_TOKEN&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">用户登录密钥，如果没有配任何环境变量的话需要配置此变量，随机字符串即可&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">GITHUB_TOKEN&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">Personal access tokensopen in new window&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">GITHUB_REPO&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">仓库名称，例如 walinejs/waline&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">GITHUB_PATH&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">数据存储目录，例如 data 表示存储在 data 目录下，默认存在仓库根目录下&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">DETA_PROJECT_KEY&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">Deta 项目密钥&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">OAUTH_URL&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://oauth.lithub.cc" target="_blank" rel="noopener"
>https://oauth.lithub.cc&lt;/a>&lt;/td>
&lt;td style="text-align: center">OAuth 第三方登录服务地址，可以 自建 authopen in new window 这是能让用户使用 GitHub, Twitter, Facebook, Google, 微博等第三方账户登录最简单的方式。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">WEBHOOK&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">评论成功后会向 WEBHOOK 配置的地址发送一条 POST 请求&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">WALINE_ADMIN_MODULE_ASSET_URL&lt;/td>
&lt;td style="text-align: center">//unpkg.com/@waline/admin&lt;/td>
&lt;td style="text-align: center">Waline admin 地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">IP2REGION_DB&lt;/td>
&lt;td style="text-align: center">　&lt;/td>
&lt;td style="text-align: center">自定义 IP 查询库路径&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h5 id="indexjs服务端配置">index.js（服务端）配置
&lt;/h5>&lt;p>配置地址:https://github.com/%username%/%repositorie%/blob/main/index.js
配置文档:&lt;a class="link" href="https://waline.js.org/reference/server/config.html" target="_blank" rel="noopener"
>https://waline.js.org/reference/server/config.html&lt;/a>
描述：该文件位于github私有仓库内，其中一些项目与vercel环境变量效果一致。在这里修改过的文件会自动在vercel内重新build。
可配置的项目：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">名称&lt;/th>
&lt;th style="text-align: center">参考&lt;/th>
&lt;th style="text-align: center">说明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">plugins&lt;/td>
&lt;td style="text-align: center">plugins: [HelloWorldPlugin],&lt;/td>
&lt;td style="text-align: center">插件系统&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">secureDomains&lt;/td>
&lt;td style="text-align: center">secureDomains: &amp;lsquo;waline.js.org&amp;rsquo;,&lt;/td>
&lt;td style="text-align: center">安全域名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">forbiddenWords&lt;/td>
&lt;td style="text-align: center">forbiddenWords: [&amp;lsquo;违禁词A&amp;rsquo;, &amp;lsquo;违禁词B&amp;rsquo;],&lt;/td>
&lt;td style="text-align: center">违禁词&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">disallowIPList&lt;/td>
&lt;td style="text-align: center">disallowIPList: [&amp;lsquo;8.8.8.8&amp;rsquo;, &amp;lsquo;4.4.4.4&amp;rsquo;],&lt;/td>
&lt;td style="text-align: center">IP 黑名单&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">mailSubject&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">评论回复邮件标题自定义，等同于环境变量 MAIL_SUBJECT&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">mailTemplate&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">评论回复邮件内容自定义，等同于环境变量 MAIL_TEMPLATE&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">mailSubjectAdmin&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">新评论通知邮件标题自定义，等同于环境变量 MAIL_SUBJECT_ADMIN&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">mailTemplateAdmin&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">新评论通知邮件内容自定义，等同于环境变量 MAIL_TEMPLATE_ADMIN&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">QQTemplate&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">QQ 评论通知模板，等同于环境变量 QQ_TEMPLATE&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">TGTemplate&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">Telegram 评论通知模板，等同于环境变量 TG_TEMPLATE&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">SCTemplate&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">Server酱 评论通知模板，等同于环境变量 SC_TEMPLATE&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">model&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">自定义数据库服务（见https://waline.js.org/cookbook/customize/database.html）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">encryptPassword&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">自定义用户系统（见https://waline.js.org/cookbook/customize/userdb.html）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">评论 Hooks&lt;/td>
&lt;td style="text-align: center">&lt;/td>
&lt;td style="text-align: center">包含一些自定义HOOK，详情见文档。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">修改过的index.js文件参考如下：&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-javascript" data-lang="javascript">&lt;span class="line">&lt;span class="cl">&lt;span class="kr">const&lt;/span> &lt;span class="nx">Application&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">require&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;@waline/vercel&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">module&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">exports&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">Application&lt;/span>&lt;span class="p">({&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">plugins&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//secureDomains: &amp;#39;*.tama.guru&amp;#39;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">COMMENT_AUDIT&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">forbiddenWords&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;***&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;***&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h5 id="前端html内配置">前端(html内)配置
&lt;/h5>&lt;p>配置地址:https://%yoursite%/%sitename%.html
配置文档:&lt;a class="link" href="https://waline.netlify.app/client/basic.html" target="_blank" rel="noopener"
>https://waline.netlify.app/client/basic.html&lt;/a>
描述：每个html都可以独立配置以达到不同的显示效果
&lt;strong>注意：以下配置针对v2版本生效，v3未知&lt;/strong>
可配置的项目：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">名称&lt;/th>
&lt;th style="text-align: center">类型&lt;/th>
&lt;th style="text-align: center">说明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">el&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">Waline 的初始化挂载器。必须是一个有效的 CSS 选择器。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">serverURL&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">Waline 的服务端地址。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">wordLimit&lt;/td>
&lt;td style="text-align: center">number \ [number, number]&lt;/td>
&lt;td style="text-align: center">评论字数限制。填入单个数字时为最大字数限制。设置为 0 时无限制。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">path&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">当前 文章页 路径，用于区分不同的 文章页，以保证正确读取该 文章页 下的评论列表。默认为&lt;code>window.location.pathname&lt;/code>，可选为&lt;code>window.location.href&lt;/code>或其他。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">avatar&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">Gravatar 头像展示方式。见文档。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">meta&lt;/td>
&lt;td style="text-align: center">string[]&lt;/td>
&lt;td style="text-align: center">评论者相关属性。可选值: &amp;rsquo;nick&amp;rsquo;, &amp;lsquo;mail&amp;rsquo;, &amp;rsquo;link&amp;rsquo;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">pageSize&lt;/td>
&lt;td style="text-align: center">number&lt;/td>
&lt;td style="text-align: center">评论列表分页，每页条数。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">lang&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">多语言支持。可自定义，见文档。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">visitor&lt;/td>
&lt;td style="text-align: center">boolean&lt;/td>
&lt;td style="text-align: center">开启文章访问量统计。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">dark&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">暗黑模式适配。详情见文档。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">highlight&lt;/td>
&lt;td style="text-align: center">boolean&lt;/td>
&lt;td style="text-align: center">代码高亮，默认开启。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">avatarCDN&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">设置 Gravatar 头像 CDN 地址。默认值是https://sdn.geekzu.org/avatar/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">avatarForce&lt;/td>
&lt;td style="text-align: center">boolean&lt;/td>
&lt;td style="text-align: center">每次访问是否强制拉取最新的评论列表头像&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">emoji&lt;/td>
&lt;td style="text-align: center">(string \ EmojiInfo)[]&lt;/td>
&lt;td style="text-align: center">表情设置，详见文档。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">requiredMeta&lt;/td>
&lt;td style="text-align: center">string[]&lt;/td>
&lt;td style="text-align: center">设置必填项，默认匿名，可填[&amp;rsquo;nick&amp;rsquo;, &amp;lsquo;mail&amp;rsquo;]等&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">uploadImage&lt;/td>
&lt;td style="text-align: center">Function&lt;/td>
&lt;td style="text-align: center">自定义图片上传方法，方便更好的存储图片。方法执行时会将图片对象传入。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">login&lt;/td>
&lt;td style="text-align: center">string&lt;/td>
&lt;td style="text-align: center">登录模式状态，分为&amp;rsquo;enable&amp;rsquo;: 启用登录 (默认) &amp;lsquo;disable&amp;rsquo;: 禁用登录，用户只能填写信息评论 &amp;lsquo;force&amp;rsquo;: 强制登录，用户必须注册并登录才可发布评论&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">copyright&lt;/td>
&lt;td style="text-align: center">boolean&lt;/td>
&lt;td style="text-align: center">是否显示页脚版权信息。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">修改过的html文件参考如下：&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span> &lt;span class="na">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;/waline.js&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">link&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#39;/waline.css&amp;#39;&lt;/span> &lt;span class="na">rel&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#39;stylesheet&amp;#39;&lt;/span> &lt;span class="p">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;waline&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">waline&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">Waline&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">init&lt;/span>&lt;span class="p">({&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">el&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;#waline&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">serverURL&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;https://%yourwalineserversite%&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">reaction&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">ture&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">meta&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;nick&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;mail&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">requiredMeta&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;mail&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pageview&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">search&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">comment&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">login&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;disable&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wordLimit&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pageSize&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">avatar&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;monsterid&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">emoji&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;https://unpkg.com/@waline/emojis@1.2.0/tieba&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//禁止图片上传按钮
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">imageUploader&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//不显示版权标志
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">copyright&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>再次提醒，我引用最新的v3版本会报错，建议用v2。&lt;/strong>&lt;/p></description></item><item><title>在archlinux正确的使用xrdp以及碰到的问题</title><link>https://blog.tama.guru/record/archlinux_xrdp.html</link><pubDate>Mon, 05 Feb 2024 23:58:41 +0800</pubDate><guid>https://blog.tama.guru/record/archlinux_xrdp.html</guid><description>&lt;p>为什么不用vnc？一是需要另外装个软件，不方便，而且配置麻烦，总是能碰到七七八八的问题，而用xrdp基本上用巨硬自带的软件就能实现远程连接。&lt;/p>
&lt;h4 id="安装并配置xrdp">安装并配置xrdp
&lt;/h4>&lt;p>&lt;strong>注：我是kde桌面环境&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xinit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S base-devel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xrdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>以上是基础软件包，下面根据平台选择安装：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yay -S xortxrdp-glamor &lt;span class="c1">#适用于I家和A家核显解码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xorgxrdp &lt;span class="c1">#使用CPU编码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xordxrdp-nvidia &lt;span class="c1">#使用英伟达独显解码&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改&lt;code>/etc/X11/Xwrapper.config&lt;/code>（无此文件自行新建），添加如下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">allowed_users&lt;/span>&lt;span class="o">=&lt;/span>anybody
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">needs_root_rights&lt;/span>&lt;span class="o">=&lt;/span>no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>复制一个.xinitrc到用户主目录并编辑其中内容:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cp /etc/X11/xinit/xinitrc /home/&lt;span class="nv">$USERNAME&lt;/span>/.xinitrc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注释掉最后的几行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#twm &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xclock -geometry 50x50-1+1 &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xterm -geometry 80x50+494+51 &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xterm -geometry 80x20+494-0 &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#exec xterm -geometry 80x66+0+0 -name login&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">DESKTOP_SESSION&lt;/span>&lt;span class="o">=&lt;/span>plasma
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/plasma-dbus-run-session-if-needed startplasma-x11
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>最后两行根据桌面环境替换：
i3w / dwm:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exec&lt;/span> i3w
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>gnome&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">unset&lt;/span> SESSION_MANAGER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">unset&lt;/span> DBUS_SESSION_BUS_ADDRESS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exec&lt;/span> dbus-launch gnome-shell --x11
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>xfce4&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">unset&lt;/span> SESSION_MANAGER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">unset&lt;/span> DBUS_SESSION_BUS_ADDRESS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exec&lt;/span> dbus-launch startxfce4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启动xrdp服务：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start xrdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="一些小问题">一些小问题：
&lt;/h4>&lt;h5 id="安装以后黑屏闪退">安装以后，黑屏、闪退
&lt;/h5>&lt;ol>
&lt;li>可以尝试修改&lt;code>/etc/xrdp/xrdp.ini&lt;/code>，把&lt;code>allow_channels=true&lt;/code>改成&lt;code>allow_channels=false&lt;/code>&lt;/li>
&lt;li>使用&lt;code>ps -elf|grep vnc&lt;/code>查询是否有多个进程同时运行，如果有，直接&lt;code>kill -9 $pid&lt;/code>（为避免出现这种问题建议每次都注销而不是直接叉掉rdp窗口）&lt;/li>
&lt;/ol>
&lt;h5 id="权限输入密码弹窗不出来">权限（输入密码）弹窗不出来
&lt;/h5>&lt;p>新增&lt;code>/etc/polkit-1/rules.d/49-nopasswd_global.rules&lt;/code>文件，并添加以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/* Allow members of the wheel group to execute any actions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * without password authentication, similar to &lt;span class="s2">&amp;#34;sudo NOPASSWD:&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">polkit.addRule&lt;span class="o">(&lt;/span>&lt;span class="k">function&lt;/span>&lt;span class="o">(&lt;/span>action, subject&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">((&lt;/span> action.id &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;org.freedesktop.policykit.exec&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">||&lt;/span> action.id &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;org.fedoraproject.FirewallD1.all&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">||&lt;/span> action.id &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;org.fedoraproject.FirewallD1.config&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">||&lt;/span> action.id &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;org.freedesktop.NetworkManager.settings.modify.system&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> subject.isInGroup&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;wheel&amp;#34;&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> polkit.Result.YES&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">})&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改后会默认允许所有授权，可能存在一定风险。&lt;/p>
&lt;h5 id="修改3389端口">修改3389端口
&lt;/h5>&lt;p>修改配置文件&lt;code>/etc/xrdp/xrdp.ini&lt;/code>中&lt;code>port=3389&lt;/code>字段即可，如果有开防火墙记得开放端口。&lt;/p></description></item><item><title>记录windows各类错误及尝试进行解决的流程</title><link>https://blog.tama.guru/record/windows-error-fix.html</link><pubDate>Wed, 31 Jan 2024 09:51:00 +0800</pubDate><guid>https://blog.tama.guru/record/windows-error-fix.html</guid><description>&lt;p>在基本上尝试了各类Windows系统我得出一个结论，那就是没有完美的Windows系统，除了Win7、Win10 LTSC、Win Server 2022这几个屁事比较少之外，其他总能碰到奇奇怪怪的事情，在此做个文章记录发生过的问题以及记录一些尝试解决处理过程中碰到的事情，免得后面又忘了又翻一遍材料。&lt;/p>
&lt;h3 id="系统更新类">系统更新类
&lt;/h3>&lt;h4 id="0x80070643---0x8024200b">0x80070643 - 0x8024200B
&lt;/h4>&lt;p>在什么系统出现：Windows 10 企业版 LTSC（21H2，19044.3930）
什么时候出现：系统更新
提示什么：安装失败: Windows 安装下列更新失败，错误为 0x8024200B: 2024-01 适用于 Windows 10 Version 21H2 安全更新，适合基于 x64 的系统 (KB5034441)。
是否解决：未知
怎么解决：&lt;/p>
&lt;ul>
&lt;li>尝试1：手工打补丁：到&lt;a class="link" href="https://catalog.update.microsoft.com/" target="_blank" rel="noopener"
>https://catalog.update.microsoft.com/&lt;/a>查找补丁号&lt;code>KB5034441&lt;/code>，结果为&lt;code>We did not find any results for &amp;quot;KB5034441&amp;quot;&lt;/code>，不成功。&lt;/li>
&lt;li>尝试2：查找官网信息：到MS官网查找&lt;a class="link" href="https://support.microsoft.com/en-us/topic/kb5034441-windows-recovery-environment-update-for-windows-10-version-21h2-and-22h2-january-9-2024-62c04204-aaa5-4fee-a02a-2fdea17075a8" target="_blank" rel="noopener"
>关于&lt;code>KB5034441&lt;/code>的信息&lt;/a>，找到前面的这条记录提到如下内容：&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>IMPORTANT&lt;/p>&lt;/blockquote>
&lt;blockquote>
&lt;p>This update requires 250 MB of free space in the recovery partition to install successfully. If the recovery partition does not have sufficient free space, this update will fail. In this case, you will receive the following error message:&lt;/p>&lt;/blockquote>
&lt;blockquote>
&lt;p>0x80070643 - ERROR_INSTALL_FAILURE&lt;/p>&lt;/blockquote>
&lt;blockquote>
&lt;p>To avoid this error or recover from this failure, please follow the Instructions to manually resize your partition to install the WinRE update and then try installing this update.&lt;/p>&lt;/blockquote>
&lt;blockquote>
&lt;p>看起来需要先保证必须在恢复分区中具有 250 MB 的可用空间才能成功应用此更新。&lt;/p>&lt;/blockquote>
&lt;p>用DG看了下我的分区结构，发现根本没有Winre这个分区，笑死。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/31/65b9a73b0cd30.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/31/65b9a73b0cd30.png" alt="我的分区结构，其中分区3-4是给debian用的" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/31/65b9a73b0cd30.png"
loading="lazy"
alt="我的分区结构，其中分区3-4是给debian用的"
>
但上面也有提到：&lt;/p>
&lt;blockquote>
&lt;p>如果 PC 没有恢复分区，则不需要此更新。在这种情况下，可以安全地忽略该错误。&lt;/p>&lt;/blockquote>
&lt;p>那就只能当这个问题不存在了。&lt;/p>
&lt;h3 id="内部错误状态类">内部错误状态类
&lt;/h3>&lt;h4 id="10013">10013
&lt;/h4>&lt;p>在什么系统出现：Windows Server 2022
什么时候出现：正常使用时出现
提示什么：创建 TLS 客户端 凭据时发生严重错误。内部错误状态为 10013。
是否解决：否
怎么解决：打开运行，输入&lt;code>inetcpl.cpl&lt;/code>后进入&lt;code>Internet选项&lt;/code>，点击&lt;code>高级&lt;/code>选项卡，找到&lt;code>使用SSL 3.0&lt;/code>，取消勾选保存并重启，之后错误数量明显减少。
出现原因：系统已经不支持SSL3.0及之前版本的安全协议，系统默认是没有勾选这一项的，但是可能是安装了某些软件把该选项打开了导致报错。&lt;/p></description></item><item><title>在debian安装配置redroid并安装shamrock的记录</title><link>https://blog.tama.guru/record/redroid.html</link><pubDate>Wed, 24 Jan 2024 12:01:00 +0800</pubDate><guid>https://blog.tama.guru/record/redroid.html</guid><description>&lt;h3 id="前言">前言
&lt;/h3>&lt;p>由于某讯对第三方QQ机器人的大力追杀，原有的机器人框架（miraiqq和go-cqhttp）等基本上都无法使用了，登录会直接代码45封号。在此之后发展出shamrock等项目，此类项目的特点是需要虚拟机或实机进行操作，意味着至少需要一个桌面环境或者一台闲置手机，开销相比之前1c512m都能跑的时候高太多。在网上冲浪的时候发现了可以将安卓的Dalvik/ART移植到Linux桌面环境，借此运行安卓APK程序，因此需要用到redroid这个软件。&lt;/p>
&lt;p>redroid即Remote anDroid，是一个架设云手机的方案，可以透过docker在linux系统上跑安卓系统容器。相比于虚拟机方案，其优势在于：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>开源&lt;/p>
&lt;/li>
&lt;li>
&lt;p>支持GPU加速+arm转X86转译器&lt;/p>
&lt;/li>
&lt;li>
&lt;p>与宿主机公用内核等相关资源&lt;/p>
&lt;/li>
&lt;li>
&lt;p>支持使用scrcpy进行连接&lt;/p>
&lt;hr>
&lt;/li>
&lt;/ul>
&lt;h3 id="给内核添加相关模块">给内核添加相关模块
&lt;/h3>&lt;p>首先需要查询系统内核是否支持&lt;code>binder&lt;/code>和&lt;code>ashmem&lt;/code>两个功能，此功能为使用redroid必须的。查询可以通过执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">lsmod &lt;span class="p">|&lt;/span> grep -e ashmem_linux -e binder_linux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>进行查询，如果有输出可以略过此步骤。如果没有任何输出则表示内核没有配置好这两个模块，需要重新编译内核。对于Ubuntu系统，官方提供了&lt;a class="link" href="https://github.com/remote-android/redroit-doc" target="_blank" rel="noopener"
>比较简单的流程&lt;/a>，对于其他系统则需要手工维护。&lt;/p>
&lt;p>首先去下载当前使用内核版本的源码：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">apt install linux-source-&lt;span class="k">$(&lt;/span>uname-r&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下载完的源码位于&lt;code>/usr/src&lt;/code>，格式是&lt;code>.xz&lt;/code>，进去之后解压源码包并进入解压的文件夹，然后执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">make menuconfig
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在弹出界面的勾选：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Device Drivers--Android--Android Drivers--Binder Ipc Driver。 &lt;span class="c1">#binder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Device Drivers--Android--Android Drivers--Binder filesystem。 &lt;span class="c1">#binder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Device Drivers--Android--Staging Drivers--Android--Enable the Anonumous Shared Memory Subsystem &lt;span class="c1">#ashmem&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">General Setup--CPU/Task &lt;span class="nb">time&lt;/span> and stats accounting--Pressure stall infomation tracking
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>后按&lt;code>save&lt;/code>保存。&lt;/p>
&lt;p>或者进去之后直接选择&lt;code>exit&lt;/code>并选择&lt;code>save config&lt;/code>。目录下会生成一个&lt;code>.config&lt;/code>的文件，编辑该文件在最后添加以下内容:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_ASHMEM&lt;/span>&lt;span class="o">=&lt;/span>y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_ANDROID&lt;/span>&lt;span class="o">=&lt;/span>y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_ANDROID_BINDER_IPC&lt;/span>&lt;span class="o">=&lt;/span>y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_ANDROID_BINDERFS&lt;/span>&lt;span class="o">=&lt;/span>y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_ANDROID_BINDER_DEVICES&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;binder,hwbinder,vndbinder,binderfs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_ANDROID_BINDER_IPC_SELFTEST&lt;/span>&lt;span class="o">=&lt;/span>y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存后执行&lt;code>make&lt;/code> ，建议不要加j让他慢慢编译，经尝试这样会导致报错。&lt;/p>
&lt;p>&lt;strong>注意&lt;/strong>：可能会报错：&lt;code>CONFIG_DEBUG_INFO_BTF&lt;/code>&lt;/p>
&lt;p>这种情况就去&lt;code>.config&lt;/code>文件里面添加以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_DEBUG_INFO_DWARF5&lt;/span>&lt;span class="o">=&lt;/span>n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFIG_DEBUG_INFO_BTF&lt;/span>&lt;span class="o">=&lt;/span>n &lt;span class="c1">#原值为y&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>跑完后在目录下执行&lt;code>modules_install&lt;/code>和&lt;code>make install&lt;/code>，执行完成后检查内核是否安装到grub了：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="n">base&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">DevBot&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">boot&lt;/span>&lt;span class="c1"># cat /boot/grub/grub.cfg | grep menuentry&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="s2">&amp;#34;${feature_menuentry_id}&amp;#34;&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">xy&lt;/span> &lt;span class="p">];&lt;/span> &lt;span class="n">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry_id_option&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;--id&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry_id_option&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">menuentry_id_option&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-simple-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">submenu&lt;/span> &lt;span class="s1">&amp;#39;Advanced options for Debian GNU/Linux&amp;#39;&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-advanced-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.5.10android&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.5.10android-advanced-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.5.10android (recovery mode)&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.5.10android-recovery-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.5.0-0.deb12.4-amd64&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.5.0-0.deb12.4-amd64-advanced-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.5.0-0.deb12.4-amd64 (recovery mode)&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.5.0-0.deb12.4-amd64-recovery-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.1.0-17-amd64&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.1.0-17-amd64-advanced-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.1.0-17-amd64 (recovery mode)&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.1.0-17-amd64-recovery-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.1.0-15-amd64&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.1.0-15-amd64-advanced-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;Debian GNU/Linux, with Linux 6.1.0-15-amd64 (recovery mode)&amp;#39;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">debian&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">gnu&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">class&lt;/span> &lt;span class="n">os&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;gnulinux-6.1.0-15-amd64-recovery-9aba24c5-ec53-4108-b461-4bcc67d1d0dc&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">menuentry&lt;/span> &lt;span class="s1">&amp;#39;UEFI Firmware Settings&amp;#39;&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="n">menuentry_id_option&lt;/span> &lt;span class="s1">&amp;#39;uefi-firmware&amp;#39;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以看到&lt;code>Debian GNU/Linux, with Linux 6.5.10android&lt;/code>已经配置进去了。&lt;/p>
&lt;p>然后我们需要修改内核启动顺序：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#nano /etc/default/grub
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_DEFAULT=&amp;#34;1 &amp;gt;0&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_TIMEOUT=5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_DISTRIBUTOR=`lsb_release -i -s 2&amp;gt; /dev/null || echo Debian`
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet splash&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX=&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_DISABLE_OS_PROBER=false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>GRUB_DEFAULT为按menuentry顺序排序设置默认启动项，第一项为0，我这里对应的是&lt;code>Debian GNU/Linux&lt;/code>，&lt;code>Debian GNU/Linux, with Linux 6.5.10android&lt;/code>是子菜单&lt;code>Advanced options for Debian GNU/Linux&lt;/code>下的第一项，所以这里应该设置为1 &amp;gt;0.注意&amp;quot;1&amp;quot;和&amp;quot;&amp;gt;&amp;ldquo;之间有一个空格。&lt;/p>
&lt;p>然后更新保存grub：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">update-grub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>查看是否配置正确：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat /proc/cmdline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>重启。然后直接一个&lt;code>uname -a&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> tamakyi@DevBot:~$ uname -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux AkarinDevBot 6.5.10android &lt;span class="c1">#2 SMP PREEMPT_DYNAMIC Wed Jan 24 00:43:00 HKT 2024 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果还是不行（提示缺少ashmem）的话，去克隆这个仓库并执行安装加载：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone https://github.com/choff/anbox-modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> anbox-modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sh ./INSTALL.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>再检查是否启用完成：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> tamakyi@DevBot:~$ grep binder /proc/filesystems
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nodev binder
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> tamakyi@DevBot:~$ grep ashmem /proc/misc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">124&lt;/span> ashmem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>有输出就表示正常启用模块了。如果如果还是用不了，那可能是你需要手动挂载binderfs：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir /dev/binderfs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount -t binder none /dev/binderfs/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后重启再验证，至此redroid的内核依赖模块安装完成。&lt;/p>
&lt;hr>
&lt;h3 id="安装redroid">安装redroid
&lt;/h3>&lt;p>安装过docker的直接运行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> root@DevBot:~# docker run -itd --rm --privileged &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --pull always &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -v ~/data:/data &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -p 35555:5555 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> redroid/redroid:13.0.0-latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中官方支持的版本如下：（截止20240124）&lt;/p>
&lt;ul>
&lt;li>Android 14 (redroid/redroid:14.0.0-latest)&lt;/li>
&lt;li>Android 14 64bit only (redroid/redroid:14.0.0_64only-latest)&lt;/li>
&lt;li>Android 13 (redroid/redroid:13.0.0-latest)&lt;/li>
&lt;li>Android 13 64bit only (redroid/redroid:13.0.0_64only-latest)&lt;/li>
&lt;li>Android 12 (redroid/redroid:12.0.0-latest)&lt;/li>
&lt;li>Android 12 64bit only (redroid/redroid:12.0.0_64only-latest)&lt;/li>
&lt;li>Android 11 (redroid/redroid:11.0.0-latest)&lt;/li>
&lt;li>Android 10 (redroid/redroid:10.0.0-latest)&lt;/li>
&lt;li>Android 9 (redroid/redroid:9.0.0-latest)&lt;/li>
&lt;li>Android 8.1 (redroid/redroid:8.1.0-latest)&lt;/li>
&lt;/ul>
&lt;p>版本并不是越高越好，越高占用内存越多，且限制更多，此处我选择安卓10，跑个shamrock足矣。
&lt;strong>经测试在安卓10内部打开设置会导致宿主机死机，并且重启后docker容器会消失，慎用&lt;/strong>&lt;/p>
&lt;p>检查是否正常使用：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># docker ps&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">d51457fc4561 redroid/redroid:10.0.0-latest &lt;span class="s2">&amp;#34;/init androidboot.h…&amp;#34;&lt;/span> &lt;span class="m">3&lt;/span> minutes ago Up &lt;span class="m">3&lt;/span> minutes 0.0.0.0:35555-&amp;gt;5555/tcp, :::35555-&amp;gt;5555/tcp sweet_vaughan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下载adb套件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">wget https://dl.google.com/android/repository/platform-tools_r34.0.5-linux.zip &lt;span class="c1">#不一定是这个版本，具体以官网为准&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip platform-tools_r34.0.5-linux.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp platform-tools_r34.0.5-linux/adb /usr/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod +x /usr/bin/adb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>连接进redroid：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> root@DevBot:~/platform-tools# adb connect localhost:35555 &lt;span class="c1">#前面把docker的5555端口映射到宿主的35555端口&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connected to localhost:35555
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> root@DevBot:~/platform-tools# adb devices
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">List of devices attached
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">localhost:35555 device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> root@DevBot:~/platform-tools# adb -s localhost:35555 shell &lt;span class="c1">#实际上我这里有多个设备连接 所以需要指定设备&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redroid_x86_64:/ $
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redroid_x86_64:/ $ free -h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> total used free shared buffers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Mem: 14G 5.3G 8.2G 12M 82M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-/+ buffers/cache: 5.2G 8.2G
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Swap: 976M &lt;span class="m">0&lt;/span> 976M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redroid_x86_64:/ $ df -h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filesystem Size Used Avail Use% Mounted on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">overlay 218G 65G 141G 32% /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 64M 592K 63M 1% /dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shm 64M &lt;span class="m">0&lt;/span> 64M 0% /dev/shm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/sdb2 218G 65G 141G 32% /data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 6.7G &lt;span class="m">0&lt;/span> 6.7G 0% /mnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 6.7G &lt;span class="m">0&lt;/span> 6.7G 0% /apex
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/fuse 218G 65G 141G 32% /storage/emulated
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redroid_x86_64:/ $ uname -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux localhost 6.5.10android &lt;span class="c1">#2 SMP PREEMPT_DYNAMIC Wed Jan 24 00:43:00 HKT 2024 x86_64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redroid_x86_64:/ $
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>查询下&lt;code>build.prop&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">1&lt;span class="p">|&lt;/span>redroid_x86_64:/ $ su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1&lt;span class="p">|&lt;/span>redroid_x86_64:/ &lt;span class="c1"># cat /system/build.prop &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># begin common build properties&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># autogenerated by build/make/tools/buildinfo_common.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.date&lt;span class="o">=&lt;/span>Mon Oct &lt;span class="m">16&lt;/span> 08:28:31 UTC &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.date.utc&lt;span class="o">=&lt;/span>&lt;span class="m">1697444911&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.fingerprint&lt;span class="o">=&lt;/span>redroid/redroid_x86_64/redroid_x86_64:10/QP1A.190711.019/frank10160828:userdebug/test-keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.id&lt;span class="o">=&lt;/span>QP1A.190711.019
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.tags&lt;span class="o">=&lt;/span>test-keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.type&lt;span class="o">=&lt;/span>userdebug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.version.incremental&lt;span class="o">=&lt;/span>eng.frank.20231016.082901
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.version.release&lt;span class="o">=&lt;/span>&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.system.build.version.sdk&lt;span class="o">=&lt;/span>&lt;span class="m">29&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.system.brand&lt;span class="o">=&lt;/span>redroid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.system.device&lt;span class="o">=&lt;/span>redroid_x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.system.manufacturer&lt;span class="o">=&lt;/span>redroid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.system.model&lt;span class="o">=&lt;/span>redroid10_x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.system.name&lt;span class="o">=&lt;/span>redroid_x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># end common build properties&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># begin build properties&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># autogenerated by buildinfo.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.id&lt;span class="o">=&lt;/span>QP1A.190711.019
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.display.id&lt;span class="o">=&lt;/span>redroid_x86_64-userdebug &lt;span class="m">10&lt;/span> QP1A.190711.019 eng.frank.20231016.082901 test-keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.incremental&lt;span class="o">=&lt;/span>eng.frank.20231016.082901
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.sdk&lt;span class="o">=&lt;/span>&lt;span class="m">29&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.preview_sdk&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.preview_sdk_fingerprint&lt;span class="o">=&lt;/span>REL
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.codename&lt;span class="o">=&lt;/span>REL
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.all_codenames&lt;span class="o">=&lt;/span>REL
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.release&lt;span class="o">=&lt;/span>&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.security_patch&lt;span class="o">=&lt;/span>2019-09-05
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.base_os&lt;span class="o">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.version.min_supported_target_sdk&lt;span class="o">=&lt;/span>&lt;span class="m">23&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.date&lt;span class="o">=&lt;/span>Mon Oct &lt;span class="m">16&lt;/span> 08:28:31 UTC &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.date.utc&lt;span class="o">=&lt;/span>&lt;span class="m">1697444911&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.type&lt;span class="o">=&lt;/span>userdebug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.user&lt;span class="o">=&lt;/span>frank
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.host&lt;span class="o">=&lt;/span>redroid-builder
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.tags&lt;span class="o">=&lt;/span>test-keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.flavor&lt;span class="o">=&lt;/span>redroid_x86_64-userdebug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.ab_update&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ro.product.cpu.abi and ro.product.cpu.abi2 are obsolete,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># use ro.product.cpu.abilist instead.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.cpu.abi&lt;span class="o">=&lt;/span>x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.cpu.abilist&lt;span class="o">=&lt;/span>x86_64,x86
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.cpu.abilist32&lt;span class="o">=&lt;/span>x86
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.cpu.abilist64&lt;span class="o">=&lt;/span>x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.product.locale&lt;span class="o">=&lt;/span>en-US
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.wifi.channels&lt;span class="o">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ro.build.product is obsolete; use ro.product.device&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.product&lt;span class="o">=&lt;/span>redroid_x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Do not try to parse description or thumbprint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.build.description&lt;span class="o">=&lt;/span>redroid_x86_64-userdebug &lt;span class="m">10&lt;/span> QP1A.190711.019 eng.frank.20231016.082901 test-keys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># end build properties&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># from build/make/target/board/gsi_system.prop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># GSI always generate dex pre-opt in system image&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.cp_system_other_odex&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># GSI always disables adb authentication&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.adb.secure&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># GSI disables non-AOSP nnapi extensions on product partition&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.nnapi.extensions.deny_on_product&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TODO(b/120679683): disable RescueParty before all problem apps solved&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persist.sys.disable_rescue&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TODO(b/78105955): disable privapp_permissions checking before the bug solved&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.control_privapp_permissions&lt;span class="o">=&lt;/span>disable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TODO(b/136212765): the default for LMK&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.lmk.kill_heaviest_task&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.lmk.kill_timeout_ms&lt;span class="o">=&lt;/span>&lt;span class="m">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.lmk.use_minfree_levels&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># end of build/make/target/board/gsi_system.prop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ADDITIONAL_BUILD_PROPERTIES&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.bionic.ld.warning&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ro.treble.enabled&lt;span class="o">=&lt;/span>&lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persist.debug.dalvik.vm.core_platform_api_policy&lt;span class="o">=&lt;/span>just-warn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dalvik.vm.lockprof.threshold&lt;span class="o">=&lt;/span>&lt;span class="m">500&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.bt.name&lt;span class="o">=&lt;/span>Android
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>说明已经正常安装redroid并使用了。&lt;/p>
&lt;hr>
&lt;h3 id="配置安装shamrock">配置安装shamrock
&lt;/h3>&lt;p>首先要把相关的东西准备好（此步骤我在windows远程操作了）：
下载:
&lt;code>https://github.com/Genymobile/scrcpy/releases/download/v2.3.1/scrcpy-win64-v2.3.1.zip&lt;/code>
&lt;code>https://downv6.qq.com/qqweb/QQ_1/android_apk/Android_9.0.15_64.apk&lt;/code>
&lt;code>https://github.com/LSPosed/LSPatch/releases/download/v0.6/manager-v0.6-398-release.apk&lt;/code>
&lt;code>https://github.com/RikkaApps/Shizuku/releases/download/v13.5.3/shizuku-v13.5.3.r1036.fff3f87-release.apk&lt;/code>
以及Shamrock安装包，因为使用的是Action版本，需要登陆Github下载，此处不放链接
，解压&lt;code>scrcpy-win64-v2.3.1.zip&lt;/code>并把QQ、LSPatch、shizuku、Shamrock放在同一目录，打开powershell，执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">./adb.exe connect 100.64.0.16:35555 &lt;span class="c1">#100.64.0.16为我的debian宿主机远程访问IP。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./adb.exe devices
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">List of devices attached
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">100.64.0.16:35555 device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./adb push Android_9.0.15_64.apk /sdcard/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./adb install LSPatch.apk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./adb install shizuku-v13.5.3.r1040.1fc3a2d-release.apk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./adb install Shamrock-v1.0.7.r260.64b7b00-all.apk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后使用scrcpy：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">scrcpy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>会进到安卓界面，先打开shizuku，会提示要启用，我们回退到adb窗口，执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">./adb shell sh /storage/emulated/0/Android/data/moe.shizuku.privileged.api/start.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后shizuku提示&lt;code>shizuku is running&lt;/code>。然后把&lt;code>Authorized 0 applications&lt;/code>点开，勾选LSPatch，再打开LSPatch，到Manager&amp;ndash;Apps点击加号，选择New Patch-Select apk(s) from storage 找到QQ安装包，点击start patch
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d331552e6.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d331552e6.png" alt="shizuku" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d331552e6.png"
loading="lazy"
alt="shizuku"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d3ce0b407.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d3ce0b407.png" alt="lsp-patch" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d3ce0b407.png"
loading="lazy"
alt="lsp-patch"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d3edd100b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d3edd100b.png" alt="start patch" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d3edd100b.png"
loading="lazy"
alt="start patch"
>
等待打补丁完成，然后点击Install。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d43075df2.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d43075df2.png" alt="patch done" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/24/65b0d43075df2.png"
loading="lazy"
alt="patch done"
>
安装完成后点击LSPatch里的QQ，找到module scope，把Shamrock打勾，即允许Shamrock对QQ生效。
然后启动QQ，QQ就闪退了&amp;hellip;
因为LSPatch目前已停止更新，后续是否会支持新版QQ尚未能明确，此文暂停更新。&lt;/p>
&lt;hr>
&lt;h3 id="参考文章">参考文章
&lt;/h3>&lt;p>&lt;a class="link" href="https://dwcarrot.github.io/blog/2023/12/29/Notes-QQ-Bot-Framework" target="_blank" rel="noopener"
>QQ-bot 框架部署记录&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/518415793" target="_blank" rel="noopener"
>一次云服务器内核升级之旅 - 知乎 (zhihu.com)&lt;/a>&lt;/p></description></item><item><title>使用S3 Browser管理Cloudflare R2存储桶</title><link>https://blog.tama.guru/record/s3browser_r2_manager.html</link><pubDate>Sat, 13 Jan 2024 22:53:02 +0800</pubDate><guid>https://blog.tama.guru/record/s3browser_r2_manager.html</guid><description>&lt;p>本来我是要把导航页所有的文件搬到Github上并&lt;strong>试图&lt;/strong>通过jsdelivr加速访问，但是我发现国内移动网络根本无法直连jsdelivr&amp;hellip;在多次反馈网页无法打开之后，最后还是退一步选择迁移到R2上了。但是R2的网页端管理真的是做得一团糟，上传经常半路失败不说，一次还只能上传100个文件，更恶心的是文件夹无法删除，对于我来说是体验真的不好了。&lt;/p>
&lt;p>既然兼容AWS S3，那就用S3的方法去管理他。
需要用到&lt;a class="link" href="https://s3browser.com/download.aspx" target="_blank" rel="noopener"
>S3Browser&lt;/a>这个软件，只有英文，但是不妨碍使用。
安装完成之后选择&lt;code>Add new account&lt;/code>。
&lt;code>Display Name&lt;/code>任意填写即可，&lt;code>Account type&lt;/code>选择&lt;code>S3 Compatible Storage&lt;/code>，即兼容S3存储。&lt;code>REST Endpotin&lt;/code>对应的是&lt;code>S3 API&lt;/code>的值，但是不能整个填写进去。比如网页端显示的&lt;code>S3 API&lt;/code>为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://xxxxxxxxxxxxxxxxxxx.r2.cloudflarestorage.com/tamabox
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>那这里要填写的是&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">xxxxxxxxxxxxxxxxxxx.r2.cloudflarestorage.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>AK&lt;/code>和&lt;code>SK&lt;/code>是创建桶的时候提供的，如果忘记了就没救了，重新弄个桶吧。
&lt;code>Encrypt Access Keys with a password&lt;/code>和&lt;code>Use secure transfer(SSL/TSL)&lt;/code>选项保留默认即可。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/13/65a2a0bdc8b8c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/13/65a2a0bdc8b8c.png" alt="add account info 1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/13/65a2a0bdc8b8c.png"
loading="lazy"
alt="add account info 1"
>
配置完之后要点开左下角的&lt;code>advanced settings&lt;/code>。
&lt;code>Signature version&lt;/code>选择&lt;code>Signature V4&lt;/code>.
&lt;code>Addressing model&lt;/code>选择&lt;code>Virtual hosted style&lt;/code>.
其他选项保留初始值不用动，点close再save changes&lt;code>即可。 ![add account info 2][3] 这时候应该是能连接进R2内部了，就当作一个文件管理器操作就行了。 ![setting complete][4] &amp;lt;br/&amp;gt; 如果只用来做图床的话可以用&lt;/code>Pic-Go`这个软件，操作方法也类似。&lt;/p></description></item><item><title>在兰空图床配置并使用Cloudflare R2 存储桶</title><link>https://blog.tama.guru/record/r2_on_lskypro.html</link><pubDate>Mon, 08 Jan 2024 16:00:00 +0800</pubDate><guid>https://blog.tama.guru/record/r2_on_lskypro.html</guid><description>&lt;h3 id="什么是r2为什么用r2">什么是R2，为什么用R2
&lt;/h3>&lt;p>R2是由Cloudflare推出的对象存储，接口兼容AWS S3且有免费套餐，套餐内容如下：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">类别&lt;/th>
&lt;th style="text-align: center">永远免费&lt;/th>
&lt;th style="text-align: center">按月收费&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">存储&lt;/td>
&lt;td style="text-align: center">10GB/月&lt;/td>
&lt;td style="text-align: center">0.015 美元/GB 存储&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">A类操作:状态改变&lt;/td>
&lt;td style="text-align: center">100 万次/月&lt;/td>
&lt;td style="text-align: center">4.50 美元/百万次&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">B类操作:读取状态&lt;/td>
&lt;td style="text-align: center">1000 万次/月&lt;/td>
&lt;td style="text-align: center">0.36 美元/百万次&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>根据文档，各类操作包括：&lt;/p>
&lt;center>A类操作&lt;/center>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">操作名称&lt;/th>
&lt;th style="text-align: center">操作含义&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">ListBuckets&lt;/td>
&lt;td style="text-align: center">列出的存储桶及其所有者&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PutBucket&lt;/td>
&lt;td style="text-align: center">创建存储桶&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">ListObjects&lt;/td>
&lt;td style="text-align: center">返回存储桶中的对象&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PutObject&lt;/td>
&lt;td style="text-align: center">创建对象&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">CopyObject&lt;/td>
&lt;td style="text-align: center">复制对象&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">CompleteMultipartUpload&lt;/td>
&lt;td style="text-align: center">完成分片上传&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">CreateMultipartUpload&lt;/td>
&lt;td style="text-align: center">创建分片上传任务&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">ListMultipartUploads&lt;/td>
&lt;td style="text-align: center">列出分片上传（进度）&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">UploadPart&lt;/td>
&lt;td style="text-align: center">分片上传&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">UploadPartCopy&lt;/td>
&lt;td style="text-align: center">从一个已存在的Object中拷贝数据来上传一个分片&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">ListParts&lt;/td>
&lt;td style="text-align: center">列出分片&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PutBucketEncryption&lt;/td>
&lt;td style="text-align: center">存储桶加密&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PutBucketCors&lt;/td>
&lt;td style="text-align: center">为指定的存储桶设置跨域资源共享CORS规则&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">PutBucketLifecycleConfiguration&lt;/td>
&lt;td style="text-align: center">设置对象生命周期规则&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;center>B类操作&lt;/center>
| 操作名称 | 操作含义 |
|:-------------------------------:|:--------------------------------------------:|
| HeadBucket | 确定是否存在存储桶以及是否有访问权限 |
| HeadObject | 确定是否存在对象以及是否有访问权限 |
| GetObject | 获取（下载）对象 |
| UsageSummary | 使用情况摘要 |
| GetBucketEncryption | 获取（下载）加密存储桶 |
| GetBucketLocation | 获取（下载）加存储桶位置 |
| GetBucketCors | 获取存储桶设置跨域资源共享CORS规则 |
| GetBucketLifecycleConfiguration | 获取对象生命周期规则 |
&lt;center>免费操作&lt;/center>
| 操作名称 | 操作含义 |
|:-------------------------------:|:--------------------------------------------:|
| DeleteObject | 删除对象 |
| DeleteBucket | 删除桶 |
| DeleteMultipartUpload | 中止分片上传 |
也就是说R2只对存储和状态修改产生费用，下载不计费，对于小网站来说足够了。
注意:看一下这篇文章[https://machbbs.com/hostloc/640526][1]，避免被坑美刀。
&lt;h3 id="有什么不足">有什么不足
&lt;/h3>&lt;p>Cloudflare祝您新的一年红红火火。&lt;/p>
&lt;h3 id="如何接入">如何接入
&lt;/h3>&lt;h4 id="cloudflare网页端配置">Cloudflare网页端配置
&lt;/h4>&lt;p>配置之前需要把一个域名接入Cloudflare并设置好解析。比如我的域名&lt;code>i-tama.website&lt;/code>分配一个二级域名&lt;code>r2.i-tama.website&lt;/code>用于自定义访问域名，解析内容任意即可，因为后面接入的时候会自动修改成CNAME接入。&lt;/p>
&lt;p>首先进入Cloudflare仪表盘的R2，点击创建存储桶：&lt;/p>
&lt;p>&lt;code>存储桶名称&lt;/code>：填写3-63个不含特殊字符，比如我使用的&lt;code>tamabox&lt;/code>。&lt;/p>
&lt;p>位置：选择自动，提供位置提示默认是无的情况下会根据位置自动选择，如果是针对中国的网站那最好是修改为亚太地区(APAC)。（注：记住这个APAC，后面会用到）&lt;/p>
&lt;p>然后点击创建，创建完成之后进入设置，设置界面有几个需要注意的地方：&lt;/p>
&lt;p>名称和S3 API：这两个后面连接需要用得到，可以保存下来。&lt;/p>
&lt;p>自定义域：这里就是配置自定义域名的位置，点击&lt;code>连接域&lt;/code>，填写需要自定义访问的域名（不加https），例如&lt;code>r2.i-tama.website&lt;/code>，并继续，然后会提示现有DNS记录将变更成CNAME解析，点击连接域之后等待初始化完成，约1-2分钟即可。成功后该域的状态应为&lt;code>有效&lt;/code>，且访问存储桶为&lt;code>已允许&lt;/code>。&lt;/p>
&lt;p>R2.dev子域：这里配置允许会生成一个&lt;code>r2.dev&lt;/code>结尾的二级域名用于公共访问，使用这个方式访问可能会有速度限制，但我没尝试过。配置也很简单，点击允许之后输入&lt;code>allow&lt;/code>即可。&lt;/p>
&lt;p>CORS策略：实际使用时可能会碰到跨域错误在这里配置即可，此处不做修改。&lt;/p>
&lt;p>以上配置完成后回退到R2仪表盘，进入账户详细信息下的管理R2 API令牌并选择创建API令牌：&lt;/p>
&lt;p>令牌名称：任意填写 记得就行。&lt;/p>
&lt;p>权限：因为我们是用来做图床的，涉及到文件读写，建议直接配置成管理员读和写。&lt;/p>
&lt;p>指定存储桶：建议一个桶一个API，所以我选择仅应用于特定存储桶，并选择刚才创建的桶。&lt;/p>
&lt;p>TTL:永久。&lt;/p>
&lt;p>客户端IP地址筛选：留空即可。&lt;/p>
&lt;p>最后创建API令牌，此时会得到令牌值、访问秘钥ID和机密访问密钥三个值，需要妥善保存好，因为确认之后就不会再出现这些数据了。&lt;/p>
&lt;p>至此，Cloudflare网页端配置完成。&lt;/p>
&lt;h4 id="图床端配置">图床端配置
&lt;/h4>&lt;p>登录管理员账号进入系统设置 &amp;gt; 存储策略，选择新建一个存储策略。&lt;/p>
&lt;p>角色组根据自己的选择去配置即可。&lt;/p>
&lt;p>名称和简介自行设置好即可。&lt;/p>
&lt;p>存储策略选择AWS S3。&lt;/p>
&lt;p>访问域名填写在Cloudflare设置的自定义域，比如我的是&lt;code>https://r2.i-tama.website/tamabox&lt;/code>。&lt;/p>
&lt;p>&lt;strong>注意，这里的格式是自定义域名+桶名称，如果只填写域名，后面上传的时候会发现我们上传的图片a.png会被上传到&lt;code>https://r2.i-tama.website/tamabox/%year%/%month%/%day%/a.png&lt;/code>，但图床中显示的链接是&lt;code>https://r2.i-tama.website/%year%/%month%/%day%/a.png&lt;/code>，结果就是404了。&lt;/strong>&lt;/p>
&lt;p>AccessKeyId和SecretAccessKey即前面提到的访问秘钥ID以及机密访问秘钥。&lt;/p>
&lt;p>连接地址填写S3 API。&lt;/p>
&lt;p>区域就是前面我们配置位置信息的简码，如果我们选择亚太这里就是填apac。&lt;/p>
&lt;p>储存桶名称即桶名称。&lt;/p>
&lt;p>是否使用路径样式&lt;strong>不要勾选&lt;/strong>，因为勾选之后上传到R2会再多一层路径。比如原来上传的位置是&lt;code>https://r2.i-tama.website/tamabox/%year%/%month%/%day%/a.png&lt;/code>，勾选之后就变成&lt;code>https://r2.i-tama.website/tamabox/tamabox/%year%/%month%/%day%/a.png&lt;/code>了。&lt;/p>
&lt;p>是否在文件上设置公开ACL，这里打开，保存之后随意上传个文件测试是否能上传成功，一般按这个步骤是不会有问题的。&lt;/p>
&lt;h3 id="体验如何">体验如何
&lt;/h3>&lt;p>我没开代理的情况下上传大概是200-300kb/s，下载差不多也是这个速度，只能说基本够用。&lt;/p></description></item><item><title>P106能在server系统上运行吗</title><link>https://blog.tama.guru/record/p106-on-winserver.html</link><pubDate>Mon, 01 Jan 2024 21:10:00 +0800</pubDate><guid>https://blog.tama.guru/record/p106-on-winserver.html</guid><description>&lt;p>结论是：能。&lt;/p>
&lt;p>花了一百块买了张P106-100，七彩虹的，几个螺丝都锈得不成样子了，看得出来是锻炼了很长时间&amp;hellip;背板也是全锈的&amp;hellip;
![背板][1]
因为我用的10400不带f，且一直正常运行，我就没去bios调什么默认集显输出了，直接插pcie上电。
上电之后等了差不多2分钟才听到磁盘寻道声，在此期间主板的debug灯一直在闪，然后就正常启动了。
进系统之后显示适配器会提示感叹号，直接到[此处][2]下载魔改驱动包和注册表文件。
![注册表和驱动包][3]
先把&lt;code>cyxRootCA.reg&lt;/code>导进系统，然后就直接运行&lt;code>win11_NVIDIA_546.33_Setup.exe&lt;/code>（实际不一定是这个版本号，看作者更新，而且Win10可以使用前缀为Win11的魔改包）。需要注意的是我在实际安装中并没有进安全模式，也没有把签名验证关掉，就一波平推过去，结果是安装正常，也能正常显示。
![安装正常][4]
关于魔改安全性：服务器上开的SEP，主机用的卡巴，并没有报毒。
关于跑分：我装的鲁大师单文件版，能识别卡，但是跑分只在10万分左右，比起网上能跑20万的整整少了一半&amp;hellip;而且在跑的过程中全程不超过30fps，不知道是不是配置问题。
关于Furmark：会提示OpenGL版本过低。按网上的说法需要重装集显驱动，我装了，没用。
关于3DMark：根本没跑。
有空再试试跑画图软件吧。
20240126更新：换了LTSC之后再跑分已经能够接近20W了&amp;hellip;系统的问题看起来真的很严重。
![20W][5]&lt;/p>
&lt;!--more-->
&lt;p>如果换上或者拔掉显卡之后无法启动，可以试着把电源拔掉并把BIOS电池抠出来一段时间再开机试试。
[1]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2024/01/01/65929b6d4c39b.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2024/01/01/65929b6d4c39b.png&lt;/a>
[2]: &lt;a class="link" href="https://www.aliyundrive.com/s/LXKQfxTX4Ra" target="_blank" rel="noopener"
>https://www.aliyundrive.com/s/LXKQfxTX4Ra&lt;/a>
[3]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2024/01/01/65929c7ce51cd.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2024/01/01/65929c7ce51cd.png&lt;/a>
[4]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2024/01/01/65929d96717d2.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2024/01/01/65929d96717d2.png&lt;/a>
[5]: http://&lt;/p></description></item><item><title>丂渐云性能测试</title><link>https://blog.tama.guru/record/idc-rbt.html</link><pubDate>Mon, 01 Jan 2024 13:28:44 +0800</pubDate><guid>https://blog.tama.guru/record/idc-rbt.html</guid><description>&lt;p>站内UP弄的丂渐云，今天看到有台CN2，8C8G一年才370不到，马上下单试了下.&lt;/p>
&lt;p>测试脚本：
测试结果：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CPU&lt;/span> &lt;span class="n">Model&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">Intel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">R&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">Xeon&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">R&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">Gold&lt;/span> &lt;span class="mi">6133&lt;/span> &lt;span class="n">CPU&lt;/span> &lt;span class="err">@&lt;/span> &lt;span class="mf">2.50&lt;/span>&lt;span class="n">GHz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CPU&lt;/span> &lt;span class="n">Cores&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="n">Cores&lt;/span> &lt;span class="mf">2494.138&lt;/span> &lt;span class="n">MHz&lt;/span> &lt;span class="n">x86_64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CPU&lt;/span> &lt;span class="n">Cache&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">28160&lt;/span> &lt;span class="n">KB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ne">OS&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">Debian&lt;/span> &lt;span class="n">GNU&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Linux&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">64&lt;/span> &lt;span class="n">Bit&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">KVM&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Kernel&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mf">6.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Total&lt;/span> &lt;span class="n">Space&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mf">3.8&lt;/span> &lt;span class="n">GB&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="mf">100.0&lt;/span> &lt;span class="n">GB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Total&lt;/span> &lt;span class="n">RAM&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">343&lt;/span> &lt;span class="n">MB&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="mi">7940&lt;/span> &lt;span class="n">MB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">276&lt;/span> &lt;span class="n">MB&lt;/span> &lt;span class="n">Buff&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Total&lt;/span> &lt;span class="n">SWAP&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">MB&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">MB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Uptime&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">days&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">hour&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="nb">min&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Load&lt;/span> &lt;span class="n">Average&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mf">0.07&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.02&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">0.00&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">TCP&lt;/span> &lt;span class="n">CC&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">cubic&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ASN&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="n">ISP&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">AS400619&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Cogent&lt;/span> &lt;span class="n">Communications&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Organization&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">PEG&lt;/span> &lt;span class="n">Tech&lt;/span> &lt;span class="n">Inc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Location&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">San&lt;/span> &lt;span class="n">Jose&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">United&lt;/span> &lt;span class="n">States&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">US&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Region&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">California&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">I&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">Speed&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="mf">1.0&lt;/span>&lt;span class="n">GB&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">380&lt;/span> &lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">I&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">Speed&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="mf">1.0&lt;/span>&lt;span class="n">GB&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">344&lt;/span> &lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">I&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">Speed&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="mf">1.0&lt;/span>&lt;span class="n">GB&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mi">287&lt;/span> &lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Average&lt;/span> &lt;span class="n">I&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">Speed&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="mf">337.0&lt;/span> &lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ne">Node&lt;/span> &lt;span class="n">Name&lt;/span> &lt;span class="n">Upload&lt;/span> &lt;span class="n">Speed&lt;/span> &lt;span class="n">Download&lt;/span> &lt;span class="n">Speed&lt;/span> &lt;span class="n">Latency&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Speedtest&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">net&lt;/span> &lt;span class="mf">45.93&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">47.79&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">1.07&lt;/span> &lt;span class="n">ms&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Fast&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span> &lt;span class="mf">0.00&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">48.5&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="o">-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Nanjing&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="n">G&lt;/span> &lt;span class="n">CT&lt;/span> &lt;span class="mf">30.87&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">47.36&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">146.24&lt;/span> &lt;span class="n">ms&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Hefei&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="n">G&lt;/span> &lt;span class="n">CT&lt;/span> &lt;span class="mf">36.89&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">47.84&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">142.05&lt;/span> &lt;span class="n">ms&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Shanghai&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="n">G&lt;/span> &lt;span class="n">CU&lt;/span> &lt;span class="mf">47.77&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">48.47&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mf">170.50&lt;/span> &lt;span class="n">ms&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>给SSH添加邮件登录提醒</title><link>https://blog.tama.guru/record/ssh_login_mail.html</link><pubDate>Tue, 26 Dec 2023 22:09:04 +0800</pubDate><guid>https://blog.tama.guru/record/ssh_login_mail.html</guid><description>&lt;p>影响SSH登录安全性的因素不外乎：禁用密码登录、密钥强度、修改默认端口、仅指定IP登录，但是如果每次登录的时候能够及时的发一封邮件提醒，可以更好的管控服务器登录状态，也能更安心些。&lt;/p>
&lt;p>需要用到&lt;code>msmtp&lt;/code>和&lt;code>mutt&lt;/code>两个软件。&lt;/p>
&lt;h4 id="安装所需软件">安装所需软件：
&lt;/h4>&lt;p>对于Centos：
&lt;code>yum install msmtp mutt&lt;/code>
对于debian系：
&lt;code>apt install msmtp mutt&lt;/code>
对于arch系用户：
&lt;code>pacman -S msmtp mutt&lt;/code>&lt;/p>
&lt;h4 id="配置msmtp">配置msmtp
&lt;/h4>&lt;p>其实msmtp就是一个支持服务器配置文件的轻型SMTP客户端，配合mutt可以达到邮件发送的效果。
对于debian系统，可以在
&lt;code>/usr/share/doc/msmtp/examples/&lt;/code>
下找到默认配置文件。其中&lt;code>msmtprc-system.example&lt;/code>代表全局配置，&lt;code>msmtprc-user.example&lt;/code>代表用户配置。如果需要所有用户都使用这个配置，则可以执行
&lt;code>cat /usr/share/doc/msmtp/examples/ &amp;gt; /etc/msmtprc&lt;/code>
然后修改&lt;code>/etc/msmtprc&lt;/code>文件：
&lt;em>注意，实际使用时不要吧中文注释也复制进去&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># Example for a system wide configuration file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># A system wide configuration file is optional.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># If it exists, it usually defines a default account.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># This allows msmtp to be used like /usr/sbin/sendmail.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">account default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># The SMTP smarthost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host smtp.qq.com #SMTP域名，例如QQ邮箱为smtp.qq.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Use TLS on port 465
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">port 465 #465为默认smtp tls端口，如果选择不加密一般改成25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tls on #是否开启TLS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tls_starttls off # STARTTLS是对纯文本通讯协议的扩展。它提供一种方式将纯文本链接升级为加密链接（TLS或SSL），而不是另外使用一个端口做加密通讯。我在使用过程中发现开启时大概率发送失败，可能和qq的smtp服务器有关，因此保持默认关闭即可。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Construct envelope-from addresses of the form &amp;#34;user@oursite.example&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from xxx@qq.com #发送邮件的地址，以qq邮箱为例
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auth on #启用验证
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">user xxx@qq.com #用户名，以qq邮箱为例
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password xxxxxxxx #这里填授权码或密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Syslog logging with facility LOG_MAIL instead of the default LOG_USER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog LOG_MAIL
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存文件后可以执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo &amp;#34;this is a test&amp;#34;|msmtp -v 收件邮箱@qq.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后会看到服务器执行邮件发送的操作：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 220 smtp.qq.com MX Tencent Server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; EHLO localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250-smtp.qq.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250-8BITMIME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250-AUTH=PLAIN LOGIN XALIOAUTH
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250-AUTH PLAIN LOGIN XALIOAUTH
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250-PIPELINING
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250 DSN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; AUTH PLAIN *******************************
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 235 Authentication successful
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; MAIL FROM:&amp;lt;xxx@qq.com&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; RCPT TO:&amp;lt;收件邮箱@qq.com&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; DATA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250 Mail Ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250 Rcpt Ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 354 End data with &amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;.&amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; From: xxx@qq.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; Date: Tue, 26 Dec 2023 21:10:21 +0800
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; test infomation
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 250 Data Ok: queued as freedom
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--&amp;gt; QUIT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;-- 221 Bye
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>得到类似以上的信息，可以判定配置配置无误了。如果收件箱并没有看到邮件，需要到寄件邮箱查询是否被当成垃圾邮件拒收了。当然这并不影响后续使用，因为这本身就是一封只有英文标题无任何内容的邮件，很容易被ban掉。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/12/26/658adb8d00c1a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/12/26/658adb8d00c1a.png" alt="被拦截了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/12/26/658adb8d00c1a.png"
loading="lazy"
alt="被拦截了"
>&lt;/p>
&lt;p>最后，我们还需要修改&lt;code>/etc/Muttrc&lt;/code>，在最后面加上：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">set sendmail=&amp;#34;/usr/bin/msmtp&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set use_from=yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set realname=&amp;#34;你想要显示的发送名称&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set from=xxx@qq.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="生成配置文件">生成配置文件
&lt;/h4>&lt;p>在&lt;code>/etc/ssh&lt;/code>下生成并编辑&lt;code>ssh_alarm.sh&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nano /etc/ssh/ssh_alarm.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>文件内容如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -z &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">SSH_CONNECTION&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;$SSH_CONNECTION:not exists&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#定义变量&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">from_ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">SSH_CONNECTION&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print$1}&amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">from_port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">SSH_CONNECTION&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print$2}&amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">server_ip&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">SSH_CONNECTION&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print$3}&amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">user&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">LOGNAME&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">hostname_1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">HOSTNAME&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="s2">&amp;#34;(&amp;#34;&lt;/span> &lt;span class="nv">$server_ip&lt;/span> &lt;span class="s2">&amp;#34;)&amp;#34;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">server_time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="k">$(&lt;/span>date +&lt;span class="s2">&amp;#34;%Y-%m-%d %R&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">e_mail&lt;/span>&lt;span class="o">=&lt;/span>收件地址@qq.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#IP白名单，192.168.1.1这个IP登录时不提示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ip_exit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">from_ip&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="p">|&lt;/span>cut -d &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> -f 1,2,3&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">ip_exit&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;192.168.1.1&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#用户登录白名单，username这个用户登录时不提示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">user&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;username&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#Send mail&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> -e &lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">**********SSH登录警告**********\n
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 登录主机:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">hostname_1&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\n
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 登录用户:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">user&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\n
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 登录时间:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">server_time&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\n
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 登录IP:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">from_ip&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\n
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 登录IP端口:&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">from_port&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\n
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 请注意核查是否可信登录，如非可信，请立即更换密匙和密码。
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">******************************&amp;#34;&lt;/span>&lt;span class="p">|&lt;/span>mutt -s &lt;span class="s2">&amp;#34;服务器SSH登录警告&amp;#34;&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">e_mail&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存后执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bash /etc/ssh/ssh_alarm.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>执行完毕不会有任何回显，但是收件端&lt;code>收件地址@qq.com&lt;/code>应该会收到邮件：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/12/26/658addbc2a019.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/12/26/658addbc2a019.png" alt="成功收到邮件" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/12/26/658addbc2a019.png"
loading="lazy"
alt="成功收到邮件"
>
最后需要配置一个sshrc文件，这个文件的作用是当连接ssh时自动执行文件内的脚本：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nano /etc/ssh/sshrc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>文件内容如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bash /etc/ssh/ssh_alarm.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存之后再次登录ssh服务器，就会自动执行&lt;code>ssh_alarm.sh&lt;/code>脚本发送邮件了。&lt;/p></description></item><item><title>Archlinux下安装并配置lnmp环境</title><link>https://blog.tama.guru/record/archlinux_lnmp.html</link><pubDate>Thu, 30 Nov 2023 11:07:00 +0800</pubDate><guid>https://blog.tama.guru/record/archlinux_lnmp.html</guid><description>&lt;p>最近把编译用的主机换个发行版，最开始用的是debian，结果现在桌面环境进不去了（而且是一引导完成就所有输入、输入都没反应，但是ssh能登陆，很奇怪），懒得去查原因就选择换个环境。本来用的almalinux，无奈真的不喜欢gnome，自己装了kde之后ibus无论怎样都打不出中文，最后还是上了arch。
无论是宝塔还是lnmp.org都没有对arch系进行适配，网上也有很多一步步排错安装的教程，但是看着一步步的报错再去核查原因着实难受，最后还是选择自己装最基础的nginx+php+mysql。&lt;/p>
&lt;h4 id="安装nginx">安装nginx
&lt;/h4>&lt;p>archlinux软件包里面有nginx和nginx-mainline（当前最新是1.25.3)两个版本，nginx版本较老且两个版本之间有冲突，故安装nginx-mainline。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S nginx-mainline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装完成后执行&lt;code>systemctl status nginx&lt;/code>可能会提示&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">11月 30 10:04:16 bot nginx[17674]: 2023/11/30 10:04:16 [warn] 17674#17674: could not build optimal types_hash, you should increase either types_hash_max_size: 1024 or types_hash_bucket_size: 64; ignoring types_hash_bucket_size
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>需要修改&lt;code>/etc/nginx/nginx.conf&lt;/code>，并在http块下添加&lt;code>types_hash_max_size 4096;&lt;/code>，例如：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> types_hash_max_size 4096;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #gzip on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后重启nginx：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl retstart nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>就不会报错了，访问也没问题。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f220cd216.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f220cd216.png" alt="Nginx页面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f220cd216.png"
loading="lazy"
alt="Nginx页面"
>&lt;/p>
&lt;h4 id="安装php">安装php
&lt;/h4>&lt;p>执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S php-fpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装最新的php模块，当前最新版本是8.2.13-1。安装php-fpm会自动把php一并安装好。
然后把php-fpm和nginx对接，修改&lt;code>/etc/nginx/nginx.conf&lt;/code>：
把：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> #location ~ \.php$ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # root html;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # fastcgi_pass 127.0.0.1:9000;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # fastcgi_index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # include fastcgi_params;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> location ~ \.php$ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> root /usr/share/nginx/html;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include fastcgi_params;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后测试配置文件是否正常：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nginx -t
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>并将相应服务启动/重启：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">fpm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">start&lt;/span> &lt;span class="n">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">fpm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">restart&lt;/span> &lt;span class="n">nginx&lt;/span> &lt;span class="c1">#或nginx -s reload&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后到网站root目录&lt;code>/usr/share/nginx/html&lt;/code>下放一个探针:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /usr/share/nginx/html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://raw.githubusercontent.com/582033/monitor/master/monitor.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后访问ip/monitor.php：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f6f37060a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f6f37060a.png" alt="php访问测试" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f6f37060a.png"
loading="lazy"
alt="php访问测试"
>
如果显示得出来说明nginx和php-fpm已经对接上了。&lt;/p>
&lt;h4 id="安装mysql">安装mysql
&lt;/h4>&lt;p>先启动php下mysql的相关拓展：
修改&lt;code>/etc/php/php.ini &lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">;extension=mysqli
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=odbc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;zend_extension=opcache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=pdo_dblib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=pdo_mysql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">extension=mysqli
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=odbc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;zend_extension=opcache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=pdo_dblib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">extension=pdo_mysql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装mariadb：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S mariadb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>初始化mysqldb的数据目录：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mysql_install_db&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">mysql&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">basedir&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">usr&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">datadir&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mysql&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启动mysql服务：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl enable mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start mysqld
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>运行安全脚本配置：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mysql_secure_installation
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>各项内容根据实际修改：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mysql_secure_installation&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Deprecated&lt;/span> &lt;span class="n">program&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">It&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">removed&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">future&lt;/span> &lt;span class="n">release&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">use&lt;/span> &lt;span class="s1">&amp;#39;mariadb-secure-installation&amp;#39;&lt;/span> &lt;span class="n">instead&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">RUNNING&lt;/span> &lt;span class="n">ALL&lt;/span> &lt;span class="n">PARTS&lt;/span> &lt;span class="n">OF&lt;/span> &lt;span class="n">THIS&lt;/span> &lt;span class="n">SCRIPT&lt;/span> &lt;span class="n">IS&lt;/span> &lt;span class="n">RECOMMENDED&lt;/span> &lt;span class="n">FOR&lt;/span> &lt;span class="n">ALL&lt;/span> &lt;span class="n">MariaDB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVERS&lt;/span> &lt;span class="n">IN&lt;/span> &lt;span class="n">PRODUCTION&lt;/span> &lt;span class="n">USE&lt;/span>&lt;span class="o">!&lt;/span> &lt;span class="n">PLEASE&lt;/span> &lt;span class="n">READ&lt;/span> &lt;span class="n">EACH&lt;/span> &lt;span class="n">STEP&lt;/span> &lt;span class="n">CAREFULLY&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="n">order&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="nb">log&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">secure&lt;/span> &lt;span class="n">it&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">we&lt;/span>&lt;span class="s1">&amp;#39;ll need the current&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span>&lt;span class="s1">&amp;#39;ve just installed MariaDB, and&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">haven&lt;/span>&lt;span class="s1">&amp;#39;t set the root password yet, you should just press enter here.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Enter&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">enter&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">none&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1">#输入mysql root密码 默认是空，直接回车&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">OK&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">successfully&lt;/span> &lt;span class="n">used&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">on&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Setting&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">unix_socket&lt;/span> &lt;span class="n">ensures&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">nobody&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">can&lt;/span> &lt;span class="nb">log&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="n">without&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">proper&lt;/span> &lt;span class="n">authorisation&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">You&lt;/span> &lt;span class="n">already&lt;/span> &lt;span class="n">have&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">account&lt;/span> &lt;span class="n">protected&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="n">safely&lt;/span> &lt;span class="n">answer&lt;/span> &lt;span class="s1">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Switch&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">unix_socket&lt;/span> &lt;span class="n">authentication&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否切人到unix_socket认证，默认是，直接回车。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Enabled&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reloading&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span>&lt;span class="o">..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">You&lt;/span> &lt;span class="n">already&lt;/span> &lt;span class="n">have&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">account&lt;/span> &lt;span class="n">protected&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="n">safely&lt;/span> &lt;span class="n">answer&lt;/span> &lt;span class="s1">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Change&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否修改root密码，默认是，直接回车。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">New&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1">#输入新的root密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Re&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">enter&lt;/span> &lt;span class="n">new&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1">#再次输入新的root密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Password&lt;/span> &lt;span class="n">updated&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reloading&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span>&lt;span class="o">..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">By&lt;/span> &lt;span class="n">default&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">installation&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">anonymous&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">allowing&lt;/span> &lt;span class="n">anyone&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">to&lt;/span> &lt;span class="nb">log&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">without&lt;/span> &lt;span class="n">having&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">have&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="n">account&lt;/span> &lt;span class="n">created&lt;/span> &lt;span class="k">for&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">them&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">This&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">intended&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">testing&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">make&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">installation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">go&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">bit&lt;/span> &lt;span class="n">smoother&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">You&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">remove&lt;/span> &lt;span class="n">them&lt;/span> &lt;span class="n">before&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">production&lt;/span> &lt;span class="n">environment&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Remove&lt;/span> &lt;span class="n">anonymous&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否删除匿名用户，默认是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Normally&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">allowed&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">connect&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;localhost&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">This&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ensures&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">someone&lt;/span> &lt;span class="n">cannot&lt;/span> &lt;span class="n">guess&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">network&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Disallow&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">login&lt;/span> &lt;span class="n">remotely&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="c1">#是否禁用远程登陆，我有需求，这里填否&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">skipping&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">By&lt;/span> &lt;span class="n">default&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">comes&lt;/span> &lt;span class="n">with&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">database&lt;/span> &lt;span class="n">named&lt;/span> &lt;span class="s1">&amp;#39;test&amp;#39;&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">anyone&lt;/span> &lt;span class="n">can&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">access&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">This&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">also&lt;/span> &lt;span class="n">intended&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">testing&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">removed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">before&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">production&lt;/span> &lt;span class="n">environment&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Remove&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">database&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">access&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">it&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否移除测试数据库，默认是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">Dropping&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">Removing&lt;/span> &lt;span class="n">privileges&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reloading&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">ensure&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">all&lt;/span> &lt;span class="n">changes&lt;/span> &lt;span class="n">made&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">far&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">will&lt;/span> &lt;span class="n">take&lt;/span> &lt;span class="n">effect&lt;/span> &lt;span class="n">immediately&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reload&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span> &lt;span class="n">now&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否刷新权限，默认是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cleaning&lt;/span> &lt;span class="n">up&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">All&lt;/span> &lt;span class="n">done&lt;/span>&lt;span class="o">!&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span>&lt;span class="s1">&amp;#39;ve completed all of the above steps, your MariaDB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">installation&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">now&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">secure&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Thanks&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">MariaDB&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>输入新的root密码测试登陆mysql：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># mysql -u root -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql: Deprecated program name. It will be removed in a future release, use &amp;#39;/usr/bin/mariadb&amp;#39; instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to the MariaDB monitor. Commands end with ; or \g.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Your MariaDB connection id is 12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Server version: 11.2.2-MariaDB Arch Linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type &amp;#39;help;&amp;#39; or &amp;#39;\h&amp;#39; for help. Type &amp;#39;\c&amp;#39; to clear the current input statement.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MariaDB [(none)]&amp;gt; quit;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Bye
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>确认一切正常，最后重启所有相关服务：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl restart mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>至此所有步骤均完成。&lt;/p>
&lt;h4 id="优化配置可选">优化配置（可选）
&lt;/h4>&lt;p>1、对于&lt;code>/etc/nginx/nginx.conf&lt;/code>:
在http块下新增：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">client_max_body_size 10m;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>2、对于&lt;code>/etc/php/php.ini&lt;/code>：
修改&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">upload_max_filesize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">M&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">upload_max_filesize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="n">M&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>3、安装phpmyadmin：
去phpmyadmin官网下载最新版安装包，目前是5.2.1：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /usr/share/nginx/hmtl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://files.phpmyadmin.net/phpMyAdmin/5.2.1/phpMyAdmin-5.2.1-all-languages.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip phpMyAdmin-5.2.1-all-languages.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv phpMyAdmin-5.2.1-all-languages phpmyadmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd phpmyadmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp config.sample.inc.php config.inc.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后修改配置文件&lt;code>config.inc.php&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$cfg[&amp;#39;blowfish_secret&amp;#39;] = &amp;#39;任意字符串&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$cfg[&amp;#39;Servers&amp;#39;][$i][&amp;#39;host&amp;#39;] = &amp;#39;127.0.0.1&amp;#39;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改nginx的配置&lt;code>/usr/nginx/nginx.conf&lt;/code>，添加以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> location /phpmyadmin {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> alias /usr/share/nginx/html/phpmyadmin;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location ~ /phpmyadmin/.+\.php$ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if ($fastcgi_script_name ~ /phpmyadmin/(.+\.php.*)$) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> set $valid_fastcgi_script_name $1;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include fastcgi_params;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_param SCRIPT_FILENAME /usr/share/nginx/html/phpmyadmin/$valid_fastcgi_script_name;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后重启nginx和php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl restart nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可能会提示”缺少 mysqli 扩展“，请检查拓展的位置是否配置正确了。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># find / -name mysqli*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/php/modules/mysqli.so
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以看到拓展实际上位于&lt;code>/usr/lib/php/modules/&lt;/code>这个位置下，那就把&lt;code>/etc/php/php.ini&lt;/code>中的&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">extension=mysqli
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">extension=/usr/lib/php/modules/mysqli.so
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>重启php-fpm服务即可正常运行。&lt;/p></description></item><item><title>使用ruleproject搭建自己的typecho程序客户端</title><link>https://blog.tama.guru/record/ruleproject.html</link><pubDate>Fri, 17 Nov 2023 23:12:00 +0800</pubDate><guid>https://blog.tama.guru/record/ruleproject.html</guid><description>&lt;p>卧槽牛皮，这东西牛啊！通过这个教程已经成功弄出了安卓端apk并正常使用！
本站安卓客户端：&lt;a class="link" href="https://share.tama.guru/d/App/Android/latest_release.apk" target="_blank" rel="noopener"
>https://share.tama.guru/d/App/Android/latest_release.apk&lt;/a>
&lt;/br>本站自签证iOS端：&lt;a class="link" href="https://share.tama.guru/d/App/iOS/%E7%8B%BC%E7%9A%84%E5%85%AC%E5%91%8A%E6%9D%BF.mobileconfig" target="_blank" rel="noopener"
>https://share.tama.guru/d/App/iOS/%E7%8B%BC%E7%9A%84%E5%85%AC%E5%91%8A%E6%9D%BF.mobileconfig&lt;/a>&lt;/p>
&lt;h3 id="介绍">介绍
&lt;/h3>&lt;p>RuleApi，基于typecho正式版数据库，使用JAVA语言Springboot框架，整合redis缓存数据库，COS、OSS对象存储，是目前typecho程序功能最全，接口最完善，用户体验最好，且性能最佳的API程序。集成了用户模块（登陆，注册，邮箱验证，用户查询，用户修改），文章模块，评论模块，分类模块，和上传模块（三合一上传方式，OSS，COS，本地上传均可），在安装完成后，可以进一步扩展typecho网站的功能，并实现更强大的性能，更全面的应用范围。&lt;/p>
&lt;h3 id="截图">截图
&lt;/h3>&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65576a92ee3f8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576a92ee3f8.png" alt="安卓端安装" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576a92ee3f8.png"
loading="lazy"
alt="安卓端安装"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65576aa82e79e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576aa82e79e.png" alt="内容" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576aa82e79e.png"
loading="lazy"
alt="内容"
>&lt;/p>
&lt;h3 id="搭建教程">搭建教程
&lt;/h3>&lt;p>以下均为安卓端app的配置，ios端个人能力有限不使用。&lt;/p>
&lt;h4 id="api端">API端
&lt;/h4>&lt;p>基本上可以参考官方项目的说明，官方提供centos使用的&lt;a class="link" href="http://shell.ruletree.club/ruleapi.sh" target="_blank" rel="noopener"
>一键脚本&lt;/a>，因为我用的debian，用的是手动安装。以下操作也是基础手动安装。&lt;/p>
&lt;h4 id="安装依赖环境">安装依赖环境
&lt;/h4>&lt;p>首先是JAVA，官方建议安装8u311版本，可以去网上找，也可以使用我下载下来的&lt;a class="link" href="https://share.tama.guru/%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%EF%BC%88%E4%BB%93%E5%BA%93%EF%BC%89/ruleproject/java" target="_blank" rel="noopener"
>文件&lt;/a>。下载之后解压到&lt;code>/opt&lt;/code>并命名为&lt;code>jdk1.8&lt;/code>，整个路径看起来应该像：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># ls /opt/jdk1.8/ bin COPYRIGHT include javafx-src.zip jmc.txt jre legal lib LICENSE man README.html release src.zip THIRDPARTYLICENSEREADME-JAVAFX.txt THIRDPARTYLICENSEREADME.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后配置环境，修改&lt;code>/etc/profile&lt;/code>，添加下面的语句到最后：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">jdk1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">CLASSPATH&lt;/span>&lt;span class="o">=.&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">jre&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jar&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jar&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jar&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>并执行&lt;code>source /etc/profile&lt;/code>使其生效。
其他还需要安装Redis、Mysql和Nginx，如果安装过宝塔的直接在面板上安装，基本上没有版本限制所以此处不写过程了。
最后还需要安装&lt;code>screen&lt;/code>用于维持ruleapi后台运行。&lt;/p>
&lt;h4 id="下载所需文件">下载所需文件
&lt;/h4>&lt;p>在&lt;code>/opt&lt;/code>新建一个文件夹，比如&lt;code>ruleapi&lt;/code>，把以下文件都下载下来。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> wget -c http://shell.ruletree.club/RuleApi.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wget -c http://shell.ruletree.club/application.properties
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wget -c http://shell.ruletree.club/apiResult.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>整个路径看起来应该像：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#ls /opt/ruleapi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiResult.php application.properties RuleApi.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">然后需要把`apiResult.php`复制到typecho的根目录。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">相关文件也已经上传云盘:[https://share.tama.guru/%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%EF%BC%88%E4%BB%93%E5%BA%93%EF%BC%89/ruleproject][7]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="修改ruleapi配置">修改ruleapi配置
&lt;/h4>&lt;p>修改&lt;code>application.properties&lt;/code>，主要修改以下几项：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="c1">#ruleapi运行的端口，如果8080被占用了就手动改。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datasource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">jdbc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">mysql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">127.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3306&lt;/span>&lt;span class="o">/&amp;lt;&lt;/span>&lt;span class="n">typecho数据库名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">characterEncoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">UTF&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datasource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">typecho数据库用户名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datasource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">typecho数据库密码&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mybatis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">configuration&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">variables&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">prefix&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">typecho数据表前缀&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">redis密码&lt;/span>&lt;span class="err">，默认为空，如果配置了其他密码自己手动修改&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">smtp服务器&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">smtp登录名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#spring.mail.from不支持中文，需要中文，看mail.properties&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">smtp密码&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">smtp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">smtp登录端口&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">smtp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ssl&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">enable&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="bp">true&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">smtp是否需要ssl&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">default&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">UTF&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">8&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="err">编码格式&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">webinfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">登录网页控制台的&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="运行程序并保持在后台运行">运行程序并保持在后台运行
&lt;/h4>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#screen -S ruleapi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#java -jar RuleApi.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> . ____ _ __ _ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /\\ / ___&amp;#39;_ __ _ _(_)_ __ __ _ \ \ \ \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">( ( )\___ | &amp;#39;_ | &amp;#39;_| | &amp;#39;_ \/ _` | \ \ \ \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \\/ ___)| |_)| | | | | || (_| | ) ) ) )
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39; |____| .__|_| |_|_| |_\__, | / / / /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> =========|_|==============|___/=/_/_/_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Spring Boot :: (v2.2.11.RELEASE)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:00 INFO 966545 --- [ main] com.RuleApi.Application 55 : Starting Application v1.3.4 on xxxxxxxxx with PID 966545 /opt/ruleapi/RuleApi.jar started by root in /opt/ruleapi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:00 INFO 966545 --- [ main] com.RuleApi.Application 651 : No active profile set, falling back to default profiles: default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:01 INFO 966545 --- [ main] .s.d.r.c.RepositoryConfigurationDelegate 249 : Multiple Spring Data modules found, entering strict repository configuration mode!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:01 INFO 966545 --- [ main] .s.d.r.c.RepositoryConfigurationDelegate 127 : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:01 INFO 966545 --- [ main] .s.d.r.c.RepositoryConfigurationDelegate 187 : Finished Spring Data repository scanning in 43ms. Found 0 Redis repository interfaces.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer 91 : Tomcat initialized with port(s): yourport (http)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.a.coyote.http11.Http11NioProtocol 173 : Initializing ProtocolHandler [&amp;#34;http-nio-yourport&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.apache.catalina.core.StandardService 173 : Starting service [Tomcat]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] org.apache.catalina.core.StandardEngine 173 : Starting Servlet engine: [Apache Tomcat/9.0.58]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] 173 : Initializing Spring embedded WebApplicationContext
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] w.s.c.ServletWebServerApplicationContext 283 : Root WebApplicationContext: initialization completed in 2660 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor 181 : Initializing ExecutorService &amp;#39;applicationTaskExecutor&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.s.b.a.w.s.WelcomePageHandlerMapping 54 : Adding welcome page: class path resource [static/index.html]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.a.coyote.http11.Http11NioProtocol 173 : Starting ProtocolHandler [&amp;#34;http-nio-yourport&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer 203 : Tomcat started on port(s): yourport(http) with context path &amp;#39;&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] com.RuleApi.Application 61 : Started Application in 6.022 seconds (JVM running for 6.495)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:14 INFO 966545 --- [nio-yourport-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] 173 : Initializing Spring DispatcherServlet &amp;#39;dispatcherServlet&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:14 INFO 966545 --- [nio-yourport-exec-1] o.s.web.servlet.DispatcherServlet 525 : Initializing Servlet &amp;#39;dispatcherServlet&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:14 INFO 966545 --- [nio-yourport-exec-1] o.s.web.servlet.DispatcherServlet 547 : Completed initialization in 8 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:15 INFO 966545 --- [nio-yourport-exec-8] io.lettuce.core.EpollProvider 68 : Starting without optional epoll library
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果有上述提示则表示程序正常启动了，可以按&lt;code>Ctrl+A D&lt;/code>保持后台运行。&lt;/p>
&lt;h4 id="配置二级域名">配置二级域名
&lt;/h4>&lt;p>因为使用IP+端口访问并不安全，需要配置一个二级域名用以访问。比如二级域名为https://rule.tama.host，生成并解析后需要添加伪静态规则：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">location ^~ /images/ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> alias /opt/ruleapi/static/;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ =404;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">location ^~ / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Origin&amp;#39; &amp;#39;*&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Methods&amp;#39; &amp;#39;GET, POST, OPTIONS, PUT, DELETE&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Credentials&amp;#39; &amp;#39;true&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Headers&amp;#39; &amp;#39;Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Data-Type,X-Auth-Token&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if ( $request_method = &amp;#39;OPTIONS&amp;#39; ) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return 200;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_pass http://127.0.0.1:&amp;lt;你的ruleapi端口&amp;gt;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header Host $host;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Real-IP $remote_addr;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header REMOTE-HOST $remote_addr;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意修改端口。之后访问https://rule.tama.host可以进入可视化管理页面。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577208c1bb8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577208c1bb8.png" alt="可视化界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577208c1bb8.png"
loading="lazy"
alt="可视化界面"
>
首次进去先点击安装及更新，每次更新之后都要点这个。此处需要填写&lt;code>webinfo.key&lt;/code>中配置的key。更新完成后关闭界面可以进入管理中心。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557722f7f421.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557722f7f421.png" alt="安装及更新" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557722f7f421.png"
loading="lazy"
alt="安装及更新"
>&lt;/p>
&lt;h4 id="管理中心配置">管理中心配置
&lt;/h4>&lt;p>这里的参数很多，我的修改只为了保证程序的运行，其他细项可以自行修改。
&lt;code>安全设置&lt;/code>建议打开机器人限制模式。
&lt;code>应用模块-应用管理&lt;/code>是重要的步骤，内容可以按自己的设置添加修改：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557734790de7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557734790de7.png" alt="应用设置1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557734790de7.png"
loading="lazy"
alt="应用设置1"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/655773783661e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773783661e.png" alt="应用设置2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773783661e.png"
loading="lazy"
alt="应用设置2"
>
之后会得到一个&lt;code>应用key&lt;/code>。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/655773af8f48f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773af8f48f.png" alt="应用key" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773af8f48f.png"
loading="lazy"
alt="应用key"
>
之后还需要到存储模块设置一个上传文件/视频的方式，可以选择OSS/COS/FTP/本地上传。如果使用本地上传，需要把本地&amp;amp;FTP图片访问地址修改为：&lt;code>https://rule.tama.host/images/&lt;/code>，rule.tama.host修改成你ruleapi的地址。（来自：&lt;a class="link" href="https://www.ijkxs.com/9955.html" target="_blank" rel="noopener"
>https://www.ijkxs.com/9955.html&lt;/a>）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577452b2529.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577452b2529.png" alt="本地访问图片" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577452b2529.png"
loading="lazy"
alt="本地访问图片"
>
至此api端算是配置完成了。&lt;/p>
&lt;h3 id="app端">APP端
&lt;/h3>&lt;h4 id="注册和配置dcloud">注册和配置dcloud
&lt;/h4>&lt;p>先需要注册一个&lt;a class="link" href="https://account.dcloud.net.cn/" target="_blank" rel="noopener"
>dcloud账号&lt;/a>并登录，绑定好手机号。然后到dcloud下载&lt;a class="link" href="https://dcloud.io/hbuilderx.html" target="_blank" rel="noopener"
>HBulder X&lt;/a>。&lt;/p>
&lt;h4 id="下载源码到本地并导入hbulderx">下载源码到本地并导入HBulderX
&lt;/h4>&lt;p>Gitee:&lt;a class="link" href="https://gitee.com/ruletree/RuleApp" target="_blank" rel="noopener"
>https://gitee.com/ruletree/RuleApp&lt;/a>
Github:&lt;a class="link" href="https://github.com/buxia97/RuleApi" target="_blank" rel="noopener"
>https://github.com/buxia97/RuleApp&lt;/a>
假设下载的目录是C:\Files\RuleApp，打开HBulderX，并执行&lt;code>文件&amp;gt;导入&amp;gt;从本地目录导入&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557762f65a2d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557762f65a2d.png" alt="导入项目" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557762f65a2d.png"
loading="lazy"
alt="导入项目"
>&lt;/p>
&lt;h4 id="修改配置项目">修改配置项目
&lt;/h4>&lt;p>首先是&lt;code>utils\api.js&lt;/code>，这里主要填写对接到ruleapi的数据，主要修改以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">API_URL&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;ruleapi网址&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">appKey&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;应用key&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>&lt;span class="n">web网站地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">GroupUrl&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;qq群链接&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">GithubUrl&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;gayhub链接&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其他可以根据注释修改。
然后修改&lt;code>manifest.json&lt;/code>，这里是图形界面的，可以根据提示直接修改，需要注意：
1.uni-app需要重新获取，这里会提示登录dcloud账号。
2.应用版本号和应用版本名称应高于前一次配置的值，首次配置可以写1。
3.app模块配置中根据需要选择Oauth如果没有配置的话把勾取消掉。
如果不选择Push的话，每次启动app都会有弹窗提示，建议配置，配置需要到&lt;a class="link" href="https://dev.dcloud.net.cn/pages/app/detail" target="_blank" rel="noopener"
>https://dev.dcloud.net.cn/pages/app/detail&lt;/a>中&lt;code>我的应用&amp;gt; 应用名称&amp;gt;Android云端证书&lt;/code>中查看证书详情，并记录sha1 sha256和md5值。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/655778cf37399.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655778cf37399.png" alt="证书指纹" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655778cf37399.png"
loading="lazy"
alt="证书指纹"
>
然后到&lt;code>各平台信息&lt;/code>中填写对应值，包名也要一并填写。
然后把数值填写到&lt;code>uniPush&amp;gt;1.0&amp;gt;应用信息&lt;/code>选择APPID，填写应用名称和包名、选择平台并选择Android应用签名。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557798cb22be.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557798cb22be.png" alt="应用信息配置" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557798cb22be.png"
loading="lazy"
alt="应用信息配置"
>
保存成功后进入&lt;code>uniPush&amp;gt;1.0&amp;gt;消息推送&amp;gt;配置管理&amp;gt;应用配置&lt;/code>下，把Appid Appkey MasterSectrt值填写到ruleapi的&lt;code>通知模块&amp;gt;UniPush配置&lt;/code>中。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a0903248.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a0903248.png" alt="应用配置" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a0903248.png"
loading="lazy"
alt="应用配置"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a30b67f8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a30b67f8.png" alt="UniPushRuleapi端" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a30b67f8.png"
loading="lazy"
alt="UniPushRuleapi端"
>&lt;/p>
&lt;h4 id="调试">调试
&lt;/h4>&lt;p>到HBulderX的运行中选择运行到浏览器，等几分钟会跳转到浏览器并打开页面，可以查看是否有误。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577acb6c90f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577acb6c90f.png" alt="调试" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577acb6c90f.png"
loading="lazy"
alt="调试"
>&lt;/p>
&lt;h4 id="编译">编译
&lt;/h4>&lt;p>执行HBulderX的的发行&amp;gt;原生App-云打包。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b174db42.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b174db42.png" alt="发行" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b174db42.png"
loading="lazy"
alt="发行"
>
填写包名并选择使用云端证书，点击打包，会提示下载相关依赖，下载完成后会自动启动打包，如果没有配置错误一般三到五分钟后就能生成apk包。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b62916d8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b62916d8.png" alt="打包" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b62916d8.png"
loading="lazy"
alt="打包"
>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:08.640 项目 &amp;#39;RuleApp-master&amp;#39; 开始编译...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:10.336 3.96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:10.336 正在编译中...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:10.337 ​已开启 uni统计1.0 版本​
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:40.332 项目 &amp;#39;RuleApp-master&amp;#39; 编译成功。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 打包成功后会自动返回下载链接。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 打包过程查询请点菜单发行-查看云打包状态。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 周五傍晚等高峰期打包排队较长，请耐心等待。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 如果是为了三方SDK调试，请使用自定义调试基座（菜单运行-手机或模拟器-制作自定义调试基座），不要反复打包。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 项目 RuleApp-master [__UNI__xxxxxxx]已成功提交到云端，正在获取打包状态...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:02:52.421
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.423 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.423 时间: 2023-11-17 23:02:50 类型: Android云端证书 准备打包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:02:52.903
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.903 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.903 时间: 2023-11-17 23:02:50 类型: Android云端证书 准备打包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:03:49.917
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:03:49.917 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:03:49.917 时间: 2023-11-17 23:02:50 类型: Android云端证书 正在云端打包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:03:49.917 预计2-5分钟完成打包。如项目使用了App原生插件，打包时间可能会更长，请耐心等待。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:04:58.053
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:04:58.054 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:04:58.054 时间: 2023-11-17 23:02:50 类型: Android云端证书 正在本地生成安装包(请勿关闭HBuilderX)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:05:27.519
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:05:27.519 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:05:27.519 时间: 2023-11-17 23:02:50 类型: Android云端证书 打包成功 安装包位置：xxxxxxxxxxxxxxxxxxxx/apk/__UNI__xxxxx__20231117230250.apk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>打包好的文件根据提示可以找到。&lt;/p>
&lt;h3 id="注意事项">注意事项
&lt;/h3>&lt;h4 id="阿里云oss防盗链">阿里云OSS防盗链
&lt;/h4>&lt;p>需要在防盗链白名单中添加&amp;quot;-&amp;quot;，否则app端资源无法显示。&lt;/p>
&lt;h4 id="添加表情包">添加表情包
&lt;/h4>&lt;p>资源位于&lt;code>RuleApp-master\unpackage\dist\dev\app-plus\static\app-plus\owo&lt;/code>、&lt;code>RuleApp-master\static\app-plus\owo&lt;/code>以及&lt;code>C:\Users\Tamakyi Gekka\Downloads\RuleApp-master\RuleApp-master\static\h5\owo&lt;/code>下。需要修改&lt;code>OwO.js&lt;/code>并根据路径添加对应资源。&lt;/p></description></item><item><title>一个新的kindle越狱方案（适用于5.16.2.1.1以下）</title><link>https://blog.tama.guru/record/LanguageBreak.html</link><pubDate>Mon, 30 Oct 2023 11:56:00 +0800</pubDate><guid>https://blog.tama.guru/record/LanguageBreak.html</guid><description>&lt;p>10月29日，Github用户&lt;a class="link" href="https://github.com/notmarek" target="_blank" rel="noopener"
>notmarek&lt;/a>发布了一个仓库&lt;a class="link" href="https://github.com/notmarek/LanguageBreak" target="_blank" rel="noopener"
>LanguageBreak&lt;/a>，内容是版本号&amp;lt;=5.16.2.1.1的kindle设备的越狱（截至10月30日官网最新版本号为5.16.4），而在此之前仅5.14.2及以下的版本才有机会越狱。&lt;/p>
&lt;p>作者对此项目的介绍在：&lt;a class="link" href="https://www.mobileread.com/forums/showthread.php?t=356872" target="_blank" rel="noopener"
>https://www.mobileread.com/forums/showthread.php?t=356872&lt;/a>。该漏洞相关信息：&lt;a class="link" href="https://www.mobileread.com/forums/showthread.php?t=356766" target="_blank" rel="noopener"
>https://www.mobileread.com/forums/showthread.php?t=356766&lt;/a>，内容如下：&lt;/p>
&lt;blockquote>
&lt;p>Looking at the differences between 5.16.2 and 5.16.3, I think I found
a smoking gun of a change.&lt;/p>
&lt;p>There is small difference the versions of
&amp;ldquo;usr/lib/blanket/langpicker.so.1.0&amp;rdquo; In the function:
module_langpicker_utilDeleteExtraDictionaries&lt;/p>
&lt;p>Before: Code:
__sprintf_chk(acStack_238,1,0x206,&amp;ldquo;rm -rf %s/%s&amp;rdquo;,&amp;quot;/mnt/us/documents/dictionaries&amp;quot;,pcVar2);
pcVar6 = (char *)system(acStack_238); after: Code:
__sprintf_chk(acStack_830,1,0x200,&amp;quot;%s/%s&amp;quot;,&amp;quot;/mnt/us/documents/dictionaries&amp;quot;,pcVar2);
pcVar6 = (char *)lab126_rmdir(acStack_830); This was passing strings to &amp;ldquo;system()&amp;rdquo; which is a glaring problem.&lt;/p>
&lt;p>Expanding out a bit: Code: __dirp =
opendir(&amp;quot;/mnt/us/documents/dictionaries&amp;quot;); if (__dirp == (DIR *)0x0)
{
if (iVar1 == 0) {
return;
} } else { LAB_000134d4:
pdVar4 = readdir(__dirp);
if (pdVar4 != (dirent *)0x0) {
pcVar2 = pdVar4-&amp;gt;d_name;
iVar5 = strcmp(pcVar2,&amp;quot;.&amp;quot;);
if (((iVar5 != 0) &amp;amp;&amp;amp; (iVar5 = strcmp(pcVar2,&amp;quot;..&amp;quot;), iVar5 != 0)) &amp;amp;&amp;amp;
(pcVar6 = strchr(pcVar2,0x2e), pcVar6 == (char *)0x0)) {
puVar7 = (undefined4 *)g_list_find_custom(iVar1,pcVar2,&amp;amp;LAB_00012534);
if (puVar7 == (undefined4 *)0x0) {
__sprintf_chk(acStack_238,1,0x206,&amp;ldquo;rm -rf %s/%s&amp;rdquo;,&amp;quot;/mnt/us/documents/dictionaries&amp;quot;,pcVar2);
pcVar6 = (char *)system(acStack_238);
if ((pcVar6 == (char *)0x0) || ((g_blanket_llog_mask &amp;amp; 0x2000000) == 0))
goto LAB_000134d4;
pcVar2 =
&amp;ldquo;E langpicker:DELETE_DICTIONARIES_FAILED:returnCode=%d:Error deleting unneeded dictionary directory&amp;rdquo; It looks like this code walks
through &amp;ldquo;/mnt/us/documents/dictionaries&amp;rdquo; (which is on the exposed file
system!)&lt;/p>
&lt;p>For each filename it finds, if it isn&amp;rsquo;t in the list, it will append
that filename to a string and pass it to system.&lt;/p>
&lt;p>Using Shell escapes such as Code: &lt;code>someprogram&lt;/code> or Code: $(some
program) should be valid filenames. However, slashes are NOT normally
allowed (is that why there was a mention of corrupting the VFAT file
system?)&lt;/p>
&lt;p>Looking at the calling function, it appears to be: &amp;lsquo;changeLocale&amp;rsquo;&lt;/p>
&lt;p>This is called from the startup script &amp;ldquo;etc/upstart/langpicker.conf&amp;rdquo;
Code:
# send the event to langpicker module to install the language
lipc-send-event com.lab126.blanket.langpicker changeLocale -s &amp;ldquo;en-US&amp;rdquo; and from &amp;ldquo;langPicker&amp;rdquo; (&amp;ldquo;language_picker.js&amp;rdquo;) Code:
setTimeout(function() {
nativeBridge.sendLipcEvent(LIPC_PILLOW_SOURCE, &amp;ldquo;changeLocale&amp;rdquo;, changeLocaleParams);
actionsInactive = false;
}, SPLASH_EVENT_TIME_OUT); It does NOT appear to be called when changing the language in the GUI - but that uses Java (settings
booklet) and not Javascript (language_picker.js).&lt;/p>
&lt;p>So, the exploit path seems to be: Create a file in
documents/dictionaries with Shell injection to run something Use
&amp;lsquo;mesquito&amp;rsquo; to call the LIPC function changeLocale&lt;/p>&lt;/blockquote>
&lt;p>在原文下面有很多用户表示通过这个方法已经成功实现越狱了。
包括但不限于：
Kindle 第 10 代（5.14.3.2）
KPW4和KPW5 （5.16.2.1和5.16.2）
KPW2（5.12.2.2）
但也有很多人表示操作过程中遇到问题，因为项目是刚发布的，后续应该会有修复。&lt;/p>
&lt;hr>
&lt;p>越狱的相关说明（机翻）：&lt;/p>
&lt;p>越狱部分：&lt;/p>
&lt;blockquote>
&lt;p>1.在 Kindle 搜索栏中输入 ;enter_demo
2.重新启动设备
3.进入演示模式后，跳过 wifi 设置，输入随机值进行商店注册
4.跳过搜索演示有效载荷
5.选择 &amp;ldquo;标准 &amp;ldquo;演示类型
6.在提示符下按 &amp;ldquo;完成&amp;rdquo;，以侧载内容。
7.演示设置完成后，做 &amp;ldquo;秘密手势&amp;rdquo;（双指轻点屏幕右下角，然后向左滑动）
8.在搜索栏中输入 ;demo 进入演示配置菜单
9.选择 &amp;ldquo;侧载内容 &amp;ldquo;选项
10.将 LanguageBreak 文件夹的内容复制到 Kindle - 合并并替换所有文件
11.拔下 Kindle 插头，返回演示菜单
12.选择 &amp;ldquo;转售设备 &amp;ldquo;选项
13.然后按 &amp;ldquo;是/转售
14.现在等待按下电源按钮启动
15.一旦出现，将你的 kindle 插回电脑，再次将 LanguageBreak 文件夹的内容复制到电脑中，覆盖文件，然后安全弹出。
16.按照屏幕上的指示按住电源按钮
17.几秒钟后，你将进入语言选择菜单
18.选择 &amp;ldquo;中文&amp;rdquo;（在 &amp;ldquo;奇特的伪托语言 &amp;ldquo;上面的那个）。
19.你的 kindle 应该会重启，屏幕上会出现一些日志信息.&lt;/p>&lt;/blockquote>
&lt;p>越狱后的操作：&lt;/p>
&lt;blockquote>
&lt;p>1.设备重启后，在搜索栏中输入 ;uzb
2.将设备连接到 PC，然后将 update_hotfix_languagebreak.bin 复制到 Kindle 存储根目录下。
3.弹出设备，输入 ;dsts 或向下滑动并选择设置图标，进入设备设置菜单
4.选择 &amp;ldquo;更新你的 Kindle&amp;rdquo;，安装自定义修复程序
5.这将使您的设备退出演示模式，并清理不需要的越狱文件。&lt;/p>&lt;/blockquote>
&lt;hr>
&lt;p>过段时间我拿自己的KPW3试试（反正我有TTL线，随时跑路）&lt;/p></description></item><item><title>使用github部署多个静态网站</title><link>https://blog.tama.guru/record/github_muti_pages.html</link><pubDate>Wed, 25 Oct 2023 23:16:29 +0800</pubDate><guid>https://blog.tama.guru/record/github_muti_pages.html</guid><description>&lt;p>因为有时候需要部署一些静态网站，但是自己的服务器上网站实在太乱了，部署在github便是我最好的选择。
默认情况下是只能部署一个网站的，如果需要部署多个就需要自己动手操作一下。&lt;/p>
&lt;p>操作的大前提是已经部署好自己用户名的网站仓库，例如我的就是&lt;a class="link" href="https://tamakyi.github.io" target="_blank" rel="noopener"
>tamakyi.github.io&lt;/a>。
之后再创建一个repository，此处的名称就会是之后的二级域名，例如我的Repository name是index，之后这个网站的地址就是&lt;a class="link" href="https://tamakyi.github.io/index" target="_blank" rel="noopener"
>https://tamakyi.github.io/index&lt;/a>。除了Repository name之外，其他都可以保留默认，然后选择Create repository.
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/65392cc5cab91.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392cc5cab91.png" alt="repository setting" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392cc5cab91.png"
loading="lazy"
alt="repository setting"
>
然后要做的就是把本地的网页文件部署上去，因为在Windows环境ixa，为了直观的体现，此处我安装了Github Desktop，在创建完repository之后点击Set up in Desktop跳转到Github Desktop。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/65392d9a9dbb4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392d9a9dbb4.png" alt="Set up in Desktop" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392d9a9dbb4.png"
loading="lazy"
alt="Set up in Desktop"
>
然后Locale path选择要clone到本地的目录，例如C:/wwwroot/。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/65392e2d140da.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392e2d140da.png" alt="Locale path" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392e2d140da.png"
loading="lazy"
alt="Locale path"
>
之后该目录下会形成一个index文件夹，然后把静态网站所有文件全部扔上去（注意如果有引用文件记得修改），一定要确保该目录下有index.html文件，能且仅能用html格式。
此处我只放了一个index.html文件，然后在Github Desktop上选择Commit to main并点击Publish branch。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/65392fe60742f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392fe60742f.png" alt="选择Commit to main并点击Publish branch" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/65392fe60742f.png"
loading="lazy"
alt="选择Commit to main并点击Publish branch"
>
然后在网页端打开仓库，进入setting。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/6539303c29146.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/6539303c29146.png" alt="Open repository" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/6539303c29146.png"
loading="lazy"
alt="Open repository"
>
在Pages页面把Branch的None切换到main，然后点击save。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/6539309bc201e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/6539309bc201e.png" alt="Pages setting 1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/6539309bc201e.png"
loading="lazy"
alt="Pages setting 1"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/653930ac32fdb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/653930ac32fdb.png" alt="Pages setting 2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/653930ac32fdb.png"
loading="lazy"
alt="Pages setting 2"
>
等待几分钟，然后Pages页面就出现网址了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/653931096978e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/653931096978e.png" alt="Create success" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/653931096978e.png"
loading="lazy"
alt="Create success"
>
也能正常打开了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/10/25/653931279ab72.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/653931279ab72.png" alt="正常打开" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/10/25/653931279ab72.png"
loading="lazy"
alt="正常打开"
>&lt;/p></description></item><item><title>在debian下安装headscale的记录</title><link>https://blog.tama.guru/record/headscale.html</link><pubDate>Thu, 14 Sep 2023 00:36:00 +0800</pubDate><guid>https://blog.tama.guru/record/headscale.html</guid><description>&lt;h5 id="什么是headscale">什么是headscale
&lt;/h5>&lt;p>&lt;code>An open source, self-hosted implementation of the Tailscale control server&lt;/code>
要说headscale肯定就要先说tailscale，这是一项VPN服务，可让您拥有的设备和应用程序在世界任何地方安全，轻松地访问。它支持使用开源 WireGuard 协议进行加密的点对点连接，这意味着只有专用网络上的设备才能相互通信。
也就意味着，在任意设备上安装tailscale之后，即可组建一个VPN网络，非常方便的达到内网穿透以及达成一些不可告人的目的。&lt;/p>
&lt;h5 id="为什么要安装headscale">为什么要安装headscale
&lt;/h5>&lt;p>tailscale是闭源的商业软件，客户端有上限（虽然一般人也用不到它的上限），而且服务器是定死的，国内连接的时候偶尔会有很大的延迟（基本都是200+，但是如果部署在国外就好一些，比如下面是我在南亚的服务器：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Bangalore: 17.85 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Singapore: 61.31 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dubai: 77.91 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hong Kong: 98.53 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Paris: 114.17 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Madrid: 116.31 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Frankfurt: 121.60 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Amsterdam: 121.80 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Tokyo: 124.99 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Warsaw: 126.75 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">London: 135.55 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sydney: 149.78 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Miami: 219.59 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Los Angeles: 220.80 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Denver: 225.65 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Seattle: 230.58 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Chicago: 238.62 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">San Francisco: 242.12 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">New York City: 246.40 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dallas: 246.59 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Toronto: 251.18 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nairobi: 280.36 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Honolulu: 292.43 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Johannesburg: 294.61 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">São Paulo: 295.29 ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>而headscale则是tailscale的开源解决方案，这意味着所有的流量都只通过你的服务器，功能也任由你选择。
但是headscale有一点不好，它没有图形界面，这意味着需要全程在终端进行操作。&lt;/p>
&lt;hr>
&lt;p>#####如何安装
######1.下载并配置
以debian为例，去&lt;a class="link" href="https://github.com/juanfont/headscale/releases" target="_blank" rel="noopener"
>https://github.com/juanfont/headscale/releases&lt;/a>下载适合自己发行版和架构的版本（我没用deb包），下载到&lt;code>/usr/local/bin/&lt;/code>并重命名为&lt;code>headscale&lt;/code>。
当前最新版是0.22.3，即：
&lt;code>wget --output-document=/usr/local/bin/headscale https://github.com/juanfont/headscale/releases/download/v0.22.3/headscale_0.22.3_linux_amd64&lt;/code>
之后再加上运行权限：
&lt;code>chmod +x /usr/local/bin/headscale&lt;/code>
创建目录用来存储数据与证书：
&lt;code>mkdir -p /var/lib/headscale&lt;/code>
创建空的 SQLite 数据库文件：
&lt;code>touch /var/lib/headscale/db.sqlite&lt;/code>
创建配置目录并下载配置文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir -p /etc/headscale &amp;amp;&amp;amp; cd /etc/headscale
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/juanfont/headscale/raw/main/config-example.yaml -O /etc/headscale/config.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后修改配置文件&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nano /etc/headscale/config.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>主要修改几个地方：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">server_url: http://SERVERIP #SERVERIP改为公网IP地址 注意，此处直接修改为http://SERVERIP:PORT1便不会出现404问题
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listen_addr: 0.0.0.0:PORT1 #PORT1默认8080，可改为连接的端口，之后连接会通过0.0.0.0:PORT1`进行，如果安装了防火墙记得放行端口
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metrics_listen_addr: 0.0.0.0:PORT2 #PORT2默认9090，可改为连接的端口，之后连接会通过0.0.0.0:PORT2`进行，如果安装了防火墙记得放行端口
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grpc_listen_addr: 0.0.0.0:50443
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">magic_dns： false #关闭magic_dns功能
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ip_prefixes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - fd7a:115c:a1e0::/48 #自定义IPV6网段，如果用不到可以屏蔽此行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 10.64.0.0/16 #自定义IPV4网段
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>创建systemd守护程序&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nano /etc/systemd/system/headscale.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改内容为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">Unit&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Description&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">headscale&lt;/span> &lt;span class="n">controller&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">After&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">syslog&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">After&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">network&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">Service&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">simple&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">User&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">headscale&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Group&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">headscale&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ExecStart&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">headscale&lt;/span> &lt;span class="n">serve&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Restart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">always&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RestartSec&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Optional security enhancements&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NoNewPrivileges&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">PrivateTmp&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ProtectSystem&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">strict&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ProtectHome&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ReadWritePaths&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">headscale&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">headscale&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">AmbientCapabilities&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">CAP_NET_BIND_SERVICE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RuntimeDirectory&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">headscale&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">Install&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">WantedBy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>创建 headscale 用户：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">useradd headscale -d /home/headscale -m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改 /var/lib/headscale 目录的所有者：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">chown&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">R&lt;/span> &lt;span class="n">headscale&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">headscale&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">headscale&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Reload SystemD 以加载新的配置文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">daemon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">reload&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启动 Headscale 服务并设置开机自启：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl enable --now headscale
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>tailscale 中有一个概念叫 tailnet，你可以理解成租户，租户与租户之间是相互隔离的，具体看参考 Tailscale 的官方文档：What is a tailnet。Headscale 也有类似的实现叫 namespace，即命名空间。我们需要先创建一个 namespace，以便后续客户端接入，例如：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">headscale namespaces create default #此处命名空间为default
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>到此服务端部分基本配置完毕。
######2.接入headscale
对于已经安装了tailscale的linux系统，可以直接执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">tailscale up --login-server=http://SERVERIP:PORT1 --accept-routes=true --accept-dns=false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果之前已经接入过tailscale，需要执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">tailscale up --login-server=http://SERVERIP:PORT1 --accept-routes=true --accept-dns=false --force-reauth
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Windows操作其实也类似，按官网说法我们需要修改注册表，但其实我们只要进入软件的安装目录并右键启动Powershell，执行如下命令:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.\tailscale.exe up --accept-dns=false --accept-routes --login-server=http://SERVERIP:PORT1 --unattended
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>之后会提示：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">To authenticate, visit:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> http://SERVERIP:PORT1/register/nodekey:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e2bfd7452.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e2bfd7452.png" alt="hs-in" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e2bfd7452.png"
loading="lazy"
alt="hs-in"
>
把其中的&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">headscale nodes register --user USERNAME --key nodekey:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>复制到服务器终端中，并修改&lt;code>USERNAME&lt;/code>为命名空间，比如上面我们设置的是&lt;code>default&lt;/code>。
执行之后服务器提示：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Machine xxx registered
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>客户端提示：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Success.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在服务器执行
&lt;code>headscale nodes list&lt;/code>
可以看到客户端分配到的IP地址为&lt;code>100.64.0.1&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ID | Hostname | Name | MachineKey | NodeKey | User | IP addresses | Ephemeral | Last seen | Expiration | Online | Expired
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 | xxx | xxx | [xxx] | [xxx] | default | 100.64.0.1, | false | 2023-09-13 15:47:03 | 0001-01-01 00:00:00 | online | no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>相同的方法再添加第二个服务器，分配到ip:&lt;code>100.64.0.2&lt;/code>
用进行互PING已经通了：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># ping 100.64.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PING 100.64.0.2 (100.64.0.2) 56(84) bytes of data.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">64 bytes from 100.64.0.2: icmp_seq=1 ttl=64 time=0.041 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">64 bytes from 100.64.0.2: icmp_seq=2 ttl=64 time=0.042 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">64 bytes from 100.64.0.2: icmp_seq=3 ttl=64 time=0.043 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">64 bytes from 100.64.0.2: icmp_seq=4 ttl=64 time=0.046 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">^C
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 100.64.0.2 ping statistics ---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4 packets transmitted, 4 received, 0% packet loss, time 3057ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rtt min/avg/max/mdev = 0.041/0.043/0.046/0.002 ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>延迟很低，很好。
######3.支持了哪些平台？
截至9月14日，基本已经实现了全平台支持，详情见&lt;a class="link" href="https://github.com/juanfont/headscale" target="_blank" rel="noopener"
>https://github.com/juanfont/headscale&lt;/a>。
官方tailscale在1.30.0之后的版本基本都实现了自定义url。
以安卓为例，打开应用程序后，必须反复打开和关闭右侧顶部栏上的烤肉串菜单图标（三个点），直到菜单中出现“更改服务器”选项。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8393b827.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8393b827.png" alt="狂点三个点" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8393b827.png"
loading="lazy"
alt="狂点三个点"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e854095bb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e854095bb.png" alt="出现Change server" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e854095bb.png"
loading="lazy"
alt="出现Change server"
>
可以在此处输入&lt;code>http://SERVERIP:PORT1&lt;/code>。保存返回上一步，然后选择&lt;code>Sign in with other&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8897db77.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8897db77.png" alt="Sign in with other" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8897db77.png"
loading="lazy"
alt="Sign in with other"
>
然后就一如既往的404了，使用浏览器打开这个网页，添加端口到IP后面再访问。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8cc39e42.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8cc39e42.png" alt="404了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8cc39e42.png"
loading="lazy"
alt="404了"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8f3822db.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8f3822db.png" alt="不404了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e8f3822db.png"
loading="lazy"
alt="不404了"
>
然后按照上面把那窜命令修改后复制到服务端执行，显示成功后安卓端杀掉tailscale进程，再重新进去之后就可以正常使用了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e959e894c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e959e894c.png" alt="正常使用了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/09/14/6501e959e894c.png"
loading="lazy"
alt="正常使用了"
>
######4.打通局域网
需求:假设本地里面有一台设备,headscale ip为&lt;code>10.64.0.5&lt;/code>，内网ip为&lt;code>192.168.50.79&lt;/code>，但是我不想内网每台设备都接入headscale，希望通过&lt;code>10.64.0.5&lt;/code>来打通局域网。
客户端（10.64.0.5）配置:
1.开启ipv4和ipv6转发&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo &amp;#39;net.ipv4.ip_forward = 1&amp;#39; | tee /etc/sysctl.d/ipforwarding.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo &amp;#39;net.ipv6.conf.all.forwarding = 1&amp;#39; | tee -a /etc/sysctl.d/ipforwarding.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sysctl -p /etc/sysctl.d/ipforwarding.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>2.修改tailscale启动配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">tailscale up --login-server=http://SERVERIP:PORT1 --accept-routes=true --accept-dns=false --advertise-routes=192.168.50.0/24
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中&lt;code>http://SERVERIP:PORT1&lt;/code>为上面的headscale服务器地址和ip，&lt;code>192.168.50.0/24&lt;/code>是客户端的内网网段。
服务端（headscale服务器）
查看10.64.0.5的id&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># headscale nodes list ID | Hostname | Name | MachineKey | NodeKey | User | IP addresses | Ephemeral | Last seen | Expiration | Online | Expired
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5 | akarinbot | akarinbot | [WEJPM] | [ETS1a] | tamaroot | 100.64.0.5, fd7a:115c:a1e0::1 | false | 2023-09-14 03:58:37 | 0001-01-01 00:00:00 | online | no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以看到此处id为5。接下来查看该服务下的路由:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">headscale routes list -i 5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># headscale routes list -i 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ID | Machine | Prefix | Advertised | Enabled | Primary
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7 | akarinbot | 192.168.50.0/24 | true | false | true
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里路由id为7，且Enabled状态为false。接下来开启这个路由&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># headscale routes enable -r 7
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>此时Enabled状态为true。
现在在任意客户端访问192.168.50.0/24网段的ip都能联通了。
#####5.其他事项
如果deb包下载很慢，可以用其他软件下载:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://pkgs.tailscale.com/stable/tailscale_{版本号}_{架构}.deb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>例如：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://pkgs.tailscale.com/stable/tailscale_1.56.1_amd64.deb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Debian12下通过docker安装homeassistant-hacs</title><link>https://blog.tama.guru/record/homeassistant-hacs-debian12.html</link><pubDate>Fri, 25 Aug 2023 11:58:39 +0800</pubDate><guid>https://blog.tama.guru/record/homeassistant-hacs-debian12.html</guid><description>&lt;p>HACS即&lt;code>Home Assistant Community Store&lt;/code>，整合了很多homeassistant的第三方集成，比如说米家的相关设备，如果使用官方自带的集成，一般只能识别出几个传感器，而且无法控制，如果想要把米家的设备完全接入就需要安装HACS下面的Xiaomi Miot Auto这个集成，安装之后效果如图所示，基本上能实现HASS管理全部米家设备的想法。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/25/64e820b842fb5.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/25/64e820b842fb5.png" alt="安装集成之后的页面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/25/64e820b842fb5.png"
loading="lazy"
alt="安装集成之后的页面"
>
安装HACS难的地方在于需要homeassistant supervised版本，要么在物理机上安装hassos，要么弄个虚拟机给hass，还有一种方法是在debian系的系统上通过docker实现，因为前面两种方法影响太大，我选择第三个。
需要注意的是最好使用原版debian系统，我现在用的是debian 12.1，正好适合。&lt;/p>
&lt;hr>
&lt;p>####首先肯定是先安装docker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apt&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">curl&lt;/span> &lt;span class="n">vim&lt;/span> &lt;span class="n">wget&lt;/span> &lt;span class="n">gnupg&lt;/span> &lt;span class="n">dpkg&lt;/span> &lt;span class="n">apt&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">transport&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">https&lt;/span> &lt;span class="n">lsb&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">release&lt;/span> &lt;span class="n">ca&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">certificates&lt;/span> &lt;span class="c1">#安装必要组件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">curl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">sS&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">gpg&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">gpg&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">dearmor&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">keyrings&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ce&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-ce.gpg] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/debian $(lsb_release -sc) stable&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span> &lt;span class="c1">#添加源和证书&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>####安装OS-AGENT和supervised&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">assistant&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">agent&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">1.5&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">os&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">agent_1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">5.1&lt;/span>&lt;span class="n">_linux_x86_64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">deb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dpkg&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">agent_1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">5.1&lt;/span>&lt;span class="n">_linux_x86_64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">deb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">assistant&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">supervised&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">installer&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">1.5&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">homeassistant&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">supervised&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">deb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dpkg&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="n">homeassistant&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">supervised&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">deb&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装supervised包时可能会报错，需要安装以下依赖包：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apt install libmicrohttpd12 systemd-journal-remote systemd-resolved libnss-resolve jq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>supervised包安装好后要重启一次机器，不然有可能会遇到解析&lt;code>checkonline.home-assistant.io&lt;/code>错误的情况。
重启之后在终端里执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker ps
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以看到出现了很多进程。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">~ sudo docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80d950683f05 ghcr.io/home-assistant/amd64-hassio-multicast:2023.06.2 &amp;#34;/init&amp;#34; 3 hours ago Up 3 hours hassio_multicast
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">e2c45b161283 ghcr.io/home-assistant/amd64-hassio-audio:2023.06.0 &amp;#34;/init&amp;#34; 3 hours ago Up 3 hours hassio_audio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">61df701e5ca7 ghcr.io/home-assistant/amd64-hassio-dns:2023.06.2 &amp;#34;/init&amp;#34; 3 hours ago Up 3 hours hassio_dns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">a6d8e3385086 ghcr.io/home-assistant/amd64-hassio-cli:2023.06.0 &amp;#34;/init&amp;#34; 3 hours ago Up 3 hours hassio_cli
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9c80287b1474 ghcr.io/home-assistant/qemux86-64-homeassistant:2023.8.4 &amp;#34;/init&amp;#34; 3 hours ago Up 36 minutes homeassistant
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7f3cb9ef899e ghcr.io/home-assistant/amd64-hassio-observer:2023.06.0 &amp;#34;/usr/bin/observer&amp;#34; 3 hours ago Up 3 hours 0.0.0.0:4357-&amp;gt;80/tcp, :::4357-&amp;gt;80/tcp hassio_observer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1e946ecbdc4d ghcr.io/home-assistant/amd64-hassio-supervisor:latest &amp;#34;/init&amp;#34; 3 hours ago Up 3 hours hassio_supervisor
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这个过程可能需要几分钟，如果可行的话建议还要挂上梯子。几分钟后浏览器访问&lt;code>http://IP:8123&lt;/code>可以到达hass界面，如果访问不了的建议检查防火墙是否放行8123端口。
####安装HACS并配置Xiaomi Miot Auto
安装HACS只需要在终端里执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wget -O - https://get.hacs.xyz | bash -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>会自动安装到hass的第三方目录下，安装完成后重启HASS。
然后在HACS下的集成选择浏览并下载存储库，在其中找到Xiaomi Miot Auto，选择安装。
安装完成之后在配置-设备与服务-添加集成-选择Xiaomi Miot Auto，然后输入小米账号ID 密码 服务器选择CN，保存之后所有设备就都出来。&lt;/p></description></item><item><title>zsh下miniconda的正确安装方法及换源方法</title><link>https://blog.tama.guru/record/miniconda.html</link><pubDate>Fri, 25 Aug 2023 01:04:56 +0800</pubDate><guid>https://blog.tama.guru/record/miniconda.html</guid><description>&lt;p>Anaconda 是一个用于科学计算的 Python 发行版，支持 Linux, Mac, Windows, 包含了众多流行的科学计算、数据分析的 Python 包。Miniconda 是一个 Anaconda 的轻量级替代，默认只包含了 python 和 conda，但是可以通过 pip 和 conda 来安装所需要的包。通常情况下安装Miniconda构建虚拟环境是很方便的，但是安装过程中会碰到一些奇怪的问题导致使用时一直报错，这里记录一下一个成功的安装方法。&lt;/p>
&lt;hr>
&lt;p>####下载并执行安装脚本&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">chmod +x Miniconda3-latest-Linux-x86_64.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash Miniconda3-latest-Linux-x86_64.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后一路yes,到最后一步是否&lt;code>conda init&lt;/code>一定要选no，不然大概率出问题。
####修改.zshrc
文件位于用户名根目录下，打开后在最后一行添加&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">eval &amp;#34;$(/root/miniconda3/bin/conda shell.zsh hook)&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>因为我安装位置在&lt;code>/root&lt;/code>下，如果不是这个路径自行修改。
然后使文件生效：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">source ~/.zshrc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>####修改为国内源
首先执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">conda config --write-default
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后用户目录下会有一个&lt;code>.condarc&lt;/code>的文件，打开，在最后输入&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">channels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - defaults
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">show_channel_urls: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">default_channels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">custom_channels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># channel_priority: flexible
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">channel_priority: strict
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># pip_interop_enabled: false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip_interop_enabled: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># safety_checks: warn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">safety_checks: enabled
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># auto_activate_base: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auto_activate_base: false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># report_errors:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">report_errors: false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存，然后执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">conda update --all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以看到现在更新很快了。&lt;/p></description></item><item><title>通过Cloudflare零信任(cloudflare zero trush)给内网服务器做穿透并搭建webssh的小记</title><link>https://blog.tama.guru/record/cloudflare_webssh_zerotrush.html</link><pubDate>Fri, 18 Aug 2023 14:23:00 +0800</pubDate><guid>https://blog.tama.guru/record/cloudflare_webssh_zerotrush.html</guid><description>&lt;p>通过cloudflare zero trush可以非常快速且方便的搭建内网穿透，而且速度一般情况下可以接受，最重要的是成本很低，你只需要：&lt;/p>
&lt;ol>
&lt;li>一个cloudflare账号&lt;/li>
&lt;li>一个托管到cloudflare的域名&lt;/li>
&lt;/ol>
&lt;p>以上内容百度到处都是，不再赘述，以下仅记录搭建webssh的过程。&lt;/p>
&lt;hr>
&lt;p>####1、安装并配置tunnel
需要在ssh服务器上执行如下命令：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#安装cloudflared，我用的arch，其他平台自己替换。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S cloudflared
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#这一步执行后会得到一个链接，复制到浏览器打开，然后选择一个托管到cloudflare的域名，确认之后会将对应的pem证书推到你服务器的.cloudflare目录下。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cloudflared tunnel login
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#创建一个tunnel，其中$tunnel-name自行配置
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cloudflared tunnel create $tunnel-name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#查看tunnel列表
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cloudflared tunnel list
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>此时在输出的列表中找到刚才创建的tunnel名为$tunnel-name对应的ID，一般格式为&lt;code>xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&lt;/code>。
####2.创建配置文件。
进入用户目录下的&lt;code>.cloudflared&lt;/code>文件夹，创建名为&lt;code>config.yam&lt;/code>的文件，内容如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tunnel: &lt;span class="nv">$ID&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">credentials-file: /home/&lt;span class="nv">$username&lt;/span>/.cloudflared/&lt;span class="nv">$ID&lt;/span>.json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ingress:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ssh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - hostname: ssh.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> service: ssh://localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># vnc远程桌面，端口5900&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - hostname: vnc.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> service: tcp://localhost:5900
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 其他http服务&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - hostname: file.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> service: http://localhost:9527
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - hostname: speed-test.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> service: http://localhost:9898
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 如果都没有匹配，则返回404，这句不能少&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - service: http_status:404
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中$ID替换为上面的ID，$username为你服务器本地用户名，&lt;code>hostname&lt;/code>字段对应外网访问的网址，&lt;code>service&lt;/code>字段对应内网网址，如果是带端口的在后面增加即可。
####3.写一个脚本，自动更新DNS以及运行tunnel
&lt;code>vim ~/tunnel-sh.sh&lt;/code>
内容如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># update cloudflare DNS record
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/cloudflared tunnel route dns $tunnel-name ssh.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/cloudflared tunnel route dns $tunnel-name vnc.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/cloudflared tunnel route dns $tunnel-name file.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/cloudflared tunnel route dns $tunnel-name speed-test.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># run tunnel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/cloudflared tunnel run $tunnel-name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意把$tunnel-name和网址换成自己的。
####4.开机自启
新建一个service，
&lt;code>sudo vim /etc/systemd/system/cloudflared-tunnel.service&lt;/code>
内容如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Unit&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Description&lt;/span>&lt;span class="o">=&lt;/span>cloudflared tunnel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Wants&lt;/span>&lt;span class="o">=&lt;/span>network-online.target
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">After&lt;/span>&lt;span class="o">=&lt;/span>network-online.target
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Service&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">User&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$username&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>sh /home/&lt;span class="nv">$username&lt;/span>/tunnel-sh.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Install&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">WantedBy&lt;/span>&lt;span class="o">=&lt;/span>default.target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意把$username换成自己的。
####5.启动&amp;amp;开机自启&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl start cloudflared-tunnel.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl enable cloudflared-tunnel.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>####6.配置application
ssh是无法直接访问的，但是cloudflare提供了application套件，配置位于cloudflare的zerotrush下的access目录。
进去之后选择&lt;code>add an application&lt;/code>，类型选&lt;code>self hosted&lt;/code>
&lt;code>Application Configuration&lt;/code>配置如下：
&lt;code>Application name(Required)&lt;/code>:app名称，随意设定
&lt;code>Session Duration(Required)&lt;/code>:会话时长，设置一次会话多久超时，一般默认24即可。
&lt;code>Application domain&lt;/code>:我们在服务器上的配置中ssh访问链接为ssh.example.com，因此这里填&lt;code>ssh&lt;/code>
&lt;code>Domain(Required)&lt;/code>:域名，我们在服务器上的配置中ssh访问链接为ssh.example.com，因此这里填&lt;code>example.com&lt;/code>
然后点击next。
&lt;code>Policy&lt;/code>配置与安全性相关：，规则名称
&lt;code>Policy name&lt;/code>：随意设定
&lt;code>Action&lt;/code>:选择这个规则下的内容允许还是拒绝
&lt;code>Session duration&lt;/code>：一次会话多久过期
&lt;code>Configure rules&lt;/code>配置如下：
&lt;code>Selector&lt;/code>:规则认证方式，以email为例，会要求每次进入网页验证邮箱PIN码
&lt;code>Value&lt;/code>：规则，与&lt;code>Selector&lt;/code>相关。
然后点击next。
在&lt;code>Additional settings&lt;/code>下的&lt;code>Browser rendering&lt;/code>切换为SSH，最后点击&lt;code>add application&lt;/code>即可web访问到ssh了。&lt;/p></description></item><item><title>【转载】一个简单的archlinux安装教程（亲测能用）</title><link>https://blog.tama.guru/record/archlinux_install_guide.html</link><pubDate>Wed, 16 Aug 2023 22:35:00 +0800</pubDate><guid>https://blog.tama.guru/record/archlinux_install_guide.html</guid><description>&lt;p>来自：&lt;a class="link" href="https://www.mivm.cn/archlinux-installation-guide-simple" target="_blank" rel="noopener"
>https://www.mivm.cn/archlinux-installation-guide-simple&lt;/a>&lt;/p>
&lt;hr>
&lt;p>###硬盘分区
如果你需要 Linux + Windows 双系统，建议使用两个物理硬盘安装，以下分区方式不适用于单硬盘双系统。如果你想要单硬盘双系统，可以加入 QQ 群向我询问。&lt;/p>
&lt;p>执行&lt;code>fdisk -l&lt;/code>查看硬盘以及分区列表，确定你要用于安装系统的硬盘路径，比如这里我用的是&lt;code>/dev/sda&lt;/code>。loop 设备是光驱等虚拟设备，不是真实的硬盘，不能用于安装系统。&lt;/p>
&lt;p>确认硬盘&lt;/p>
&lt;p>如果你有多块硬盘，第一块硬盘一般为&lt;code>/dev/sda&lt;/code> 或&lt;code>/dev/nvme0n1&lt;/code> (NVME)，第二块硬盘一般为&lt;code>/dev/sdb&lt;/code> 或&lt;code>/dev/nvme0n2&lt;/code> (NVME)，以此类推。U 盘或移动硬盘也会被列出，注意不要搞错。&lt;/p>
&lt;p>如果你的硬盘没有被列出，可能是在 BIOS 开启了 RAID 模式（部分笔记本会默认开启），前往 BIOS 将硬盘模式改为 AHCI 模式即可，更改后可能会导致现有的 Windows 无法启动。&lt;/p>
&lt;p>下述分区操作将清空目标硬盘数据，请在操作前做好数据备份。&lt;/p>
&lt;p>务必将下列命令中的${diskPath}替换为你的硬盘路径。示例：&lt;code>sgdisk /dev/sda&lt;/code>&lt;/p>
&lt;p>擦除分区表：&lt;code>sgdisk -Z ${diskPath}&lt;/code>&lt;/p>
&lt;p>创建大小为 260M 的 ESP 分区 （UEFI 引导必要分区）：&lt;code>sgdisk -n=0:0:+260M -t=0:ef00 ${diskPath}&lt;/code>&lt;/p>
&lt;p>使用剩余空间创建系统分区：&lt;code>sgdisk -N=0 ${diskPath}&lt;/code>&lt;/p>
&lt;p>显示分区信息：&lt;code>fdisk -l ${diskPath}&lt;/code>，对比你的分区信息是否与下列信息相似，重点是分区类型 (Type)。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Disk ${diskPath}: *** GiB, *** bytes, *** sectors
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disk model: ***
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Units: sectors of 1 * *** = *** bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sector size (logical/physical): *** bytes / *** bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I/O size (minimum/optimal): ** bytes / *** bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disklabel type: gpt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disk identifier: ***
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Device Start End Sectors Size Type
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">${diskPath}1 *** *** *** 260M EFI System
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">${diskPath}2 *** *** *** ***G Linux filesystem
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>PS：给 ESP 分区分配 260M 空间是为了兼容不同硬盘，不同的 UEFI 固件，以及存放系统内核和 initramfs。对于某些早期或者有缺陷的 UEFI 实现，可能至少需要分配 512M。&lt;/p>
&lt;p>某些教程的分区步骤会创建一个额外的 SWAP（交换空间）分区，这里并不推荐创建，具体原因参考下面的【设置交换空间】章节&lt;/p>
&lt;p>如果你的硬盘空间较大，或者想把系统和数据分别存放在不同的分区，想要多个分区也可以。&lt;/p>
&lt;p>格式化并挂载分区
格式化 ESP 分区为 FAT32：&lt;code>mkfs.fat -F 32 ${part1Path}&lt;/code>，把${part1Path}替换为第一个分区的路径，示例：&lt;code>mkfs.fat -F 32 /dev/sda1&lt;/code>&lt;/p>
&lt;p>注意：如果你在格式化 ESP 分区的时候提示：&lt;code>WARNING: Not enough clusters for a 32 bit FAT!&lt;/code>，请尝试使用&lt;code>mkfs.fat -s 2 -F 32 ${part1Path}&lt;/code>或&lt;code>mkfs.fat -s 1 -F 32 ${part1Path}&lt;/code>命令来格式化 ESP 分区，否则 UEFI 固件可能会无法读取 ESP 分区。&lt;/p>
&lt;p>格式化系统分区为 EXT4：&lt;code>mkfs.ext4 -m 5 ${part2Path}&lt;/code>，把${part2Path}替换为第二个分区路径，示例：&lt;code>mkfs.ext4 -m 5 /dev/sda2&lt;/code>&lt;/p>
&lt;p>PS：-m是指定保留块所占百分比，默认值为 5，用作保留快的空间不能被使用。你可以减小这个值增加分区的可用空间，或者增大这个值提升固态硬盘的性能。&lt;/p>
&lt;p>如果你想要更好的性能和更现代的功能，可以在系统分区尝试使用 XFS 文件系统：&lt;code>mkfs.xfs ${part2Path}&lt;/code>&lt;/p>
&lt;p>XFS 可能需要手动维护，参考：https://wiki.archlinux.org/title/XFS&lt;/p>
&lt;p>PS：XFS 分区大小目前只支持扩容，不支持缩小。&lt;/p>
&lt;p>当然你也可以在系统分区使用其他文件系统，比如 Btrfs、JFS、F2FS 等，你可以前往 ArchWiki 查看这些文件系统的对应文档。&lt;/p>
&lt;p>挂载系统分区：&lt;code>mount ${part2Path} /mnt&lt;/code>，把${part2Path}替换为第二个分区路径，示例：&lt;code>mount /dev/sda2 /mnt&lt;/code>&lt;/p>
&lt;p>创建 ESP 分区挂载路径：&lt;code>mkdir /mnt/boot&lt;/code>&lt;/p>
&lt;p>挂载 ESP 分区：&lt;code>mount -o umask=0077 ${part1Path} /mnt/boot&lt;/code>，把${part1Path}替换为第一个分区路径，示例：&lt;code>mount -o umask=0077 /dev/sda1 /mnt/boot&lt;/code>&lt;/p>
&lt;p>检查分区是否挂载成功：df，如果输出包含类似以下行，则代表挂载成功。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Filesystem Size Used Avail Use% Mounted on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">${part2Path} *** *** *** ***% /mnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">${part1Path} *** *** *** ***% /mnt/boot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>###设置中国镜像源（推荐）
安装环境默认启用了所有的软件镜像源，为了使安装更顺利，建议只使用位于中国的镜像，如果你不在中国或者对自己的网络有信心可以忽略此操作。&lt;/p>
&lt;p>下载中国镜像列表：&lt;code>curl -L -o /etc/pacman.d/mirrorlist &amp;quot;https://archlinux.org/mirrorlist/?country=CN&amp;quot;&lt;/code>&lt;/p>
&lt;p>执行&lt;code>nano /etc/pacman.d/mirrorlist&lt;/code>编辑镜像列表文件，删除&lt;code>#Server = &lt;/code>前面的&lt;code>#&lt;/code>以启用镜像，不需要全部启用，一般 3 个就够了。某些镜像同时支持 HTTP 和 HTTPS 协议，只需要删除 HTTPS 协议行的#。&lt;/p>
&lt;p>PS：镜像列表默认按照字母排序，推荐安装完系统后选择一个速度较快的镜像，并把它放在其他镜像前面。阿里云、华为云、腾讯云 等云服务商也有 ArchLinux 软件源镜像，但是还没有加入官方镜像列表，大家可以手动添加使用。&lt;/p>
&lt;p>PPS：不同的镜像更新间隔有些许不同，而 Arch 又是一个以滚动发布著称的发行版，软件更新频率较快。如果你对更新频率有较高的要求，建议选择更新间隔较短的镜像。&lt;/p>
&lt;p>###安装系统
设置本地化环境：&lt;code>export LANG=C&lt;/code>&lt;/p>
&lt;p>安装所需软件包到系统分区：&lt;code>pacstrap /mnt base linux linux-firmware bash-completion e2fsprogs nano networkmanager pacman-contrib sudo amd-ucode intel-ucode sof-firmware&lt;/code>&lt;/p>
&lt;p>软件包介绍
base: ArchLinux 运行所需的基础软件包集合&lt;/p>
&lt;p>linux: Linux 内核&lt;/p>
&lt;p>linux-firmware: Linux 设备驱动集合，包含了绝大多数设备的驱动（固件）。&lt;/p>
&lt;p>bash-completion: Bash 补全支持&lt;/p>
&lt;p>e2fsprogs: EXT4 文件系统实用工具&lt;/p>
&lt;p>nano: 文本编辑器&lt;/p>
&lt;p>networkmanager: 网络管理器&lt;/p>
&lt;p>pacman-contrib: pacman 相关实用脚本&lt;/p>
&lt;p>sudo: 用于普通用户获取 root 权限&lt;/p>
&lt;p>amd-ucode intel-ucode: AMD 和 Intel 的 CPU 微码更新，用于修补 CPU 漏洞。&lt;/p>
&lt;p>sof-firmware: Open Sound 固件&lt;/p>
&lt;p>虚拟机用户不需要安装amd-ucode intel-ucode，物理机用户也可以只安装适用于你电脑的 CPU 的微码包，比如 AMD CPU 用户就不需要安装intel-ucode。&lt;/p>
&lt;p>如果你使用了 XFS 文件系统，将e2fsprogs替换为xfsprogs，或者替换为你的文件系统的工具包。&lt;/p>
&lt;p>如果你的设备不是笔记本可以不安装sof-firmware，也可以等到稍后设备没声音时再安装它尝试修复。&lt;/p>
&lt;p>可以趁安装的这段时间喝口水，它并不需要很久。&lt;/p>
&lt;p>成功安装完成后执行&lt;code>genfstab -U /mnt &amp;gt; /mnt/etc/fstab&lt;/code>生成 fstab 文件&lt;/p>
&lt;p>最后执行&lt;code>arch-chroot /mnt&lt;/code>进入新系统环境&lt;/p>
&lt;p>###系统初始化设置
####设置时区为中国：&lt;code>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime&lt;/code>，你也可以设置为所在的时区，完整的时区列表：https://twiki.org/cgi-bin/xtra/tzdatepick.html&lt;/p>
&lt;p>####同步硬件时钟：&lt;code>hwclock --systohc&lt;/code>&lt;/p>
&lt;p>务必将下列命令中的${hostname}替换为你的主机名（例如：kanto）。主机名建议使用小写字母组成，最多 64 个字符，你可以使用下面的输入框验证主机名是否符合规则。&lt;/p>
&lt;p>请输入主机名
####设置系统主机名：
&lt;code>echo ${hostname} &amp;gt; /etc/hostname&lt;/code>&lt;/p>
&lt;p>执行nano /etc/hosts编辑 hosts 文件并添加以下行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">127.0.0.1 localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">127.0.0.1 ${hostname}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">::1 ip6-localhost ip6-loopback
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">::1 ${hostname}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>执行&lt;code>nano /etc/locale.gen&lt;/code>编辑本地化配置文件，删除以下行前面的#，可以使用Page Up和Page Down健来快速翻页上下滚动。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#en_US.UTF-8 UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#zh_CN.UTF-8 UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#zh_TW.UTF-8 UTF-8
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果你需要其他本地化，删除其他行前的#，行末尾务必是 UTF-8。最后保存退出，执行&lt;code>locale-gen&lt;/code>生成本地化环境。&lt;/p>
&lt;p>设置默认本地化环境：&lt;code>echo LANG=en_US.UTF-8 &amp;gt; /etc/locale.conf&lt;/code>，为了确保兼容性，默认本地化环境最好是英语。&lt;/p>
&lt;p>执行&lt;code>SUDO_EDITOR=nano visudo&lt;/code>编辑 sudo 配置文件，删除&lt;code># %wheel ALL=(ALL) ALL&lt;/code>行前面的&lt;code>#&lt;/code>以便让 wheel 用户组可以使用sudo获取 root 权限。&lt;/p>
&lt;p>务必将下列命令中的${username}替换为你的用户名（例如：pikachu）。用户名建议使用小写字母组成（不能包含大写字母、不能以数字开头），最多 32 个字符，你可以使用下面的输入框验证用户名是否符合规则。&lt;/p>
&lt;p>请输入用户名
创建一个新用户并加入 wheel 用户组：&lt;code>useradd -m -G wheel -s /bin/bash ${username}&lt;/code>&lt;/p>
&lt;p>设置新用户密码：&lt;code>passwd ${username}&lt;/code>&lt;/p>
&lt;p>PS：输入密码时不会显示&lt;/p>
&lt;p>安装引导管理程序（重要）：
安装 GRUB 软件包：&lt;code>pacman -S grub&lt;/code>&lt;/p>
&lt;p>安装 GRUB 至 ESP 分区：&lt;code>grub-install --removable --target=x86_64-efi --efi-directory=/boot&lt;/code>，提示&lt;code>Installation finished. No error reported.&lt;/code>字样表示安装成功。&lt;/p>
&lt;p>生成 GRUB 配置文件：&lt;code>grub-mkconfig -o /boot/grub/grub.cfg&lt;/code>&lt;/p>
&lt;p>PS: 如果你电脑的 UEFI 固件不支持 64 位 UEFI 文件，则需要安装 32 位 UEFI 文件才能成功引导：&lt;code>grub-install --removable --target=i386-efi --efi-directory=/boot&lt;/code>&lt;/p>
&lt;p>如果你不喜欢 GRUB，或者喜欢简单的引导管理程序，可以尝试下 systemd-boot。&lt;/p>
&lt;p>退出新系统环境：&lt;code>exit&lt;/code>&lt;/p>
&lt;p>执行&lt;code>umount -R /mnt&lt;/code>卸载分区，如果没有错误，拔掉 ArchLinux 安装盘并执行reboot重启系统。&lt;/p>
&lt;p>没有意外的话，应该成功启动至新系统并看到以下界面，login 前面显示的是主机名，输入刚刚创建的新用户名和密码登陆系统。&lt;/p>
&lt;p>成功启动&lt;/p>
&lt;p>PS：如果你有多个系统，可能并不会重启至 ArchLinux，需要你手动选择 ArchLinux 启动。&lt;/p>
&lt;p>进阶设置
root 权限小贴士
sudo 是临时获取 root 权限的工具，如果需要 root 权限执行某个命令，可以使用 sudo 执行它。sudo 提供了细粒化的控制，使它更加的安全。&lt;/p>
&lt;p>虽然su也可以获取 root 权限，但是正常情况下你不应该使用它，相较 sudo，它太暴力了。如果没有设置 root 密码，su也将无法工作。&lt;/p>
&lt;p>一些命令内置了独立的提权实现，比如systemctl命令，当这些命令需要 root 权限，但是没有以 root 身份允许时，它们就会使用自己的提权实现进行提权操作。&lt;/p>
&lt;p>可以使用sudo -i临时登陆到 root 用户的 Shell。&lt;/p>
&lt;p>root 虽好，但不要滥用，使用之前应该先了解当前命令的操作是否真的需要 root 权限，滥用 root 权限轻则会导致一些程序无法正常工作，重则会危及系统安全。&lt;/p>
&lt;p>PS：ArchLinux 的 root 用户默认处于无密码锁定状态，除非你清楚自己在做什么，否则不建议解锁或设置密码。&lt;/p>
&lt;p>启用网络管理器（注意大小写）：&lt;code>sudo systemctl enable --now NetworkManager&lt;/code>&lt;/p>
&lt;p>如果是无线网络，执行nmtui使用图形界面进行配置，选择「Activate a connection」连接无线网络。&lt;/p>
&lt;p>如果你还想继续使用 SSH 远程控制，执行&lt;code>sudo pacman -S openssh&lt;/code>安装 OpenSSH，然后执行&lt;code>sudo systemctl start sshd&lt;/code>启动 SSH 服务器。&lt;/p>
&lt;p>不过此时就不能使用 root 用户登陆 SSH 了，需要使用刚刚创建的新用户。&lt;/p>
&lt;p>禁用网络管理器的连接等待（注意大小写）：&lt;code>sudo systemctl disable NetworkManager-wait-online&lt;/code>，禁用后可以加快系统启动，不会有副作用，除非某些自动启动的服务需要互联网。&lt;/p>
&lt;p>启用从网络同步系统时间：&lt;code>sudo timedatectl set-ntp true&lt;/code>&lt;/p>
&lt;p>启用本地 DNS 解析器（可选，建议启用）：&lt;code>sudo systemctl enable --now systemd-resolved&lt;/code>&lt;/p>
&lt;p>创建 DNS 解析文件软链接（依赖上一个操作）：&lt;code>sudo ln -sf /run/systemd/resolve/stub-resolv.conf /etc/resolv.conf&lt;/code>&lt;/p>
&lt;p>启用每周自动清理不需要的 Pacman 软件包缓存（可选，建议启用）：&lt;code>sudo systemctl enable paccache.timer&lt;/code>&lt;/p>
&lt;p>如果你使用的硬盘支持 TRIM 特性（大多数固态硬盘都支持），建议启用定时执行 TRIM：&lt;code>sudo systemctl enable fstrim.timer&lt;/code>&lt;/p>
&lt;p>如果你需要使用 Wine、Steam 或其他的 32 位程序，执行&lt;code>sudo nano /etc/pacman.conf&lt;/code>编辑 Pacman 配置文件，删除以下行前面的#以启用 32 位系统库支持。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#[multilib]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#Include = /etc/pacman.d/mirrorlist
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存后执行sudo pacman -Sy更新软件数据库&lt;/p>
&lt;p>添加 ArchLinuxCN 存储库（推荐）：
Arch Linux 中文社区仓库是由 Arch Linux 中文社区驱动的非官方软件仓库，包含许多官方仓库未提供的额外的软件包，以及已有软件的 git 版本等变种。一部分软件包的打包脚本来源于 AUR，但也有许多包与 AUR 不一样。（关于 AUR 的介绍请见下面的章节）&lt;/p>
&lt;p>ArchLinuxCN 依靠镜像加速可以在国内提供比 AUR 更好的体验，而且还省去了部分软件的编译过程。如果你的网络环境导致无法顺利从 AUR 安装某些软件包，推荐添加。&lt;/p>
&lt;p>执行&lt;code>sudo nano /etc/pacman.conf&lt;/code>编辑 Pacman 配置文件，在底部添加以下行。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[archlinuxcn]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Server = https://opentuna.cn/archlinuxcn/$arch
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存后执行&lt;code>sudo pacman -Sy archlinuxcn-keyring&lt;/code>更新软件数据库并安装 ArchLinuxCN GPG 密钥，如果安装命令出现&lt;code>error: archlinuxcn-keyring: Signature from &amp;quot;Jiachen YANG (Arch Linux Packager Signing Key) &amp;quot; is marginal trust&lt;/code>这样的错误，执行命令&lt;code>sudo pacman-key --lsign-key &amp;quot;farseerfc@archlinux.org&amp;quot;&lt;/code>修复，然后再重新执行安装命令。&lt;/p>
&lt;p>安装防火墙支持（可选）：
如果你需要在非信任的网络下使用设备，推荐使用防火墙增强你的设备网络安全性，如果你只在你信任的网络下使用设备，那么可以不安装。&lt;/p>
&lt;p>防火墙有很多选择，ArchLinux 的基础包默认已经包含了 iptables 实用工具，用于配置 Linux 内核实现的防火墙，不过由于它并不易用，我推荐最好是使用易用的 iptables 前端。&lt;/p>
&lt;p>我推荐大家安装 Firewalld，它简单易用，并且我们待会安装的桌面环境可以很好的集成它，便于使用图形界面管理。其他 iptables 前端可参考：https://wiki.archlinux.org/title/Iptables#Front-ends&lt;/p>
&lt;p>安装防火墙：&lt;code>sudo pacman -S firewalld&lt;/code>&lt;/p>
&lt;p>启用防火墙：&lt;code>sudo systemctl enable --now firewalld&lt;/code>&lt;/p>
&lt;p>Firewalld 更多信息：https://wiki.archlinux.org/title/Firewalld&lt;/p>
&lt;p>###安装显卡驱动、Vulkan 和硬件加速支持：
如果不知道该装那个，可以加入 QQ 群向我询问。&lt;/p>
&lt;p>小山只实际测试过 AMD 和 Intel 的显卡驱动安装，Nvidia 显卡驱动安装尚未测试。&lt;/p>
&lt;p>Vulkan 是跨平台图形接口，目前主要用途是在 Linux 下运行 Windows 游戏以及部分 Linux 游戏（详见：Linux 运行 Windows 游戏指南），但并不是所有显卡都支持它，你可以前往 &lt;a class="link" href="https://vulkan.gpuinfo.org/listreports.php?platform=linux" target="_blank" rel="noopener"
>https://vulkan.gpuinfo.org/listreports.php?platform=linux&lt;/a> 查询你的显卡是否支持 Vulkan。&lt;/p>
&lt;p>OpenCL 是可选的，推荐需要时再安装。&lt;/p>
&lt;p>如果你没有启用 32 位系统库支持，执行下列命令时务必删除lib32开头的软件包。&lt;/p>
&lt;p>####AMD
#####图形加速库
&lt;code>sudo pacman -S mesa&lt;/code>&lt;/p>
&lt;p>#####硬件视频加速
&lt;code>sudo pacman -S mesa-vdpau libva-mesa-driver lib32-mesa lib32-mesa-vdpau lib32-libva-mesa-driver lib32-opencl-clover-mesa&lt;/code>
&lt;strong>注：原文 &lt;code>lib32-opencl-mesa&lt;/code>已不适用,换用&lt;code>ib32-opencl-clover-mesa&lt;/code>&lt;/strong>&lt;/p>
&lt;p>#####Vulkan：
&lt;code>sudo pacman -S vulkan-icd-loader vulkan-radeon lib32-vulkan-icd-loader lib32-vulkan-radeon&lt;/code>&lt;/p>
&lt;p>#####OpenCL
&lt;code>sudo pacman -S ocl-icd&lt;/code>
&lt;strong>注：原文&lt;code>opencl-mesa&lt;/code>已不适用，废除。&lt;/strong>&lt;/p>
&lt;p>andvlk 是由 AMD 开源的 AMD GPU Vulkan 实现，这个实现比 Mesa 的 RADV 在某些场景下性能要好一些，并且系统允许安装多个 Vulkan 实现并让软件进行选择，推荐游戏玩家安装。&lt;/p>
&lt;p>####Intel
#####图形加速库
&lt;code>sudo pacman -S mesa&lt;/code>&lt;/p>
&lt;p>硬件视频加速：如果你的 Intel CPU 架构是 Broadwell 或以上（包括 Intel Arc 显卡）的安装intel-media-driver，反之则安装libva-intel-driver。&lt;/p>
&lt;p>#####Vulkan
&lt;code>sudo pacman -S vulkan-icd-loader vulkan-intel lib32-mesa lib32-vulkan-icd-loader lib32-vulkan-intel&lt;/code>&lt;/p>
&lt;p>OpenCL：如果你的 Intel CPU 架构是 Broadwell 或以上（包括 Intel Arc 显卡）的安装intel-compute-runtime ocl-icd，反之则安装beignet ocl-icd，beignet 需要通过 AUR 安装。&lt;/p>
&lt;p>####Nvidia
前往 &lt;a class="link" href="https://www.nvidia.com/en-us/drivers/unix/legacy-gpu/" target="_blank" rel="noopener"
>https://www.nvidia.com/en-us/drivers/unix/legacy-gpu/&lt;/a> 查看 Nvidia 私有驱动最新版本不支持的显卡列表，如果你的显卡不在这个列表里，那么你可以使用最新的 Nvidia 私有驱动，反之则需要使用开源驱动或旧版私有驱动（通过 AUR 安装）。&lt;/p>
&lt;p>#####Nvidia 私有驱动
&lt;code>sudo pacman -S nvidia nvidia-settings cuda xorg-server-devel lib32-nvidia-utils&lt;/code>&lt;/p>
&lt;p>#####Nvidia 开源驱动 (RTX 3000 系列或更高)
&lt;code>sudo pacman -S nvidia-open nvidia-settings cuda xorg-server-devel lib32-nvidia-utils&lt;/code>&lt;/p>
&lt;p>#####OpenCL
&lt;code>sudo pacman -S opencl-nvidia ocl-icd lib32-opencl-nvidia&lt;/code>&lt;/p>
&lt;p>Nouveau 是 Linux 内核的 Nvidia 显卡开源驱动，由于 Nvidia 新显卡需要签名固件，所以它无法支持一些较新系列的显卡，推荐 GTX 700 或以下系列使用。&lt;/p>
&lt;p>#####Nouveau 图形加速库
&lt;code>sudo pacman -S mesa&lt;/code>&lt;/p>
&lt;p>#####Nouveau 硬件视频加速
&lt;code>sudo pacman -S mesa-vdpau libva-mesa-driver lib32-mesa lib32-mesa-vdpau lib32-libva-mesa-driver&lt;/code>&lt;/p>
&lt;p>PS：如果是双显卡的笔记本，运行软件时可以选择使用的显卡（默认是集成显卡）。参见：https://wiki.archlinux.org/title/PRIME&lt;/p>
&lt;p>如果你不需要桌面环境，那么你的安装到这里就可以结束了，也可以看看下面的 AUR 介绍和推荐阅读。
安装显示管理器和桌面环境：
本指南以 KDE Plasma 桌面环境 + SDDM 显示管理器为例&lt;/p>
&lt;p>Plasma 是功能全面且对新手友好的桌面环境，具有高度可定制性，并且它在最近的更新中，性能提升了很多。&lt;/p>
&lt;p>SDDM 显示管理器是 Plasma 推荐的显示管理器&lt;/p>
&lt;p>如果你想使用其他桌面环境或显示管理器，建议前往其他桌面环境或显示管理器的 ArchWiki 页面详细了解&lt;/p>
&lt;p>桌面环境列表：https://wiki.archlinux.org/title/Desktop_environment#List_of_desktop_environments&lt;/p>
&lt;p>显示管理器列表：https://wiki.archlinux.org/title/Display_manager#List_of_display_managers&lt;/p>
&lt;p>#####安装桌面环境、显示管理器、终端（Konsole）以及 Noto 字体集
&lt;code>sudo pacman -S --noconfirm plasma sddm konsole noto-fonts noto-fonts-cjk noto-fonts-emoji&lt;/code>&lt;/p>
&lt;p>#####安装 Plasma 可选依赖（使其更好的工作）
&lt;code>sudo pacman -S --asdeps gst-plugins-good packagekit-qt5 xsettingsd&lt;/code>&lt;/p>
&lt;p>如果你是笔记本用户，推荐安装fwupd以便通过 LVFS 接受来自厂商的固件更新（需要厂商支持），以及安装power-profiles-daemon获取电源配置文件支持（需要设备支持）。&lt;/p>
&lt;p>可能无用的软件包
plasma 是个软件包组，里面可能会有一些用不上的软件包。&lt;/p>
&lt;p>以下软件包根据需求决定是否需要卸载&lt;/p>
&lt;p>drkonqi: KDE 崩溃处理程序&lt;/p>
&lt;p>kgamma5: 调整显示器的伽玛设置（已不存在）&lt;/p>
&lt;p>ksshaskpass: ssh-add 密码助手&lt;/p>
&lt;p>plasma-firewall: 防火墙管理界面&lt;/p>
&lt;p>plasma-sdk: Plasma 开发工具包&lt;/p>
&lt;p>plasma-thunderbolt: Thunderbolt（雷电）设备管理界面&lt;/p>
&lt;p>plasma-vault: 创建加密的保险库（需要额外的可选依赖）&lt;/p>
&lt;p>plasma-workspace-wallpapers: Plasma 桌面的额外壁纸&lt;/p>
&lt;p>卸载以上列出的软件包：sudo pacman -Rns drkonqi ksshaskpass plasma-firewall plasma-sdk plasma-thunderbolt plasma-vault plasma-workspace-wallpapers&lt;/p>
&lt;p>#####安装蓝牙支持（可选）：
安装：sudo pacman -S bluedevil&lt;/p>
&lt;p>安装可选依赖（蓝牙音频支持）：sudo pacman -S &amp;ndash;asdeps pulseaudio-bluetooth&lt;/p>
&lt;p>启用：&lt;code>sudo systemctl enable bluetooth&lt;/code>&lt;/p>
&lt;p>设置交换空间（可选）
交换空间（Swap）是硬盘上的一块区域，通俗的讲就是虚拟内存，跟 Windows 下的虚拟内存（分页文件）是一样的，当物理内存不够用时内核会把部分物理内存数据转移到交换空间，从而使需要更多内存的程序可以运行。&lt;/p>
&lt;p>交换空间是可选的，如果你的物理内存不够大，那么你可以使用交换空间使内存利用更高效，如果你的物理内存足够使用，也可以不需要使用交换空间。&lt;/p>
&lt;p>由于交换空间是使用硬盘作为存储介质，所以它无法达到像物理内存的速度，特别是在机械硬盘或 SATA 固态硬盘上面，如果硬盘速度太慢，会使交换空间弊大于利。&lt;/p>
&lt;p>可能某些人会告诉你虚拟内存的大小务必是物理内存的两倍，无论是 Windows 还是 Linux，这种说法是完全错误的，虚拟内存的大小完全根据需求决定（Windows 默认会自动管理虚拟内存大小）。&lt;/p>
&lt;p>如果要使用交换空间，你也可以尝试一下 Zswap 和 ZRAM，两者皆在物理内存中提供压缩的交换空间，从而使物理内存可以容纳更多的数据，减少硬盘上的交换空间的 I/O 操作，有效延长固态硬盘寿命，代价是使用更多的 CPU。&lt;/p>
&lt;p>注意：当你启用了交换空间，部分桌面的电源菜单会出现「休眠」选项，但是它并不会工作，因为休眠需要配置内核参数以及 initramfs hook。参见：https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate#Hibernation&lt;/p>
&lt;p>交换分区 VS 交换文件：
交换空间用硬盘上的一块区域作为虚拟内存，这块区域既可以是一个文件，也可以是一个完整的分区。&lt;/p>
&lt;p>以前 Linux 安装会建议为交换空间创建一个单独的分区，以确保交换空间的最佳性能。这种做法是因为在当时大多数电脑还是机械硬盘，机械硬盘起始扇区的速度可能会更快，完整的分区还可以避免碎片等问题。但是缺点也很明显，一旦建立分区，调整大小会非常麻烦，自由度较低。&lt;/p>
&lt;p>现在的电脑大多数都使用固态硬盘，没有了机械硬盘的一些限制，所以更推荐使用交换文件，可以使交换空间更加灵活。&lt;/p>
&lt;p>推荐使用 systemd-swap 来管理交换空间、Zswap 或 ZRAM，它可以根据当前内存和交换空间的使用情况自动创建新的交换空间，同时也可以比较方便的管理 Zswap 和 ZRAM。不过由它创建的交换文件并不能用于系统休眠，如果你有系统休眠需求，建议手动创建。&lt;/p>
&lt;p>更多关于交换空间请参考：https://wiki.archlinux.org/title/Swap&lt;/p>
&lt;p>更改显示管理器（SSDM）本地化环境（可选）：
如果要让 SDDM 的本地化环境为非英文，可以执行以下更改。&lt;/p>
&lt;p>PS：本地化环境除了影响语言显示，还有时间格式。&lt;/p>
&lt;p>执行&lt;code>sudo SYSTEMD_EDITOR=nano systemctl edit sddm&lt;/code>编辑 SDDM 服务单元，在文件第 3 行添加：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[Service]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Environment=LANG=zh_CN.UTF-8
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果是其他语言用户，可以把zh_CN替换为你需要的本地化。&lt;/p>
&lt;p>执行&lt;code>sudo systemctl enable sddm&lt;/code>启用 SDDM&lt;/p>
&lt;p>执行sudo reboot重启系统，重启后应该会看到如下图所示的界面，输入密码登陆桌面环境。&lt;/p>
&lt;p>如果没有看到如下图所示的界面，可能是显卡驱动的安装有问题。&lt;/p>
&lt;p>SSDM&lt;/p>
&lt;p>###Plasma 桌面环境配置
点击屏幕左下角的按钮打开应用启动器，点击「System Settings」打开系统设置。&lt;/p>
&lt;p>点击「Regional Setting」，点击系统设置界面右下角的「Add languages&amp;hellip;」添加简体中文和繁体中文，并把英文排到最后，简繁排第一和第二，然后点击右下角的「Apply」。点击左侧的「Formats」，选择「Regional」为「中国 - 简体中文 (zh_CN)」，或者选择你所在的区域，然后点击右下角的「Apply」。&lt;/p>
&lt;p>PS：简繁的优先级顺序取决于个人，因为有些程序可能没有简体或繁体翻译，简繁同时存在可以在没有其中一种翻译的情况下使用另一种翻译，如果两个都没有再使用英文。&lt;/p>
&lt;p>按下Ctrl + Alt + Delete，选择「Log Out」注销会话并重新登录使其生效。&lt;/p>
&lt;p>注：如果注销后发现图形界面为半中半英的，可以把&lt;code>~/.config/plasma-localerc&lt;/code>中&lt;code>Formats&lt;/code>的&lt;code>zh_CN&lt;/code>修改为&lt;code>zh_CN.UTF-8&lt;/code>.并注销桌面。&lt;/p>
&lt;p>在应用启动器里找到「Konsole」，也可以通过快捷键Ctrl + Alt + T打开，这是 Plasma 桌面下的终端。&lt;/p>
&lt;p>安装输入法、浏览器和其他实用软件
你也可以完全按照偏好去选择其他软件，或者不安装，下面有每个软件包的介绍。&lt;/p>
&lt;p>安装：&lt;code>sudo pacman -S --noconfirm dolphin ark kwrite gwenview fcitx5-im fcitx5-chinese-addons fcitx5-pinyin-zhwiki firefox firefox-i18n-zh-cn firefox-i18n-zh-tw&lt;/code>&lt;/p>
&lt;p>安装 dolphin 可选依赖（视频缩略图支持）：&lt;code>sudo pacman -S --asdeps ffmpegthumbs&lt;/code>&lt;/p>
&lt;p>安装 ark 可选依赖（更多压缩包格式支持）：&lt;code>sudo pacman -S --asdeps lrzip lzop p7zip unrar&lt;/code>&lt;/p>
&lt;p>安装 gwenview 可选依赖（更多图片格式支持）：&lt;code>sudo pacman -S --asdeps qt5-imageformats&lt;/code>&lt;/p>
&lt;p>软件包介绍
dolphin = 文件管理器、ark = 压缩工具、kwrite = 文本编辑器、gwenview = 图片浏览器，这些软件都属于 KDE 家族，搭配 KDE Plasma 桌面使用更佳。&lt;/p>
&lt;p>fcitx5-im: Fcitx5 输入法框架的软件包组（或许你喜欢 IBus？）&lt;/p>
&lt;p>fcitx5-chinese-addons: Fcitx5 中文插件集合，包含拼音输入法等插件。&lt;/p>
&lt;p>fcitx5-pinyin-zhwiki: 来自 zh.wikipedia.org 的 Fcitx5 拼音输入法字典&lt;/p>
&lt;p>更多基于 Fcitx5 的中文输入法：https://wiki.archlinux.org/title/Fcitx5#Chinese&lt;/p>
&lt;p>firefox: FireFox 浏览器&lt;/p>
&lt;p>firefox-i18n-zh-cn firefox-i18n-zh-tw: FireFox 的简繁中文语言包，你也可以只安装需要的语言包。&lt;/p>
&lt;p>如果你更偏爱使用 Chromium / Google Chrome 浏览器，可以安装chromium软件包。&lt;/p>
&lt;p>PS：Chromium 是开源版的 Google Chrome，它们的区别参见 &lt;a class="link" href="https://en.wikipedia.org/wiki/Chromium_%28web_browser%29#Differences_from_Google_Chrome" target="_blank" rel="noopener"
>https://en.wikipedia.org/wiki/Chromium_(web_browser)#Differences_from_Google_Chrome&lt;/a>。Google Chrome 可以通过 AUR 或 ArchLinuxCN 安装。&lt;/p>
&lt;p>PPS：2021年3月15日起 Chromium 不再支持与 Google API 相关的功能，包括 Google 账户登陆和同步等。如果你需要使用这些功能，最佳方法是安装 Google Chrome，还有一种方法可以使 Chromium 恢复这些功能支持，你可以前往 ArchWiki 了解或加入 QQ 群向我询问。&lt;/p>
&lt;p>更多 KDE 家族应用：apps.kde.org&lt;/p>
&lt;p>执行nano ~/.bash_profile配置输入法环境变量，添加以下行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GTK_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">QT_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">XMODIFIERS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">im&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">SDL_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>PS：输入法需要重启系统或重新登录才会生效&lt;/p>
&lt;p>输入法默认激活快捷键：Ctrl + 空格&lt;/p>
&lt;p>输入法的设置可以在 「系统设置」→「区域设置」→「输入法」修改，你可以点击「添加输入法」来添加拼音或其他输入法。&lt;/p>
&lt;p>Plasma 设置优化
外观 → 字体：除了等宽字体，其余字体修改为 [Sans Serif]（无衬线）。如果你觉得字体看起来不正常（对比下图），可以加入 QQ 群与我交流。&lt;/p>
&lt;p>开机和关机 → 登陆屏幕 (SDDM)： 主题更改为「微风」&lt;/p>
&lt;p>Discover 可以用于安装/更新/卸载系统软件包和 Plasma 插件/主题，还有来自 LVFS 的固件更新。&lt;/p>
&lt;p>删除安装过程中下载的软件包：&lt;code>sudo pacman -Scc --noconfirm&lt;/code>&lt;/p>
&lt;p>重启系统开启你的 ArchLinux 之旅&lt;/p>
&lt;p>ArchLinux For Plamsa&lt;/p>
&lt;h4 id="安装-aur-软件包管理器可选">安装 AUR 软件包管理器（可选）
&lt;/h4>&lt;p>什么是 AUR？&lt;/p>
&lt;p>AUR 全称是 Arch User Repository（Arch 用户软件仓库），AUR 软件包由来自社区的用户进行维护，他们上传编写好的软件包构建脚本，其他用户可以使用这些构建脚本自动生成软件包并安装。&lt;/p>
&lt;p>官方仓库没有的软件包，或者是官方仓库软件包的开发或过时版本，基本上都可以在 AUR 找到，所以 ArchLinux 安装第三方软件包非常方便。&lt;/p>
&lt;p>AUR: aur.archlinux.org&lt;/p>
&lt;p>ArchWiki 的 AUR 页面：https://wiki.archlinux.org/title/Arch_User_Repository&lt;/p>
&lt;p>PS：AUR 的软件包大多数都没有经过测试，使用风险需要自己承担。&lt;/p>
&lt;p>AUR 软件包的安装和更新默认需要手动操作，并不能像使用 pacman 那样方便的安装和更新，不过一些优秀的 AUR 包管理工具可以让你像使用 pacman 安装存储库包那样安装 AUR 包。&lt;/p>
&lt;p>我推荐使用 yay 作为 AUR 包的管理工具，因为它的使用方法和 pacman 基本一致，可以大幅度降低学习成本。&lt;/p>
&lt;p>不过还是推荐大家学习如何手动安装 AUR 软件包，以备不时之需，下面安装 yay 的操作就是安装大多数 AUR 软件包的步骤。&lt;/p>
&lt;p>如果是第一次安装 AUR 软件包，需要安装所需依赖：sudo pacman -S &amp;ndash;noconfirm &amp;ndash;needed base-devel git&lt;/p>
&lt;p>安装 yay 步骤：&lt;/p>
&lt;p>前往 AUR 的 yay 页面查看 「Git Clone URL」：https://aur.archlinux.org/packages/yay&lt;/p>
&lt;p>使用 git 克隆存储库：git clone &lt;a class="link" href="https://aur.archlinux.org/yay.git" target="_blank" rel="noopener"
>https://aur.archlinux.org/yay.git&lt;/a> ~/aur-yay-repo&lt;/p>
&lt;p>转到存储库目录：cd ~/aur-yay-repo&lt;/p>
&lt;p>构建软件包并安装：makepkg -i -r -s&lt;/p>
&lt;p>清理工作：cd ~ &amp;amp;&amp;amp; rm -rf ~/aur-yay-repo&lt;/p>
&lt;p>现在可以使用 yay 来管理存储库软件包和 AUR 软件包了，如果已添加的存储库不存在对应的包，yay 会自动在 AUR 中搜索，如果找到的话就开始安装操作。&lt;/p>
&lt;p>用法：&lt;/p>
&lt;p>如果不加任何参数执行 yay，它默认执行更新所有软件包操作：yay&lt;/p>
&lt;p>安装软件包：yay -S &amp;lt;package_name&amp;gt; or yay -S &amp;ndash;aur &amp;lt;package_name&amp;gt; # 只从 AUR 获取包&lt;/p>
&lt;p>更新所有软件包：yay -Syu&lt;/p>
&lt;p>只更新 AUR 软件包：yay -Su &amp;ndash;aur&lt;/p>
&lt;p>只更新存储库软件包：yay -Syu &amp;ndash;repo&lt;/p>
&lt;p>yay 更多用法参考：https://github.com/Jguer/yay#readme&lt;/p>
&lt;p>PS：如果你添加了 ArchLinuxCN 软件存储库，因为它包含了一些 AUR 软件包，所以你可以使用 pacman 安装某些 AUR 软件包。或者，你也可以使用&amp;ndash;aur参数让 yay 只从 AUR 获取包，相反你也可以使用&amp;ndash;repo参数让 yay 只从存储库获取包。&lt;/p>
&lt;p>注意：不要使用 root 权限执行 yay 或任何 AUR 相关的命令，它们会在需要 root 权限时使用 sudo。&lt;/p>
&lt;h4 id="关于多系统启动">关于多系统启动
&lt;/h4>&lt;p>如果你的系统分别安装在不同的硬盘，那么只需要在电脑启动的时候引导不同的硬盘就可以了。&lt;/p>
&lt;p>你也可以通过安装os-prober使 GRUB 自动检测已安装的其他系统，并将其添加到 GRUB 启动菜单。安装完成后，添加GRUB_DISABLE_OS_PROBER=false到/etc/default/grub，重新生成 GRUB 配置文件：grub-mkconfig -o /boot/grub/grub.cfg。如果你又安装了其他系统，则需要再次重新生成 GRUB 配置文件。&lt;/p>
&lt;p>关于 os-prober 更多用法以及注意事项：https://wiki.archlinux.org/title/GRUB#Detecting_other_operating_systems&lt;/p>
&lt;h4 id="安装xrdp需要yay或paru">安装Xrdp（需要yay或paru)
&lt;/h4>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yay -S xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xorgxrdp-glamor #针对amd和intel集显的调用
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pacman -S xorg-xinit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改&lt;code>/etc/X11/Xwrapper.config&lt;/code>添加如下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">allowed_users=anybody
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">needs_root_rights=no
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>再接下来，复制xinit配置文件到用户根目录：&lt;code>cp /etc/X11/xinit/xinitrc ~/.xinitrc&lt;/code> ，并修改最后几行为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#twm &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xclock -geometry 50x50-1+1 &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xterm -geometry 80x50+494+51 &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xterm -geometry 80x20+494-0 &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#exec xterm -geometry 80x66+0+0 -name login&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 声音&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">PULSE_SCRIPT&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xrdp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pulse&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">default&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pa&lt;/span> &lt;span class="n">pulseaudio&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">daemonize&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">no&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pulseaudio&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># kde-plasma桌面&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">DESKTOP_SESSION&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">plasma&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">plasma&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">dbus&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">needed&lt;/span> &lt;span class="n">startplasma&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">x11&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启用相关服务并重启系统：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl enable xrdp.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl enable xrdp-sesman.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo reboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果xrdp无法弹出授权框，可以修改&lt;code>/etc/polkit-1/rules.d/49-nopasswd_global.rules&lt;/code>为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/* Allow members of the wheel group to execute any actions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * without password authentication, similar to &amp;#34;sudo NOPASSWD:&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">polkit.addRule(function(action, subject) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if (subject.isInGroup(&amp;#34;wheel&amp;#34;)) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return polkit.Result.YES;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>来允许所有请求。&lt;/p>
&lt;h4 id="建议阅读">建议阅读
&lt;/h4>&lt;p>建议阅读以下 Wiki 以便更好的使用 ArchLinux：&lt;/p>
&lt;p>应用程序列表：https://wiki.archlinux.org/title/List_of_applications，你可以在这里按照用途类型找到可用软件。&lt;/p>
&lt;p>一般建议：https://wiki.archlinux.org/title/General_recommendations&lt;/p>
&lt;p>系统维护：https://wiki.archlinux.org/title/System_maintenance&lt;/p>
&lt;p>systemctl 基本用法：https://wiki.archlinux.org/title/Systemd#Basic_systemctl_usage&lt;/p>
&lt;p>pacman 软件包管理器：https://wiki.archlinux.org/title/Pacman，安装/卸载/更新软件全靠它。&lt;/p>
&lt;p>CPU 调频：https://wiki.archlinux.org/title/CPU_frequency_scaling&lt;/p>
&lt;p>蓝牙：https://wiki.archlinux.org/title/Bluetooth&lt;/p>
&lt;p>Synaptics 触摸板：https://wiki.archlinux.org/title/Touchpad_Synaptics，建议 Synaptics 触摸板的笔记本用户阅读。&lt;/p>
&lt;p>Bash：https://wiki.archlinux.org/title/Bash&lt;/p>
&lt;p>腾讯 QQ：https://wiki.archlinux.org/title/Tencent_QQ&lt;/p>
&lt;p>中国大陆用户的推荐解决方案：https://wiki.archlinux.org/title/General_recommendations#中国大陆用户的推荐解决方案&lt;/p></description></item><item><title>[nonebot插件]修仙2.0框架的帮助合辑</title><link>https://blog.tama.guru/record/xiuxian2-0.html</link><pubDate>Tue, 15 Aug 2023 00:28:41 +0800</pubDate><guid>https://blog.tama.guru/record/xiuxian2-0.html</guid><description>&lt;p>这玩意的内容是真的多&amp;hellip;光是帮助就好长，看都看不过来，这里做个汇总。&lt;/p>
&lt;hr>
&lt;p>###帮助内容整合：
####1、我要修仙:进入修仙模式
####2、我的修仙信息:获取修仙数据
####3、修仙签到:获取灵石及修为
####4、重入仙途:重置灵根数据,每次108880灵石
####5、风控帮助:发送&amp;quot;风控帮助&amp;quot;获取
####6、改名xx:修改你的道号
####7、突破:修为足够后,可突破境界(一定几率失败)
####8、闭关、出关、灵石出关、灵石修炼、双修:修炼增加修为,挂机功能
####9、送灵石180@xxx,偷灵石@xxx,抢灵石@xxx
####10、排行榜:修仙排行榜,灵石排行榜,战力排行榜,宗门排行榜
####11、悬赏令
#####11.1、悬赏令:获取对应实力的悬赏令
#####11.2、悬赏令刷新:刷新当前悬赏令,每日免费{count}次
####实力支持：江湖好手|搬血境|洞天境|化灵境|铭纹境|列阵境|尊者境|神火境|真一境|圣祭境|天神境|虚道境
#####11.3、悬赏令终止:终止当前悬赏令任务
#####11.4、悬赏令结算:结算悬赏奖励
#####11.5、悬赏令接取+编号：接取对应的悬赏令
#####11.6、最后的悬赏令:用于接了悬赏令却境界突破导致卡住的道友使用&amp;quot;
####12、我的状态:查看当前HP,我的功法:查看当前技能
####13、宗门系统:发送&amp;quot;宗门帮助&amp;quot;获取
#####13.1我的宗门:查看当前所处宗门信息
#####13.2、创建宗门:创建宗门，需求：灵石，需求境界
#####13.3、加入宗门:加入一个宗门
#####13.4、宗门职位变更:宗主可以改变宗门成员的职位等级【0 1 2 3 4】分别对应【宗主 长老 亲传 内门 外门】外门弟子无法获得宗门修炼资源
#####13.5、宗门捐献:建设宗门，提高宗门建设度，每{config[&amp;ldquo;&amp;ldquo;等级建设度&amp;rdquo;&amp;rdquo;]}建设度会提高1级攻击修炼等级上限
#####13.6、退出宗门:退出当前宗门
#####13.7、踢出宗门:踢出对应宗门成员,需要输入正确的qq号或at对方
#####13.8、宗主传位:宗主可以传位宗门成员
#####13.9、升级攻击修炼:升级道友的攻击修炼等级,每级修炼等级提升4%攻击力
#####13.10、宗门列表:查看所有宗门列表
#####13.11、宗门任务接取、我的宗门任务:接取宗门任务，可以增加宗门建设度和资材，每日上限：{config[&amp;ldquo;&amp;ldquo;每日宗门任务次上限&amp;rdquo;&amp;rdquo;]}次
#####13.12、宗门任务完成:完成所接取的宗门任务，完成间隔时间：{config[&amp;ldquo;&amp;ldquo;宗门任务完成cd&amp;rdquo;&amp;rdquo;]}秒
#####13.13、宗门任务刷新:刷新当前所接取的宗门任务，刷新间隔时间：{config[&amp;ldquo;&amp;ldquo;宗门任务刷新cd&amp;rdquo;&amp;rdquo;]}秒
#####13.14、宗门功法、神通搜寻:宗主可消耗宗门资材和宗门灵石搜寻功法或者神通
#####13.15、学习宗门功法、神通:宗门成员可消耗宗门资材来学习宗门功法或者神通，后接功法名称
#####13.16、宗门功法查看:查看当前宗门已有的功法
#####13.17、宗门成员查看、查看宗门成员:查看所在宗门的成员信息
#####13.18、宗门丹房建设、建设宗门丹房:建设宗门丹房，可以让每个宗门成员每日领取丹药
#####13.19、宗门丹药领取、领取宗门丹药领取:领取宗门丹药&amp;quot;
####15、世界BOSS:发送&amp;quot;世界boss帮助&amp;quot;获取
#####15.1、生成世界boss:生成一只随机大境界的世界Boss,超管权限
#####15.2、查询世界boss:查询本群全部世界Boss,可加Boss编号查询对应Boss信息
#####15.3、世界boss开启、关闭:开启后才可以生成世界Boss,管理员权限
#####15.4、讨伐boss、讨伐世界boss:讨伐世界Boss,必须加Boss编号
#####15.5、世界boss帮助、世界boss:获取世界Boss帮助信息
#####15.6、天罚boss、天罚世界boss:删除世界Boss,必须加Boss编号,管理员权限
#####15.7、世界积分查看:查看自己的世界积分,和世界积分兑换商品
#####15.8、世界积分兑换+编号：兑换对应的商品&amp;quot;
####16、功法/灵田:发送“功法帮助/灵田帮助”查看,当前获取途径看“宗门帮
#####16.1、我的功法:查看自身功法信息
#####16.2、切磋:at对应人员,不会消耗气血
#####16.3、洞天福地购买:购买洞天福地
#####16.4、洞天福地查看:查看自己的洞天福地
#####16.5、洞天福地改名+名字：修改自己洞天福地的名字
#####16.6、灵田开垦:提升灵田的等级,提高灵田结算的药材数量
#####16.7、抑制黑暗动乱:清除修为浮点数
#####16.8、我的双修次数:查看剩余双修次数&amp;quot;
####17、背包/交友:发送&amp;quot;背包帮助&amp;quot;获取
#####17.1、我的背包、我的物品:查看自身背包前98个物品的信息
#####17.2、使用+物品名字：使用物品,丹药可批量使用
#####17.3、换装+装备名字：卸载目标装备
#####17.4、坊市购买+物品编号:购买坊市内的物品
#####17.5、坊市查看、查看坊市:查询坊市在售物品
#####17.6、坊市上架:坊市上架 物品 金额 数量，上架背包内的物品,最低金额50w
#####17.7、系统坊市上架:系统坊市上架 物品 金额 数量，上架任意存在的物品，超管权限
#####17.8、坊市下架+物品编号：下架坊市内的物品，管理员和群主可以下架任意编号的物品！
#####17.9、群交流会开启、关闭:开启交友行功能，管理员指令，注意：会在机器人所在的全部已开启此功能的群内通报交友消息
#####17.10、交友+金额：对本次交友会的物品进行交友
#####17.11、炼金+物品名字：将物品炼化为灵石,支持批量炼金和绑定丹药炼金
#####17.12、背包帮助:获取背包帮助指令
#####17.13、查看修仙界物品:支持类型【功法|神通|丹药|合成丹药|法器|防具】
#####17.14、清空坊市:清空本群坊市,管理员权限
#####非指令：
#####a、定时生成交友会,每天{auction_time_config[&amp;lsquo;hours&amp;rsquo;]}点每整点生成一场交友会&amp;quot;
####18、秘境系统:发送&amp;quot;秘境帮助&amp;quot;获取
#####18.1、群秘境开启、关闭:开启本群的秘境生成，管理员权限
#####18.2、生成秘境:生成一个随机秘境，超管权限
#####18.3、探索秘境:探索秘境获取随机奖励
#####18.4、秘境结算、结算秘境:结算秘境奖励
#####18.5、秘境探索终止、终止探索秘境:终止秘境事件
#####18.6、秘境帮助:获取秘境帮助信息
#####非指令：
####18.a、每日18点30分生成一个随机等级的秘境&amp;quot;
####19、炼丹帮助:炼丹功能
#####19.1、炼丹:会检测背包内的药材,自动生成配方【一次最多匹配25种药材】
#####19.2、配方:发送配方领取丹药【配方主药&amp;hellip;..】
#####19.3、炼丹配方帮助:获取炼丹配方帮助
#####19.4、灵田收取、灵田结算:收取洞天福地里灵田的药材
#####19.5、我的炼丹信息:查询自己的炼丹信息
#####19.6、升级收取等级:每一个等级会增加灵田收取的数量
#####19.7、升级丹药控火:每一个等级会增加炼丹的产出数量
#####备注：炼丹配方信息
######1、炼丹需要主药、药引、辅药
######2、主药和药引控制炼丹时的冷热调和,冷热失和则炼不出丹药
######3、草药的类型控制产出丹药的类型
######4、工具网址 &lt;code>https://huggingface.co/spaces/chewing/liandan&lt;/code>
####20、传承系统:发送&amp;quot;传承帮助/虚神界帮助&amp;quot;获取
#####20.1、传承抽卡:花费10颗思恋结晶获取一次传承卡片
#####20.2、传承信息:获取传承主要信息
#####20.3、传承背包:获取传承全部信息
#####20.4、加载传承数据:重新从卡片中加载所有传承属性(数据显示有误时可用)
#####20.5、传承卡图:加上卡片名字获取传承卡牌原画
######思恋结晶获取方式:虚神界对决【俄罗斯轮盘修仙版】
######双方共6次机会,6次中必有一次暴毙
######获胜者将获取10颗思恋结晶并不消耗虚神界对决次数
######失败者将获取5颗思恋结晶并且消耗一次虚神界对决次数
######每天有三次虚神界对决次数
#####20.a.1、投影虚神界:将自己的分身投影到虚神界,将可被所有地域的道友挑战
#####20.a.2、虚神界列表:查找虚神界里所有的投影
#####20.a.3、虚神界对决:输入虚神界人物编号即可与对方对决,不输入编号将会与{NICKNAME}进行对决
#####20.a.4、虚神界修炼:加入对应的修炼时间,即可在虚神界修炼&amp;quot;
####21、修仙适配:将1的境界适配到2
####22、启用/禁用修仙功能:当前群开启或关闭修仙功能
####23、更新记录:获取插件最新内容&lt;/p></description></item><item><title>一种很新的群晖安装方法</title><link>https://blog.tama.guru/record/new_dsm_install.html</link><pubDate>Sat, 12 Aug 2023 16:26:00 +0800</pubDate><guid>https://blog.tama.guru/record/new_dsm_install.html</guid><description>&lt;p>这个方法需要一个叫做&amp;quot;arpl&amp;quot;的固件（链接：&lt;a class="link" href="https://github.com/fbelavenuto/arpl/releases" target="_blank" rel="noopener"
>https://github.com/fbelavenuto/arpl/releases&lt;/a>），其特点是引导式安装，不需要手工提取&lt;code>grup.cfg&lt;/code>修改相关文件，相对较为简单。
###1.下载和安装
去上面的网站下载对应版本的zip包，解压并使用Win32DiskImager之类的工具写入U盘。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d732efe98f4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d732efe98f4.png" alt="arpl" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d732efe98f4.png"
loading="lazy"
alt="arpl"
>
一般下载最新版即可，我是在物理机安装因此选择第一个。
写完之后把U盘安装到需要安装群晖的主板上并在BIOS中设置好UEFI启动，因各主板步骤不一致此处不赘述。
###2.进入和初步配置arpl
开启群晖主板电源等待1分钟之后，在路由器界面找到主板网卡IP,浏览器输入&lt;code>http://ip:7681&lt;/code>即可进入arpl界面。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d733a862a8d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d733a862a8d.png" alt="IP" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d733a862a8d.png"
loading="lazy"
alt="IP"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d733df70ec6.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d733df70ec6.png" alt="arpl界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d733df70ec6.png"
loading="lazy"
alt="arpl界面"
>
进去之后先选择&lt;code>x Cmdline menu&lt;/code>，然后进入&lt;code>c Define a custom MAC&lt;/code>，此步骤用于修改mac1的数据，如果需要洗白建议先做这一步，修改MAC后需要重新进入路由器界面找到主板网卡IP，因为IP会重新分配。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7346458918.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7346458918.png" alt="修改MAC" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7346458918.png"
loading="lazy"
alt="修改MAC"
>
###3.配置arpl
####首先是&lt;code>m Choose a model&lt;/code>
即选择安装的群晖型号，此处我以DS918+为例。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d734f031a5b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d734f031a5b.png" alt="DS918&amp;#43;" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d734f031a5b.png"
loading="lazy"
alt="DS918&amp;#43;"
>
####第二步,&lt;code>n Choose a Build Number&lt;/code>
即选择安装的版本，当前我要安装的是7.1.1，即版本号42962.
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d735383187c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d735383187c.png" alt="42962" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d735383187c.png"
loading="lazy"
alt="42962"
>
####第三步，&lt;code>s Choose a serial number&lt;/code>
即输入序列号，进去之后会有两个选项，一个是&lt;code>a Generate a random serial number&lt;/code>，即随机生成一个SN，如果玩黑的直接选这个即可。如果有SN码则选择第二个&lt;code>m Enter a serial number&lt;/code>，输入后回车会提示&lt;code>Invalid serial, continue?&lt;/code>，不理，确认即可。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d735fb61ff8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d735fb61ff8.png" alt="Invalid serial" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d735fb61ff8.png"
loading="lazy"
alt="Invalid serial"
>
####第四步，&lt;code>Addone&lt;/code>
即插件安装，默认会安装&lt;code>misc&lt;/code>和&lt;code>acpid&lt;/code>这两个插件，其他可以手动选择，好像对我都没用，所以就保留默认了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7365373041.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7365373041.png" alt="addons install" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7365373041.png"
loading="lazy"
alt="addons install"
>
####第五步，&lt;code>x Cmdline menu&lt;/code>
这个界面可以对一些详细的配置进行修改，比如有两个网口，想设置第二个网口的mac，则可以在&lt;code>a Add/edit a cmdline item&lt;/code>中输入&lt;code>mac2&lt;/code>并回车，然后输入MAC2的地址即可，其他例如U盘的PID和VID也可以通过这个方式修改。其他选项如字面意思理解，此处不赘述。（更正：不需要设置PID和VID，见&lt;a class="link" href="https://github.com/fbelavenuto/arpl/blob/main/README-Zh.md" target="_blank" rel="noopener"
>https://github.com/fbelavenuto/arpl/blob/main/README-Zh.md&lt;/a>）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d736c8d7f49.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d736c8d7f49.png" alt="Cmdline menu" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d736c8d7f49.png"
loading="lazy"
alt="Cmdline menu"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d737ff28aa9.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d737ff28aa9.png" alt="修改PID" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d737ff28aa9.png"
loading="lazy"
alt="修改PID"
>
####第六步，&lt;code>i Synoinfo menu&lt;/code>
展示和修改群晖的相关信息，一般不用修改。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73782ec5b5.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73782ec5b5.png" alt="Synoinfo" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73782ec5b5.png"
loading="lazy"
alt="Synoinfo"
>
####第七步，&lt;code>v Advanced menu&lt;/code>
高级菜单，内容包含&lt;code>切换LKM版本&lt;/code>、&lt;code>模块&lt;/code>、&lt;code>手动编辑配置文件&lt;/code>、&lt;code>尝试恢复DSM启动盘&lt;/code>以及&lt;code>展示SATA端口和设备&lt;/code>，一般只用看看最后一项检查SATA是否安装正常即可。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d738622c42c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d738622c42c.png" alt="高级菜单" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d738622c42c.png"
loading="lazy"
alt="高级菜单"
>
我的主板有两个SATA控制器，一共四个端口，因为我只安装一块硬盘，所以&lt;code>Port 1&lt;/code>是亮的。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7392c59480.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7392c59480.png" alt="SATA信息" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d7392c59480.png"
loading="lazy"
alt="SATA信息"
>
####第八步，&lt;code>Build the loader&lt;/code>
即编译启动器，它会自动下载所需文件并进行编译，直到提示&lt;code>Ready&lt;/code>会自动退出。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d739dd66108.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d739dd66108.png" alt="编译过程" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d739dd66108.png"
loading="lazy"
alt="编译过程"
>
####第九步，&lt;code>b Boot the loader&lt;/code>
此处即可开始启动了。此步骤会受U盘读写速度影响，（如果U盘带灯能看到狂闪）选择之后会卡一段时间直到显示&lt;code>Booting...&lt;/code>，需要等待。如果有接显示器，此时会看到关机了，需要手动启动。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73a4103d18.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73a4103d18.png" alt="booting" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73a4103d18.png"
loading="lazy"
alt="booting"
>
###4.安装固件
浏览器登陆https://find.synology.com会查找到刚才安装的群晖。不知道为什么，群晖助手一直都显示不到，只有通过浏览器查找才可以。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73fb7a7d36.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73fb7a7d36.png" alt="找到服务器" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73fb7a7d36.png"
loading="lazy"
alt="找到服务器"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73ffacb153.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73ffacb153.png" alt="安装" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d73ffacb153.png"
loading="lazy"
alt="安装"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/12/64d74024b8445.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d74024b8445.png" alt="选择固件" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/12/64d74024b8445.png"
loading="lazy"
alt="选择固件"
>&lt;/p>
&lt;p>###5.一些问题：
####1.无法安装DSM，文件可能已经损坏。
可能是硬盘插错，U盘VID PID没正确配置，又或者是引导文件有问题，一切皆有可能。
####2.作者更新不及时？
尝试其他同类项目：&lt;a class="link" href="https://github.com/AuxXxilium/arc/releases" target="_blank" rel="noopener"
>https://github.com/AuxXxilium/arc/releases&lt;/a>&lt;/p></description></item><item><title>记录在raspbian上折腾pikvm的失败过程</title><link>https://blog.tama.guru/record/pikvm_with_raspbian.html</link><pubDate>Thu, 10 Aug 2023 18:02:00 +0800</pubDate><guid>https://blog.tama.guru/record/pikvm_with_raspbian.html</guid><description>&lt;p>###前言
很久之前买过一款kvm套件，基于树莓派4b的拓展版，能够通过USB和跳线起到控制设备开关机以及远程操作的作用，但是&lt;a class="link" href="https://pikvm.org/" target="_blank" rel="noopener"
>pikvm官方&lt;/a>只发布了基于32位archlinuxarm的固件，在其官网的QA处有这么一段描述：&lt;/p>
&lt;blockquote>
&lt;p>Why is PiKVM OS based on Arch Linux ARM and not Raspbian / Raspberry Pi OS? &amp;amp;gt; There are several reasons:
Several years ago, when PiKVM was just starting out, Raspbian didn‘t have a minimalistic image and the transition to systemd was in full swing, which is why the distribution was not too stable. Raspbian did not have all the necessary packages in the repositories to satisfy most software dependencies.
PiKVM was born as a pet project, and the founder likes Arch the most.
However, we plan to provide an alternative OS image based on Raspbian in the future - now it is quite stable.&lt;/p>&lt;/blockquote>
&lt;p>大概意思就是pikvm起步早，当时raspbian还没成型，且raspbian的库中不能满足pikvm的依赖。&lt;strong>但是官方正在计划做基于raspbian的固件&lt;/strong>，简而言之就是现在没有。
但对我来说，arch系的系统确实难用（&lt;strong>我是debian的狗&lt;/strong>），另一方面我个人觉得，32位系统并不能发挥4B的全部实力。于是今天在逛pikvm的github的时候发现了这么一个issus：&lt;a class="link" href="https://github.com/pikvm/pikvm/issues/374" target="_blank" rel="noopener"
>Running pikvm on top of another OS&lt;/a>下有个评论：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4a19558178.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4a19558178.png" alt="github issus" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4a19558178.png"
loading="lazy"
alt="github issus"
>
&lt;a class="link" href="https://kvmnerds.com/RPiKVM/How_to_Install_PiKVM_onRaspbian_32-bit_OS.pdf" target="_blank" rel="noopener"
>第一个PDF&lt;/a>介绍了用树莓派官方镜像刷写工具写入32位的raspios并安装pikvm的过程，为什么一定要32位？我不明白。因此决定刷个64位的系统按他的步骤试试看。
###刷个RaspiOS
系统方面我选择的是基于debian 11于20230503更新的当前最新系统。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4a2b421570.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4a2b421570.png" alt="raspbian system flash" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4a2b421570.png"
loading="lazy"
alt="raspbian system flash"
>
安装操作流程依照上面的PDF进行，需要注意的是其中提到的&lt;code>enable &amp;amp;quot;Skip first-run wizard&amp;amp;quot;&lt;/code>选项当前已经不存在。
###尝试安装pikvm
进入SSH，下载&lt;code>https://kvmnerds.com/RPiKVM/install-pikvm-raspbian.sh&lt;/code>这个文件并赋予执行权限，然后直接&lt;code>./install-pikvm-raspbian.sh&lt;/code>，开始一长串的wget（请注意:kvmnerds.com这个域名不能直连，需要自配梯子）&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Running part &lt;span class="m">1&lt;/span> of PiKVM installer v5.6 script &lt;span class="k">for&lt;/span> Raspbian by @srepac
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Getting Pi-KVM packages from https://kvmnerds.com/REPO/NEW
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW -O /var/cache/kvmd/packages.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/janus-0.11.3-raspbian-armv7l.pkg.tar.xz -O /var/cache/kvmd/janus-0.11.3-raspbian-armv7l.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmi-rpi2-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-platform-v0-hdmi-rpi2-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmi-rpi2-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-platform-v0-hdmi-rpi2-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmi-rpi3-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-platform-v0-hdmi-rpi3-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmi-rpi3-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-platform-v0-hdmi-rpi3-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmi-zero2w-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-platform-v0-hdmi-zero2w-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmi-zero2w-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-platform-v0-hdmi-zero2w-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmiusb-rpi2-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/k
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmiusb-rpi2-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmiusb-rpi3-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/k
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmiusb-rpi3-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmiusb-zero2w-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v0-hdmiusb-zero2w-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmi-rpi4-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmi-rpi4-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmi-zero2w-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmi-zero2w-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmi-zerow-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmi-zerow-3.54-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmiusb-rpi4-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/k
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v2-hdmiusb-rpi4-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v3-hdmi-rpi4-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v3-hdmi-rpi4-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v4mini-hdmi-rpi4-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v4mini-hdmi-rpi4-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/k
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v4plus-hdmi-rpi4-3.241-1-any.pkg.tar.xz -O /var/cache/kvmd/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-platform-v4plus-hdmi-rpi4-3.47-1-any.pkg.tar.xz -O /var/cache/kvmd/k
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://kvmnerds.com/REPO/NEW/kvmd-webterm-0.42-1-any.pkg.tar.xz -O /var/cache/kvmd/kvmd-webterm-0.42-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -l /var/cache/kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">total &lt;span class="m">3912&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">4787&lt;/span> Aug &lt;span class="m">10&lt;/span> 17:05 installer-20230810-17:04:49.log
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">1858636&lt;/span> Feb &lt;span class="m">13&lt;/span> &lt;span class="m">2022&lt;/span> janus-0.11.3-raspbian-armv7l.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">1144228&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">749608&lt;/span> Feb &lt;span class="m">10&lt;/span> &lt;span class="m">2022&lt;/span> kvmd-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6220&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmi-rpi2-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6220&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmi-rpi2-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6280&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmi-rpi3-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6280&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmi-rpi3-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6684&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmiusb-rpi2-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6684&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmiusb-rpi2-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6732&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmiusb-rpi3-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6732&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmiusb-rpi3-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6704&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmiusb-zero2w-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6704&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmiusb-zero2w-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6336&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmi-zero2w-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6336&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v0-hdmi-zero2w-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6364&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v2-hdmi-rpi4-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6364&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v2-hdmi-rpi4-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6888&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v2-hdmiusb-rpi4-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6888&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v2-hdmiusb-rpi4-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6372&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v2-hdmi-zero2w-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6372&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v2-hdmi-zero2w-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">5776&lt;/span> Feb &lt;span class="m">19&lt;/span> &lt;span class="m">2022&lt;/span> kvmd-platform-v2-hdmi-zerow-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">5776&lt;/span> Feb &lt;span class="m">19&lt;/span> &lt;span class="m">2022&lt;/span> kvmd-platform-v2-hdmi-zerow-3.54-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6628&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v3-hdmi-rpi4-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6628&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v3-hdmi-rpi4-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6792&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v4mini-hdmi-rpi4-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6792&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v4mini-hdmi-rpi4-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6792&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v4plus-hdmi-rpi4-3.241-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">6792&lt;/span> Aug &lt;span class="m">7&lt;/span> 08:16 kvmd-platform-v4plus-hdmi-rpi4-3.47-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">5940&lt;/span> Jun &lt;span class="m">26&lt;/span> &lt;span class="m">2022&lt;/span> kvmd-webterm-0.42-1-any.pkg.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">14716&lt;/span> Aug &lt;span class="m">10&lt;/span> 17:04 packages.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Choose which capture device you will use:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> - USB dongle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">2&lt;/span> - v2 CSI
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">3&lt;/span> - V3 HAT
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>我的平台是V3 HA3,因此选择3：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Platform selected -&amp;gt; kvmd-platform-v3-hdmi-rpi4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Please verify the platform selected above.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Press ENTER to &lt;span class="k">continue&lt;/span> or CTRL+C to &lt;span class="nb">break&lt;/span> out of script.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>回车确认，然后会进入安装依赖和编译过程流程（过程中会有&lt;code>apt does not have a stable CLI interface&lt;/code>的提示，忽略即可）：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/boot/config.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># For more options and information see&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># http://rpf.io/configtxt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Some settings may impact device functionality. See link above for details&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment if you get no picture on HDMI for a default &amp;#34;safe&amp;#34; mode&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#hdmi_safe=1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment the following to adjust overscan. Use positive numbers if console&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># goes off screen, and negative if there is too much border&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#overscan_left=16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#overscan_right=16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#overscan_top=16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#overscan_bottom=16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment to force a console size. By default it will be display&amp;#39;s size minus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># overscan.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#framebuffer_width=1280&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#framebuffer_height=720&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment if hdmi display is not detected and composite is being output&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#hdmi_force_hotplug=1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment to force a specific HDMI mode (this will force VGA)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#hdmi_group=1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#hdmi_mode=1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment to force a HDMI mode rather than DVI. This can make audio work in&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DMT (computer monitor) modes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#hdmi_drive=2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment to increase signal to HDMI, if you have interference, blanking, or&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># no display&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#config_hdmi_boost=4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># uncomment for composite PAL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#sdtv_mode=2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#uncomment to overclock the arm. 700 MHz is the default.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#arm_freq=800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Uncomment some or all of these to enable the optional hardware interfaces&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#dtparam=i2c_arm=on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#dtparam=i2s=on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#dtparam=spi=on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Uncomment this to enable infrared communication.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#dtoverlay=gpio-ir,gpio_pin=17&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#dtoverlay=gpio-ir-tx,gpio_pin=18&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Additional overlays and parameters are documented /boot/overlays/README&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Enable audio (loads snd_bcm2835)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtparam&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">audio&lt;/span>&lt;span class="o">=&lt;/span>on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Automatically load overlays for detected cameras&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">camera_auto_detect&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Automatically load overlays for detected DSI displays&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">display_auto_detect&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Enable DRM VC4 V3D driver&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>vc4-kms-v3d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">max_framebuffers&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Run in 64-bit mode&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">arm_64bit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Disable compensation for displays with overscan&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">disable_overscan&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>cm4&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Enable host mode on the 2711 built-in XHCI USB controller.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This line should be removed if the legacy DWC2 controller is required&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># (e.g. for USB device mode) or if USB support is not required.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">otg_mode&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>all&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>pi4&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Run as fast as firmware / board allows&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">arm_boost&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>all&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># srepac custom configs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">hdmi_force_hotplug&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">gpu_mem&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">128&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">enable_uart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>tc358743
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>disable-bt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>dwc2,dr_mode&lt;span class="o">=&lt;/span>peripheral
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtparam&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">act_led_gpio&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">13&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># HDMI audio capture&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>tc358743-audio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># SPI (AUM)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>spi0-1cs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># I2C (display)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtparam&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">i2c_arm&lt;/span>&lt;span class="o">=&lt;/span>on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Clock&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>i2c-rtc,pcf8563
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/modules: kernel modules to load at boot time.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This file contains the names of kernel modules that should be loaded&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># at boot time, one per line. Lines beginning with &amp;#34;#&amp;#34; are ignored.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">i2c-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tc358743
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dwc2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">libcomposite
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/udev/rules.d/99-kvmd.rules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># https://unix.stackexchange.com/questions/66901/how-to-bind-usb-device-under-a-static-name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># https://wiki.archlinux.org/index.php/Udev#Setting_static_device_names&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">KERNEL&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s2">&amp;#34;video[0-9]*&amp;#34;&lt;/span>, &lt;span class="nv">SUBSYSTEM&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s2">&amp;#34;video4linux&amp;#34;&lt;/span>, &lt;span class="nv">KERNELS&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s2">&amp;#34;fe801000.csi|fe801000.csi1&amp;#34;&lt;/span>, ATTR&lt;span class="o">{&lt;/span>name&lt;span class="o">}==&lt;/span>&lt;span class="s2">&amp;#34;unicam-
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">KERNEL==&amp;#34;&lt;/span>hidg0&lt;span class="s2">&amp;#34;, GROUP=&amp;#34;&lt;/span>kvmd&lt;span class="s2">&amp;#34;, SYMLINK+=&amp;#34;&lt;/span>kvmd-hid-keyboard&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">KERNEL==&amp;#34;&lt;/span>hidg1&lt;span class="s2">&amp;#34;, GROUP=&amp;#34;&lt;/span>kvmd&lt;span class="s2">&amp;#34;, SYMLINK+=&amp;#34;&lt;/span>kvmd-hid-mouse&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">KERNEL==&amp;#34;&lt;/span>hidg2&lt;span class="s2">&amp;#34;, GROUP=&amp;#34;&lt;/span>kvmd&lt;span class="s2">&amp;#34;, SYMLINK+=&amp;#34;&lt;/span>kvmd-hid-mouse-alt&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-&amp;gt; Installing dependencies for pikvm
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt install -y nginx python3 net-tools bc expect v4l-utils iptables vim dos2unix screen tmate nfs-common gpi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt install -y python3-pip
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pip3 install dbus-next
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-aiofiles
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-aiohttp
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-appdirs
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-asn1crypto
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-async-timeout
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-bottle
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-cffi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-chardet
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-click
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-colorama
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-cryptography
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-dateutil
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-dbus
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-hidapi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-idna
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-libgpiod
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-marshmallow
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-more-itertools
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-multidict
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-netifaces
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-packaging
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-passlib
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-pillow
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-ply
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-psutil
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-pycparser
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-pyelftools
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-pyghmi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-pygments
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-pyparsing
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-requests
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-semantic-version
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-serial
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-setproctitle
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-setuptools
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-six
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-spidev
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-systemd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-tabulate
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-urllib3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-wrapt
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-xlib
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-yaml
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-yarl
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt-get install -y python3-serial-asyncio
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Selecting previously unselected package libev4:arm64.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">(Reading database ... 100902 files and directories currently installed.)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Preparing to unpack libev4_4.33-1_arm64.deb ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Unpacking libev4:arm64 (1:4.33-1) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Setting up libev4:arm64 (1:4.33-1) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Processing triggers for libc-bin (2.31-13+rpt2+rpi1+deb11u5) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">(Reading database ... 100908 files and directories currently installed.)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Preparing to unpack libjson-c5_0.15-2_arm64.deb ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Unpacking libjson-c5:arm64 (0.15-2) over (0.15-2) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Setting up libjson-c5:arm64 (0.15-2) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Processing triggers for libc-bin (2.31-13+rpt2+rpi1+deb11u5) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">(Reading database ... 100908 files and directories currently installed.)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Preparing to unpack libuv1_1.40.0-2_arm64.deb ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Unpacking libuv1:arm64 (1.40.0-2) over (1.40.0-2) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Setting up libuv1:arm64 (1.40.0-2) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Processing triggers for libc-bin (2.31-13+rpt2+rpi1+deb11u5) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Selecting previously unselected package ttyd.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">(Reading database ... 100908 files and directories currently installed.)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Preparing to unpack ttyd_1.6.3-3~bpo11+1_arm64.deb ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Unpacking ttyd (1.6.3-3~bpo11+1) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Setting up ttyd (1.6.3-3~bpo11+1) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/ttyd.service → /lib/systemd/system/ttyd.service.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Processing triggers for man-db (2.9.4-2) ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">ttyd version: ttyd version 1.6.3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-&amp;gt; Building ustreamer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">apt install -y build-essential libssl-dev libevent-dev libjpeg-dev libbsd-dev libraspberrypi-dev libgpiod-de
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Cloning into &amp;#39;ustreamer&amp;#39;...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Enumerating objects: 174, done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Counting objects: 100% (174/174), done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Compressing objects: 100% (107/107), done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Total 174 (delta 62), reused 136 (delta 54), pack-reused 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Receiving objects: 100% (174/174), 172.77 KiB | 1.31 MiB/s, done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Resolving deltas: 100% (62/62), done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make apps
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[1]: Entering directory &amp;#39;/tmp/ustreamer&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make -C src
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[2]: Entering directory &amp;#39;/tmp/ustreamer/src&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC libs/base64.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC libs/frame.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC libs/logging.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC libs/memsink.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC libs/options.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC libs/unjpeg.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/blank.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/data/blank_jpeg.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/data/favicon_ico.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/data/index_html.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/device.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/encoder.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/encoders/cpu/encoder.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/encoders/hw/encoder.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/h264.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/bev.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/mime.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/path.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/server.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/static.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/unix.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/uri.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/m2m.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/main.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/options.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/stream.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/workers.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/gpio/gpio.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC ustreamer/http/systemd/systemd.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">== LD ustreamer.bin
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC dump/file.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-- CC dump/main.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">== LD ustreamer-dump.bin
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[2]: Leaving directory &amp;#39;/tmp/ustreamer/src&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[1]: Leaving directory &amp;#39;/tmp/ustreamer&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make apps
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[1]: Entering directory &amp;#39;/tmp/ustreamer&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make -C src
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[2]: Entering directory &amp;#39;/tmp/ustreamer/src&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[2]: Nothing to be done for &amp;#39;all&amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[2]: Leaving directory &amp;#39;/tmp/ustreamer/src&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[1]: Leaving directory &amp;#39;/tmp/ustreamer&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make -C src install
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[1]: Entering directory &amp;#39;/tmp/ustreamer/src&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p /usr/local/bin
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">install -m755 ustreamer.bin /usr/local/bin/ustreamer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">install -m755 ustreamer-dump.bin /usr/local/bin/ustreamer-dump
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make[1]: Leaving directory &amp;#39;/tmp/ustreamer/src&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p /usr/local/share/man/man1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">for man in ustreamer.1 ustreamer-dump.1; do \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> install -m644 man/&lt;/span>&lt;span class="nv">$man&lt;/span>&lt;span class="s2"> /usr/local/share/man/man1/&lt;/span>&lt;span class="nv">$man&lt;/span>&lt;span class="s2">; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> gzip -f /usr/local/share/man/man1/&lt;/span>&lt;span class="nv">$man&lt;/span>&lt;span class="s2">; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">done
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">ustreamer version/features: 5.41
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">+ WITH_GPIO
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">+ WITH_SYSTEMD
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">+ WITH_PTHREAD_NP
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">+ WITH_SETPROCTITLE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">+ HAS_PDEATHSIG
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-&amp;gt; Building wiringpi from source
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Cloning into &amp;#39;WiringPi&amp;#39;...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Enumerating objects: 1733, done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Counting objects: 100% (615/615), done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Compressing objects: 100% (114/114), done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">remote: Total 1733 (delta 555), reused 502 (delta 501), pack-reused 1118
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Receiving objects: 100% (1733/1733), 803.57 KiB | 1.24 MiB/s, done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Resolving deltas: 100% (1188/1188), done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">wiringPi Build script
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">=====================
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">WiringPi Library
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[UnInstall]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] wiringPi.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] wiringSerial.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] wiringShift.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] piHiPri.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] piThread.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] wiringPiSPI.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] wiringPiI2C.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] softPwm.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] softTone.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp23008.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp23016.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp23017.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp23s08.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp23s17.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] sr595.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] pcf8574.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] pcf8591.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp3002.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp3004.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp4802.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] mcp3422.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] max31855.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] max5322.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] ads1115.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] sn3218.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] bmp180.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] htu21d.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] ds18b20.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] rht03.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] drcSerial.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] drcNet.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] pseudoPins.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] wpiExtensions.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pseudoPins.c: In function ‘myAnalogRead’:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pseudoPins.c:50:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 50 | int *ptr = (int *)node-&amp;gt;data0 ;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> | ^
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pseudoPins.c: In function ‘myAnalogWrite’:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pseudoPins.c:59:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 59 | int *ptr = (int *)node-&amp;gt;data0 ;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> | ^
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pseudoPins.c: In function ‘pseudoPinsSetup’:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">pseudoPins.c:89:17: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> 89 | node-&amp;gt;data0 = (unsigned int)ptr ;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> | ^
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Link (Dynamic)]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Install Headers]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Install Dynamic Lib]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">WiringPi Devices Library
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[UnInstall]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] ds1302.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] maxdetect.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] piNes.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] gertboard.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] piFace.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] lcd128x64.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] lcd.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] scrollPhat.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] piGlow.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Link (Dynamic)]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Install Headers]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Install Dynamic Lib]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">GPIO Utility
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] gpio.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Compile] readall.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Link]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">[Install]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">All Done.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">NOTE: To compile programs with wiringPi, you need to add:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> -lwiringPi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> to your compile line(s) To use the Gertboard, MaxDetect, etc.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> code (the devLib), you need to also add:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> -lwiringPiDev
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> to your compile line(s).
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">gpio version: 2.70
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Copyright (c) 2012-2018 Gordon Henderson
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">This is free software with ABSOLUTELY NO WARRANTY.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">For details type: gpio -warranty
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Raspberry Pi Details:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> Type: Pi 4B, Revision: 01, Memory: 4096MB, Maker: Sony
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> * Device tree is enabled.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> *--&amp;gt; Raspberry Pi 4 Model B Rev 1.1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> * This Raspberry Pi supports user-level GPIO access.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">-&amp;gt; Enabling kvmd-nginx kvmd-webterm kvmd-otg and kvmd services, but do not start them.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-nginx.service → /lib/systemd/system/kvmd-ng
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-webterm.service → /lib/systemd/system/kvmd-
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-otg.service → /lib/systemd/system/kvmd-otg.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd.service → /lib/systemd/system/kvmd.service.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-fix.service → /lib/systemd/system/kvmd-fix.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-tc358743.service → /lib/systemd/system/kvmd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Reboot is required to create kvmd users and groups.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Please re-run this script after reboot to complete the install.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">Press ENTER to continue or CTRL+C to break out of script.
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>最后这里提示&lt;code>Reboot is required to create kvmd users and groups.Please re-run this script after reboot to complete the install.&lt;/code>，会在重启之后创建一个kvmd用户和组，要求重启后再次运行这个脚本，按下回车之后会自动重启。重启过后再次执行脚本进入第二阶段：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Running part &lt;span class="m">2&lt;/span> of PiKVM installer v5.6 script &lt;span class="k">for&lt;/span> Raspbian by @srepac
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Ensuring KVMD users and groups ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Disabling nginx service, so that we can use kvmd-nginx instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Synchronizing state of nginx.service with SysV service script with /lib/systemd/systemd-sysv-install.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Executing: /lib/systemd/systemd-sysv-install disable nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Removed /etc/systemd/system/multi-user.target.wants/nginx.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Creating symlinks &lt;span class="k">for&lt;/span> use with kvmd python scripts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Creating kvmd-webterm homedir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x &lt;span class="m">2&lt;/span> kvmd-webterm root &lt;span class="m">4096&lt;/span> Aug &lt;span class="m">10&lt;/span> 17:16 /home/kvmd-webterm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ConfigError: Invalid value &lt;span class="s1">&amp;#39;&amp;#39;&lt;/span> &lt;span class="k">for&lt;/span> key &lt;span class="s1">&amp;#39;kvmd/streamer/unix&amp;#39;&lt;/span>: None argument is not a valid absolute path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Did kvmd -m run properly? &lt;span class="o">[&lt;/span>y/n&lt;span class="o">]&lt;/span> y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Restoring config files
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">11360&lt;/span> Nov &lt;span class="m">20&lt;/span> &lt;span class="m">2021&lt;/span> tools.js
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Getting most current tools.js file... &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">11856&lt;/span> Aug &lt;span class="m">10&lt;/span> 17:18 tools.js
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> root root &lt;span class="m">11360&lt;/span> Nov &lt;span class="m">20&lt;/span> &lt;span class="m">2021&lt;/span> tools.js.20230810
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating CSS files as per pikvm/pikvm#599: fixed webui windows oversizing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /usr/share/kvmd/web/share/css/kvm/stream.css
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /usr/share/kvmd/web/share/css/login/login.css
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /usr/share/kvmd/web/share/css/modal.css
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /usr/share/kvmd/web/share/css/start.css
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /usr/share/kvmd/web/share/css/vars.css
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /usr/share/kvmd/web/share/css/window.css
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Job &lt;span class="k">for&lt;/span> kvmd-otg.service failed because the control process exited with error code.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See &lt;span class="s2">&amp;#34;systemctl status kvmd-otg.service&amp;#34;&lt;/span> and &lt;span class="s2">&amp;#34;journalctl -xe&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> details.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Found existing installation: Pillow 8.1.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not uninstalling pillow at /usr/lib/python3/dist-packages, outside environment /usr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Can&lt;span class="s1">&amp;#39;t uninstall &amp;#39;&lt;/span>Pillow&lt;span class="s1">&amp;#39;. No files were found to uninstall.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Check kvmd devices
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">lrwxrwxrwx 1 root root 6 Aug 10 17:18 /dev/kvmd-video -&amp;gt; video0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">You should see devices for keyboard, mouse, and video.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Point a browser to https://tama
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">If it doesn&amp;#39;&lt;/span>t work, &lt;span class="k">then&lt;/span> reboot one last time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Please make sure kvmd services are running after reboot.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Raspbian pikvm installer script completed on Thu &lt;span class="m">10&lt;/span> Aug 17:18:18 CST &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>好像是受上面的配置影响，字面上理解是OTG这部分出问题了，但是不管了，先进&lt;code>https://tama&lt;/code>看看 ：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4ac937ca7b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4ac937ca7b.png" alt="500报错" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4ac937ca7b.png"
loading="lazy"
alt="500报错"
> 直接报错了&amp;hellip;查日志看看：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@tama:~/pikvm# journalctl -fu kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-- Journal begins at Wed 2023-05-03 11:23:19 CST. --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:26 tama systemd[1]: kvmd.service: Main process exited, code=exited, status=1/FAILURE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:27 tama kvmd-cleanup[3136]: ConfigError: Invalid value &amp;#39;&amp;#39; for key &amp;#39;kvmd/streamer/unix&amp;#39;: None ar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:27 tama systemd[1]: kvmd.service: Control process exited, code=exited, status=1/FAILURE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:27 tama systemd[1]: kvmd.service: Failed with result &amp;#39;exit-code&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:27 tama systemd[1]: kvmd.service: Consumed 1.483s CPU time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:30 tama systemd[1]: kvmd.service: Scheduled restart job, restart counter is at 93.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:30 tama systemd[1]: Stopped PiKVM - The main daemon.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:30 tama systemd[1]: kvmd.service: Consumed 1.483s CPU time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:30 tama systemd[1]: Started PiKVM - The main daemon.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:31 tama kvmd[3148]: ConfigError: Invalid value &amp;#39;&amp;#39; for key &amp;#39;kvmd/streamer/unix&amp;#39;: None argument i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:31 tama systemd[1]: kvmd.service: Main process exited, code=exited, status=1/FAILURE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:31 tama kvmd-cleanup[3150]: ConfigError: Invalid value &amp;#39;&amp;#39; for key &amp;#39;kvmd/streamer/unix&amp;#39;: None ar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:32 tama systemd[1]: kvmd.service: Control process exited, code=exited, status=1/FAILURE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:32 tama systemd[1]: kvmd.service: Failed with result &amp;#39;exit-code&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:32 tama systemd[1]: kvmd.service: Consumed 1.490s CPU time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">qAug 10 17:25:35 tama systemd[1]: kvmd.service: Scheduled restart job, restart counter is at 94.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:35 tama systemd[1]: Stopped PiKVM - The main daemon.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 17:25:35 tama systemd[1]: kvmd.service: Consumed 1.490s CPU time.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>直接就卡在启动过程中反复重启了&amp;hellip;
如果再次运行脚本，会提示让你确认命令&lt;code>kvmd -n&lt;/code>能否运行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Running part &lt;span class="m">2&lt;/span> of PiKVM installer v5.6 script &lt;span class="k">for&lt;/span> Raspbian by @srepac
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Ensuring KVMD users and groups ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Disabling nginx service, so that we can use kvmd-nginx instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Synchronizing state of nginx.service with SysV service script with /lib/systemd/systemd-sysv-install.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Executing: /lib/systemd/systemd-sysv-install disable nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Creating symlinks &lt;span class="k">for&lt;/span> use with kvmd python scripts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Creating kvmd-webterm homedir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x &lt;span class="m">2&lt;/span> kvmd-webterm root &lt;span class="m">4096&lt;/span> Aug &lt;span class="m">10&lt;/span> 17:16 /home/kvmd-webterm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ConfigError: Invalid value &lt;span class="s1">&amp;#39;&amp;#39;&lt;/span> &lt;span class="k">for&lt;/span> key &lt;span class="s1">&amp;#39;kvmd/streamer/unix&amp;#39;&lt;/span>: None argument is not a valid absolute path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Did kvmd -m run properly? &lt;span class="o">[&lt;/span>y/n&lt;span class="o">]&lt;/span> n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Please install missing packages as per the kvmd -m output in another ssh/terminal.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>但是直接运行&lt;code>kvmd -m&lt;/code>又会报同样的错：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@tama:~/pikvm# kvmd -m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ConfigError: Invalid value &lt;span class="s1">&amp;#39;&amp;#39;&lt;/span> &lt;span class="k">for&lt;/span> key &lt;span class="s1">&amp;#39;kvmd/streamer/unix&amp;#39;&lt;/span>: None argument is not a valid absolute path
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后我看了眼脚本文件里面有这么一行:
&lt;code># 5.6 05/24/23 - added override entry to fix the Invalid value '' for key 'kvmd/server/unix': None argument error&lt;/code>
(|||ﾟДﾟ)?server报错是没有，但是还有个streamer报错啊？
我上discord翻了下，发现有人也报过这个错误：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4b8cc9513b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4b8cc9513b.png" alt="discord" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/08/10/64d4b8cc9513b.png"
loading="lazy"
alt="discord"
>
我试着把他这句加到我的配置文件的streamer下面：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> streamer:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> unix: /run/kvmd/kvmd.sock
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> h264_bitrate:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> default: 5000
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>重启之后报错发生改变：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@tama:/etc/kvmd# journalctl -fu kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-- Journal begins at Wed 2023-05-03 11:23:19 CST. --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:01 tama systemd[1]: kvmd.service: Scheduled restart job, restart counter is at 33.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:01 tama systemd[1]: Stopped PiKVM - The main daemon.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:01 tama systemd[1]: kvmd.service: Consumed 1.492s CPU time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:01 tama systemd[1]: Started PiKVM - The main daemon.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:02 tama kvmd[6664]: ConfigError: Invalid value &amp;#39;&amp;#39; for key &amp;#39;ipmi/kvmd/unix&amp;#39;: None argument is not a valid absolute path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:02 tama systemd[1]: kvmd.service: Main process exited, code=exited, status=1/FAILURE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:02 tama kvmd-cleanup[6670]: ConfigError: Invalid value &amp;#39;&amp;#39; for key &amp;#39;ipmi/kvmd/unix&amp;#39;: None argument is not a valid absolute path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:02 tama systemd[1]: kvmd.service: Control process exited, code=exited, status=1/FAILURE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:02 tama systemd[1]: kvmd.service: Failed with result &amp;#39;exit-code&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aug 10 18:17:02 tama systemd[1]: kvmd.service: Consumed 1.489s CPU time.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这个key&amp;hellip;
要放到哪去？
我放弃了。&lt;/p>
&lt;hr>
&lt;p>###转战blikvm
换个思路，blikvm的文档里面也有一个版本能在64位raspbian上跑，至少看起来是成功了，该文档地址位于：&lt;a class="link" href="https://github.com/ThomasVon2021/blikvm/blob/master/dev-readme.md" target="_blank" rel="noopener"
>https://github.com/ThomasVon2021/blikvm/blob/master/dev-readme.md&lt;/a>
其使用的环境为：&lt;/p>
&lt;ol>
&lt;li>Raspberry Pi OS Lite&lt;/li>
&lt;li>Release date: 20230201&lt;/li>
&lt;li>System: 64-bit&lt;/li>
&lt;li>Kernel version: 5.15&lt;/li>
&lt;li>Debian version: 11 (bullseye)
和新版的除了内核高点之外其他也差不到哪去。所以在最新版本上跑试试。
原文档就不放出来了，真的无力吐槽&amp;hellip;就放一些出问题的地方吧&amp;hellip;&lt;/li>
&lt;li>&lt;code>git clone https://libwebsockets.org/repo/libwebsockets&lt;/code>链接是失效的，应该使用&lt;code>git clone https://github.com/warmcat/libwebsockets&lt;/code>&lt;/li>
&lt;li>php安装内容是偏向7.4的，但是&lt;code>pecl install http://pecl.php.net/get/swoole-5.0.3.tgz&lt;/code>这个地方会报错表示该版本仅支持php8.0+，所以需要修改成4.8.10或者其他版本。还有就是&lt;code>pecl install inotify&lt;/code>这个命令无法直接执行，需要去pecl下载包下来到本地手动安装。&lt;/li>
&lt;li>&lt;code>Install kvmd services&lt;/code>这个地方更是吐血，首先是安装kvmd-main这个阶段，&lt;code>kvmd-main.service&lt;/code>中&lt;code>ExecStart&lt;/code>指向&lt;code>/usr/bin/blikvm/kvmd-main&lt;/code>，但是这个文件并不在这个目录，导致安装会出错，同时这个&lt;code>kvmd-main.service&lt;/code>依赖syslogd，需要手动运行&lt;code>apt install busybox-syslogd&lt;/code>。其他的ustreamer以及kvmd-web均是如此，需要进所有文件去检查，路径有很多都是错的&amp;hellip;
一通修改之后终于见到了熟悉的界面&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Commercial&lt;/span> &lt;span class="ne">IP&lt;/span> &lt;span class="n">KVM&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">Raspberry&lt;/span> &lt;span class="n">Pi&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Copyright&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">C&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">gzsgcs&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">All&lt;/span> &lt;span class="n">Rights&lt;/span> &lt;span class="n">Reserved&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Unauthorized&lt;/span> &lt;span class="n">copying&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">any&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">this&lt;/span> &lt;span class="n">project&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">via&lt;/span> &lt;span class="n">any&lt;/span> &lt;span class="n">medium&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">strictly&lt;/span> &lt;span class="n">prohibited&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Proprietary&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">confidential&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Written&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">gzsgcs&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">gzsgcs&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">gmail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">September&lt;/span> &lt;span class="mi">2022&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">2.11&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">08&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">24&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Program&lt;/span> &lt;span class="n">start&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Bootstrapping&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Checking&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">system&lt;/span> &lt;span class="n">read&lt;/span> &lt;span class="n">write&lt;/span> &lt;span class="n">status&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">system&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">readable&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">writable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Emulating&lt;/span> &lt;span class="n">network&lt;/span> &lt;span class="n">interfaces&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Interface&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">eth0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">,&lt;/span>&lt;span class="ne">IP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Mask&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Broadcast&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">50.164&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">255.255&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">255.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">50.255&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">You&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">running&lt;/span> &lt;span class="n">Release&lt;/span> &lt;span class="n">Version&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Warning&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Custom&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">found&lt;/span> &lt;span class="p">,&lt;/span> &lt;span class="n">skip&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">admin&lt;/span> &lt;span class="n">config&lt;/span> &lt;span class="n">loaded&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">check&lt;/span> &lt;span class="n">msd&lt;/span> &lt;span class="n">directory&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Building&lt;/span> &lt;span class="k">static&lt;/span> &lt;span class="n">assets&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Static&lt;/span> &lt;span class="n">assets&lt;/span> &lt;span class="n">cache&lt;/span> &lt;span class="n">build&lt;/span> &lt;span class="n">success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">MSD&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">JSON&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">exists&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">initializing&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">MSD&lt;/span> &lt;span class="n">json&lt;/span> &lt;span class="n">initialize&lt;/span> &lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Current&lt;/span> &lt;span class="n">Resolution&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">640&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="mi">480&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">wait&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">ustreamer&lt;/span> &lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">ustreamer&lt;/span> &lt;span class="n">service&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">started&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="mi">2023&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">08&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">36&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Log&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">wait&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">janus&lt;/span> &lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>但是依然有好几个服务还没运行成功（janus 和 ustreamer)&amp;hellip;.再慢慢改吧。&lt;/p>
&lt;hr>
&lt;p>不改了，去死吧。&lt;/p></description></item><item><title>记一次KPW3拆机降级</title><link>https://blog.tama.guru/record/264.html</link><pubDate>Sun, 23 Jul 2023 22:40:00 +0800</pubDate><guid>https://blog.tama.guru/record/264.html</guid><description>&lt;blockquote>
&lt;p>&amp;ldquo;亚马逊将于一年之后即2023年6月30日，在中国停止Kindle电子书店的运营。在此之后，您将不能购买新的电子书。对于已经购买的电子书，您可以在2024年6月30日之前下载，并且可以在此后继续阅读。&amp;rdquo;&lt;/p>&lt;/blockquote>
&lt;p>以上公告来自亚马逊。这意味着6月30日起Kindle的国内线上服务将不再完整，需要完整的服务需要申请一个其他地区的亚马逊账号，但是国外的亚马逊商城中文书籍极少甚至有些地区没有，趁这个机会我就想把手头的KPW3越个狱。
之所以要拆机是因为KPW3当前免拆机越狱的最后一个版本是5.14.2（来源：&lt;a class="link" href="https://bookfere.com/post/406.html" target="_blank" rel="noopener"
>Kindle 越狱支持一览：检查 Kindle 设备能否越狱&lt;/a>），而我的设备已经升级到5.15.1.1,想要降级越狱必须拆机。&lt;/p>
&lt;p>准备工作：&lt;/p>
&lt;ul>
&lt;li>杜邦线公对母若干根&lt;/li>
&lt;li>TTL刷机板（我用的是FT232RL，这玩意能选择输出1.8 3.3或者5伏）&lt;/li>
&lt;li>拆机工具（包括但不限于翘片、螺丝刀、最好有热吹风）&lt;/li>
&lt;li>电烙铁（选配，但是最好是有）&lt;/li>
&lt;li>SecureCRT&lt;/li>
&lt;/ul>
&lt;p>拆机过程不再赘述网上一抓一大把，拿出主板的时候注意从顶部抠开。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd38ff776cb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd38ff776cb.png" alt="底部的充电口和电源会有卡槽，因此选择顶部拆除主板" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd38ff776cb.png"
loading="lazy"
alt="底部的充电口和电源会有卡槽，因此选择顶部拆除主板"
>
安装好TTL的驱动并确定好COM端口号，配置SecureCRT如下图所示。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd39ced253e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd39ced253e.png" alt="我的端口是COM4，SecureCRT配置一定要如图所示设置" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd39ced253e.png"
loading="lazy"
alt="我的端口是COM4，SecureCRT配置一定要如图所示设置"
>
接下来进行硬件连接，需要切换成3.3V模式，然后划出三根线，GND连接主板上任意部位，我连接到充电口；DEBUG接口左边为RX，连接到TTL的TX，中间为TX，连接到TTL的RX，最终如下图所示。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd3b5343c36.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd3b5343c36.png" alt="接线方式" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd3b5343c36.png"
loading="lazy"
alt="接线方式"
>
*正式刷写时此处应用烙铁飞出RX TX这两根线并固定好，否则刷到半断开了容易GG。
此时重启KPW3，SecureCRT上应该会显示出一些信息，证明是连接成功了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd3c4f9ca10.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd3c4f9ca10.png" alt="SecureCRT信息" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/23/64bd3c4f9ca10.png"
loading="lazy"
alt="SecureCRT信息"
>&lt;/p>
&lt;p>剩下的部分等我的烙铁到了再更新 ::acfun:11:: 。&lt;/p>
&lt;hr>
&lt;p>焊点太小了焊不上，此贴终结。&lt;/p>
&lt;hr>
&lt;p>买了个J焊头，这次焊上去了，继续更新。因为触点实在太小了，拉了两坨锡把触点搞大，好在没有连锡。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c64da366c22.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c64da366c22.png" alt="2023-07-30T11:46:40.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c64da366c22.png"
loading="lazy"
alt="2023-07-30T11:46:40.png"
>
长按电源10S重启，直到SecureCRT信息跳动，疯狂的按Enter（其实只要在&lt;code>Hit any key to stop autoboot:0&lt;/code>之前按住就行了，不然会进入正常启动流程。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c64dfb2e960.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c64dfb2e960.png" alt="2023-07-30T11:48:09.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c64dfb2e960.png"
loading="lazy"
alt="2023-07-30T11:48:09.png"
>
然后电脑安装这个&lt;a class="link" href="https://359303267.github.io/files/kindle-02/Zadig.zip" target="_blank" rel="noopener"
>驱动&lt;/a>，驱动选择&lt;code>libsub-win32&lt;/code>即可。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c654fdd287a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c654fdd287a.png" alt="驱动安装" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c654fdd287a.png"
loading="lazy"
alt="驱动安装"
>
驱动安装完成后回到SecureCRT,在&lt;code>uboot&amp;gt;&lt;/code>后输入&lt;code>run bootcmd_diags&lt;/code>回车，然后再次疯狂回车，避免程序跑完后系统正常启动。注意，&lt;em>此时要把USB数据线与电脑连接。&lt;/em>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c655b86b3a3.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c655b86b3a3.png" alt="进入Recovery模式" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c655b86b3a3.png"
loading="lazy"
alt="进入Recovery模式"
>
如果成功了，会弹出一个Menu菜单，这个菜单会有倒计时，10秒没有反应就正常启动，因此要快点按住&lt;code>e&lt;/code>，此时电脑会弹出一个Kindle的分区，把&lt;code>update_pw3_factory_5.8.9.0.1.bin&lt;/code>这个固件放进去，复制完成后按住&lt;code>1&lt;/code>，系统会进入恢复模式并自动升级。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c656bd55ca9.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c656bd55ca9.png" alt="复制到kindle" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c656bd55ca9.png"
loading="lazy"
alt="复制到kindle"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c656d7ad5cd.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c656d7ad5cd.png" alt="复制到Kindle2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c656d7ad5cd.png"
loading="lazy"
alt="复制到Kindle2"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c657074ccc8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c657074ccc8.png" alt="开始升级" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c657074ccc8.png"
loading="lazy"
alt="开始升级"
>
在Kindle上可以看到显示正在安装更新。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c6575d5d9ee.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c6575d5d9ee.png" alt="正在安装更新" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c6575d5d9ee.png"
loading="lazy"
alt="正在安装更新"
>
这个时间是比较久的，而且线路松动的话设备很容易寄，因此焊接必须要做好，保证线路不能松动。
等大约二十分钟后系统自动重启，可以看到系统版本已经降下来了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/30/64c65790d27fa.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c65790d27fa.png" alt="降级成功" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/30/64c65790d27fa.png"
loading="lazy"
alt="降级成功"
>&lt;/p></description></item><item><title>Vultr免费服务器体验</title><link>https://blog.tama.guru/record/vultr-free-instance.html</link><pubDate>Sun, 16 Jul 2023 01:35:27 +0800</pubDate><guid>https://blog.tama.guru/record/vultr-free-instance.html</guid><description>&lt;p>今年年初的时候Vultr推出了免费服务器计划，只要满足以下条件就能申请一台服务器：&lt;/p>
&lt;ul>
&lt;li>绑定了信用卡&lt;/li>
&lt;li>开启2FA&lt;/li>
&lt;/ul>
&lt;p>服务器的规格如下：&lt;/p>
&lt;ul>
&lt;li>单核虚拟处理器&lt;/li>
&lt;li>0.5GB内存&lt;/li>
&lt;li>10GB磁盘&lt;/li>
&lt;li>2TB的免费全球带宽&lt;/li>
&lt;/ul>
&lt;p>0.5G内存可能是小了点，但是免费的，跑个Debian应该还行。
申请之后一段时间会收到这个提示：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2ceba25477.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2ceba25477.png" alt="2023-07-15T16:52:09.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2ceba25477.png"
loading="lazy"
alt="2023-07-15T16:52:09.png"
>
其中有提到这个计划的启动时间和结束时间，但是有网友问过客服，如果到期了再次审核满足条件的话是能继续续下去的。
建立新实例的步骤如下：&lt;/p>
&lt;ol>
&lt;li>选择Cloud Compute&lt;/li>
&lt;/ol>
&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2cf27838d7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2cf27838d7.png" alt="D1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2cf27838d7.png"
loading="lazy"
alt="D1"
>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>选择Regular Performance
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2cf6e27c7a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2cf6e27c7a.png" alt="D2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2cf6e27c7a.png"
loading="lazy"
alt="D2"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>选择Server Location。需要注意的是，免费计划只适用于美国西雅图、迈阿密和德国法兰克福，选择其他地方是不会在Server Size出现&amp;quot;Free Tier&amp;quot;这个选项的。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2d0139c2d4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2d0139c2d4.png" alt="D3" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2d0139c2d4.png"
loading="lazy"
alt="D3"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2d0213b511.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2d0213b511.png" alt="D4" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/07/16/64b2d0213b511.png"
loading="lazy"
alt="D4"
>
新建成功之后去PING了一下IP，居然是通的 (ﾟ∀。)，记得几年前Vultr家的服务器是一封一大片。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>磁盘占用情况：&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@vultr:~# df -h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Filesystem Size Used Avail Use% Mounted on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">udev 207M 0 207M 0% /dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 46M 696K 46M 2% /run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/dev/vda1 9.4G 2.6G 6.3G 30% /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 229M 0 229M 0% /dev/shm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 5.0M 0 5.0M 0% /run/lock
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmpfs 46M 0 46M 0% /run/user/0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>还剩6.3G，还行，还能做些事情。&lt;/p>
&lt;ul>
&lt;li>内存占用情况：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@vultr:~# free -m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> total used free shared buff/cache available
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Mem: 457 104 233 0 140 353
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Swap: 0 0 0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>还剩233M&amp;hellip;这下不开swap不行了，给swap划分1个G，那就还剩5个G左右的空间。
还要配置好swap的使用机制：
&lt;code>echo &amp;quot;vm.swappiness = 50&amp;quot; &amp;gt;&amp;gt; /etc/sysctl.conf&lt;/code>
这个数值0即完全不使用swap，100即更偏向使用swap。这么小内存的机子，我就配置个五五开差不多了。&lt;/p>
&lt;ul>
&lt;li>网速测试：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">vultr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="c1"># speedtest-cli&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Retrieving&lt;/span> &lt;span class="n">speedtest&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">net&lt;/span> &lt;span class="n">configuration&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Testing&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">Choopa&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">LLC&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">********&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Retrieving&lt;/span> &lt;span class="n">speedtest&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">net&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Selecting&lt;/span> &lt;span class="n">best&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">based&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">ping&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Hosted&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">Wowrack&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Seattle&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">WA&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mf">1.31&lt;/span> &lt;span class="n">km&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="mf">9.041&lt;/span> &lt;span class="n">ms&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Testing&lt;/span> &lt;span class="n">download&lt;/span> &lt;span class="n">speed&lt;/span>&lt;span class="o">................................................................................&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Download&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">655.26&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Testing&lt;/span> &lt;span class="n">upload&lt;/span> &lt;span class="n">speed&lt;/span>&lt;span class="o">......................................................................................................&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Upload&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">3234.36&lt;/span> &lt;span class="n">Mbit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>(ﾟ∀。) Really nigger?
拖个镜像试试看&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@vultr:~# wget https://cdimage.debian.org/debian-cd/current/amd64/iso-dvd/debian-12.0.0-amd64-DVD-1.iso
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--2023-07-15 17:24:53-- https://cdimage.debian.org/debian-cd/current/amd64/iso-dvd/debian-12.0.0-amd64-DVD-1.iso
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Resolving cdimage.debian.org (cdimage.debian.org)... 2001:6b0:19::163, 2001:6b0:19::173, 2001:6b0:19::165, ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connecting to cdimage.debian.org (cdimage.debian.org)|2001:6b0:19::163|:443... connected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP request sent, awaiting response... 302 Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Location: https://saimei.ftp.acc.umu.se/debian-cd/current/amd64/iso-dvd/debian-12.0.0-amd64-DVD-1.iso [following]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--2023-07-15 17:24:54-- https://saimei.ftp.acc.umu.se/debian-cd/current/amd64/iso-dvd/debian-12.0.0-amd64-DVD-1.iso
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Resolving saimei.ftp.acc.umu.se (saimei.ftp.acc.umu.se)... 2001:6b0:19::138, 194.71.11.138
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connecting to saimei.ftp.acc.umu.se (saimei.ftp.acc.umu.se)|2001:6b0:19::138|:443... connected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP request sent, awaiting response... 200 OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Length: 3931095040 (3.7G) [application/x-iso9660-image]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saving to: ‘debian-12.0.0-amd64-DVD-1.iso’
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">debian-12.0.0-amd64-DVD-1.iso 100%[===========================================================================================================================================&amp;gt;] 3.66G 87.3MB/s in 46s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-07-15 17:25:41 (81.9 MB/s) - ‘debian-12.0.0-amd64-DVD-1.iso’ saved [3931095040/3931095040]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>欸欸欸 (ﾟ∀。)&lt;/p></description></item><item><title>搭了个基于NekoBox的提问箱！</title><link>https://blog.tama.guru/record/tamabox.html</link><pubDate>Sat, 03 Jun 2023 14:36:00 +0800</pubDate><guid>https://blog.tama.guru/record/tamabox.html</guid><description>&lt;p>之前接触过NekoBox这个匿名提问箱，非常小巧，界面简洁不花哨，非常有好感。但是因为一些不方便说明的原因，作者把原站关闭了（&lt;strong>更正，作者已经重新开放原站了&lt;/strong>），实在可惜。好在他有把源码放到github（引路：https://github.com/NekoWheel/NekoBox)，虽然基本上相当于没有教程，而且使用过程中有好多报错。经过搭建之后半天摸索，现在功能基本上都正常了。
在此基础上，我引入并魔改了几个js实现了页面二维码以及自定义前景色背景色等小功能，另一方面则是尽量把可以部署的资源都部署到OSS上以实现更快速的访问。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4051a4908d.jpg">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4051a4908d.jpg" alt="一些修改" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4051a4908d.jpg"
loading="lazy"
alt="一些修改"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4063f2a0ce.jpg">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4063f2a0ce.jpg" alt="二维码自定义颜色" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4063f2a0ce.jpg"
loading="lazy"
alt="二维码自定义颜色"
>
底部加上了没什么用但是就想加上去的信息统计，至少看到数字有变化能盼我感受到:啊啊，原来还有人在用啊。。。&lt;/p>
&lt;p>狼的提问箱：&lt;a class="link" href="https://box.tama.guru" target="_blank" rel="noopener"
>狼的提问箱&lt;/a> 欢迎访问和体验！&lt;/p>
&lt;p>界面很简洁，很干净。&lt;/p>
&lt;p>正如作者所说的“一个究极简洁的匿名问答箱。没有多余的社交元素，只是一问一答。不提醒，不打扰。你不需要下载 App，不需要绑定社交账号，甚至连邮箱都不需要是真的。”
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/06/03/647aded8a9a91.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/06/03/647aded8a9a91.png" alt="2023-06-03T06:33:59.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/06/03/647aded8a9a91.png"
loading="lazy"
alt="2023-06-03T06:33:59.png"
>
提问也不需要注册，如果是需要收到提醒就填个接收邮箱就行了：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/06/03/647adef1ce54b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/06/03/647adef1ce54b.png" alt="2023-06-03T06:34:24.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/06/03/647adef1ce54b.png"
loading="lazy"
alt="2023-06-03T06:34:24.png"
>
再最近一次更新中也实现了图片评论回答功能，一般提问箱的功能基本上能够实现了（用的R2作为图床，别问为什么）:
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4070845834.jpg">
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4070845834.jpg" alt="图片问答" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2024/01/27/65b4070845834.jpg"
loading="lazy"
alt="图片问答"
>
可以自定义提问箱的背景和个人头像，怕被骚扰？也可惜设置仅允许注册用户向我提问，也可以把所有关于你的信息导出，如果想销号也是直接停用：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/06/03/647adf02a5ac4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/06/03/647adf02a5ac4.png" alt="2023-06-03T06:34:41.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/06/03/647adf02a5ac4.png"
loading="lazy"
alt="2023-06-03T06:34:41.png"
>
如果你正好需要这样一个提问箱，不妨试试，有需要的话也可以自己搭建，最后，欢迎大家向我提问 ::acfun:1001::
&lt;a class="link" href="https://box.tama.guru/_/tamakyi" target="_blank" rel="noopener"
>小狼的提问箱 - 狼的提问箱&lt;/a>&lt;/p></description></item><item><title>在技嘉B550M上成功点亮并使用（但不完美）DG1教程</title><link>https://blog.tama.guru/record/dg1_with_b550m.html</link><pubDate>Wed, 10 May 2023 23:24:00 +0800</pubDate><guid>https://blog.tama.guru/record/dg1_with_b550m.html</guid><description>&lt;p>先上结果：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bafc914fe4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bafc914fe4.png" alt="image0" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bafc914fe4.png"
loading="lazy"
alt="image0"
>
所以网上关于这张卡无法在AMD的平台上跑这个说法基本上宣告破产了。
但是在我B550M这个平台上安装上这卡并不容易，不仅是兼容性层面，还有物理层面问题（我的主卡3060ti实在是太大，直接把两个PCIe口占据了。。。而直接用PCIe延长线也是因为底座过高而无法安装。
接下来说说装这张卡碰到的坑。
大前提肯定是把ResizeBAR打开了，详情看之前的文章：[post cid=&amp;ldquo;239&amp;rdquo; /]
首先我是插在A320M+2200G平台上的（这是NAS机，之前我想把这做推流机），插上去之后显示无输出，但是PiKVM能看到硬盘灯在闪烁，判断系统是正常运行了，于是从远程桌面进去发现能正常，安装驱动之后能够正确识别型号（设备管理器中有一个PCI设备一直显示无驱动且找不到驱动），发现NDI推流延迟较高，故放弃，转战主机。
主机上主显卡是3060TI，这玩意非常的大，大到把主板底部的大多数接口都盖住了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb1d9637ac.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb1d9637ac.png" alt="image1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb1d9637ac.png"
loading="lazy"
alt="image1"
>&lt;/p>
&lt;ol>
&lt;li>首先我是DG1+PCIe延长线（延长线只支持到PCIe3.0）接到PCIe3.0接口上，主显卡不变，插在直通CPU的PCIe4.0接口，结果就如前文所述，延长线底座太高，3060TI插不进去了&amp;hellip;&lt;/li>
&lt;li>然后我试着单独把DG1插到PCIe3.0接口上，结果是硬盘灯闪，显示器无信号。&lt;/li>
&lt;li>再试着把DG1插到PCIe4.0接口上，结果也是硬盘灯闪，显示器无信号。即判断直接插入这张卡是无法正常显示的。&lt;/li>
&lt;li>接下来我用3060TI接上延长线连接PCIe4.0接口，DG1直插PCIe3.0接口，显示器能反应，能进BIOS，但是进入系统的启动过程中会提示无法启动，无论切换到Win10 LTSC2021 Server2022 Win11均无法正常启动，这里就是我最疑惑的地方了。&lt;/li>
&lt;li>最后我改变了想法，把3060TI接上延长线连接PCIe3.0接口，DG1直插PCIe4.0接口，却发现是能正常进入系统了！我的两台显示器分别插在两张卡上，进入系统之后只有插在3060TI上的卡的显示器是亮的，插在DG1的显示器黑屏。安装Xe驱动后，双屏正常工作了。&lt;/li>
&lt;/ol>
&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb463d2912.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb463d2912.png" alt="image2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb463d2912.png"
loading="lazy"
alt="image2"
>
但是这样对性能的损耗有些大，3060TI在PCIe3.0上无法发挥其最大效用，而DG1占着PCIe4.0接口，但它最多也只能跑到4.0 x8
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb523b9976.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb523b9976.png" alt="image3" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb523b9976.png"
loading="lazy"
alt="image3"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb5a7f26ea.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb5a7f26ea.png" alt="image4" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bb5a7f26ea.png"
loading="lazy"
alt="image4"
>
而且我发现这样接上之后，鼠标的拖动会偶尔发生卡顿，这个情况现在也是无解。
接下来我想再买一根PCIe4.0的延长线，看看这样插能不能把性能跑满，后续再继续测试视频和直播的编解码能力。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bbb5982d69.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bbb5982d69.png" alt="image5" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bbb5982d69.png"
loading="lazy"
alt="image5"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/10/645bbb49660ed.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bbb49660ed.png" alt="image6" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/10/645bbb49660ed.png"
loading="lazy"
alt="image6"
>&lt;/p>
&lt;p>PS1:发现在启动浏览器的情况下鼠标拖动会有卡顿，如果桌面无任何程序时则很流畅。
PS2:点亮后如果把3060TI拔了（即单卡启动）仍然无法显示，在3060TI上插上HDMI后就都正常显示了。
PS3:把DG1上的线都插到3060TI上之后卡顿问题有所缓解但仍有发生。
PS4:对于PS1提到的问题，我发现，双显示器情况下把两条视频线分别插入两张显卡，不会发生卡顿。
PS5:在微星H510M爆破弹上开启UEFI resizebar above 4g和安全启动，关闭快速启动，无法点亮。拔掉电源和bios电池放电也无法启动，再插上核显（10400的uhd630）输出时有一定概率花屏。&lt;/p></description></item><item><title>记一次VBios的升级和resizebar的开启</title><link>https://blog.tama.guru/record/3060ti_vbiosupdate_sizebar.html</link><pubDate>Sun, 07 May 2023 23:28:00 +0800</pubDate><guid>https://blog.tama.guru/record/3060ti_vbiosupdate_sizebar.html</guid><description>&lt;p>首先科普一下resize bar是什么：&lt;/p>
&lt;blockquote>
&lt;p>可调整大小的 BAR 是一种可选的 PCI Express 接口技术。当您在游戏中的世界中移动时，GPU 内存 （VRAM） 会通过许多小型 CPU 不断传输纹理、着色器和几何体到 GPU 的传输。随着现代游戏资产规模的不断增长，这导致了大量的转移。使用可调整大小的 BAR，可以根据需要请求资产并完整发送，因此 CPU 可以有效地访问整个帧缓冲区。如果发出多个请求，传输可以同时进行，而不是排队。（来自&lt;a class="link" href="https://www.nvidia.com/en-us/geforce/news/geforce-rtx-30-series-resizable-bar-support/" target="_blank" rel="noopener"
>Nvidia官网&lt;/a>)&lt;/p>&lt;/blockquote>
&lt;p>这不是今天刚买了DG1嘛，有说到什么Resizebar什么新功能巴拉巴拉的，之前听都没听过，查了下资料发现好像是有点用处的嗷，又看了下30系确实是能用的，于是喜滋滋的去&lt;a class="link" href="https://nvidia.custhelp.com/app/answers/detail/a_id/5165/~/nvidia-resizable-bar-firmware-update-tool" target="_blank" rel="noopener"
>这里&lt;/a>看如何操作（这里的七彩虹链接404了，后面是去官网找的）。我的卡是七彩虹的iGame GeForce RTX 3060 Ti Ultra W OC-V，去官网上找到对应的驱动页面，找到BIOS看到一个3060Ti Resizable BAR Support，哟还是今年三月更新的，赶紧下载了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457ba25bbd51.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457ba25bbd51.png" alt="显示更新时间还挺近的" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457ba25bbd51.png"
loading="lazy"
alt="显示更新时间还挺近的"
>
打开压缩包之后打开&lt;code>3060tiRZBARupdaterV2.exe&lt;/code>（这里显示修改时间2021/4/9，怪）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457ba8cdc288.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457ba8cdc288.png" alt="3060tiRZBARupdaterV2.exe" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457ba8cdc288.png"
loading="lazy"
alt="3060tiRZBARupdaterV2.exe"
>
按y进行下一步，发现提示&lt;code>Unsupported by this tool, contact card vendor&lt;/code> ::acfun:1004:: 这不是我的卡的驱动吗？怎么还能不支持的？然后再搜了下，开启resize bar需要满足以下条件：&lt;/p>
&lt;ul>
&lt;li>BIOS中支持并开启&lt;code>Resize Bar Support&lt;/code>同时开启&lt;code>Above 4G Decoding&lt;/code>&lt;/li>
&lt;li>关闭CSM（其实我的主板在打开&lt;code>Resize Bar Support&lt;/code>后自动就把CSM关闭了，好像CSM和这个功能有冲突）&lt;/li>
&lt;li>一张30系显卡&lt;/li>
&lt;/ul>
&lt;p>然后我就走了一遍流程把上面都打开了（顺便还把BIOS给升级了一遍）。重启后发现还是显示&lt;code>Resize Bar Disable&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bc5cdc0f7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bc5cdc0f7.png" alt="这是最后处理好了的图，原来这里是显示Disable的" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bc5cdc0f7.png"
loading="lazy"
alt="这是最后处理好了的图，原来这里是显示Disable的"
>
然后在GPU-Z的Advanced-PCIe Resizable BAR下面的Resizable BAR enabled in BIOS显示是NO ::acfun:19::
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bcba7a168.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bcba7a168.png" alt="这里原来一直都是NO" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bcba7a168.png"
loading="lazy"
alt="这里原来一直都是NO"
>
什么勾八？
网上搜索了一下，发现也有人出现这个情况，然后他把CSM重新打开就能识别了。我复现了一下发现根本不可行，而且其他例如CSM disabled也变成NO了，这不是妥妥的坑人嘛。
本来我都打算放弃了，在这个&lt;a class="link" href="https://tieba.baidu.com/p/8092717058" target="_blank" rel="noopener"
>贴子&lt;/a>上看到有提到vbios的问题，然后我琢磨着是不是我的vbios版本不对，然后去查了下如何升级vbios以及去 哪儿整vbios。
[button color=&amp;ldquo;danger&amp;rdquo;]风险警告！刷写VBIOS操作不当可能会导致显卡变砖！[/button]
[button color=&amp;ldquo;danger&amp;rdquo;]风险警告！刷写VBIOS操作不当可能会导致显卡变砖！[/button]
[button color=&amp;ldquo;danger&amp;rdquo;]风险警告！刷写VBIOS操作不当可能会导致显卡变砖！[/button]
简单来说，就是到&lt;a class="link" href="https://www.techpowerup.com/vgabios" target="_blank" rel="noopener"
>这个网站&lt;/a>搜索到自己型号的显卡，找到之后下载到一个rom后缀的文件，这个就是vbios了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457be6670682.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457be6670682.png" alt="我对应的型号是这个" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457be6670682.png"
loading="lazy"
alt="我对应的型号是这个"
>
文件有了，还需要工具，也是到这个网站找到NVIDIA NVFlash这个页面:&lt;a class="link" href="https://www.techpowerup.com/download/nvidia-nvflash/" target="_blank" rel="noopener"
>https://www.techpowerup.com/download/nvidia-nvflash/&lt;/a>按自己机器的型号下载到压缩包之后，把文件解压，并把rom文件放在同一个文件夹。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bf0d1451d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bf0d1451d.png" alt="如果怕ROM文件混淆可以自己重命名" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bf0d1451d.png"
loading="lazy"
alt="如果怕ROM文件混淆可以自己重命名"
>
以管理员身份运行CMD，并进入此文件夹。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bf5d1318d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bf5d1318d.png" alt="CMD进入文件夹" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bf5d1318d.png"
loading="lazy"
alt="CMD进入文件夹"
>
先执行&lt;code>nvflash.exe --list&lt;/code>查询是否识别到显卡并且判断显卡vbios版本
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bfafd2aa7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bfafd2aa7.png" alt="此处的10DE,2486,7377,1501便是我的vbios版本，当然，这已经是升级后的了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457bfafd2aa7.png"
loading="lazy"
alt="此处的10DE,2486,7377,1501便是我的vbios版本，当然，这已经是升级后的了"
>
然后执行&lt;code>nvflash.exe -6 Colorful.RTX3060Ti.8192.201112.rom&lt;/code>这里选择要升级的rom文件，&lt;code>-6&lt;/code>参数是强制升级。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c038e046c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c038e046c.png" alt="升级过程，没截图，手机拍屏幕" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c038e046c.png"
loading="lazy"
alt="升级过程，没截图，手机拍屏幕"
>
上图中现有版本是94.04.27.80.EC，要升级的版本是94.04.27.80.ED，看上去确实是差了一个版本。
如果顺利的话这里直接一路y过去，最后会提示你要重启，重启就是了。
然后再次打开上面那个&lt;code>3060tiRZBARupdaterV2.exe&lt;/code>，哦豁。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c1b0845eb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c1b0845eb.png" alt="已经提示支持升级了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c1b0845eb.png"
loading="lazy"
alt="已经提示支持升级了"
>
&lt;code>Update supported, will be applied&lt;/code> 我直接一个y。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c15f8e864.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c15f8e864.png" alt="升级成功了" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c15f8e864.png"
loading="lazy"
alt="升级成功了"
>
提示&lt;code>Update successful&lt;/code>，它要求重启，那我直接一个重启。
最后就是喜闻乐见的开启成功了，果然是vbios的问题。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c23aed0ea.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c23aed0ea.png" alt="BAR1原来只有256，现在变成8192，即全卡显存大小" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/07/6457c23aed0ea.png"
loading="lazy"
alt="BAR1原来只有256，现在变成8192，即全卡显存大小"
>
完事手工。 ::acfun:06::
[button color=&amp;ldquo;danger&amp;rdquo;]再次警告！刷写VBIOS操作不当可能会导致显卡变砖！[/button]&lt;/p></description></item><item><title>解决AcFunLive的mirai机器人无法使用的问题</title><link>https://blog.tama.guru/record/acfunlive-mirai.html</link><pubDate>Fri, 05 May 2023 23:35:47 +0800</pubDate><guid>https://blog.tama.guru/record/acfunlive-mirai.html</guid><description>&lt;p>*注意，mirai无法启动仅针对在windows下使用时出现，linux并无此问题。&lt;/p>
&lt;p>使用最新的acfunlive源码编译windows-gui并使用时发现，执行
&lt;code>acfunlive.exe -mirai&lt;/code>
会直接开始程序的运行，跳过mirai登录验证场景并报错：
&lt;code>error: read /dev/stdin: The handle is invalid&lt;/code>
这个问题苦恼了我很久，之前都时再开个linux虚拟机单独跑录播机器人，但是一想到之前也碰到过mirai机器人无法登录的问题，最终解决方式是通过gocqhttp生成device和session文件替换到程序目录中以骗过程序你已经登陆过了。
以下是操作流程：&lt;/p>
&lt;ol>
&lt;li>下载并配置go-cqhttp
到官网下载当前环境配置版本的go-cqhttp，此处我是windows，直接下载&lt;a class="link" href="https://github.com/Mrs4s/go-cqhttp/releases/download/v1.0.1/go-cqhttp_windows_amd64.exe" target="_blank" rel="noopener"
>windows_x64&lt;/a>版本。下载后双击运行exe，提示无法直接运行，之后生成一个bat文件，双击&lt;code>go-cqhttp.bat&lt;/code>文件运行，然后输入1回车，提示&lt;code>默认配置文件已生成，请修改 config.yml 后重新启动!&lt;/code>后关闭窗口。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/05/64551e91cd25b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64551e91cd25b.png" alt="2023-05-05T15:19:44.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64551e91cd25b.png"
loading="lazy"
alt="2023-05-05T15:19:44.png"
>
修改&lt;code>config.yml&lt;/code>，主要是修改uin这一项，其他不用管（因为之后使用的是watch协议登录，所以不需要填密码），修改后保存文件。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/05/64551f1085317.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64551f1085317.png" alt="2023-05-05T15:21:51.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64551f1085317.png"
loading="lazy"
alt="2023-05-05T15:21:51.png"
>
再次双击&lt;code>go-cqhttp.bat&lt;/code>文件运行，在提示&lt;code>Bot将在5秒后登录并开始信息处理, 按 Ctrl+C 取消.&lt;/code>后按Ctrl+C中断程序运行。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/05/64551fac3c9af.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64551fac3c9af.png" alt="2023-05-05T15:24:27.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64551fac3c9af.png"
loading="lazy"
alt="2023-05-05T15:24:27.png"
>
然后目录下会生成一个&lt;code>device.json&lt;/code>文件，打开并将&lt;code>&amp;quot;protocol&amp;quot;:6&lt;/code>的值修改成&lt;code>2&lt;/code>，保存。然后再次双击&lt;code>go-cqhttp.bat&lt;/code>文件运行，一段时间后他会提示你扫码登录，使用登录了同一个账号的手机扫码会提示是一个手表设备，确认登录。等出现如下内容时可以关闭程序。并看到目录下生成了&lt;code>sesssion.token&lt;/code>这个文件。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/05/645520dc60a55.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/645520dc60a55.png" alt="2023-05-05T15:29:31.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/645520dc60a55.png"
loading="lazy"
alt="2023-05-05T15:29:31.png"
>&lt;/li>
&lt;li>修改acfunlive配置
把gocqhttp目录下的&lt;code>sesssion.token&lt;/code>和&lt;code>device.json&lt;/code>复制到acfunlive目录（保险起见可以全部复制过去），然后将其重命名为&lt;code>qqsesssion.token&lt;/code>和&lt;code>qqdevice.json&lt;/code>，此时目录结构如下所示。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/05/6455217dd9f5c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/6455217dd9f5c.png" alt="2023-05-05T15:32:12.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/6455217dd9f5c.png"
loading="lazy"
alt="2023-05-05T15:32:12.png"
>
此时在powershell下执行&lt;code>.\acfunlive.exe -mirai&lt;/code>或者正常启动到&lt;code>http://localhost:51880/startmirai&lt;/code>再打开&lt;code>http://localhost:51880/log&lt;/code>可以看到已经登录成功了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/05/05/64552211c7de8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64552211c7de8.png" alt="2023-05-05T15:34:40.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/05/05/64552211c7de8.png"
loading="lazy"
alt="2023-05-05T15:34:40.png"
>
如果提示要扫码，那么会在acfunlive的目录下有一个&lt;code>qqqrcode.png&lt;/code>文件，打开用手机扫码登录即可。&lt;/li>
&lt;/ol></description></item><item><title>4G开发板EC200A的初次使用记录</title><link>https://blog.tama.guru/record/EC200A-CN.html</link><pubDate>Wed, 19 Apr 2023 23:06:55 +0800</pubDate><guid>https://blog.tama.guru/record/EC200A-CN.html</guid><description>&lt;p>本来是想买个随身WIFI，以便家里突然断网/断电的时候能够用手头上多余的一张SIM卡开个应急热点，但是去淘宝搜了一圈，成品随身WIFI要么说经常断网，要么就是无法使用自己的卡，要么就是能插自己的卡，但是只能插物联网卡或是插一张之后就不能插别的卡了（卡和机器绑定了），可玩性极差。然后想想家里还有一坨树莓派，用充电宝供电，能不能在这个基础上整些模块。
于是，在搜索了相关材料之后，选择了移远的EC200A-CN。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffc0ca404b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffc0ca404b.png" alt="2023-04-19T14:34:51.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffc0ca404b.png"
loading="lazy"
alt="2023-04-19T14:34:51.png"
>
大概就长这样，一个USB口，四个串口，一个SIM卡槽，一个天线接口，没了。
在WIN下直接插上会直接当作USB网卡使用，但是任务管理器下面的&lt;code>AT Interface&lt;/code>和&lt;code>Diag Interface&lt;/code>会有感叹号，这意味着无法进行AT指令交互，也就只能当作一块无线网卡使用。只需要把&lt;a class="link" href="https://share.tama.guru/LocalShare/GitCode/EC200A%E9%A9%B1%E5%8A%A8.rar" target="_blank" rel="noopener"
>这个驱动&lt;/a>打上就正常了。
先不管WIN下使用AT怎样怎样，买这块板子的初衷就是给树莓派用的，然后我就把板子拔下来插树莓派上了。
先说下环境，因为我要用到pikvm，所以使用的系统是魔改的archlinuxarm，内核版本&lt;code>5.15.68-3-rpi-ARCH&lt;/code>。
插上去之后，灯开始闪，但是执行
&lt;code>ifconfig&lt;/code>
之后：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffe20059da.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffe20059da.png" alt="2023-04-19T14:43:43.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffe20059da.png"
loading="lazy"
alt="2023-04-19T14:43:43.png"
>
你妈的，我USB0呢？
吓得我赶紧看看是不是给我搞坏了或者根本没识别。 ::acfun:02::
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffe7cdbef4.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffe7cdbef4.png" alt="2023-04-19T14:45:16.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643ffe7cdbef4.png"
loading="lazy"
alt="2023-04-19T14:45:16.png"
>
还好还好，东西还在。 ::acfun:03::
那么这是怎么个回事呢？我看店铺上明明写着linux免驱啊！于是在问一通客服之后 给了我个tgz包。 ::acfun:01:: 不问不给是吧。解压之后内容如下：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/643fff1dcc0a8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643fff1dcc0a8.png" alt="2023-04-19T14:47:57.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/643fff1dcc0a8.png"
loading="lazy"
alt="2023-04-19T14:47:57.png"
>
因为我的内核版本是&lt;code>5.15.68&lt;/code>，离得比较近的是&lt;code>5.15.11&lt;/code>，进入这个目录，执行
&lt;code>make&lt;/code>
和
&lt;code>make install&lt;/code>
后会生成&lt;code>option.ko``qcserial.ko&lt;/code>和&lt;code>usb_wwan.ko&lt;/code>三个文件，执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">insmod option.ko
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">insmod qcserial.ko
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">insmod usb_wwan.ko
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>载入模块。如果报错，可能是依赖没有载入。我是在执行&lt;code>insmod usb_wwan.ko&lt;/code>时报错的，于是执行
&lt;code>modinfo ./usb_wwan.ko | grep depend&lt;/code>
它显示需要载入一个usb模块，于是再执行
&lt;code>modprobe usb&lt;/code>
再执行一次上面的命令，就算是成功完成驱动安装了。可以通过执行
&lt;code>dmesg | grep ttyUSB*&lt;/code>
验证是否安装完成，我这个板子只有3个TTY，5G的卡好像是有5个TTY的。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/64400113e27f2.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/64400113e27f2.png" alt="2023-04-19T14:56:19.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/64400113e27f2.png"
loading="lazy"
alt="2023-04-19T14:56:19.png"
>
这时候再次执行&lt;code>ifconfig&lt;/code>，捏妈妈的，还是没有！ ::acfun:09::
然后再查查资料，再&lt;a class="link" href="https://zhuanlan.zhihu.com/p/107458906" target="_blank" rel="noopener"
>这个地方&lt;/a>翻到了一些有用的东西，这里说的时通过EC20模块访问互联网，大同小异，就先照着这个试试。原来还需要安装一个wvdial依赖包，因为我是arch，执行
&lt;code>pacman -S wvdial&lt;/code>
如果时debian系的就是
&lt;code>apt install wvdial&lt;/code>
应该也找得到吧。
然后修改配置文件，这里直接借鉴作者的。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#电信或移动
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Dialer lan1]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init1 = ATZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init2 = ATQ0 V1 E1 S0=0 &amp;amp;C1 &amp;amp;D2 +FCLASS=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Modem Type = Analog Modem
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Baud = 9600
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">New PPPD = yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Modem = /dev/ttyUSB2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ISDN = 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Phone = *99#
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password = card
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Username = card
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#联通
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Dialer lan1]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init1 = ATZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init2 = ATQ0 V1 E1 S0=0 &amp;amp;C1 &amp;amp;D2 +FCLASS=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init3 = at+cgdcont=1,&amp;#34;ip&amp;#34;,&amp;#34;uninet&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Modem Type = Analog Modem
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Baud = 9600
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">New PPPD = yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Modem = /dev/ttyUSB2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ISDN = 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Phone = *99#
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password = card
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Username = card
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>根据自己的卡类型填写其中一组配置即可。其中的&lt;code>lan1&lt;/code>是配置的名称，可以自行修改。然后打开个&lt;code>screen&lt;/code>（因为执行时程序必须在后台）
&lt;code>screen -S dial&lt;/code>
执行：
&lt;code>wvdial lan1&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/644002b020efb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/644002b020efb.png" alt="2023-04-19T15:03:11.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/644002b020efb.png"
loading="lazy"
alt="2023-04-19T15:03:11.png"
>
会根据配置文件进行PPP拨号，并生成一个ppp0的网卡。然后把screen放到后台，执行以下命令实验是否成功联网：
&lt;code>ping www.baidu.com -I ppp0&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/04/19/6440033f0c2b1.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/6440033f0c2b1.png" alt="2023-04-19T15:05:34.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/04/19/6440033f0c2b1.png"
loading="lazy"
alt="2023-04-19T15:05:34.png"
>
可以看到成功PING通了，第一个包的延迟很高，但是后面就慢慢好起来了。 ::acfun:2002::&lt;/p></description></item><item><title>PVE安装后续优化</title><link>https://blog.tama.guru/record/pve_install.html</link><pubDate>Sun, 12 Mar 2023 01:43:00 +0800</pubDate><guid>https://blog.tama.guru/record/pve_install.html</guid><description>&lt;p>安装PVE并不复杂，相关操作网上一抓一大把此处不再赘述。
此处主要记录一些安装后碰上的问题以及对应的解决方案。
#####&lt;center>开启硬件直通&lt;/center>#####
1.首先确保CPU带有虚拟化能力。对于AMD平台，在&lt;code>BIOS的高级&amp;gt;CPU设置&lt;/code>查看是否有能开启&lt;code>SVM Mode&lt;/code>。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cb997ec1de.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cb997ec1de.png" alt="2023-03-11T17:25:44.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cb997ec1de.png"
loading="lazy"
alt="2023-03-11T17:25:44.png"
>确认能打开后，到&lt;code>高级&amp;gt;AMD CBS&amp;gt;NBIO Common Options&amp;gt;NB Configuration&lt;/code>下把&lt;code>IOMMU&lt;/code>打开。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cba128c724.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cba128c724.png" alt="2023-03-11T17:27:47.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cba128c724.png"
loading="lazy"
alt="2023-03-11T17:27:47.png"
>
2.进入系统控制台，修改grub启动时添加硬件直通功能。
打开&lt;code>/etc/default/grub&lt;/code>
将&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>进行修改。&lt;/p>
&lt;p>对于AMD平台修改为&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet amd_iommu=on iommu=pt video=efifb:off,vesafb:off&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>对于Intel平台修改为&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet intel_iommu=on iommu=pt video=efifb:off,vesafb:off&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改完成后执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">update-grub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>并添加以下模块到内核中：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo vfio &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo vfio_iommu_type1 &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo vfio_pci &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo vfio_virqfd &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>添加完成后重启。
#####&lt;center>替换源&lt;/center>#####
执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#先把企业源换掉&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">rf&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pve&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">repo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;#deb https://enterprise.proxmox.com/debian/pve Bookworm pve-enterprise&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pve&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">enterprise&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#替换其他软件源&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">mirrors&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ustc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">edu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cn&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">release&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bookworm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">trusted&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">release&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bookworm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb https://mirrors.ustc.edu.cn/proxmox/debian/pve bookworm pve-no-subscription&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pve&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">no&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">subscription&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb https://mirrors.ustc.edu.cn/proxmox/debian/ceph-pacific bookworm main&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ceph&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> &lt;span class="s2">&amp;#34;s#http://download.proxmox.com/debian#https://mirrors.ustc.edu.cn/proxmox/debian#g&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">CLI&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pveceph&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> &lt;span class="s2">&amp;#34;s#ftp.debian.org/debian#mirrors.aliyun.com/debian#g&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="s2">&amp;#34;s#security.debian.org#mirrors.aliyun.com/debian-security#g&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>最后执行更新&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apt update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#####&lt;center>关闭订阅提示&lt;/center>#####
修改文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">javascript&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">widget&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">toolkit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmoxlib&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>搜索 &lt;code>data.status.toLowerCase&lt;/code>，并将框中内容删除：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbd6c8417c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbd6c8417c.png" alt="2023-03-11T17:42:05.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbd6c8417c.png"
loading="lazy"
alt="2023-03-11T17:42:05.png"
>
再次搜索 &lt;code>data.status.toLowerCase&lt;/code>，并将框中内容删除：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbda27355a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbda27355a.png" alt="2023-03-11T17:42:59.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbda27355a.png"
loading="lazy"
alt="2023-03-11T17:42:59.png"
>
之后重启平台。
#####&lt;center>无法使用mkfs格式化硬盘&lt;/center>#####
如果提示：
&lt;code>apparently in use by the system; will not make a filesystem here!&lt;/code>
则先执行
&lt;code>dmsetup remove_all&lt;/code>
再执行
&lt;code>mkfs.filesystem /dev/disk&lt;/code>
#####&lt;center>手动挂载已有硬盘&lt;/center>#####
首先通过&lt;code>fdisk -l&lt;/code>查询硬盘/分区的路径
如需要挂载的设备为：
&lt;code>/dev/sdc4 83888128 468862094 384973967 183.6G Linux filesystem&lt;/code>
接下来通过&lt;code>blkid``查询设备UUID及分区类型 如查询结果为： &lt;/code>/dev/sdc4: UUID=&amp;ldquo;b958d02b-9f99-4e48-bacf-xxxxxxxx&amp;rdquo; BLOCK_SIZE=&amp;ldquo;512&amp;rdquo; TYPE=&amp;ldquo;xfs&amp;rdquo; PARTUUID=&amp;ldquo;beabe66d-07c2-2d4b-9836-xxxxxxx&amp;rdquo;&lt;code> 如果需要挂载的是硬盘，接下来需要的是UUID，如果需要的是分区，则需要PARTUUID，另一个参数`type=&amp;quot;xfs&amp;quot;`表明了文件系统类型 修改&lt;/code>/etc/fstab```添加以下内容&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">UUID=&amp;#34;b958d02b-9f99-4e48-bacf-xxxxxxxx&amp;#34; /mnt/rootfs2 xfs defaults 0 0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>第二个参数是需要挂载的目录位置。最后执行
&lt;code>mount -a&lt;/code>即可。
#####&lt;center>使用lxc安装docker&lt;/center>#####
1、首先进行换源操作&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">APLInfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">APLInfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm_back&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="s1">&amp;#39;s|http://download.proxmox.com|https://mirrors.tuna.tsinghua.edu.cn/proxmox|g&amp;#39;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">APLInfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>更换完成后重启pve。
2、接下来进入PVE网页端，按如下操作安装debian软件包。（选择的目录应有CT镜像功能）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d92828b077.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d92828b077.png" alt="2023-03-12T08:51:14.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d92828b077.png"
loading="lazy"
alt="2023-03-12T08:51:14.png"
>之后等待窗口提示&lt;code>TASK OK&lt;/code>。
3、点击右上角的&lt;code>创建CT&lt;/code>，配置常规选项：特别要记住&lt;code>CT ID&lt;/code>，并把&lt;code>无特权的容器&lt;/code>的勾取消掉。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93a5acf5c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93a5acf5c.png" alt="2023-03-12T08:56:05.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93a5acf5c.png"
loading="lazy"
alt="2023-03-12T08:56:05.png"
>
模板刚才下载的目录位置以及模板。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93cd17138.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93cd17138.png" alt="2023-03-12T08:56:45.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93cd17138.png"
loading="lazy"
alt="2023-03-12T08:56:45.png"
>
磁盘空间根据实际情况给，建议20G以上。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93f8bccc7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93f8bccc7.png" alt="2023-03-12T08:57:28.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93f8bccc7.png"
loading="lazy"
alt="2023-03-12T08:57:28.png"
>
核心数分配根据机器的实际情况配置。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9413db27b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9413db27b.png" alt="2023-03-12T08:57:56.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9413db27b.png"
loading="lazy"
alt="2023-03-12T08:57:56.png"
>
内存设置考虑到后期我需要运行的Docker内容较多，我设置为1024，如果配置较低或者使用负载较小可以设置512，Swap同理。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9459ae6d2.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9459ae6d2.png" alt="2023-03-12T08:59:05.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9459ae6d2.png"
loading="lazy"
alt="2023-03-12T08:59:05.png"
>
网络选项根据自己内网路由情况进行编辑，不建议使用DHCP，因为我经常找不到IP。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94b3dfa2c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94b3dfa2c.png" alt="2023-03-12T09:00:35.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94b3dfa2c.png"
loading="lazy"
alt="2023-03-12T09:00:35.png"
>
DNS设置使用默认即可。然后确认信息无误点击完成，等待&lt;code>TASK OK&lt;/code>。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94e514dbc.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94e514dbc.png" alt="2023-03-12T09:01:25.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94e514dbc.png"
loading="lazy"
alt="2023-03-12T09:01:25.png"
>
然后进入Docker的容器选项设置，把功能中以下内容勾选。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d953d9bdd1.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d953d9bdd1.png" alt="2023-03-12T09:02:53.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d953d9bdd1.png"
loading="lazy"
alt="2023-03-12T09:02:53.png"
>
接下来进入终端，修改配置文件，如我的lxc容器id是&lt;code>100&lt;/code>，则修改
&lt;code>/etc/pve/lxc/100.conf&lt;/code>
在文件末尾添加以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">lxc.apparmor.profile: unconfined
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.cgroup.devices.allow: a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.cap.drop:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#以上三行是必备的，以下两行是用来开启容器tun转发的，不是必须的
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.cgroup2.devices.allow: c 10:200 rwm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.mount.entry: /dev/net/tun dev/net/tun none bind,create=file
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改后整个文件应该看起来像：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d960b5a827.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d960b5a827.png" alt="2023-03-12T09:06:19.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d960b5a827.png"
loading="lazy"
alt="2023-03-12T09:06:19.png"
>
接下来点击Docker界面的启动，等待启动完成。
4、进入Docker的控制台，修改软件源：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">修改 /etc/apt/sources.list替换成以下内容：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-backports main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-backports main contrib non-free
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>执行&lt;code>apt update&lt;/code>更新。
5、
执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apt&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">docker&lt;/span> &lt;span class="n">run&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">restart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">always&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;portainer&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">p&lt;/span> &lt;span class="mi">9000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sock&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">portainer_data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span> &lt;span class="mi">6053537&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">portainer&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ce&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>进入容器IP:9000即可看到Docker控制界面。
#####&lt;center>开机提示ACPI BIOS Error(bug)&amp;hellip;&lt;/center>#####
在引导界面按e，并在linux行的最后添加&lt;code>acpi_backlight=vendor&lt;/code>
这种情况一般是修改显卡直通之后出现的，而在网上查了一圈，好像也只有华擎主板有这个问题&amp;hellip;&lt;a class="link" href="https://post.smzdm.com/p/akko88w8/" target="_blank" rel="noopener"
>参考链接&lt;/a>&lt;/p>
&lt;p>#####&lt;center>挂载现有硬盘到虚拟机或lxc容器&lt;/center>#####
先获取分区的识别符
&lt;code>ls -l /dev/disk/by-id&lt;/code>
例如本次要挂载的分区为&lt;code>ata-b958d02b-9f99-4e48-bacf-xxxxxxxx&lt;/code>
如果要挂载到虚拟机上，则执行
&lt;code>qm set 虚拟机ID -sata1 /dev/disk/by-id/硬盘识别符&lt;/code>
如果要挂载到LXC容器内，则执行
&lt;code>pct set 容器ID -mp0 /dev/disk/by-uuid/硬盘识别符,mp=/挂载路径&lt;/code>
如果已经在pve上挂载硬盘想映射进lxc容器，可以执行：
&lt;code>pct set 容器ID -mp0 /pve上挂载位置,mp=/lxc挂载路径&lt;/code>
同理可将pve上的任意路径挂载进容器中。
#####&lt;center>PVE8.0创建LXC容器之后无法进入ssh&lt;/center>#####
更新到8.0之后发现怎么创建容器都进不去SSH，具体是：控制台一片空白；XSHELL连接提示拒绝访问；宿主机使用&lt;code>ssh root@192.168.xx.xx&lt;/code>提示&lt;code>Permission denied, please try again.&lt;/code>（密码是正确的）
这种情况下可以先进入宿主机的ssh，执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">VMID Status Lock Name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">101 running docker12
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>当前我运行的lxc容器ID是101，因此执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@docker12:/etc/ssh#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这样就能进来了。
再编辑下&lt;code>/etc/ssh/sshd_config&lt;/code>，把&lt;code>PermitRootLogin&lt;/code>改成&lt;code>yes&lt;/code>，再重启下sshd服务，这次能正常登陆了。&lt;/p></description></item><item><title>解决Debian11安装慢问题的一些歪门邪道</title><link>https://blog.tama.guru/record/debian_install_slow.html</link><pubDate>Wed, 08 Mar 2023 16:02:24 +0800</pubDate><guid>https://blog.tama.guru/record/debian_install_slow.html</guid><description>&lt;p>前几天安装Debian的时候，在&lt;code>Select and install software&lt;/code>过程总是报错后终止安装进程，强制进入下一步安装引导会提示没有安装grub引导器可能会导致无法启动，查了一些资料后都在说是&lt;code>debian-security&lt;/code>这个源在国外，直接连接速度极慢（体现为这一步下载4个文件需要几个小时，而且极大可能会突然连接不上然后安装失败）。
那么就有说在这一步之前选择&lt;code>不使用网络源&lt;/code>并且按&lt;code>Ctrl+Alt+F2&lt;/code>切换到其他tty：
修改&lt;code>/target/etc/apt/sources.list&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#修改debian-security为国内源或者直接屏蔽掉这一行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#deb http://security.debian.org/debian-security bullseye-security main
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>但是实际就算是把源换成国内的或是屏蔽掉，在点击下一步之后还是会把&lt;code>security.debian.org&lt;/code>这个源还原回来，然后继续卡着&amp;hellip;
那么就有两种办法，
###一、全局代理###
这种方法我还没试过，不过觉得是可行的，需要在路由器或者上级网络配置好全局国外代理。使用手机USB网络或者热点可能有些问题，因为在这一步WIFI和USB网卡驱动还没能安装。
###二、拔网线###
在进入&lt;code>是否选择网络源&lt;/code>这个界面的时候把网线拔了再点下一步，这样就默认只使用本地介质上的资源进行更新。最好不要全程断网（进系统之后你需要自己配置网卡设置）或是在这之前断网（尝试在DHCP配置完成之后、是否选择网络源之前拔掉网线，会有可能导致安装进程卡住。），等待安装完成后再把网线接回去。&lt;/p></description></item><item><title>目前能访问OpenGPT的方法</title><link>https://blog.tama.guru/record/accessofopengpt.html</link><pubDate>Sat, 11 Feb 2023 18:29:00 +0800</pubDate><guid>https://blog.tama.guru/record/accessofopengpt.html</guid><description>&lt;p>目前访问&lt;a class="link" href="https://chat.openai.com/" target="_blank" rel="noopener"
>ChatGPT主页&lt;/a>多半会得到以下几种结果：
####·OpenAI‘s services are not available in your country·####
如果你没挂梯子，那么请挂上梯子并打开全局代理模式，选择除香港外的服务器。
如果想使用规则模式，那么需要把以下内容添加到规则模式&lt;code>DOMAIN-SUFFIX&lt;/code>：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">openai.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auth0.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sentry.io
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">google.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">googleapis.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hcaptcha.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">recaptcha.net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gstatic.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gvt2.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gvt1.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gvt3.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">msftconnecttest.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">live.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sfx.ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">microsoft.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>####·Access Denied·####
过于频繁的切换服务器/当前IP已经被BAN。
####·访问&lt;a class="link" href="https://www.bing.com/new" target="_blank" rel="noopener"
>新必应&lt;/a>提示404后跳转到必应中国·####
参考：&lt;a class="link" href="https://bbs.pcbeta.com/viewthread-1958967-1-1.html" target="_blank" rel="noopener"
>PCBeta&lt;/a>
需要安装插件&lt;a class="link" href="https://microsoftedge.microsoft.com/addons/detail/gooreplacer/cidbonnpjopamnhfjdgfcmjmlmehjnej?hl=zh-CN" target="_blank" rel="noopener"
>Gooreplacer&lt;/a>，请求/相应头设置如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">动作类型：修改
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">键名：x-forwarded-for
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">键值：1.1.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">匹配模式：^http(s?)://(www\.)?bing\.com/?(.*)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">匹配类型：正则表达式
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>设置页面保留所有&lt;code>ON&lt;/code>。
再进入&lt;a class="link" href="https://www.bing.com/new" target="_blank" rel="noopener"
>新必应&lt;/a>即可看到加入队列的选项。
####·新必应加入等待列表提示“出错了，请重试”·####
官方回复：&lt;a class="link" href="https://answers.microsoft.com/zh-hans/microsoftedge/forum/all/microsoft-%E6%96%B0%E5%BF%85%E5%BA%94/15dc9cb5-86ae-4f2c-9f27-f09f7bae901c" target="_blank" rel="noopener"
>官方社区答疑&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">可能受当前地区、网络 IP、申请频繁、频繁更换 IP 来源影响导致暂时禁止访问，
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">您可以耐心等待一段时间或几天后再进行加入申请，看看是否可行；
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">如果急需体验 Microsoft 新必应相关的功能的话，或许可以尝试通过重新注册新的 Microsoft 账户来申请加入，看看是否可行。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>捣鼓SteamDeck的那些事</title><link>https://blog.tama.guru/record/steamdeck.html</link><pubDate>Thu, 02 Feb 2023 09:47:00 +0800</pubDate><guid>https://blog.tama.guru/record/steamdeck.html</guid><description>&lt;p>I have a d○ck.
不得不说，这东西挺有意思的，amd定制的zen2架构CPU及性能相当于1050的显卡能够应付大部分场景使用以及轻度游戏，还能轻松安装SteamOS+WIN10/11组合，玩一些原系统上因为各种原因玩不了的游戏，如果空间不够，还能自己买一个2230的M2换上去。但是在使用过程中这玩意其实坑挺多的，想要快乐玩耍掌握一些linux基础知识以及“合适的网络”是必不可少的。下面是我在使用过程中碰到的一些问题以及解决办法。
####·首次开机联网后一直提示正在安装，然后卡在还剩1秒或者弹窗报错·####
基本上是国内专属问题了，归根结底就是网络原因和&amp;quot;steam.cloud&amp;quot;连接有问题导致更新无法进行，而更新又是必须的就导致了这个死循环。
有网友说我有科技，直接开科技不就行了？如果是在路由的话这必须要设置全局代理，因为SteamDeck的WIFI连接界面不能手动设置代理。用手机开热点或许也是一个好办法，但是实测我的流量根本没走，可能是我的姿势不对吧。
还有网友说在安装界面直接长按电源键硬重启，多几次就能跳过，我试了四五次也不行。其中一次关机重启后进入到一个有LOGO+进度条及网速的界面，也在提示install update，但是更新完自动重启之后还是问题依旧。
目前我唯一测试通过的方法就是手机挂UU加速器（亲测雷神无效）加速steam（仅加速商店是免费的），然后开热点，SteamDeck这边开机的时候要设置为英文+UTC-8时区（即默认设置）再连接热点更新，大概率等待半小时就能通过了，手机这边如果开了流量监控，就会发现流量基本1.5m/s这个速度走（峰值4-5m/s），如果没动的话，建议重启加速器或是点击SteamDeck上的Back返回上一步重新开始，直到流量正常出去。大概也就花费1-2G。（下图是我更新了两次）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/02/02/63db0743c8f68.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/02/02/63db0743c8f68.png" alt="2023-02-02T00:43:46.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/02/02/63db0743c8f68.png"
loading="lazy"
alt="2023-02-02T00:43:46.png"
>&lt;/p>
&lt;p>####·登录不上Steam账号·####
首次登录可能会遇到这个问题，开加速器即可。&lt;/p>
&lt;p>####·我想换SSD，应该注意什么·####
必须换2230长度的M2硬盘替换，一般能买到的都是二手的SN740或者530（530存货比较少反而比较贵），其他长度的硬盘虽然能够魔改替换上去但是会严重影响和硬盘紧贴在一起的电源芯片的散热，有烧鸡可能。详细拆机更换流程可以直接参考&lt;a class="link" href="https://zh.ifixit.com/Guide/Steam&amp;#43;Deck&amp;#43;SSD&amp;#43;%E6%9B%B4%E6%8D%A2/148989" target="_blank" rel="noopener"
>iFixit&lt;/a>或者对着&lt;a class="link" href="https://www.acfun.cn/v/ac39982689" target="_blank" rel="noopener"
>拆机视频&lt;/a>操作即可。切记拆机后断开电源再换盘。&lt;/p>
&lt;p>####·我想在固态上装双系统，而且开机能够选择引导·####
主要分为以下几个步骤：在U盘上载入一个带gparted的系统&amp;ndash;&amp;gt;拆出分区&amp;ndash;&amp;gt;装系统&amp;ndash;&amp;gt;做引导。
（1）建议找一块USB3.0的U盘，到此处下载&lt;a class="link" href="https://github.com/ventoy/Ventoy/releases" target="_blank" rel="noopener"
>Ventoy&lt;/a>最新版本，下载解压执行Ventoy2Disk.exe，插入U盘后点击安装会把P盘数据格式化，然后生成一个Ventoy的空盘，&lt;a class="link" href="https://downloads.sourceforge.net/gparted/gparted-live-1.4.0-6-amd64.iso" target="_blank" rel="noopener"
>下载gparted&lt;/a>或其他带gparted的系统镜像直接扔进这个空盘，同时准备好WIN10/11的系统镜像，也一并放进去。
（2）把SteamDeck关机，用OTG或拓展坞把U盘连接到SteamDeck。按音量-及电源键一秒进入启动项选择，进入Boot from USB,然后会弹出Ventoy的启动界面并显示所有的镜像，选择下载好的gparted的iso镜像，选择normal启动，然后一路回车就进入镜像了。
（3）选择最大的分区将其resize，在最后部分调整出一块200G的空间，然后新增两个NTFS分区，一个用于装系统（80G），一个用于与SteamOS共享数据及给WIN装游戏。（根据实际情况自行调整）调整完后关机。
（4）按步骤2进入启动项选择，这次选择WIN镜像，后续步骤不再赘述，安装步骤和一般装系统完全一致。
（5）等安装完成后重启进入启动项选择，进入SteamOS并进入桌面模式，在右下角菜单找到系统&amp;gt;终端，&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">passwd&lt;/span> &lt;span class="c1">#修改默认密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">passwd&lt;/span> &lt;span class="c1">#修改root密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">steamos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">readonly&lt;/span> &lt;span class="n">disable&lt;/span> &lt;span class="c1">#关闭系统只读&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">git&lt;/span> &lt;span class="n">clone&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">jlobue10&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SteamDeck_rEFInd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mv&lt;/span> &lt;span class="n">SteamDeck_rEFInd&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">SteamDeck_rEFInd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">SteamDeck_rEFInd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Downloads&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">chmod&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="n">refind_install_no_pacman&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">sh&lt;/span> &lt;span class="n">refind_install_no_pacman&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>至此引导脚本安装完成，重启之后就能看到StemaOS和WIN的两个LOGO了，五秒内不选择默认从SteamOS启动。之所以选择&lt;code>refind_install_no_pacman.sh&lt;/code>是因为SteamOS默认情况下要开启pacman非常麻烦，而且后续升级的话pacman安装的相关软件都会丢失仅保留配置。&lt;/p>
&lt;p>####·我想玩学习版游戏·####
自测了几个proton版本以及proton next还有heroics game launcher，还是有很多游戏没办法正常启动，建议直接上WIN系统。&lt;/p>
&lt;p>####·WIN系统设备管理器里面安装了Steam官方的驱动之后还是有几个感叹号·####
截止2023.2.2，Steam官方仅提供了APU（显卡+声音）、声卡、蓝牙、读卡器、WIFI驱动，一部分驱动在WINDOWS系统更新后自动安装，剩余的部分驱动等待官方跟进放出。&lt;/p>
&lt;p>####·进入gparted镜像时报错无法进入图形界面·####
如果提示&lt;code>I/O error, dev mmcblk0, sector x op 0x0:(READ) flags 0x0 phys_seg&lt;/code>，请检查是否插入了SD卡，如果有，先拔出再重新进入。&lt;/p>
&lt;p>####·steam内游戏下载速度慢·####
去设置看看下载服务器是否本地位置，不然就开加速器（例如我进系统他自己给我调整到日本札幌，换回国内重启后速度就上来了）。&lt;/p>
&lt;p>####·桌面模式的discovery商店访问速度慢·####
Steam桌面商店使用的是flathub源，默认使用的是&lt;code>https://glathub.org/repo&lt;/code>，在国内访问较慢，建议换到上海交大源：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo steamos-readonly disable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo flatpak remote-modify flathub --url=https://mirror.sjtu.edu.cn/flathub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后进商店里面更新一下就好了。&lt;/p>
&lt;p>####·我账号很多想用家庭共享，但是好像不起作用·####
因为家庭共享是基于设备的，只在电脑上开通在deck上市无法启用的。这种情况下只能先登陆需要共享的账号，下载个游戏，然后登陆另外一个账号，这里会显示成“借用”状态，点击申请授权即可。&lt;/p>
&lt;p>####·怎么进BIOS/启动菜单·####
关机状态下：
&lt;code>音量&lt;/code>+ &amp;amp; &lt;code>电源键&lt;/code> 一秒（有提示音就放手） = &lt;code>BIOS设置&lt;/code>
&lt;code>音量&lt;/code>- &amp;amp; &lt;code>电源键&lt;/code> 一秒（有提示音就放手） = &lt;code>引导选择&lt;/code>&lt;/p>
&lt;p>####·怎么使用Steam自带的Proton环境·####
在桌面模式下进入Steam，选择添加非Steam游戏，对话框默认之能选择&lt;code>.desktop&lt;/code>修改成&lt;code>all files&lt;/code>，然后选择需要执行的&lt;code>.exe&lt;/code>文件，保存后右键Steam中生成的项目选择属性，兼容性设置中勾选强制使用，然后选择任意一个已安装的Proton环境，再运行即可。&lt;/p>
&lt;p>####·Steam自带的Proton在哪个路径·####
以Proton7.0为例，其目录位于&lt;code>/home/desk/.local/.(忘了，待查)./driver_c/&lt;/code>&lt;/p>
&lt;p>####·连接了其他设备切换模式后还能用吗·####
亲测可以。以蓝牙设备为例，在游戏模式下连接键鼠后切换到桌面模式能正常使用。&lt;/p>
&lt;p>（未完待续）&lt;/p></description></item><item><title>WIN11连接老版本系统（WIN7-WIN10）打印机提示0X000000709的解决方法</title><link>https://blog.tama.guru/record/0X000000709.html</link><pubDate>Mon, 09 Jan 2023 15:24:10 +0800</pubDate><guid>https://blog.tama.guru/record/0X000000709.html</guid><description>&lt;p>去年年末我们单位新采购了几台电脑，毫无意外的全部都是预装WIN11(22H2)，本来还美滋滋，一到连接打印机的时候就开始不对劲了，无论怎么连接都连接不上，叫技术人员上来给出几个解决方案：一、把打印机连接到这台新电脑（这样其他电脑就连接不上了）；二、把系统降下WIN10；三、让别人帮打印。
结果我在网上找了几个方法，最终生效的有且只有一个。
&lt;br>
方法一：最多的方法是修改&lt;code>C:\Windows\System32\win32spl.dll&lt;/code>文件，网上有很多版本，也有做成脚本的，根据系统的型号覆盖后重启。以失败告终，依旧报错0X000000709。
&lt;br>
方法二：修改注册表。即把以下内容保存成reg文件，导入注册表后重启。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Windows Registry Editor Version 5.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">［HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print］
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">“RpcAuthnLevelPrivacyEnabled”=dword:00000000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">［HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint］
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">“RestrictDriverInstallationToAdministrators”=dword:00000000
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>结果：重启后依旧提示失败，报错0X000000709。
&lt;br>
方法三：在Windows功能中启用&lt;code>LPD打印服务&lt;/code>及&lt;code>LPR端口监视器&lt;/code>，然后&lt;code>通过手动设置添加本地打印机或网络打印机&lt;/code>，创建一个新LPR端口并绑定到远程IP。
结果：重启后依旧提示失败，报错0X000000709。
&lt;br>
方法四：在&lt;code>控制面板\所有控制面板项\凭据管理器&lt;/code>下的&lt;code>Windows凭据&lt;/code>添加一个Windows凭据，地址选填网络打印机所在的IP/计算机名，用户名填写&lt;code>guest&lt;/code>，密码不填。
结果：能连接，打印成功。&lt;/p></description></item><item><title>安装最新版nodejs的正确方法</title><link>https://blog.tama.guru/record/iwannanewnodejs.html</link><pubDate>Sat, 31 Dec 2022 21:13:00 +0800</pubDate><guid>https://blog.tama.guru/record/iwannanewnodejs.html</guid><description>&lt;p>::acfun:02:: 安装这个nodejs真的要命！首先是官方库里面的版本过老，如果通过添加源的方式更新一方面是更新速度极慢，另一方面则是可能会碰到“由于没有公钥，无法验证下列签名”这个怪问题，查了好多文章都无法解决。&lt;/p>
&lt;p>替换树莓派默认的node.js和npm
一、删除默认安装的软件
卸载nodejs
&lt;code>sudo apt-get remove nodejs&lt;/code>
清除软件包以及相关配置
&lt;code>sudo apt-get purge nodejs&lt;/code>
二、查看内核版本：
&lt;code>Linux tamapi 5.15.76-v8+ #1597 SMP PREEMPT Fri Nov 4 12:16:41 GMT 2022 aarch64 GNU/Linux&lt;/code>
aarch64 那我就选arm64版本的
三、下载最新版的 nodejs：此处是node19
&lt;code>https://nodejs.org/dist/latest-v19.x/node-v19.3.0-linux-arm64.tar.gz&lt;/code>
四、解压压缩包
&lt;code>tar -zxvf node-v19.3.0-linux-arm64.tar.gz&lt;/code>
五、删除系统上的旧目录（如果存在）
&lt;code>sudo rm /usr/bin/node&lt;/code>
&lt;code>sudo rm /usr/bin/npm&lt;/code>
六、将文件复制到指定位置
&lt;code>sudo mv ./node-v19.3.0-linux-arm64 /usr/local/node&lt;/code>
七、node 和 npm 创建软连接
&lt;code>sudo ln -s /usr/local/node/bin/node /usr/bin/node&lt;/code>
&lt;code>sudo ln -s /usr/local/node/bin/npm /usr/bin/npm&lt;/code>
八、检查软件安装是否成功
&lt;code>node -v&lt;/code>
v19.3.0
&lt;code>npm -v&lt;/code>
9.2.0&lt;/p></description></item><item><title>通过自购礼品卡在日服applestore充值使用（也适用于美服）</title><link>https://blog.tama.guru/record/apple_jp_giftcard.html</link><pubDate>Tue, 06 Dec 2022 00:23:34 +0800</pubDate><guid>https://blog.tama.guru/record/apple_jp_giftcard.html</guid><description>&lt;p>请注意充值时拥有日本IP！请注意充值时拥有日本IP！请注意充值时拥有日本IP！&lt;/p>
&lt;p>通常情况下，在日服需要充值金额要通过以下几种方案：&lt;/p>
&lt;ul>
&lt;li>JCB 信用卡（不适用美服）：需要申请一张JCB国际信用卡，基本上各大银行都会有提供，此方案好就好在可以直接绑定到账户进行消费而不需要通过礼品卡渠道。&lt;/li>
&lt;li>购买礼品卡：一般情况下很多人会选择到淘宝或者其他平台购买礼品卡，虽然方便，但是一个重要的问题是如果卖家使用黑卡买的礼品卡，那么你的账号可能也会受牵连。所以如果你恰好有一张外币卡（Visa或者MasterCard都行，各大银行都可以），就可以自己到日服apple store购买礼品卡，安全性大大提高。&lt;/li>
&lt;li>我在日本有熟人。&lt;/li>
&lt;/ul>
&lt;!--more-->
&lt;p>以下对自有外币卡购买礼品卡进行介绍：&lt;/p>
&lt;ol>
&lt;li>进入[官网][1]，一定要进对，如果不小心买了用于购买硬件和外设的卡，那你就只能想办法电话到日本联系退款了。
先点击&lt;code>購入&lt;/code>。&lt;/li>
&lt;/ol>
&lt;p>![2022-12-05T16:03:05.png][2]
之后第一个默认选择email接收，第二个是卡面，随便选，第三项是充值金额，最后一项是&lt;code>その他の金額&lt;/code>可以输入整数的其他金额。
![2022-12-05T16:04:46.png][3]
再后来是填写收寄方信息：&lt;code>受取人の名前&lt;/code>即收方名字，&lt;code>受取人のメールアドレス&lt;/code>即收方邮件地址（之后礼品卡号会发到这个邮箱），同理差出人名字和邮箱也需要填写。（名字可以随意写，但是最好真实些）&lt;code>あなたからのメッセージを追加しますか？&lt;/code>追加其他信息这里没必要填。最后点击&lt;code>バッグに追加&lt;/code>。
![2022-12-05T16:07:29.png][4]![2022-12-05T16:12:03.png][5]
之后会进入确认界面，需要确认金额以及&lt;code>宛先:``差出人:&lt;/code>信息是否正确，正确点击&lt;code>注文手続きへ&lt;/code>进入下一步。
![2022-12-05T16:14:16.png][6]
如果之前有登录了apple id，会跳过这一步，如果没登陆，直接点击右侧的&lt;code>続行してApple IDを後で作成します。&lt;/code>进入下一步![2022-12-05T16:16:48.png][7]&lt;/p>
&lt;ol start="2">
&lt;li>填写付款信息。选择&lt;code>一般的な支払い方法&lt;/code>下的&lt;code>クレジットカードまたはデビットカード&lt;/code>然后按照下图填写信息。
![2022-12-05T16:21:11.png][8]
注意，信息不能太离谱，实在不会写的去网上找生成器。&lt;code>携帯電話番号はありません。&lt;/code>一定要勾选，然后在上面填写一个日本的座机号，之后点击&lt;code>注文の確認&lt;/code>，扣款短信就会发到手机上了。&lt;/li>
&lt;/ol>
&lt;!--more-->
&lt;p>接下来的部分下次充值再写。
[1]: &lt;a class="link" href="https://www.apple.com/jp/shop/gift-cards" target="_blank" rel="noopener"
>https://www.apple.com/jp/shop/gift-cards&lt;/a>
[2]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e163682a9f.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e163682a9f.png&lt;/a>
[3]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e169c0e420.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e169c0e420.png&lt;/a>
[4]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e173ee025f.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e173ee025f.png&lt;/a>
[5]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e18501b7ab.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e18501b7ab.png&lt;/a>
[6]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e18d5f4072.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e18d5f4072.png&lt;/a>
[7]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e196dcaa02.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e196dcaa02.png&lt;/a>
[8]: &lt;a class="link" href="https://r2.337845818.best/oss-to-r2/2022/12/06/638e1a7472944.png" target="_blank" rel="noopener"
>https://r2.337845818.best/oss-to-r2/2022/12/06/638e1a7472944.png&lt;/a>&lt;/p></description></item><item><title>Switch15.0.1大气层系统升级的记录（整合包）-更新到17.0.1</title><link>https://blog.tama.guru/record/switch_Atmosphere.html</link><pubDate>Sun, 27 Nov 2022 01:15:00 +0800</pubDate><guid>https://blog.tama.guru/record/switch_Atmosphere.html</guid><description>&lt;p>目前系统是已经硬破的状态，且能正常运行，但是版本已经有点老了（Atmosphere版本14），导致目前有部分新的游戏无法运行，因此在此记录Switch升级大气层系统的相关步骤。&lt;/p>
&lt;p>事前准备：&lt;/p>
&lt;ul>
&lt;li>一台Switch，已经硬破（软破需要看ShallowSea的说明文档，会多出来两个步骤）&lt;/li>
&lt;li>确保Switch有足够的电。。。&lt;/li>
&lt;li>Switch固件，&lt;a class="link" href="https://darthsternie.net/switch-firmwares/" target="_blank" rel="noopener"
>下载地址&lt;/a>,当前最新15.0.1&lt;/li>
&lt;li>ShallowSea整合包，&lt;a class="link" href="https://github.com/carcaschoi/ShallowSea" target="_blank" rel="noopener"
>下载地址&lt;/a>，当前最新2.12.4，相关说明可以看&lt;a class="link" href="https://github.com/carcaschoi/ShallowSea/blob/main/docs/User%20guide.md" target="_blank" rel="noopener"
>这里&lt;/a>。下载地址会标注整合包支持的系统版本。
&lt;scode type=red>请注意，ShallowSea因DMCA已经被屏蔽，其他固件请参考https://www.gamer520.com/48671.html&lt;/scode>&lt;/li>
&lt;/ul>
&lt;!--more-->
&lt;p>下面开始升级。&lt;/p>
&lt;ul>
&lt;li>取出Switch上的SD卡，删除除了&lt;code>emmMMC&lt;/code> &lt;code>Nintendo&lt;/code> 和你保存游戏的文件夹之外的其他所有文件。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/638241260e32a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638241260e32a.png" alt="2022-11-26T16:39:02.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638241260e32a.png"
loading="lazy"
alt="2022-11-26T16:39:02.png"
>&lt;/li>
&lt;li>把ShallowSea整合包&lt;code>ShallowSea-ams.zip&lt;/code>解压覆盖到SD卡上。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/6382414d42649.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/6382414d42649.png" alt="2022-11-26T16:39:41.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/6382414d42649.png"
loading="lazy"
alt="2022-11-26T16:39:41.png"
>&lt;/li>
&lt;li>在SD卡上新建一个&lt;code>firmware&lt;/code>文件夹（或者其他英文文件夹），把Switch固件解压其中。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/26/6382365a2312d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/26/6382365a2312d.png" alt="2022-11-26T16:09:39.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/26/6382365a2312d.png"
loading="lazy"
alt="2022-11-26T16:09:39.png"
>&lt;/li>
&lt;li>确认文件完整后弹出SD并插入Switch上。&lt;/li>
&lt;li>插入注入器和短路器，&amp;quot;+&amp;ldquo;与电源键蓝灯进入引导
正常进入系统，设置里的主机-更新主机的Atmosphere版本已经升级到了最新1.4.0
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/638247fc998d5.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638247fc998d5.png" alt="2022-11-26T17:08:12.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638247fc998d5.png"
loading="lazy"
alt="2022-11-26T17:08:12.png"
>&lt;/li>
&lt;li>接下来升级系统，进入相册-Daybreak
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/6382483aa25e9.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/6382483aa25e9.png" alt="2022-11-26T17:09:14.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/6382483aa25e9.png"
loading="lazy"
alt="2022-11-26T17:09:14.png"
>&lt;/li>
&lt;li>选择Install，并进入之前下载了15.0.1固件的文件夹&lt;code>Firmware&lt;/code>，弹出Update infomation等待验证完成后选择&lt;code>Continue&lt;/code>,Select driver variant选择&lt;code>Install(FAT32+exFAT)&lt;/code>,等待升级完成后选择&lt;code>Reboot&lt;/code>重启。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/638248ab215ba.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638248ab215ba.png" alt="2022-11-26T17:11:07.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638248ab215ba.png"
loading="lazy"
alt="2022-11-26T17:11:07.png"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/638248c432267.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638248c432267.png" alt="2022-11-26T17:11:32.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638248c432267.png"
loading="lazy"
alt="2022-11-26T17:11:32.png"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/638249433066c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638249433066c.png" alt="2022-11-26T17:13:39.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638249433066c.png"
loading="lazy"
alt="2022-11-26T17:13:39.png"
>
可以看到系统版本也更新了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/27/638249951880a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638249951880a.png" alt="2022-11-26T17:15:01.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/27/638249951880a.png"
loading="lazy"
alt="2022-11-26T17:15:01.png"
>&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>上面的作者整合包Github被DMCA了，目前可以考虑&lt;a class="link" href="https://github.com/Yuanbanba/Atmosphere" target="_blank" rel="noopener"
>https://github.com/Yuanbanba/Atmosphere&lt;/a>这个版本，更新方法一样，保留好SD卡内的Emutendo和Nentendo文件夹（如果没有了也不要紧），其他删掉，再把整合包解压覆盖到SD卡根目录，此包支持系统版本为最高17.0.1，更新方法和上面一样。
为避免惨剧再次发生，以上文件已在云盘做备份：&lt;a class="link" href="https://share.tama.guru/AliDisk/Switch_Games/ROM/17.0.1" target="_blank" rel="noopener"
>https://share.tama.guru/AliDisk/Switch_Games/ROM/17.0.1&lt;/a>&lt;/p></description></item><item><title>Win11安装优化那些事</title><link>https://blog.tama.guru/record/win11_new_setup.html</link><pubDate>Sun, 06 Nov 2022 23:08:00 +0800</pubDate><guid>https://blog.tama.guru/record/win11_new_setup.html</guid><description>&lt;p>坚持了大半年的WIN10今天终于因为不明原因无法启动了（开机无限转圈圈，进入修复模式修复失败无解），于是干脆就把系统换成Win11。自从上次直接从10升11出现一堆bug之后，&lt;del>以及我对阿三一直以来抱有的一种不信任感&lt;/del>让我这半年基本没摸过11，这次就全新安装，给它个面子，看看它能不能给我个面子。&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]安装信息[/scode]
使用的是22H2的消费者版本镜像。安装选择的是Win11专业工作站版。
磁力链：&lt;code>magnet:?xt=urn:btih:85730cfa4be6b8c3e655d76becc2f6d32f261ce4&amp;amp;dn=zh-cn_windows_11_business_editions_version_22h2_updated_oct_2022_x64_dvd_b4e3a4f8.iso&amp;amp;xl=5515886592&lt;/code>&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]激活办法[/scode]
激活还是老样子，可以用KMS激活，或者直接使用&lt;a class="link" href="https://www.nite07.com/aact/" target="_blank" rel="noopener"
>AAct&lt;/a>进行激活。
[scode type=&amp;ldquo;yellow&amp;rdquo;]激活注意事项[/scode]
下载AAct之前需要把Windows安全中心的“病毒和威胁防护”相关设定先关闭，否则会被删除。卡巴斯基反病毒会检测到&lt;code>HEUR:HackTool.Win32.KMSAuto.gen&lt;/code>，反正看你个人。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cba685a30.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cba685a30.png" alt="2022-11-06T14:58:45.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cba685a30.png"
loading="lazy"
alt="2022-11-06T14:58:45.png"
>&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]让任务栏左对齐，使“开始按钮居左[/scode]
右键任务栏，选择任务栏设置，在”任务栏行为&amp;gt;任务栏对其方式选择“靠左”。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cce4d538e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cce4d538e.png" alt="2022-11-06T15:04:03.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cce4d538e.png"
loading="lazy"
alt="2022-11-06T15:04:03.png"
>&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]让右键菜单以传统方式显示[/scode]
Win11最影响体验的改变就是把右键菜单放到第二层，非常浪费时间。以下方法在22H2实验后仍然有效：
以管理员方式运行cmd，并输入
&lt;code>reg add HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32 /ve&lt;/code>
回车后重启资源管理器即可。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cda9357d0.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cda9357d0.png" alt="2022-11-06T15:07:20.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cda9357d0.png"
loading="lazy"
alt="2022-11-06T15:07:20.png"
>&lt;/p>
&lt;p>以下是目前做到的效果，后续有变动再更新。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cdebb7be8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cdebb7be8.png" alt="2022-11-06T15:08:26.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/11/06/6367cdebb7be8.png"
loading="lazy"
alt="2022-11-06T15:08:26.png"
>&lt;/p></description></item><item><title>关于“狼圈子”的使用说明</title><link>https://blog.tama.guru/record/wolf_circle.html</link><pubDate>Sat, 22 Oct 2022 16:00:00 +0800</pubDate><guid>https://blog.tama.guru/record/wolf_circle.html</guid><description>&lt;p>首先，欢迎使用狼圈子。&lt;/p>
&lt;p>[tag type=&amp;ldquo;info&amp;rdquo;]“圈子”是什么？[/tag]
这是一个Typecho上的插件，能够实现类似twitter或者广场的效果，目前本站圈子部分开放注册。
[tag type=&amp;ldquo;info&amp;rdquo;]我该如何注册？是否需要实名？[/tag]
只需要到&lt;a class="link" href="https://blog.tama.guru/guest?auth=signup" target="_blank" rel="noopener"
>这里&lt;/a>像一般网站那样填写信息就行了，请确认电子邮箱是正确的，因为涉及到消息提醒、账号找回都需要通过注册时使用的邮箱。本站不需要填写任何关于实名的信息，如果有，那么你可能碰到骗子了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/63539c332a3a0.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539c332a3a0.png" alt="2022-10-22T07:30:59.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539c332a3a0.png"
loading="lazy"
alt="2022-10-22T07:30:59.png"
>
或者在主界面点击小企鹅可以使用第三方登陆。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/63539c6c244ee.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539c6c244ee.png" alt="2022-10-22T07:31:56.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539c6c244ee.png"
loading="lazy"
alt="2022-10-22T07:31:56.png"
>&lt;/p>
&lt;!--more-->
&lt;p>以下是关于使用的部分说明，按图中顺序进行：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/63539d552ddcf.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539d552ddcf.png" alt="2022-10-22T07:35:49.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539d552ddcf.png"
loading="lazy"
alt="2022-10-22T07:35:49.png"
>
[scode type=&amp;ldquo;lblue&amp;rdquo;]1、博客[/scode]
也就是从圈子返回本站，没什么好说的。
[scode type=&amp;ldquo;lblue&amp;rdquo;]2、动态[/scode]
这里显示的是你自己以及你所关注的人的帖子，就类似于“粉丝可见”。
[scode type=&amp;ldquo;lblue&amp;rdquo;]3、探索[/scode]
探索包含的是全站内容，包括你没关注的人发的消息。探索包含[tag type=&amp;ldquo;info&amp;rdquo;]话题[/tag][tag type=&amp;ldquo;info&amp;rdquo;]用户[/tag][tag type=&amp;ldquo;info&amp;rdquo;]帖子[/tag]三个子页面；话题就是
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/63539e7920e7c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539e7920e7c.png" alt="2022-10-22T07:40:41.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539e7920e7c.png"
loading="lazy"
alt="2022-10-22T07:40:41.png"
>类似这样的给帖子添加tag的效果，可以方便分类和查找；用户页面显示了本站所有注册的用户；帖子就是类似于“广场”的功能了。
[scode type=&amp;ldquo;lblue&amp;rdquo;]4、通知[/scode]
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/63539f0b31536.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539f0b31536.png" alt="2022-10-22T07:43:07.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539f0b31536.png"
loading="lazy"
alt="2022-10-22T07:43:07.png"
>如图所示，点赞、评论、关注还有@会在这个页面显示。
[scode type=&amp;ldquo;lblue&amp;rdquo;]5、话题[/scode]
与“探索”中的话题效果一致。
[scode type=&amp;ldquo;lblue&amp;rdquo;]6、消息[/scode]
就是私信，这里可以给用户发消息。点击进入个人页面的这个蓝色按钮就能发消息了。有怪人轰炸你？截图发我我给你铲咯。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/63539fd983ca8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539fd983ca8.png" alt="2022-10-22T07:46:33.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/63539fd983ca8.png"
loading="lazy"
alt="2022-10-22T07:46:33.png"
>
[scode type=&amp;ldquo;lblue&amp;rdquo;]7、沸点[/scode]
就是一个rss资源集合，目前整合了知乎日报精选、机核网以及动漫花园三个源。
[scode type=&amp;ldquo;lblue&amp;rdquo;]8、收藏[/scode]
简而言之，就是你收藏的帖子，点击帖子右下角的三个点选择收藏就会在这里显示。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a07293024.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a07293024.png" alt="2022-10-22T07:49:07.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a07293024.png"
loading="lazy"
alt="2022-10-22T07:49:07.png"
>
[scode type=&amp;ldquo;lblue&amp;rdquo;]9、博友[/scode]
其他同样使用圈子插件的站长都会在这里留下链接。
[scode type=&amp;ldquo;lblue&amp;rdquo;]10、后台[/scode]
这里引导到的是typecho后台关于圈子插件的设置，如果非管理员访问会提示非法访问。
钱包、广告、推广这三项目前没用，此处不展开。
[scode type=&amp;ldquo;lblue&amp;rdquo;]11、设置[/scode]
此处包含的是关于账户的一些设置，比如用户名、邮箱地址、简介、关联QQ等。这里还可以设置通知和邮件提醒的类型，这里不勾选的消息是不会推送的。如果你想给账号后面增加蓝标，可以选择“验证我的账户”，如果你想退站了，请点击“删除配置文件”。
[scode type=&amp;ldquo;lblue&amp;rdquo;]12、风格[/scode]
这里可以选择圈子的配色方案和背景颜色。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a1dc9d6ee.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a1dc9d6ee.png" alt="2022-10-22T07:55:09.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a1dc9d6ee.png"
loading="lazy"
alt="2022-10-22T07:55:09.png"
>&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]废话这么多，那我该如何发帖？[/scode]
在你的主页顶端可以找到发帖的对话框。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a23818aeb.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a23818aeb.png" alt="2022-10-22T07:56:40.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/22/6353a23818aeb.png"
loading="lazy"
alt="2022-10-22T07:56:40.png"
>图中显示的分别是插入图片、视频、我一次都没试成功过的功能、表情（仅限emoji）、投票、预设GIF。需要注意的是上传的视频大小是有限制的，限制为24M。
[scode type=&amp;ldquo;lblue&amp;rdquo;]还有什么要注意的？[/scode]
请注意遵守国家相关的法律规定再发言。
后续有更新在补充说明。&lt;/p></description></item><item><title>stable-diffusion使用过程中的一些记录</title><link>https://blog.tama.guru/record/stable-diffusion-webui.html</link><pubDate>Wed, 19 Oct 2022 23:44:38 +0800</pubDate><guid>https://blog.tama.guru/record/stable-diffusion-webui.html</guid><description>&lt;p>原文已丢失，以下部分为重写。
正文部分忘得差不多了，此处就记录一下使用过程中的问题吧。&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]No.1 我想在本地搭建服务并分享出去[/scode]
修改目录下的&lt;code>webui.py&lt;/code>文件，将101行&lt;code>app,local_url,share_url = demo.launch(&lt;/code>的代码块修改为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> app,local_url,share_url = demo.launch(
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> share=True,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_name=&amp;#34;你的本地IP，比如192.168.10.121&amp;#34; if cmd_opts.listen else None,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server_port=cmd_opts.port,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> debug=cmd_opts.gradio_debug,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> auth=[tuple(cred.split(&amp;#39;:&amp;#39;)) for cred in cmd_opts.gradio_auth.strip(&amp;#39;&amp;#34;&amp;#39;).split(&amp;#39;,&amp;#39;)] if cmd_opts.gradio_auth else None,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inbrowser=cmd_opts.autolaunch,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> prevent_thread_lock=True
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> )
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改完成后保存运行&lt;code>webui-user.bat&lt;/code>即可。
需要注意的是开启分享需要全程连接谷歌，因为需要调用到谷歌的gradio服务。
[scode type=&amp;ldquo;lblue&amp;rdquo;]No.2 我想在本地搭建服务但是我的运存有点小[/scode]
按照官方的说法，只需要修改&lt;code>webui-user.bat&lt;/code>文件，将&lt;code>set COMMANDLINE_ARGS=&lt;/code>添加参数&lt;code>--medvram&lt;/code>即可，即显示为：
&lt;code>set COMMANDLINE_ARGS=--medvram&lt;/code>
修改完成后保存运行&lt;code>webui-user.bat&lt;/code>即可。
[scode type=&amp;ldquo;lblue&amp;rdquo;]No.3 我生成的结果好丑！[/scode]
我猜你是想画二次元涩图。其一：程序的wiki上留下的模型比较&amp;hellip;正常？所以首先你需要替换掉模型。目前因为一些原因novelai的ckpt模型已泄露，可以将下载到的模型重命名为&lt;code>model.ckpt&lt;/code>并替换到&lt;code>models\Stable-diffusion&lt;/code>目录再重新启动程序即可。
其二：你需要到网页端把NSFW过滤给关掉了。
其三：你可能需要添加一些低质量关键词过滤，以下为参考：
&lt;code>lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry, bad feet&lt;/code>&lt;/p></description></item><item><title>阿里云服务器的买后优化记录</title><link>https://blog.tama.guru/record/aliyun_server.html</link><pubDate>Sun, 16 Oct 2022 00:15:00 +0800</pubDate><guid>https://blog.tama.guru/record/aliyun_server.html</guid><description>&lt;p>腾讯云香港服务器蹲了半年都蹲不出台正常点的，中低端经常售罄，至少都要2C2T+4G起步，一个月就要六七十，这谁受得了？？？月初打开阿里云一看，哟嚯，2C（其实是1C2T）+2G一个月才30，试用下访问速度基本上接近国内服务器，这我直呼受不了，赶紧把之前那破腾讯云上的数据迁移咯。使用体验基本复合我的预期，但是2G跑个debian在加几个网站基本就没用想别的了，内存这块有优化的必要。&lt;/p>
&lt;hr>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]No.1 mysql[/scode]&lt;/p>
&lt;p>对于小内存的机子来说mysql跑一段时间之后内存占用会高得恐怖。我中午刚新开的服务器，到晚上11点多用&lt;code>htop&lt;/code>一看，单mysqld这个进程已经吃了18.5%的内存，也就是差不多400M，你也是真的能吃 ::acfun:01:: 。查了些资料然后进行比对，发现镜像原本的配置也已经优化的差不多了，但是我们还需要打开&lt;code>my.cnf&lt;/code>，在&lt;code>[mysqld]&lt;/code>字段添加&lt;/p>
&lt;p>&lt;code>performance_schema = off&lt;/code>&lt;/p>
&lt;p>然后保存重启mysql进程，也是有一定效果。&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]No.2 AliyunDun（阿里云盾）[/scode]&lt;/p>
&lt;p>这玩意是预装在系统里的，平时啥也不干也会吃掉5到6个点的内存，在官方的介绍页上，对这个产品的表述是：&lt;/p>
&lt;blockquote>
&lt;p>云盾是阿里巴巴集团多年来安全技术研究积累的成果，结合阿里云云计算平台强大的数据分析能力。为中小网站提供如安全漏洞检测、网页木马检测以及面向云服务器用户提供的主机入侵检测、防DDOS等一站式安全服务。&lt;/p>&lt;/blockquote>
&lt;p>其实平时不乱开端口，不乱往主机上塞文件问题就不大，至于DDoS，真要打我这小破站你这盾也不够用啊。。。&lt;/p>
&lt;p>以下是卸载步骤：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wget http://update.aegis.aliyun.com/download/uninstall.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sh uninstall.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget http://update.aegis.aliyun.com/download/quartz_uninstall.sh sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">quartz_uninstall.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pkill aliyun-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -fr /etc/init.d/agentwatch /usr/sbin/aliyun-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf /usr/local/aegis*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>未完待续 ::acfun:2003::&lt;/p></description></item><item><title>MIUI刷机那些破事（持续更新）</title><link>https://blog.tama.guru/record/miuiflashing.html</link><pubDate>Wed, 05 Oct 2022 17:23:00 +0800</pubDate><guid>https://blog.tama.guru/record/miuiflashing.html</guid><description>&lt;p>[scode type=&amp;ldquo;red&amp;rdquo;]&amp;ldquo;this MIUI version can’t be installed on this device&amp;rdquo;[/scode]
这个报错是MIUI12+版本在跨区刷包的时候出现的，电脑上使用MiFlasher进行跨区线刷时，&lt;code>务必保证选择了“全部删除/保留用户数据”，而非“全部删除并lock”&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/15/634a5ac38399f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/15/634a5ac38399f.png" alt="image.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/15/634a5ac38399f.png"
loading="lazy"
alt="image.png"
>
，目前跨区刷机已经被小米官方限制成仅解bl锁的用户使用，所以当你勾选了“全部删除并lock”的时候，系统会直接无法启动。如果之前手机有绑定账号并且能解锁bl，那么只需要下载小米官方的解锁软件重新再解锁一次就能正常使用了。如果你没绑定账号，那么就去找售后吧。
[scode type=&amp;ldquo;lblue&amp;rdquo;]&amp;ldquo;error:Not catch chinkpoint($fastboot -s .* lock), flash is not done&amp;rdquo;[/scode]
这个报错出现在线刷不回锁的时候，字面意思就是在MiFlash软件的Configuration中有一个&amp;quot;Checkpoint&amp;quot;的选项，用于判断刷机脚本是否完成，默认情况下这里是&lt;code>\$fastboot -s .* lock&lt;/code>，但是如果我们刷机的时候选择“全部删除/保留用户数据”，就不会涉及到上锁的命令，所以会触发这个错误，但其实刷机过程已经完成了，不会对使用有影响，如果觉得碍眼可以把&lt;code>Checkpoint&lt;/code>给清空，就不会提示了。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2022/10/15/634a5af10a251.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/15/634a5af10a251.png" alt="image.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2022/10/15/634a5af10a251.png"
loading="lazy"
alt="image.png"
>
[scode type=&amp;ldquo;red&amp;rdquo;]&amp;ldquo;我是电信卡，我在欧版上发不出短信&amp;rdquo;[/scode]
恭喜你刷到的是正版的欧版MIUI。如果非要用这个版本，需要先刷回国内版本的MIUI，进入短信应用用电信卡发一条短信，如果正常能发出再刷欧版，大概率能够解决这个问题。&lt;/p></description></item><item><title>关于MIUI升级到开发版的方法</title><link>https://blog.tama.guru/record/miuidev.html</link><pubDate>Tue, 04 Oct 2022 19:47:00 +0800</pubDate><guid>https://blog.tama.guru/record/miuidev.html</guid><description>&lt;p>不知道从哪个版本的miui开始，开发版的miui便不能直接从稳定版通过简单的卡刷进行转换，需要在官方论坛申请“公测”或者“内测”权限之后才能进行安装，而申请资格需要在官方论坛达到4级以上的等级并且要完成所谓的“答题”，如果等级不够或者“答题”分数不及格均无法获得权限，就算通过其他方法搞到了卡刷包，在刷写的时候也会被提示“该账号非内测权限”然后就停住了。
在这种背景之下，出现了几种方法来强行升级到开发版：
1、买账号：去某些平台上购买有升级权限的账号或者是找人代答题，这种方法我没试过，不知道是否能达到店方生成的“后续稳定升级”，而且，本来是花费一些心思能申请到的账号需要花钱去购买，也算是助长了这种风气吧，个人非常不推荐。
2、“偷渡”：也就是利用升级步骤上的一些漏洞来进行升级，之前会有一种把开发包下载好了之后在系统升级到99%断网再替换文件来骗过系统验证的方法，这种方法反正我是没成功过了；另一种是对于那些解锁了男同锁而且安装好了magisk框架的用户，可以到这个网站&lt;a class="link" href="https://pan.cgtsoft.com/2%20MIUI%20Flash%20Freely/" target="_blank" rel="noopener"
>CGT Software&lt;/a>下载&lt;code>MIUI Flash Freely 模块&lt;/code>安装，理论上可支持MIUI 12/12.5/13，安装完直接刷开发包就可以了，这种方法我试过，确实是可以直接通过卡刷偷渡到开发版，且稳定使用了一段时间，但是目前出现了系统待机耗电量极高的问题，加上之前曾经看到过通过偷渡的方式上开发版会碰到很多系统完整性问题，我也选择放弃这个方法了。（注：每次升级之前都要装一次这个插件，而且装完最好双清）
3、线刷：部分网站会把一些官方“不小心”放出来的开发版线刷包整合，比如&lt;a class="link" href="https://xiaomirom.com/series/zeus/" target="_blank" rel="noopener"
>Xiaomirom&lt;/a>这个网站，直接线刷进去能够最大限度保证系统完整性，但是后续依旧无法升级，而且线刷包一般版本都比较老。
所以我选择eea版本miui。&lt;/p>
&lt;p>看了下MIUI Flash Freely模块的内容，其实质是把&lt;code>/product/etc/device_fratures/机型代号.xml&lt;/code>中的&lt;code>support_ota_validate&lt;/code>修改成&lt;code>false&lt;/code>，字面上理解就是把OTA数据验证关闭。
真能藏啊米哥。&lt;/p></description></item><item><title>新版raspbian远程登录方法</title><link>https://blog.tama.guru/record/raspbian11login.html</link><pubDate>Mon, 19 Sep 2022 13:32:04 +0800</pubDate><guid>https://blog.tama.guru/record/raspbian11login.html</guid><description>&lt;p>新版的raspbian中已经取消了默认的&lt;code>pi+raspbian&lt;/code>登录方式，这意味着如果使用无屏幕登录方式将无法直接登录。
解决方法：
1、用老版本。
2、连接显示器和键盘，首次开机会引导到配置账户界面。
3、去raspberry官网下载“树莓派镜像烧录器“，可以直观的配置一些首次开机必须的选项。&lt;/p></description></item><item><title>centos7在保留python2.7的前提下安装python3.x的方法</title><link>https://blog.tama.guru/record/centos7_python3-x.html</link><pubDate>Sat, 17 Sep 2022 01:46:10 +0800</pubDate><guid>https://blog.tama.guru/record/centos7_python3-x.html</guid><description>&lt;p>不会有人2022年了还在用centos7吧。。。
由于centos7默认安装的是python2.7且系统内组件高度依赖python2.7，如果直接卸载换成3.X会导致许多系统软件无法运行(yum就是一个很好的例子），因此想法如下：
·编译安装3.X版本
·把原来的python软链接指向3.x，并创建pip3的软链接
·把相关软件的头手动进行修改
例如&lt;code>/usr/libexec/urlgrabber-ext-down&lt;/code>中原来的&lt;code>#!/usr/bin/python&lt;/code>应手动指定为&lt;code>#!/usr/bin/python2.7&lt;/code>，&lt;code>/usr/bin/yum&lt;/code>同理。
参考：&lt;a class="link" href="https://www.cnblogs.com/jizhong/p/15157828.html" target="_blank" rel="noopener"
>https://www.cnblogs.com/jizhong/p/15157828.html&lt;/a>&lt;/p></description></item><item><title>适用于handsome主题的自适应视频挂载</title><link>https://blog.tama.guru/record/handsome-framevideo.html</link><pubDate>Sun, 24 Jul 2022 01:59:00 +0800</pubDate><guid>https://blog.tama.guru/record/handsome-framevideo.html</guid><description>&lt;p>原文请访问：[button type=&amp;ldquo;round&amp;rdquo; color=&amp;ldquo;success&amp;rdquo; url=&amp;ldquo;https://www.raycns.com/archives/774.html&amp;rdquo;]此处[/button]&lt;/p>
&lt;p>适用于带有iframe功能的视频网站。
使用方法：
将以下代码添加至 Handsome主题外观&amp;gt;设置外观开发者设置&amp;gt;自定义CSS&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/*视频挂载*/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_video {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">position: relative;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">width: 100%;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@media only screen and (max-width: 767px) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_video {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">height: 15em;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@media only screen and (min-width: 768px) and (max-width: 991px) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_video {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">height: 20em;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@media only screen and (min-width: 992px) and (max-width: 1199px) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_video {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">height: 30em;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@media only screen and (min-width: 1200px) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_video {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">height: 40em;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_cross {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">position: relative;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">width: 100%;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">height: 0;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">padding-bottom: 75%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.iframe_cross iframe {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">position: absolute;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">width: 100%;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">height: 100%;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">left: 0;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">top: 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>演示&lt;/p>
&lt;p>打开你想挂载在网站的视频
复制视频源代码复制嵌入代码
在复制的嵌入链接的iframe与src之间添加class=&amp;ldquo;iframe_video&amp;rdquo;&lt;/p>
&lt;p>以下演示&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;iframe class=&amp;#34;iframe_video&amp;#34; src=&amp;#34;https://www.acfun.cn/player/ac35737823&amp;#34; id=&amp;#34;ACPlayer-re&amp;#34; scrolling=&amp;#34;no&amp;#34; border=&amp;#34;0&amp;#34; frameborder=&amp;#34;no&amp;#34; framespacing=&amp;#34;0&amp;#34; allowfullscreen=&amp;#34;true&amp;#34;&amp;gt;&amp;lt;/iframe&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>成片：&lt;/p>
&lt;iframe class="iframe_video" src="https://www.acfun.cn/player/ac35737823" id="ACPlayer-re" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">&lt;/iframe></description></item><item><title>handsome主题博客信息添加全站字数、在线人数、访客总数和网站加载耗时</title><link>https://blog.tama.guru/record/sidebarmodify.html</link><pubDate>Sat, 23 Jul 2022 17:18:00 +0800</pubDate><guid>https://blog.tama.guru/record/sidebarmodify.html</guid><description>&lt;p>转载自：&lt;a class="link" href="https://www.cloudsd.com/archives/25.html" target="_blank" rel="noopener"
>Typecho博客handsome主题博客信息添加全站字数、在线人数、访客总数和网站加载耗时&lt;/a>&lt;/p>
&lt;p>首先将以下代码加到themes/handsome/libs/Content.php中放在class Content{}[tag type=&amp;ldquo;danger&amp;rdquo;]之前[/tag]。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-mysql" data-lang="mysql">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cm">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 全站字数
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">allOfCharacters&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Typecho_Db&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="nf">get&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;text&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="k">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;table.contents&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">rows&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="nf">fetchAll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">foreach&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">rows&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">mb_strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">trim&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;text&amp;#39;&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;UTF-8&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">unit&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">10000&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">/=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">10000&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">unit&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;万&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;gt;=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">/=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">unit&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;千&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="k">out&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;%.2lf %s&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">unit&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="k">out&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="cm">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 在线人数
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">online_users&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;online.txt&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="err">数据文件&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">cookiename&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Nanlon_OnLineCount&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">Cookie名称&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">onlinetime&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="err">在线有效时间&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">online&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nf">file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowtime&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">_SERVER&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;REQUEST_TIME&amp;#39;&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowonline&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nf">array&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">foreach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">online&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nf">explode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;|&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">sesstime&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nf">trim&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowtime&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">sesstime&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;lt;=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">onlinetime&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowonline&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">sesstime&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">_COOKIE&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">cookiename&lt;/span>&lt;span class="p">]))&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">uid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">_COOKIE&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">cookiename&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">vid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">do&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">vid&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">uid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;U&amp;#39;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">vid&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">array_key_exists&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">uid&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowonline&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">setcookie&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">cookiename&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">uid&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowonline&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">uid&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowtime&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">total_online&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nf">count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowonline&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="o">=@&lt;/span>&lt;span class="nf">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;w&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">flock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">LOCK_EX&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">rewind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">foreach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">nowonline&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">as&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fuid&lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">ftime&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fline&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fuid&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="s1">&amp;#39;|&amp;#39;&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">ftime&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="s2">&amp;#34;\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="nf">fputs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fline&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">flock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">LOCK_UN&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;$total_online&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cm">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 访客总数
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">theAllViews&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Typecho_Db&lt;/span>&lt;span class="p">::&lt;/span>&lt;span class="nf">get&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="nf">fetchAll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;SELECT SUM(VIEWS) FROM `typecho_contents`&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">number_format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">row&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;SUM(VIEWS)&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cm">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 加载耗时
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">timer_start&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">global&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timestart&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">mtime&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">explode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">microtime&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timestart&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">mtime&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">mtime&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">true&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nf">timer_start&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">timer_stop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="k">precision&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">global&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timestart&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timeend&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">mtime&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">explode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">microtime&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timeend&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">mtime&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">mtime&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timetotal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">number_format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timeend&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timestart&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="k">precision&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timetotal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timetotal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34; ms&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">timetotal&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34; s&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">display&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">echo&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="err">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>themes/handsome/component/sidebar.php添加代码:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;li class=&amp;#34;list-group-item text-second&amp;#34;&amp;gt;&amp;lt;span class=&amp;#34;blog-info-icons&amp;#34;&amp;gt;&amp;lt;i data-feather=&amp;#34;edit-3&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span class=&amp;#34;badge pull-right&amp;#34;&amp;gt;&amp;lt;?php echo allOfCharacters(); ?&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;?php _me(&amp;#34;全站字数&amp;#34;) ?&amp;gt;&amp;lt;/li&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;li class=&amp;#34;list-group-item&amp;#34;&amp;gt; &amp;lt;i class=&amp;#34;glyphicon glyphicon-user text-muted text-muted&amp;#34;&amp;gt;&amp;lt;/i&amp;gt; &amp;lt;span class=&amp;#34;badge pull-right&amp;#34;&amp;gt;&amp;lt;?php echo online_users() ?&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;?php _me(&amp;#34;在线人数&amp;#34;) ?&amp;gt;&amp;lt;/li&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;li class=&amp;#34;list-group-item text-second&amp;#34;&amp;gt;&amp;lt;span class=&amp;#34;blog-info-icons&amp;#34;&amp;gt; &amp;lt;i data-feather=&amp;#34;user&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span class=&amp;#34;badge pull-right&amp;#34;&amp;gt;&amp;lt;?php echo theAllViews();?&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;?php _me(&amp;#34;访客总数&amp;#34;) ?&amp;gt;&amp;lt;/li&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;li class=&amp;#34;list-group-item text-second&amp;#34;&amp;gt;&amp;lt;span class=&amp;#34;blog-info-icons&amp;#34;&amp;gt; &amp;lt;i data-feather=&amp;#34;clock&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;#34;badge pull-right&amp;#34;&amp;gt;&amp;lt;?php echo timer_stop();?&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;?php _me(&amp;#34;加载耗时&amp;#34;) ?&amp;gt;&amp;lt;/li&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>使用OBS自动添加字幕识别已经转自动语音</title><link>https://blog.tama.guru/record/obs-subtitles-audio.html</link><pubDate>Sun, 17 Jul 2022 12:38:00 +0800</pubDate><guid>https://blog.tama.guru/record/obs-subtitles-audio.html</guid><description>&lt;p>请直接参考作者文档：&lt;a class="link" href="https://github.com/summershrimp/obs-auto-subtitle/blob/master/README-zh.md" target="_blank" rel="noopener"
>obs-auto-subtitle/README-zh.md at master · summershrimp/obs-auto-subtitle (github.com)&lt;/a>&lt;/p>
&lt;p>自动转语音部分正在测试中&lt;/p>
&lt;p>[scode type=&amp;ldquo;yellow&amp;rdquo;]注意：使用中如果出现OBS闪退，多半是因为KEY到期了，先把相关源禁用，再到滤镜里设置新的KEY就能正常使用了。[/scode]&lt;/p>
&lt;p>[scode type=&amp;ldquo;red&amp;rdquo;]插件不支持obs 28.0及以上版本，如果在steam中误升级可右键obs 属性 测试版 选择27.X版本。[/scode]&lt;/p></description></item><item><title>handsome主题短代码</title><link>https://blog.tama.guru/record/hs-shortcode.html</link><pubDate>Tue, 12 Jul 2022 01:15:00 +0800</pubDate><guid>https://blog.tama.guru/record/hs-shortcode.html</guid><description>&lt;p>来源：&lt;a class="link" href="https://auth.ihewro.com/user/docs#/preference/shortCode" target="_blank" rel="noopener"
>短代码 - Handsome 使用文档 (ihewro.com)&lt;/a>&lt;/p>
&lt;p>以下进行搬运：&lt;/p>
&lt;ul>
&lt;li>时间线&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[timeline title=&amp;#34;2020大事记&amp;#34; type=&amp;#34;small&amp;#34; start=&amp;#34;梦开始的地方&amp;#34; end=&amp;#34;新的一年开始&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item date=&amp;#34;2020-1-20&amp;#34;] 武汉封城，疫情让一起变得慌乱起来 [/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item date=&amp;#34;2020-3-20&amp;#34;] 开始远程办公，慢慢有序起来[/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item]生活变得好起来了[/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item date=&amp;#34;2020-10-1&amp;#34;] 国庆节去哈尔滨旅行，和老同学见面[/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/timeline]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>备注：
timeline 属性列表：&lt;/p>
&lt;p>type：可选项，默认为small， 可选值:
small 小巧款式的时间线
large 大款式的时间线
random，可选项，默认为true，可选值为true、false，true表示时间线每一条会使用随机的色彩
对于 large样式的时间线，提供时间线开始和结束的一个文字自定义：&lt;/p>
&lt;p>start：一些简单的文字
end:一些简单的文字
item 属性列表：&lt;/p>
&lt;p>date ：可选项，默认不显示时间，可选值：
一个日期文字，实际上可以填写任何类型文字（不要太长）
color：可选项，设置当前时间线条的颜色，可选值：&amp;ldquo;light&amp;rdquo;, &amp;ldquo;info&amp;rdquo;, &amp;ldquo;dark&amp;rdquo;, &amp;ldquo;success&amp;rdquo;, &amp;ldquo;black&amp;rdquo;, &amp;ldquo;warning&amp;rdquo;, &amp;ldquo;primary&amp;rdquo;, &amp;ldquo;danger&amp;rdquo;&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>计划表&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[goal title=&amp;#34;2021的小目标&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item check=&amp;#34;true&amp;#34;] 每天早睡 [/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item check=&amp;#34;false&amp;#34;] 每天早起 [/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item progress=&amp;#34;50%&amp;#34;] 阅读10本书 [/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item start=&amp;#34;2021-01-02&amp;#34; end=&amp;#34;2021-10-1&amp;#34;] 每天锻炼30分钟 [/item]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/goal]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>备注：
计划表中包含了三种类型的任务：
check类型，该类型任务只有两种状态，完成和未完成
progress，该类型任务可以显示任务执行的进度，需要手动填写进度
start、end，该类型任务设置一个起始时间和终止时间，进度会根据当前时间自动更新进度
时间格式：必须是正确的时间格式，比如2021-01-02 12:00 ，也可以只写日期2021-01-02&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>音乐
云解析歌曲：支持以下媒体：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">网易云音乐 http://music.163.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">单曲 http://music.163.com/#/song?id=424474911
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">专辑 http://music.163.com/#/album?id=34808540
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌手 http://music.163.com/#/artist?id=3681
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌单 http://music.163.com/#/playlist?id=436843836
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">榜单 http://music.163.com/#/discover/toplist?id=60198
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">QQ 音乐 https://y.qq.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">单曲 https://y.qq.com/n/yqq/song/000jDQWP4JiB3y.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">专辑 https://y.qq.com/n/yqq/album/003rytri2FHG3V.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌手 https://y.qq.com/n/yqq/singer/003Nz2So3XXYek.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌单 https://y.qq.com/n/yqq/playlist/1144188779.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">虾米音乐 http://www.xiami.com or http://h.xiami.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">单曲 http://www.xiami.com/song/bf08DNT3035f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">专辑 http://www.xiami.com/album/ddOZW6a10eb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌手 http://www.xiami.com/artist/be6yda0f8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌单 http://www.xiami.com/collect/254478782
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">酷狗音乐 http://www.kugou.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">单曲 http://www.kugou.com/song/#hash=09E8DE70A24C97B92A29F6A19F3528A2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">专辑 http://www.kugou.com/yy/album/single/1645030.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌手 http://www.kugou.com/yy/singer/home/3520.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌单 http://www.kugou.com/yy/special/single/119859.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">百度音乐 http://music.baidu.com/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">单曲 http://music.baidu.com/song/268275324
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">专辑 http://music.baidu.com/album/268275533
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌手 http://music.baidu.com/artist/1219
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">歌单 http://music.baidu.com/songlist/364201689
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>本地mp3地址播放：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">//单首歌曲
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[hplayer]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Music title=&amp;#34;歌曲名&amp;#34; author=&amp;#34;歌手&amp;#34; url=&amp;#34;http://&amp;#34; pic=&amp;#34;图片文件URL&amp;#34; lrc=&amp;#34;歌词文件URL&amp;#34; type=&amp;#34;mini&amp;#34;/]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/hplayer]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//多首歌曲
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[hplayer]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Music title=&amp;#34;歌曲名&amp;#34; author=&amp;#34;歌手&amp;#34; url=&amp;#34;http://&amp;#34; pic=&amp;#34;图片文件URL&amp;#34; lrc=&amp;#34;歌词文件URL&amp;#34; type=&amp;#34;mini&amp;#34;/]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Music title=&amp;#34;歌曲名&amp;#34; author=&amp;#34;歌手&amp;#34; url=&amp;#34;http://&amp;#34; pic=&amp;#34;图片文件URL&amp;#34; lrc=&amp;#34;歌词文件URL&amp;#34; type=&amp;#34;mini&amp;#34;/]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/hplayer]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中lrc 字段可以不填，表示没有歌词,type 可选择为 normal、mini 两种&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>视频
点击编辑器的插入视频图标可以插入视频，支持本地的视频地址的播放和解析第三方平台的视频
时光机的视频插入按钮也是同样的操作&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[vplayer url=&amp;#34;http://xxx.com/xxx.mp4&amp;#34; pic=&amp;#34;http://xxx.com/xxx.png&amp;#34;]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>url：视频地址
pic：视频背景图片&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>按钮&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button color=&amp;#34;danger&amp;#34; icon=&amp;#34;fontello fontello-gratipay&amp;#34; url=&amp;#34;http:\/\/wpa.qq.com\/msgrd?v=3&amp;amp;uin=535425690&amp;amp;site=qq&amp;amp;menu=yes&amp;#34;]点击QQ咨询购买（√推荐）[/button]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button color=&amp;#34;success&amp;#34; icon=&amp;#34;glyphicon glyphicon-send&amp;#34; url=&amp;#34;mailto:ihewro@163.com&amp;#34;]ihewro#163.com[/button]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button color=&amp;#34;success&amp;#34; icon=&amp;#34;music&amp;#34; url=&amp;#34;mailto:ihewro@163.com&amp;#34;]音乐歌单[/button]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button color=&amp;#34;success&amp;#34; icon=&amp;#34;🍜&amp;#34; url=&amp;#34;mailto:ihewro@163.com&amp;#34;]菜谱[/button]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>备注：&lt;/p>
&lt;p>内容可替换如下：
矩形文字按钮
椭圆形文字按钮
矩形图标文字按钮
例如：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[button]矩形按钮文字[/button]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button color=&amp;#34;succees&amp;#34;]矩形按钮文字[/button]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button type=&amp;#34;round&amp;#34; color=&amp;#34;success&amp;#34;]椭圆形按钮文字[/button]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[button color=&amp;#34;success&amp;#34; icon=&amp;#34;glyphicon glyphicon-eur&amp;#34;]图标按钮文字[/button]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>type：选填，不填默认为矩形按钮。可选值：
round：椭圆形按钮
color： 选填，不填默认为success（绿色），可选值：
light：白色
info：蓝色
dark：深色
success：绿色
black：黑色
warning：黄色
primary：紫色
danger：红色
icon：选填，不填默认为文字按钮
url:选填，填写点击的链接。举例：如果你的链接是http://www.baidu.com，请手动将/前面加一个反斜杆\，即http://www.baidu.com&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>链接卡片&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[link]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item name=&amp;#34;百度一些&amp;#34; link=&amp;#34;http://baidu.com&amp;#34; desc=&amp;#34;百度一下你就知道&amp;#34; /]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item name=&amp;#34;网站名称&amp;#34; link=&amp;#34;http://example.com&amp;#34; desc=&amp;#34;一些链接描述&amp;#34; /]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[item name=&amp;#34;网站名称&amp;#34; link=&amp;#34;http://example.com&amp;#34; desc=&amp;#34;一些链接描述&amp;#34; pic=&amp;#34;图片地址&amp;#34; /]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/link]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;ul>
&lt;li>文章卡片
点击编辑器的调用文章的按钮可以调用其他文章并显示。&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[post cid=&amp;#34;XXX&amp;#34; /]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[post cid=&amp;#34;XXX&amp;#34; cover=&amp;#34;http:\/\/localhost\/build\/usr\/themes\/handsome\/usr\/img\/sj\/6.jpg&amp;#34;/]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>cid：必填，是文章的唯一编号，在后台的编辑文章的地址可以看到，比如http://localhost/build/admin/write-post.php?cid=23,值为23
cover：可选项，调用文章显示的封面，如果不填则默认显示随机缩略图。
size：可选项，可填写值large 、small，默认为large。small表示只显示文章标题，不显示其他额外信息。&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>外链卡片&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[post url=&amp;#34;XXX&amp;#34; title=&amp;#34;XXX&amp;#34; intro=&amp;#34;XXX&amp;#34; cover=&amp;#34;XXXX&amp;#34; /]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>title：必填，外链的名称/标题
url：必填，外链的地址（请填写绝对地址，就是浏览器地址栏什么样的就填什么样的）
intro：（可选）外链网站的简介/介绍
cover：（选填）外链网站的介绍图片地址&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>相册与图集
相册与图集的区别是：&lt;/li>
&lt;/ul>
&lt;p>相册样式是固定一行N个，N会根据屏幕尺寸调整
图集会自动将图集内部的所有图片显示在一行中（如果图片太多，需要分成多个图集），并且大小会自动调整
相册&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[album]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[普通的图片插入，支持markdown语法和html语法，混合也可以]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/album]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>图集：增加type=&amp;ldquo;photos&amp;rdquo; 则album下的图片排成一行，并根据图片的长高比自动排列&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[album type=&amp;#34;photos&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[普通的图片插入，支持markdown语法和html语法，混合也可以]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/album]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;ul>
&lt;li>回复可见&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[hide]需要隐藏的内容[/hide]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;ul>
&lt;li>登陆可见&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[login]需要加密的内容[/login]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;ul>
&lt;li>高亮提示文本&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;share&amp;#34;]这是灰色的短代码框，常用来引用资料什么的[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;yellow&amp;#34;]这是黄色的短代码框，常用来做提示，引起读者注意。[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;red&amp;#34;]这是红色的短代码框，用于严重警告什么的。[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;lblue&amp;#34;]这是浅蓝色的短代码框，用于显示一些信息。[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;green&amp;#34;]这是绿色的短代码框，显示一些推荐信息。[/scode]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>高亮提示文本有三种样式，默认的样式如上，可以通过&amp;quot;size&amp;quot; 属性来修改:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;red&amp;#34; size=&amp;#34;simple&amp;#34;]该样式不包含左侧的图标，为简单样式[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;red&amp;#34; size=&amp;#34;small&amp;#34;]该样式为文字背景，不包含图标和过多的边距[/scode]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;ul>
&lt;li>收缩框
示例代码：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[collapse title=&amp;#34;标题&amp;#34; status=&amp;#34;false&amp;#34;]一些文字内容[/collapse]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[collapse title=&amp;#34;标题&amp;#34;]一些文字内容[/collapse]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中status为false 表示默认不显示文字内容，为true表示默认显示内容。
不写status 属性，默认是展开内容的。&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>标签卡
示例代码：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[tabs]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tab name=&amp;#34;标签页 1&amp;#34; active=&amp;#34;true&amp;#34;]内容 1[/tab]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tab name=&amp;#34;标签页 2&amp;#34;]内容 2[/tab]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/tabs]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>每个tab 都必须包括name属性，只能有一个tab 添加active属性，表示默认显示该tab的内容。&lt;/p>
&lt;p>此外tab支持更多css的属性，比如颜色，字体粗细等：
[tab name=&amp;ldquo;标签页 2&amp;rdquo; color:&amp;quot;#000&amp;quot; font-weight=&amp;ldquo;bold&amp;rdquo;]高级内容文本示例[/tab]&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>标签tag
示例代码：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[tag]默认白色文字[/tag]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tag type=&amp;#34;primary&amp;#34;]紫色文字[/tag]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tag type=&amp;#34;info&amp;#34;]蓝色文字[/tag]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tag type=&amp;#34;warning&amp;#34;]黄色文字[/tag]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tag type=&amp;#34;danger&amp;#34;]红色文字[/tag]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tag type=&amp;#34;success&amp;#34;]绿色文字[/tag]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[tag type=&amp;#34;dark&amp;#34;]黑色文字[/tag]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;ul>
&lt;li>文章中插入多栏&lt;/li>
&lt;/ul>
&lt;p>size属性可以填写百分比或者固定的宽度值（单位是px）&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">//一个简单的例子
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[colum]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[block size=&amp;#34;20%&amp;#34;]百分比宽度[/block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[block size=&amp;#34;200px&amp;#34;]固定宽度[/block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[block]标题3[/block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/clumn]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">// 一个复杂一点的例子，block内部可以使用其他的短代码带来更丰富的排版
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[column]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[block size=&amp;#34;20%&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;red&amp;#34; size=&amp;#34;small&amp;#34;]标题1[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;share&amp;#34; size=&amp;#34;small&amp;#34;]标题1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">标题1的内容
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[block size=&amp;#34;200px&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;red&amp;#34; size=&amp;#34;small&amp;#34;]标题2[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[scode type=&amp;#34;red&amp;#34; size=&amp;#34;small&amp;#34;]标题3[/scode]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/block]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[/column]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>OneCirclePro插件和handsome静态资源切换到国内服务器</title><link>https://blog.tama.guru/record/OneCirclePro-jscss.html</link><pubDate>Mon, 11 Jul 2022 22:52:00 +0800</pubDate><guid>https://blog.tama.guru/record/OneCirclePro-jscss.html</guid><description>&lt;p>体验了几天这个主题，发现资源加载是真的离谱，动不动10s+：&lt;/p>
&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://pic.tama.guru/i/2022/07/11/62cc370ea8a47.png">
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc370ea8a47.png" alt="请输入图片描述" />
&lt;/a>
&lt;/div>
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc370ea8a47.png"
loading="lazy"
alt="请输入图片描述"
>&lt;/p>
&lt;p>于是就想着把部分静态资源扔国内来了。&lt;/p>
&lt;p>直接把包内&lt;code>themeCore\themes\default\statics&lt;/code>打包上传到国内服务器搭建的网站目录下，最好和其他资源间隔开来，比如&lt;code>https://hostname/cdn/OneCircle/&lt;/code>，然后修改&lt;code>themeCore/themes/default/apps/main/content.phtml&lt;/code>和&lt;code>themeCore/themes/default/apps/cpanel/content_nosidebar.phtml&lt;/code>把&lt;code>{%config theme_url%}&lt;/code>替换成&lt;code>https://hostname/cdn/OneCircle/&lt;/code>，再刷新即可。&lt;/p>
&lt;p>&lt;code>[scode type=&amp;quot;yellow&amp;quot;]注意！部分资源位于&lt;/code>themeCore\themes\default\apps\cpanel\statics&lt;code>下，此部分资源和上面的不一样，也需要提取到国内服务器上并进行替换。（说的就是你！&lt;/code>themeCore/themes/default/apps/cpanel/content_nosidebar.phtml&lt;code> 你mua的！）[/scode]&lt;/code>&lt;/p>
&lt;p>对于部分资源会得到&lt;code>has been blocked by CORS policy: No 'Access-Control-Allow-Origin'&lt;/code>的跨域警告，是因为&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;link rel=&amp;#34;stylesheet&amp;#34; href=&amp;#34;https://hostname/cdn/OneCircle/statics/scss/master.styles.min.css?v={%config version%}&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里的&lt;code>master.styles.min.js&lt;/code>会请求几个woff文件，初步解决方案是只把这里修改回去，即：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">&amp;lt;link rel=&amp;#34;stylesheet&amp;#34; href=&amp;#34;{%config theme_url%}/statics/scss/master.styles.min.css?v={%config version%}&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>后面有好方法再说。。。&lt;/p>
&lt;p>PS:解决方案：如果使用宝塔面板，在目标服务器（国内服务器）要关闭&lt;code>防跨站攻击(open_basedir)&lt;/code>功能，并在配置文件的location添加以下两句即可：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> location / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header Access-Control-Allow-Origin *;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header Access-Control-Allow-Methods &amp;#39;GET, POST, OPTIONS&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>handsome主题内置了自定义cdn加速的功能，在主题设置的&lt;code>速度优化-主题本地静态资源自定义cdn加速&lt;/code>下，填写加速地址：&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>你需要把asset目录上传到你的cdn服务器上，比如CDN服务器的 handsome目录里，地址即为 &lt;code>https://cdn.ihewro.com/handsome/assets/&lt;/code>&lt;/li>
&lt;li>在当前框中就填入该地址，主题就会引用你搭建的cdn上面的资源，而不再引用当前服务器上的资源&lt;/li>
&lt;/ul>&lt;/blockquote></description></item><item><title>使用lskypro作为typecho图床</title><link>https://blog.tama.guru/record/lskypro.html</link><pubDate>Mon, 11 Jul 2022 20:46:00 +0800</pubDate><guid>https://blog.tama.guru/record/lskypro.html</guid><description>&lt;p>如果你的服务器在国外导致部分内容加载缓慢，同时因为CDN需要准备七七八八的(cloudflare除外，但是体验一样不好)，又信不过国内一众免费图床（稳定性和安全性问题），那么可以试着使用lskypro在国内服务器自建图床。&lt;/p>
&lt;p>官网地址：&lt;a class="link" href="https://docs.lsky.pro/docs/v2/#%E4%BB%8B%E7%BB%8D" target="_blank" rel="noopener"
>Lsky Pro V 2.x | Lsky Pro&lt;/a>&lt;/p>
&lt;p>依赖：（推荐使用宝塔面板安装依赖插件，以下操作均在宝塔面板操作并通过测试）&lt;/p>
&lt;ul>
&lt;li>PHP &amp;gt;= 8.0.2&lt;/li>
&lt;li>BCMath PHP 扩展&lt;/li>
&lt;li>Ctype PHP 扩展&lt;/li>
&lt;li>DOM PHP 拓展&lt;/li>
&lt;li>Fileinfo PHP 扩展&lt;/li>
&lt;li>JSON PHP 扩展&lt;/li>
&lt;li>Mbstring PHP 扩展&lt;/li>
&lt;li>OpenSSL PHP 扩展&lt;/li>
&lt;li>PDO PHP 扩展&lt;/li>
&lt;li>Tokenizer PHP 扩展&lt;/li>
&lt;li>XML PHP 扩展&lt;/li>
&lt;li>Imagick 拓展&lt;/li>
&lt;li>exec、shell_exec 函数&lt;/li>
&lt;li>readlink、symlink 函数&lt;/li>
&lt;li>putenv、getenv 函数&lt;/li>
&lt;li>关闭&lt;code>open_basedir&lt;/code>(即“防跨站”，在宝塔的网站-设置-网站目录-防跨站攻击(open_basedir))&lt;/li>
&lt;/ul>
&lt;p>数据库版本要求：&lt;/p>
&lt;ul>
&lt;li>Mysql 5.7+&lt;/li>
&lt;li>PostgreSQL 9.6+&lt;/li>
&lt;li>SQLite 3.8.8+&lt;/li>
&lt;li>SQL Server 2017+&lt;/li>
&lt;/ul>
&lt;p>软件下载地址：&lt;a class="link" href="https://github.com/lsky-org/lsky-pro/releases" target="_blank" rel="noopener"
>https://github.com/lsky-org/lsky-pro/releases&lt;/a>&lt;/p>
&lt;p>部署到服务器上之后，设置好伪静态：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">location / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ /index.php?$query_string;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>运行目录选择&lt;code>/public&lt;/code>。&lt;/p>
&lt;p>可能因为权限问题导致目录访问不了等问题，因此要在lskypro的目录运行：&lt;/p>
&lt;p>&lt;code>chown -R www:www *&lt;/code>&lt;/p>
&lt;p>&lt;code>chmod -R 755 *&lt;/code>&lt;/p>
&lt;p>之后访问安装的地址即可进入检测界面，这里可能会提示&lt;code>chown&lt;/code>、&lt;code>chmod&lt;/code>等功能不可用，可以在宝塔的PHP设置中把以上的禁用函数取消掉。&lt;/p>
&lt;p>如无问题，即可进入账户设置和服务器链接的界面。&lt;/p>
&lt;hr>
&lt;p>安装完成后默认是所有人都能上传的，这可能会导致一些问题，因此最好是设置一个管理员群组：&lt;/p>
&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://pic.tama.guru/i/2022/07/11/62cc175c060a8.png">
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc175c060a8.png" alt="请输入图片描述" />
&lt;/a>
&lt;/div>
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc175c060a8.png"
loading="lazy"
alt="请输入图片描述"
>&lt;/p>
&lt;p>在设置中关闭游客上传和注册功能：&lt;/p>
&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://pic.tama.guru/i/2022/07/11/62cc17b76b256.png">
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc17b76b256.png" alt="请输入图片描述" />
&lt;/a>
&lt;/div>
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc17b76b256.png"
loading="lazy"
alt="请输入图片描述"
>&lt;/p>
&lt;p>接口打开留着以便后面使用。&lt;/p>
&lt;hr>
&lt;p>接入typecho：&lt;/p>
&lt;p>&lt;a class="link" href="https://www.coldyun.cn/archives/140.html" target="_blank" rel="noopener"
>typecho兰空（LskyPro）图床插件 - Cold' Blog (coldyun.cn)&lt;/a>在莫言的1.0版本插件基础上新增了对lskypro2.0版本的支持，直接到他的博客下载附件上传到typecho下的plugin安装即可。插件需要填写&lt;code>Api&lt;/code>和&lt;code>Token&lt;/code>两项，其中&lt;code>Token&lt;/code>与上面的接口有关，我们需要通过post的方式获得&lt;code>token&lt;/code>：此处使用&lt;a class="link" href="https://www.postman.com/" target="_blank" rel="noopener"
>Postman&lt;/a>：&lt;/p>
&lt;p>注册成功后在左侧的collections点击加号，在New Collection点击&lt;code>GET New Request&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://pic.tama.guru/i/2022/07/11/62cc19d910ed0.png">
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc19d910ed0.png" alt="请输入图片描述" />
&lt;/a>
&lt;/div>
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc19d910ed0.png"
loading="lazy"
alt="请输入图片描述"
>&lt;/p>
&lt;p>接下来在右侧把GET切换成POST：&lt;/p>
&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://pic.tama.guru/i/2022/07/11/62cc1a8d574f8.png">
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc1a8d574f8.png" alt="请输入图片描述" />
&lt;/a>
&lt;/div>
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc1a8d574f8.png"
loading="lazy"
alt="请输入图片描述"
>&lt;/p>
&lt;p>其中链接填写&lt;code>https://hostname/api/v1/tokens&lt;/code> hostname是你的lskypro服务安装域名。&lt;/p>
&lt;p>key填写&lt;code>email&lt;/code>和&lt;code>password&lt;/code>后面的value为lskypro安装注册时填写的管理员邮箱和密码，之后点击Send，下方会提示：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://pic.tama.guru/i/2022/07/11/62cc1b5f8d671.png">
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc1b5f8d671.png" alt="请输入图片描述" />
&lt;/a>
&lt;/div>
&lt;img src="https://pic.tama.guru/i/2022/07/11/62cc1b5f8d671.png"
loading="lazy"
alt="请输入图片描述"
>&lt;/p>
&lt;p>此处即我们需要的token，填写进插件即可，后面就能正常使用了。&lt;/p>
&lt;p>&lt;code>[scode type=&amp;quot;yellow&amp;quot;]注意！如果提示500错误，极有可能是跨域设置问题，对于宝塔面板需要关掉防跨站攻击，对于lnmp需要进入&lt;/code>lnmp/tools&lt;code>目录执行&lt;/code>remove_open_basedir_restriction.sh&lt;code>，并输入图床源代码所在的目录，保存并执行&lt;/code>lnmp restart即可&lt;code>[/scode]&lt;/code>&lt;/p></description></item><item><title>handsome美化记录</title><link>https://blog.tama.guru/record/handsome-modify.html</link><pubDate>Sun, 10 Jul 2022 20:20:00 +0800</pubDate><guid>https://blog.tama.guru/record/handsome-modify.html</guid><description>&lt;p>&lt;code>[scode type=&amp;quot;yellow&amp;quot;]此处备份handsome主题一些自定义的教程：[/scode]&lt;/code>&lt;/p>
&lt;ul>
&lt;li>彩色标签云：在&lt;code>开发者设置-自定义 JavaScript&lt;/code>填写：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">let tags = document.querySelectorAll(&amp;#34;#tag_cloud-2 a&amp;#34;);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">let colorArr = [&amp;#34;#428BCA&amp;#34;, &amp;#34;#AEDCAE&amp;#34;, &amp;#34;#ECA9A7&amp;#34;, &amp;#34;#DA99FF&amp;#34;, &amp;#34;#FFB380&amp;#34;, &amp;#34;#D9B999&amp;#34;];
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tags.forEach(tag =&amp;gt; {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tagsColor = colorArr[Math.floor(Math.random() * colorArr.length)];
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tag.style.backgroundColor = tagsColor;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果使用PJAX需要同步填写到PJAX回调函数。&lt;/p>
&lt;ul>
&lt;li>头像相关美化：在&lt;code>开发者设置-自定义CSS&lt;/code>：&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/*头像呼吸光环和鼠标悬停旋转放大*/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.img-full {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> width: 100px;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> border-radius: 50%;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> animation: light 4s ease-in-out infinite;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> transition: 0.5s;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.img-full:hover {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> transform: scale(1.15) rotate(720deg);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@keyframes light {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0% {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> box-shadow: 0 0 4px #f00;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 25% {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> box-shadow: 0 0 16px #0f0;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 50% {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> box-shadow: 0 0 4px #00f;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 75% {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> box-shadow: 0 0 16px #0f0;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 100% {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> box-shadow: 0 0 4px #f00;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/*评论头像旋转*/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.img-circle {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> transition: all 0.3s;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.img-circle:hover {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> transform: rotate(360deg);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>唯一指定漫画阅读软件tachiyomi</title><link>https://blog.tama.guru/record/tachiyomi.html</link><pubDate>Sat, 09 Jul 2022 13:40:00 +0800</pubDate><guid>https://blog.tama.guru/record/tachiyomi.html</guid><description>&lt;p>项目地址：[tachiyomi](&lt;a class="link" href="https://github.com/tachiyomiorg/tachiyomi" target="_blank" rel="noopener"
>tachiyomiorg/tachiyomi: Free and open source manga reader for Android. (github.com)&lt;/a>)&lt;/p>
&lt;p>介绍：tachiyomi是一个开源的支持安卓6.0+的漫画阅读器，支持在线阅读漫画源内容，插件更新速度快，界面美观，更新中文/英文/日文插件（包括NSFW）&lt;/p>
&lt;p>优点：插件更新快，覆盖内容广（包含dmzj等常见内容源，基本上正经漫画都能搜出来），MD界面，开源无广告&lt;/p>
&lt;p>缺点：&lt;/p>
&lt;ul>
&lt;li>插件使用github源，部分地区无法在软件内安装，需要手动到&lt;a class="link" href="https://github.com/tachiyomiorg/tachiyomi-extensions/tree/repo/apk" target="_blank" rel="noopener"
>tachiyomi-extensions/apk at repo · tachiyomiorg/tachiyomi-extensions (github.com)&lt;/a>手动下载或者开小飞机下载。&lt;/li>
&lt;li>只支持安卓使用，其他设备使用需要一台服务器部署tachidesk服务：&lt;a class="link" href="https://github.com/Suwayomi/Tachidesk-Server" target="_blank" rel="noopener"
>Suwayomi/Tachidesk-Server: A rewrite of Tachiyomi for the Desktop (github.com)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>添加acfun直播的颜文字（仅针对handsome主题）</title><link>https://blog.tama.guru/record/aclive-emotion.html</link><pubDate>Thu, 07 Jul 2022 00:59:00 +0800</pubDate><guid>https://blog.tama.guru/record/aclive-emotion.html</guid><description>&lt;p>很简单，直接把对应文件替换掉就好。
后续会把ac娘也接入。
[hide]https://blog.tama.guru/usr/themes/handsome/usr/OwO.json[/hide]&lt;/p>
&lt;p>PS:AC娘图标包也已经实装
只需要把[hide]https://cdn.aixifan.com/dotnet/20130418/project/emot/package2.0/acfun_emoji.zip[/hide]下载到服务器解压并将压缩包下&lt;code>图片集&lt;/code>文件夹移动到&lt;code>usr/themes/handsome/assets/img/emotion&lt;/code>改名为&lt;code>acfun&lt;/code>再用上面的文件替换即可。&lt;/p>
&lt;p>如果觉得显示的表情过大了，可以在主题设置中的自定义css添加：&lt;/p>
&lt;pre>&lt;code>/*滑稽小表情自定义大小*/
.emotion-funny {
width: 30px;
}
.comment-content-true img.emotion-funny {
max-width: 100%!important;
}
&lt;/code>&lt;/pre></description></item><item><title>在异地服务器使用go-miraiqq教程</title><link>https://blog.tama.guru/record/miraiqq-remote.html</link><pubDate>Wed, 06 Jul 2022 09:11:45 +0800</pubDate><guid>https://blog.tama.guru/record/miraiqq-remote.html</guid><description>&lt;p>在异地直接扫码登录miraiqq会有“异常，建议在同一WIFI环境下使用”的提示，如果服务器在本地还好，但是买的服务器在外地就很难这样去处理了。
解决的方式也很简单，因为go-cqhttp是通过检查运行目录下的 &lt;code>device.json&lt;/code>和 &lt;code>session.token&lt;/code>来验证数据的，因此只要在本地环境搭建好go-cqhttp环境并登陆，然后用本地生成的两个文件传输到远程服务器下替换掉原有文件就好了。&lt;/p>
&lt;hr>
&lt;p>具体步骤：&lt;/p>
&lt;ol>
&lt;li>本地搭建go-cqhttp（本地的服务器类型可以与异地不一致，因为最终生成的 &lt;code>device.json&lt;/code>和 &lt;code>session.token&lt;/code>内容是一样的）
到 &lt;code>https://github.com/Mrs4s/go-cqhttp/releases&lt;/code>下载本地系统对应版本的文件，例如使用windows的可以下载 &lt;code>https://github.com/Mrs4s/go-cqhttp/releases/download/v1.0.0-rc3/go-cqhttp_windows_amd64.exe&lt;/code>，下载到本地双击运行；使用debian系的可以 &lt;code>wget https://github.com/Mrs4s/go-cqhttp/releases/download/v1.0.0-rc3/go-cqhttp_1.0.0-rc3_linux_amd64.deb&lt;/code> 然后 &lt;code>dpkg -i go-cqhttp_1.0.0-rc3_linux_amd64.deb&lt;/code>，即可使用go-cqhttp命令在当前目录下运行。&lt;/li>
&lt;li>使用windows版本会提示请勿通过双击运行本程序，确认即可，后续会生成 &lt;code>go-cqhttp.bat&lt;/code>，双击运行 &lt;code>go-cqhttp.bat&lt;/code>按要求选择通信方式，一般选择 &lt;code>0:HTTP通信&lt;/code>即可，待提示 &lt;code>默认配置文件已生成，请修改 config.yml 后重新启动!&lt;/code>后可关闭窗口。&lt;/li>
&lt;li>之后修改 &lt;code>config.yml&lt;/code>，此处只需要填报QQ账号、密码 其他不要动。&lt;/li>
&lt;li>修改好之后再运行 &lt;code>go-cqhttp.bat&lt;/code>一般会提示两个步骤：一是要滑动验证，直接复制生成的网址到浏览器并按要求处理即可；二是选择使用手机接收验证码。处理完两个步骤后提示正常运行即可关闭窗口，然后把目录下的 &lt;code>device.json&lt;/code>和 &lt;code>session.token&lt;/code>传输到服务器的miraiqq目录再运行对应程序即可（注意服务器的config文件中QQ账号、密码要和本地一致）。
PS： linux大同小异。&lt;/li>
&lt;/ol></description></item><item><title>阿巴阿巴阿巴</title><link>https://blog.tama.guru/record/wmdht_001.html</link><pubDate>Tue, 05 Jul 2022 23:08:02 +0800</pubDate><guid>https://blog.tama.guru/record/wmdht_001.html</guid><description>&lt;p>感谢万能小狼，我的账号密码终于回来了。（第一天就忘掉自己设置的密码，我是笨蛋&lt;/p></description></item><item><title>一些链接的备份</title><link>https://blog.tama.guru/record/somelinks.html</link><pubDate>Tue, 05 Jul 2022 02:00:00 +0800</pubDate><guid>https://blog.tama.guru/record/somelinks.html</guid><description>&lt;p>慢慢完善&lt;/p>
&lt;hr>
&lt;p>资源类：&lt;/p>
&lt;ul>
&lt;li>nyaa:&lt;a class="link" href="https://www.nyaa.eu/?page=search&amp;amp;cats=0_0&amp;amp;filter=0&amp;amp;term=VR" target="_blank" rel="noopener"
>Home - Nyaa.se Torrents Proxy&lt;/a>&lt;/li>
&lt;li>trackerlist:&lt;a class="link" href="https://trackerslist.com/#/" target="_blank" rel="noopener"
>XIU2/TrackersListCollection&lt;/a>&lt;/li>
&lt;li>mox.moe(&lt;a class="link" href="https://volmoe.com/" target="_blank" rel="noopener"
>Mox.moe [Kindle漫畫|Kobo漫畫|epub漫畫] [volmoe.com]&lt;/a>&lt;/li>
&lt;li>在线解析：&lt;a class="link" href="https://www.ahhhhfs.com/13620/" target="_blank" rel="noopener"
>影视软件VIP视频解析接口集合 | ahhhhfs - A姐分享&lt;/a>&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>游戏相关：&lt;/p>
&lt;ul>
&lt;li>steam游戏价格查询:https://steamdb.info/&lt;/li>
&lt;li>雀魂网页版：&lt;a class="link" href="https://game.maj-soul.net/1/" target="_blank" rel="noopener"
>雀魂麻將&lt;/a>&lt;/li>
&lt;li>&lt;/li>
&lt;/ul></description></item><item><title>关注人/圈子功能处于寄的状态</title><link>https://blog.tama.guru/record/follow-crash.html</link><pubDate>Sun, 03 Jul 2022 19:09:46 +0800</pubDate><guid>https://blog.tama.guru/record/follow-crash.html</guid><description>&lt;p>因为使用这个主题的时候是整个dev分支clone过来的，难免有一些bug（也确实看到作者刚在十几天前修了一些东西）
目前使用关注人/圈子会在后台显示&lt;code>post 500 error&lt;/code>
错误位置：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl"> var xhrSendProcessor = function()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> var requestDescriptor = findRequestDescriptor(this);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if (xhrProxyEnabled &lt;span class="err">&amp;amp;&amp;amp;&lt;/span> requestDescriptor)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> deleteDescriptor(this);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if (!requestDescriptor.isCORS &lt;span class="err">&amp;amp;&amp;amp;&lt;/span> !requestDescriptor.headerSet)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> oldSetRequestHeader.apply(this, [KasperskyLab.RequestCustomHeader, &amp;#39;Ajax_Request&amp;#39;]);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if (requestDescriptor.RequestSend)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> requestDescriptor.RequestSend.apply(this, [].slice.call(arguments));
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> catch(e)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> KasperskyLab.SessionError(e, &amp;#34;xhr&amp;#34;);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return oldSend.apply(this, [].slice.call(arguments));
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>具体出错位置：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> return oldSend.apply(this, [].slice.call(arguments));
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>暂且记录问题。&lt;/p></description></item><item><title>做一下ddbot的记录</title><link>https://blog.tama.guru/record/ddbot-live.html</link><pubDate>Sun, 03 Jul 2022 16:43:00 +0800</pubDate><guid>https://blog.tama.guru/record/ddbot-live.html</guid><description>&lt;h2 id="避免服务器寄了群友d谁都忘了以下做个记录">避免服务器寄了群友d谁都忘了，以下做个记录
&lt;/h2>&lt;p>&lt;strong>订阅列表(截至20220703)&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">空灵晓 7491034
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">qyqx 378269
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ag_Key 459097
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">唐茶唯一指定唐茶色 18245957
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">裕奈Yuna 37662640
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">完美的核桃 46571378
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">千璃Senri 12961787
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1001Project 179922
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">筱木茗 25061941
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">律诗 32844838
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">奈子绘Nakoe 35764170
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">✟塞壬Siren✟ 37181305
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">一支橘猫 13337864
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">我家亲爱的列克星敦 220810
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">寒禅肆青雲 65454607
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">存活率极低的小狼 852888
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">唐茶 2869300
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tsukasalol 416752
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>&lt;strong>notify.group.acfun.live.tmpl&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">living&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">AcFun&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">{{&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="p">}}&lt;/span> &lt;span class="nx">正在直播&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">开始时间：&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="nx">hour&lt;/span> &lt;span class="p">}}&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="nx">minute&lt;/span> &lt;span class="p">}}&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="nx">second&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">直播标题：&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">title&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">直播链接：&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">url&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span> &lt;span class="nx">pic&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">cover&lt;/span> &lt;span class="s2">&amp;#34;[封面]&amp;#34;&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">AcFun&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">{{&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="p">}}&lt;/span> &lt;span class="nx">直播结束了&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span> &lt;span class="nx">pic&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="nx">cover&lt;/span> &lt;span class="s2">&amp;#34;[封面]&amp;#34;&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">-&lt;/span> &lt;span class="nx">end&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>今天吃什么选择器
内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">KFC 拌面 包子 煲仔饭 肠粉 炒菜 炒饭 炒面 炒年糕 川菜 刀削面 盖浇饭 汉堡 汉堡王 黄焖鸡 黄焖鸡米饭 烩面 馄饨 火锅 鸡公煲 煎饼果子 饺子 咖喱饭 烤串 烤冷面 烤肉拌饭 烤肉饭 烤鸭 肯德基 拉面 兰州拉面 凉皮 凉皮儿 卤肉饭 螺狮粉 驴肉火烧 麻辣拌 麻辣烫 麻辣烫肉夹馍 麻辣香锅 麦当劳 冒菜 米线 牛肉面 泡面 披萨 热干面 沙县小吃 烧烤 生煎 石锅拌饭 手抓饼 寿司 水饺 酸菜鱼 酸辣粉 土豆粉 小碗菜 蟹黄包 羊肉汤 油泼面 炸鸡 炸酱面 重庆小面 粥 猪脚饭 粽子
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如有需要后续会更新&lt;/p></description></item></channel></rss>