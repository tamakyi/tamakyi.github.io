<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>树莓派 on 狼的公告板 ver.Hugo</title><link>https://blog.tama.guru/tags/%E6%A0%91%E8%8E%93%E6%B4%BE.html</link><description>Recent content in 树莓派 on 狼的公告板 ver.Hugo</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>tamakyi</copyright><lastBuildDate>Tue, 26 Aug 2025 01:52:02 +0000</lastBuildDate><atom:link href="https://blog.tama.guru/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/index.xml" rel="self" type="application/rss+xml"/><item><title>使用fruity-pikvm实现在64位raspios上运行pikvm</title><link>https://blog.tama.guru/record/fruity-pikvm.html</link><pubDate>Sat, 08 Feb 2025 11:35:42 +0800</pubDate><guid>https://blog.tama.guru/record/fruity-pikvm.html</guid><description>&lt;p>我这个树莓派4买了好多年，基本上是吃灰的状态。因为自从我买了一套pikvm外设装上去之后，基本上就只能跑pikvm的那个魔改archlinux，我就是感觉各种别扭。一方面32位的arm系统并不能发挥PI4的性能，很多软件（包括一些容器）最低也需要aarch；另一方面，pikvm软件源在国内的访问速度简直就是一坨**，就算是挂了梯子都不一定能连的上，更不用说更新软件了。&lt;/p>
&lt;p>今天偶然发现fruity-pikvm这个项目（https://github.com/jacobbar/fruity-pikvm），看介绍能够&amp;quot;将 PiKVM 安装移植到其他 SBC，如 OrangePi、BananaPi、MangoPi 等。且已在已在 OrangePi Zero 2 上进行了测试，目前，此脚本支持架构 &lt;strong>arm64/aarch64&lt;/strong> 和 armhf/armv7l，并且应该适用于任何基于 Debian 的发行版，例如 Ubuntu、&lt;strong>Debian&lt;/strong>、Armbian 等&amp;hellip;&amp;hellip;&amp;quot;&lt;/p>
&lt;p>哦？&lt;/p>
&lt;p>我直接跑回家下了坨2024-11-19的raspios刷上去，配置完环境之后直接按照步骤执行fruity-pikvm安装:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo apt install -y git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ git clone https://kkgithub.com/jacobbar/fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ &lt;span class="nb">cd&lt;/span> fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ sudo ./install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装过程只需要按一下y，其他都是在编译、安装和测试过程。但是最后安装fruity-pikvm时出现了错误：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">--&amp;gt;&amp;gt; installing fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Selecting previously unselected package fruity-pikvm.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dpkg: regarding fruity-pikvm_0.2_arm64.deb containing fruity-pikvm, pre-dependency problem:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fruity-pikvm pre-depends on iptables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> iptables is not installed.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dpkg: error processing archive fruity-pikvm_0.2_arm64.deb &lt;span class="o">(&lt;/span>--install&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pre-dependency problem - not installing fruity-pikvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Errors were encountered &lt;span class="k">while&lt;/span> processing:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo: kvmd: &lt;span class="nb">command&lt;/span> not found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reboot and enjoy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>他依赖iptables，但是raspiso默认没有，那装一个完了再重新安装fruity-pikvm就是了：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ wget https://github.com/jacobbar/fruity-pikvm/releases/download/debfile/fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ sudo dpkg -i fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>接着继续报错，但是整体是能安装了：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/fruity-pikvm $ sudo dpkg -i fruity-pikvm_0.2_arm64.deb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>Reading database ... &lt;span class="m">133479&lt;/span> files and directories currently installed.&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Preparing to unpack fruity-pikvm_0.2_arm64.deb ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Unpacking fruity-pikvm &lt;span class="o">(&lt;/span>0.2&lt;span class="o">)&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Setting up fruity-pikvm &lt;span class="o">(&lt;/span>0.2&lt;span class="o">)&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Ensuring KVMD users and groups ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd&amp;#39;&lt;/span> with GID 991.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-pst&amp;#39;&lt;/span> with GID 990.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-ipmi&amp;#39;&lt;/span> with GID 989.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-vnc&amp;#39;&lt;/span> with GID 988.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-nginx&amp;#39;&lt;/span> with GID 987.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-janus&amp;#39;&lt;/span> with GID 986.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-certbot&amp;#39;&lt;/span> with GID 985.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - The main daemon&lt;span class="o">)&lt;/span> with UID &lt;span class="m">991&lt;/span> and GID 991.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-pst&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - Persistent storage&lt;span class="o">)&lt;/span> with UID &lt;span class="m">990&lt;/span> and GID 990.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-ipmi&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - IPMI to KVMD proxy&lt;span class="o">)&lt;/span> with UID &lt;span class="m">989&lt;/span> and GID 989.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-vnc&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - VNC to KVMD/Streamer proxy&lt;span class="o">)&lt;/span> with UID &lt;span class="m">988&lt;/span> and GID 988.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-nginx&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - HTTP entrypoint&lt;span class="o">)&lt;/span> with UID &lt;span class="m">987&lt;/span> and GID 987.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-janus&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - Janus WebRTC Gateway&lt;span class="o">)&lt;/span> with UID &lt;span class="m">986&lt;/span> and GID 986.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-certbot&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>PiKVM - Certbot-Renew &lt;span class="k">for&lt;/span> KVMD-Nginx&lt;span class="o">)&lt;/span> with UID &lt;span class="m">985&lt;/span> and GID 985.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Generating KVMD-Nginx certificate ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ mkdir -p /etc/kvmd/nginx/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ rm -f &lt;span class="s1">&amp;#39;/etc/kvmd/nginx/ssl/*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ &lt;span class="nb">cd&lt;/span> /etc/kvmd/nginx/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl ecparam -out server.key -name prime256v1 -genkey
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl req -new -x509 -sha256 -nodes -key server.key -out server.crt -days &lt;span class="m">3650&lt;/span> -subj /C&lt;span class="o">=&lt;/span>RU/ST&lt;span class="o">=&lt;/span>Moscow/L&lt;span class="o">=&lt;/span>Moscow/O&lt;span class="o">=&lt;/span>PiKVM/OU&lt;span class="o">=&lt;/span>PiKVM/CN&lt;span class="o">=&lt;/span>localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chown root:kvmd-nginx /etc/kvmd/nginx/ssl/server.crt /etc/kvmd/nginx/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">440&lt;/span> /etc/kvmd/nginx/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">444&lt;/span> /etc/kvmd/nginx/ssl/server.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">755&lt;/span> /etc/kvmd/nginx/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Generating KVMD-VNC certificate ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ mkdir -p /etc/kvmd/vnc/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ rm -f &lt;span class="s1">&amp;#39;/etc/kvmd/vnc/ssl/*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ &lt;span class="nb">cd&lt;/span> /etc/kvmd/vnc/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl ecparam -out server.key -name prime256v1 -genkey
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ openssl req -new -x509 -sha256 -nodes -key server.key -out server.crt -days &lt;span class="m">3650&lt;/span> -subj /C&lt;span class="o">=&lt;/span>RU/ST&lt;span class="o">=&lt;/span>Moscow/L&lt;span class="o">=&lt;/span>Moscow/O&lt;span class="o">=&lt;/span>PiKVM/OU&lt;span class="o">=&lt;/span>PiKVM/CN&lt;span class="o">=&lt;/span>localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chown root:kvmd-vnc /etc/kvmd/vnc/ssl/server.crt /etc/kvmd/vnc/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">440&lt;/span> /etc/kvmd/vnc/ssl/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">444&lt;/span> /etc/kvmd/vnc/ssl/server.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+ chmod &lt;span class="m">755&lt;/span> /etc/kvmd/vnc/ssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Disabling nginx service, so that we can use kvmd-nginx instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Synchronizing state of nginx.service with SysV service script with /lib/systemd/systemd-sysv-install.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Executing: /lib/systemd/systemd-sysv-install disable nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Removed &lt;span class="s2">&amp;#34;/etc/systemd/system/multi-user.target.wants/nginx.service&amp;#34;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Disabling janus service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Synchronizing state of janus.service with SysV service script with /lib/systemd/systemd-sysv-install.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Executing: /lib/systemd/systemd-sysv-install disable janus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Removed &lt;span class="s2">&amp;#34;/etc/systemd/system/multi-user.target.wants/janus.service&amp;#34;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Ensuring KVMD-Webterm users and groups ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating group &lt;span class="s1">&amp;#39;kvmd-webterm&amp;#39;&lt;/span> with GID 984.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Creating user &lt;span class="s1">&amp;#39;kvmd-webterm&amp;#39;&lt;/span> &lt;span class="o">(&lt;/span>Pi-KVM - Web terminal&lt;span class="o">)&lt;/span> with UID &lt;span class="m">984&lt;/span> and GID 984.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Making tesseract data &lt;span class="nv">link&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Creating symlinks &lt;span class="k">for&lt;/span> use with kvmd python &lt;span class="nv">scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Adding path to python &lt;span class="k">for&lt;/span> KVMD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/lib/dpkg/info/fruity-pikvm.postinst: line 76: /usr/local/lib/python3.10/dist-packages/site-packages.pth: No such file or &lt;span class="nv">directory&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Fixing armbian otg &lt;span class="nv">takeover&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">==&lt;/span>&amp;gt; Enabling kvmd-nginx kvmd-webterm kvmd-otg and kvmd services, but &lt;span class="k">do&lt;/span> not start them.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-nginx.service → /lib/systemd/system/kvmd-nginx.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-webterm.service → /lib/systemd/system/kvmd-webterm.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-otg.service → /lib/systemd/system/kvmd-otg.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd.service → /lib/systemd/system/kvmd.service.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/kvmd-fix.service → /lib/systemd/system/kvmd-fix.service.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里报错的&lt;code>/usr/local/lib/python3.10/dist-packages/site-packages.pth: No such file or directory&lt;/code>在项目的issus中有类似表述：（&lt;a class="link" href="https://github.com/jacobbar/fruity-pikvm/issues/5" target="_blank" rel="noopener"
>Use a release with preinstalled python 3.10 for easier installation · Issue #5 · jacobbar/fruity-pikvm&lt;/a>），也就是python库默认没有添加kvmd-packages这个问题，检测是否真的出现可以使用&lt;code>kvmd -m&lt;/code>命令测试，通常会提示&lt;code>No module named 'kvmd'&lt;/code>。解决办法就是手动添加路径到默认库：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /usr/local/lib/python3.10/site-packages/kvmd.pth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#写入内容：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/local/lib/python3.10/kvmd-packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#保存&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /usr/local/lib/python3.10/dist-packages/site-packages.pth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#写入内容：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/local/lib/python3.10/kvmd-packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#保存&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>/usr/local/lib/python3.10/dist-packages/&lt;/code>这个路径可能不存在，可以手动创建。&lt;/p>
&lt;p>完成之后重启PI，使用IP访问，发现提示500 ISE，检查kvmd-nginx进程发现丢失&lt;code>kvmd.sock&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo systemctl status kvmd-nginx.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect&lt;span class="o">()&lt;/span> to unix:/run/kvmd/kvmd.sock failed &lt;span class="o">(&lt;/span>2: No such file or directory&lt;span class="o">)&lt;/span> &lt;span class="k">while&lt;/span> connecting to upstream, client: *.0.0.*, server: localhost, request: &lt;span class="s2">&amp;#34;GET / HTTP/2.0&amp;#34;&lt;/span>, subrequest: &lt;span class="s2">&amp;#34;/auth_check&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这个问题在上面的issus上也有提到，但是只说了python库默认没有添加kvmd-packages这个问题如何解决，500报错并没有解决。然后我继续检查日志：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/bin/kvmd&amp;#34;&lt;/span>, line 9, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: main&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/__init__.py&amp;#34;&lt;/span>, line 75, in main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: KvmdServer&lt;span class="o">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/server.py&amp;#34;&lt;/span>, line 263, in run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: comp.sysprep&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/plugins/hid/otg/__init__.py&amp;#34;&lt;/span>, line 114, in sysprep
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: &lt;span class="nv">udc&lt;/span> &lt;span class="o">=&lt;/span> usb.find_udc&lt;span class="o">(&lt;/span>self.__udc&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/usb.py&amp;#34;&lt;/span>, line 34, in find_udc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: raise RuntimeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Can&amp;#39;t find any UDC&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 14:53:39 akarinbot kvmd&lt;span class="o">[&lt;/span>2180&lt;span class="o">]&lt;/span>: RuntimeError: Can&lt;span class="err">&amp;#39;&lt;/span>t find any UDC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里抛出一个&lt;code>Can't find any UDC&lt;/code>的错误，UDC我查了下应该指的是&lt;code>USB Device Controller&lt;/code>，检查是否有相关设备：&lt;code>lsmod | grep usb&lt;/code>发现返回确实是空值。搜了下这个关键词，在&lt;a class="link" href="https://techblog.jeppson.org/2022/03/fix-kvmd-not-starting-after-updating-pikvm/" target="_blank" rel="noopener"
>Fix KVMD not starting after updating piKVM - Technicus&lt;/a>这篇文章中发现有人提到在PI4上也出现了这个问题，然后我按照他在文章说的修改config.txt配置文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /boot/firmware/config.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#添加以下内容到最后&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>tc358743
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>disable-bt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dtoverlay&lt;/span>&lt;span class="o">=&lt;/span>dwc2,dr_mode&lt;span class="o">=&lt;/span>peripheral
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#结束&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后再执行&lt;code>lsmod | grep usb&lt;/code>，发现能检测到设备了。作者应该是对照了pikvm官方系统的配置文件和raspios的配置文件发现差异。&lt;/p>
&lt;p>在这个issus下也有相关讨论：&lt;a class="link" href="https://kkgithub.com/Prototyped/pikvm-container/issues/1" target="_blank" rel="noopener"
>RuntimeError：找不到任何 UDC ·问题 #1 ·原型/pikvm 容器&lt;/a>，这里的操作是：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo /usr/sbin/modprobe libcomposite
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo nano /etc/modules-load.d/kvmd.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#添加以下内容&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dwc2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">libcomposite
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#保存&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这个方法选择不动&lt;code>config.txt&lt;/code>配置文件，看上去也更安全，但是我用的是第一种方法，第二种并没有效果。&lt;/p>
&lt;p>到这里的时候网页端已经能够使用admin/admin访问了，但是进入kvm页面发现无法显示，然后检查日志的时候发现疯狂报错：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer ERROR --- Unexpected streamer error: &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2793&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/streamer.py&amp;#34;&lt;/span>, line 428, in __streamer_task_loop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> raise RuntimeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Streamer unexpectedly died&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RuntimeError: Streamer unexpectedly died
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.info.system ERROR --- Can&lt;span class="err">&amp;#39;&lt;/span>t parse streamer features
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/info/system.py&amp;#34;&lt;/span>, line 69, in __get_streamer_info
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>status, name&lt;span class="o">)&lt;/span> &lt;span class="o">=&lt;/span> map&lt;span class="o">(&lt;/span>str.strip, line.split&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ValueError: not enough values to unpack &lt;span class="o">(&lt;/span>expected 2, got 1&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer INFO --- Started streamer &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>2835: /usr/bin/ustreamer --device&lt;span class="o">=&lt;/span>/dev/kvmd-video --persistent --format&lt;span class="o">=&lt;/span>mjpeg --resolution&lt;span class="o">=&lt;/span>1920x1080 --desired-fps&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> --drop-same-frames&lt;span class="o">=&lt;/span>&lt;span class="m">30&lt;/span> --last-as-blank&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --unix&lt;span class="o">=&lt;/span>/run/kvmd/ustreamer.sock --unix-rm --unix-mode&lt;span class="o">=&lt;/span>&lt;span class="m">0660&lt;/span> --exit-on-parent-death --process-name-prefix&lt;span class="o">=&lt;/span>kvmd/streamer --notify-parent --no-log-colors --sink&lt;span class="o">=&lt;/span>kvmd::ustreamer::jpeg --sink-mode&lt;span class="o">=&lt;/span>&lt;span class="m">0660&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; /usr/bin/ustreamer: error &lt;span class="k">while&lt;/span> loading shared libraries: libjpeg.so.8: cannot open shared object file: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kvmd.apps.kvmd.streamer ERROR --- Unexpected streamer error: &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2835&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>他要&lt;code>libjpeg.so.8&lt;/code>这个东西，但很明显我没有：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo find / -name libjpeg*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/aarch64-linux-gnu/libjpeg.so.62
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/aarch64-linux-gnu/libjpegxr.so.1.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/aarch64-linux-gnu/libjpeg.so.62.3.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在https://github.com/jacobbar/fruity-pikvm/issues/5中，他简单粗暴的从5.4的镜像里面提取出libjpeg.so.8和libjpeg.so.8.2.2两个文件扔到系统的&lt;code>/usr/lib/aarch64-linux-gnu&lt;/code>里。现在版本都飞到6.6.74了，肯定是没5.4，那只能自己编译个：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.4.290.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ tar xvf linux-5.4.290.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ &lt;span class="nb">cd&lt;/span> linux-5.4.290
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ cp /boot/config-&lt;span class="k">$(&lt;/span>uname -r&lt;span class="k">)&lt;/span> .config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ nano .config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#把 #CONFIG_TRUSTED_KEYS is not set 修改为 CONFIG_TRUSTED_KEYS=&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel/linux-5.4.290 $ make menuconfig &lt;span class="c1">#需要调整配置用&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~/kernel $ make -j4 &lt;span class="c1">#四线程编译&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果怕跑到半掉了可以开个screen。&lt;/p>
&lt;p>&lt;strong>但是！我发现另一台不记得是香蕉还是香橙的PI的docker内居然找到了这玩意，反正一样是aarch，直接狠狠替换。&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>base&lt;span class="o">)&lt;/span> tamakyi@akarinbot-arm64:~$ sudo find / -name libjpeg*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>sudo&lt;span class="o">]&lt;/span> tamakyi 的密码：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/lib/docker/overlay2/001ccded49667e443e6b0d924d49a33745a8cf2634056ada168e84a81aeae3ac/diff/usr/lib/libjpeg.so.8.2.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/lib/docker/overlay2/001ccded49667e443e6b0d924d49a33745a8cf2634056ada168e84a81aeae3ac/diff/usr/lib/libjpeg.so.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>还是不行，再看一下日志：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:06 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: RuntimeError: Streamer unexpectedly died
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- Started streamer &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>2914: /usr/bin/ustreamer --device&lt;span class="o">=&lt;/span>/dev/kvmd-video --persistent --format&lt;span class="o">=&lt;/span>mjpeg --resolution&lt;span class="o">=&lt;/span>1920x1080 --desired-fps&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> --drop-same-frames&lt;span class="o">=&lt;/span>&lt;span class="m">30&lt;/span> --last-as-blank&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --unix&lt;span class="o">=&lt;/span>/run/kvmd/ustreamer.sock --unix-rm --unix-mode&lt;span class="o">=&lt;/span>0660&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; /usr/bin/ustreamer: error &lt;span class="k">while&lt;/span> loading shared libraries: libc.musl-aarch64.so.1: cannot open shared object file: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer ERROR --- Unexpected streamer error: &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2914&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: File &lt;span class="s2">&amp;#34;/usr/local/lib/python3.10/kvmd-packages/kvmd/apps/kvmd/streamer.py&amp;#34;&lt;/span>, line 428, in __streamer_task_loop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 16:44:07 akarinbot kvmd&lt;span class="o">[&lt;/span>986&lt;span class="o">]&lt;/span>: raise RuntimeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Streamer unexpectedly died&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>又缺个&lt;code>libc.musl-aarch64.so.1&lt;/code>，去网上找了下，没有提到这个文件的信息，但是有&lt;code>libc.musl-x86_64.so.1&lt;/code>，换汤不换药嘛，那就&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo apt install musl musl-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo ln -s /usr/lib/aarch64-linux-musl/libc.so /lib/libc.musl-aarch64.so.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo systemctl restart kvmd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>现在登陆进去没异常了，但是提示&lt;code>No Singal&lt;/code>，再看看日志文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tamakyi@akarinbot:~ $ sudo journalctl -u kvmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- Starting streamer ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- Started streamer &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>8263: /usr/bin/ustreamer --device&lt;span class="o">=&lt;/span>/dev/kvmd-video --persistent --format&lt;span class="o">=&lt;/span>mjpeg --resolution&lt;span class="o">=&lt;/span>1920x1080 --desired-fps&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> --drop-same-frames&lt;span class="o">=&lt;/span>&lt;span class="m">30&lt;/span> --last-&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.203 main&lt;span class="o">]&lt;/span> -- Starting PiKVM uStreamer 5.37 ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 main&lt;span class="o">]&lt;/span> -- Using internal blank placeholder
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 main&lt;span class="o">]&lt;/span> -- Using JPEG-sink: kvmd::ustreamer::jpeg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 main&lt;span class="o">]&lt;/span> -- Listening HTTP on UNIX socket &lt;span class="s1">&amp;#39;/run/kvmd/ustreamer.sock&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 stream&lt;span class="o">]&lt;/span> -- Using V4L2 device: /dev/kvmd-video
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1037.204 stream&lt;span class="o">]&lt;/span> -- Using desired FPS: &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; &lt;span class="o">================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:30 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- ERROR &lt;span class="o">[&lt;/span>1037.205 stream&lt;span class="o">]&lt;/span> -- Can&lt;span class="s1">&amp;#39;t access device: No such file or directory
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">2月 07 17:13:30 akarinbot kvmd[7433]: kvmd.apps.kvmd.streamer INFO --- =&amp;gt; -- INFO [1037.205 stream] -- Waiting for the device access ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">2月 07 17:13:30 akarinbot kvmd[7433]: kvmd.apps.kvmd.streamer INFO --- =&amp;gt; -- INFO [1037.206 http] -- Starting HTTP eventloop ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">2月 07 17:13:31 akarinbot kvmd[7433]: aiohttp.access INFO --- [admin (token) / -] &amp;#39;&lt;/span>GET /auth/check HTTP/1.0&lt;span class="s1">&amp;#39; =&amp;gt; 200; size=194 --- referer=&amp;#39;&lt;/span>https://*.*.*.*/kvm/&lt;span class="s1">&amp;#39;; user_agent=&amp;#39;&lt;/span>Mozilla/5.0 &lt;span class="o">(&lt;/span>Linux&lt;span class="p">;&lt;/span> Android 10&lt;span class="p">;&lt;/span> K&lt;span class="o">)&lt;/span> AppleWebKit/537&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2月 &lt;span class="m">07&lt;/span> 17:13:31 akarinbot kvmd&lt;span class="o">[&lt;/span>7433&lt;span class="o">]&lt;/span>: kvmd.apps.kvmd.streamer INFO --- &lt;span class="o">=&lt;/span>&amp;gt; -- INFO &lt;span class="o">[&lt;/span>1038.367 http&lt;span class="o">]&lt;/span> -- HTTP: NEW client &lt;span class="o">(&lt;/span>&lt;span class="nv">now&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">)&lt;/span>: &lt;span class="o">[&lt;/span>100.74.203.35&lt;span class="o">]&lt;/span>:0, &lt;span class="nv">id&lt;/span>&lt;span class="o">=&lt;/span>bad9da595991fbbf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>基本上正常了，但还有一个&lt;code>Can't access device: No such file or directory&lt;/code>，总之先保证能跑起来了，真是心累。&lt;/p></description></item></channel></rss>