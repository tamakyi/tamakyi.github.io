<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mysql on 狼的公告板 ver.Hugo</title><link>https://blog.tama.guru/tags/mysql.html</link><description>Recent content in Mysql on 狼的公告板 ver.Hugo</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>tamakyi</copyright><lastBuildDate>Fri, 15 Aug 2025 02:00:15 +0000</lastBuildDate><atom:link href="https://blog.tama.guru/tags/mysql/index.xml" rel="self" type="application/rss+xml"/><item><title>Archlinux下安装并配置lnmp环境</title><link>https://blog.tama.guru/record/archlinux_lnmp.html</link><pubDate>Thu, 30 Nov 2023 11:07:00 +0800</pubDate><guid>https://blog.tama.guru/record/archlinux_lnmp.html</guid><description>&lt;p>最近把编译用的主机换个发行版，最开始用的是debian，结果现在桌面环境进不去了（而且是一引导完成就所有输入、输入都没反应，但是ssh能登陆，很奇怪），懒得去查原因就选择换个环境。本来用的almalinux，无奈真的不喜欢gnome，自己装了kde之后ibus无论怎样都打不出中文，最后还是上了arch。
无论是宝塔还是lnmp.org都没有对arch系进行适配，网上也有很多一步步排错安装的教程，但是看着一步步的报错再去核查原因着实难受，最后还是选择自己装最基础的nginx+php+mysql。&lt;/p>
&lt;h4 id="安装nginx">安装nginx
&lt;/h4>&lt;p>archlinux软件包里面有nginx和nginx-mainline（当前最新是1.25.3)两个版本，nginx版本较老且两个版本之间有冲突，故安装nginx-mainline。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S nginx-mainline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装完成后执行&lt;code>systemctl status nginx&lt;/code>可能会提示&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">11月 30 10:04:16 bot nginx[17674]: 2023/11/30 10:04:16 [warn] 17674#17674: could not build optimal types_hash, you should increase either types_hash_max_size: 1024 or types_hash_bucket_size: 64; ignoring types_hash_bucket_size
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>需要修改&lt;code>/etc/nginx/nginx.conf&lt;/code>，并在http块下添加&lt;code>types_hash_max_size 4096;&lt;/code>，例如：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">http {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> types_hash_max_size 4096;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #gzip on;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后重启nginx：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl retstart nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>就不会报错了，访问也没问题。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f220cd216.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f220cd216.png" alt="Nginx页面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f220cd216.png"
loading="lazy"
alt="Nginx页面"
>&lt;/p>
&lt;h4 id="安装php">安装php
&lt;/h4>&lt;p>执行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S php-fpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装最新的php模块，当前最新版本是8.2.13-1。安装php-fpm会自动把php一并安装好。
然后把php-fpm和nginx对接，修改&lt;code>/etc/nginx/nginx.conf&lt;/code>：
把：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> #location ~ \.php$ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # root html;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # fastcgi_pass 127.0.0.1:9000;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # fastcgi_index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # include fastcgi_params;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> location ~ \.php$ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> root /usr/share/nginx/html;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include fastcgi_params;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后测试配置文件是否正常：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nginx -t
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>并将相应服务启动/重启：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">fpm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">start&lt;/span> &lt;span class="n">php&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">fpm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">restart&lt;/span> &lt;span class="n">nginx&lt;/span> &lt;span class="c1">#或nginx -s reload&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后到网站root目录&lt;code>/usr/share/nginx/html&lt;/code>下放一个探针:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /usr/share/nginx/html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://raw.githubusercontent.com/582033/monitor/master/monitor.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后访问ip/monitor.php：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f6f37060a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f6f37060a.png" alt="php访问测试" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/30/6567f6f37060a.png"
loading="lazy"
alt="php访问测试"
>
如果显示得出来说明nginx和php-fpm已经对接上了。&lt;/p>
&lt;h4 id="安装mysql">安装mysql
&lt;/h4>&lt;p>先启动php下mysql的相关拓展：
修改&lt;code>/etc/php/php.ini &lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">;extension=mysqli
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=odbc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;zend_extension=opcache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=pdo_dblib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=pdo_mysql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">extension=mysqli
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=odbc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;zend_extension=opcache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">;extension=pdo_dblib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">extension=pdo_mysql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装mariadb：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S mariadb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>初始化mysqldb的数据目录：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mysql_install_db&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">mysql&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">basedir&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">usr&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">datadir&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mysql&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>启动mysql服务：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl enable mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start mysqld
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>运行安全脚本配置：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mysql_secure_installation
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>各项内容根据实际修改：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mysql_secure_installation&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Deprecated&lt;/span> &lt;span class="n">program&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">It&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">removed&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">future&lt;/span> &lt;span class="n">release&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">use&lt;/span> &lt;span class="s1">&amp;#39;mariadb-secure-installation&amp;#39;&lt;/span> &lt;span class="n">instead&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">RUNNING&lt;/span> &lt;span class="n">ALL&lt;/span> &lt;span class="n">PARTS&lt;/span> &lt;span class="n">OF&lt;/span> &lt;span class="n">THIS&lt;/span> &lt;span class="n">SCRIPT&lt;/span> &lt;span class="n">IS&lt;/span> &lt;span class="n">RECOMMENDED&lt;/span> &lt;span class="n">FOR&lt;/span> &lt;span class="n">ALL&lt;/span> &lt;span class="n">MariaDB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">SERVERS&lt;/span> &lt;span class="n">IN&lt;/span> &lt;span class="n">PRODUCTION&lt;/span> &lt;span class="n">USE&lt;/span>&lt;span class="o">!&lt;/span> &lt;span class="n">PLEASE&lt;/span> &lt;span class="n">READ&lt;/span> &lt;span class="n">EACH&lt;/span> &lt;span class="n">STEP&lt;/span> &lt;span class="n">CAREFULLY&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="n">order&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="nb">log&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">secure&lt;/span> &lt;span class="n">it&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">we&lt;/span>&lt;span class="s1">&amp;#39;ll need the current&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span>&lt;span class="s1">&amp;#39;ve just installed MariaDB, and&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">haven&lt;/span>&lt;span class="s1">&amp;#39;t set the root password yet, you should just press enter here.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Enter&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">enter&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">none&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1">#输入mysql root密码 默认是空，直接回车&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">OK&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">successfully&lt;/span> &lt;span class="n">used&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">on&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Setting&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">unix_socket&lt;/span> &lt;span class="n">ensures&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">nobody&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">can&lt;/span> &lt;span class="nb">log&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="n">without&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">proper&lt;/span> &lt;span class="n">authorisation&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">You&lt;/span> &lt;span class="n">already&lt;/span> &lt;span class="n">have&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">account&lt;/span> &lt;span class="n">protected&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="n">safely&lt;/span> &lt;span class="n">answer&lt;/span> &lt;span class="s1">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Switch&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">unix_socket&lt;/span> &lt;span class="n">authentication&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否切人到unix_socket认证，默认是，直接回车。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Enabled&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reloading&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span>&lt;span class="o">..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">You&lt;/span> &lt;span class="n">already&lt;/span> &lt;span class="n">have&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">account&lt;/span> &lt;span class="n">protected&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="n">safely&lt;/span> &lt;span class="n">answer&lt;/span> &lt;span class="s1">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Change&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否修改root密码，默认是，直接回车。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">New&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1">#输入新的root密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Re&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">enter&lt;/span> &lt;span class="n">new&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1">#再次输入新的root密码&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Password&lt;/span> &lt;span class="n">updated&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reloading&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span>&lt;span class="o">..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">By&lt;/span> &lt;span class="n">default&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">installation&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">anonymous&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">allowing&lt;/span> &lt;span class="n">anyone&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">to&lt;/span> &lt;span class="nb">log&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">without&lt;/span> &lt;span class="n">having&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">have&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="n">account&lt;/span> &lt;span class="n">created&lt;/span> &lt;span class="k">for&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">them&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">This&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">intended&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">testing&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">make&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">installation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">go&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">bit&lt;/span> &lt;span class="n">smoother&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">You&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">remove&lt;/span> &lt;span class="n">them&lt;/span> &lt;span class="n">before&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">production&lt;/span> &lt;span class="n">environment&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Remove&lt;/span> &lt;span class="n">anonymous&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否删除匿名用户，默认是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Normally&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">allowed&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">connect&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;localhost&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">This&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ensures&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">someone&lt;/span> &lt;span class="n">cannot&lt;/span> &lt;span class="n">guess&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">network&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Disallow&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">login&lt;/span> &lt;span class="n">remotely&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="c1">#是否禁用远程登陆，我有需求，这里填否&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">skipping&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">By&lt;/span> &lt;span class="n">default&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MariaDB&lt;/span> &lt;span class="n">comes&lt;/span> &lt;span class="n">with&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">database&lt;/span> &lt;span class="n">named&lt;/span> &lt;span class="s1">&amp;#39;test&amp;#39;&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">anyone&lt;/span> &lt;span class="n">can&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">access&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">This&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">also&lt;/span> &lt;span class="n">intended&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">testing&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">removed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">before&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">into&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">production&lt;/span> &lt;span class="n">environment&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Remove&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">database&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">access&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">it&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否移除测试数据库，默认是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">Dropping&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">Removing&lt;/span> &lt;span class="n">privileges&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">database&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reloading&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">ensure&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">all&lt;/span> &lt;span class="n">changes&lt;/span> &lt;span class="n">made&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">far&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">will&lt;/span> &lt;span class="n">take&lt;/span> &lt;span class="n">effect&lt;/span> &lt;span class="n">immediately&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Reload&lt;/span> &lt;span class="n">privilege&lt;/span> &lt;span class="n">tables&lt;/span> &lt;span class="n">now&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">#是否刷新权限，默认是&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span> &lt;span class="n">Success&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cleaning&lt;/span> &lt;span class="n">up&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">All&lt;/span> &lt;span class="n">done&lt;/span>&lt;span class="o">!&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span>&lt;span class="s1">&amp;#39;ve completed all of the above steps, your MariaDB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">installation&lt;/span> &lt;span class="n">should&lt;/span> &lt;span class="n">now&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">secure&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Thanks&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">MariaDB&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>输入新的root密码测试登陆mysql：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># mysql -u root -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql: Deprecated program name. It will be removed in a future release, use &amp;#39;/usr/bin/mariadb&amp;#39; instead
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to the MariaDB monitor. Commands end with ; or \g.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Your MariaDB connection id is 12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Server version: 11.2.2-MariaDB Arch Linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type &amp;#39;help;&amp;#39; or &amp;#39;\h&amp;#39; for help. Type &amp;#39;\c&amp;#39; to clear the current input statement.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MariaDB [(none)]&amp;gt; quit;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Bye
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>确认一切正常，最后重启所有相关服务：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl restart mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>至此所有步骤均完成。&lt;/p>
&lt;h4 id="优化配置可选">优化配置（可选）
&lt;/h4>&lt;p>1、对于&lt;code>/etc/nginx/nginx.conf&lt;/code>:
在http块下新增：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">client_max_body_size 10m;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>2、对于&lt;code>/etc/php/php.ini&lt;/code>：
修改&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">upload_max_filesize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">M&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">upload_max_filesize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="n">M&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>3、安装phpmyadmin：
去phpmyadmin官网下载最新版安装包，目前是5.2.1：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /usr/share/nginx/hmtl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://files.phpmyadmin.net/phpMyAdmin/5.2.1/phpMyAdmin-5.2.1-all-languages.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip phpMyAdmin-5.2.1-all-languages.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv phpMyAdmin-5.2.1-all-languages phpmyadmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd phpmyadmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp config.sample.inc.php config.inc.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后修改配置文件&lt;code>config.inc.php&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$cfg[&amp;#39;blowfish_secret&amp;#39;] = &amp;#39;任意字符串&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$cfg[&amp;#39;Servers&amp;#39;][$i][&amp;#39;host&amp;#39;] = &amp;#39;127.0.0.1&amp;#39;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改nginx的配置&lt;code>/usr/nginx/nginx.conf&lt;/code>，添加以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> location /phpmyadmin {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> alias /usr/share/nginx/html/phpmyadmin;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> location ~ /phpmyadmin/.+\.php$ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if ($fastcgi_script_name ~ /phpmyadmin/(.+\.php.*)$) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> set $valid_fastcgi_script_name $1;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include fastcgi_params;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_index index.php;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastcgi_param SCRIPT_FILENAME /usr/share/nginx/html/phpmyadmin/$valid_fastcgi_script_name;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后重启nginx和php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl restart nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可能会提示”缺少 mysqli 扩展“，请检查拓展的位置是否配置正确了。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># find / -name mysqli*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/php/modules/mysqli.so
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以看到拓展实际上位于&lt;code>/usr/lib/php/modules/&lt;/code>这个位置下，那就把&lt;code>/etc/php/php.ini&lt;/code>中的&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">extension=mysqli
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改成&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">extension=/usr/lib/php/modules/mysqli.so
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>重启php-fpm服务即可正常运行。&lt;/p></description></item><item><title>阿里云服务器的买后优化记录</title><link>https://blog.tama.guru/record/aliyun_server.html</link><pubDate>Sun, 16 Oct 2022 00:15:00 +0800</pubDate><guid>https://blog.tama.guru/record/aliyun_server.html</guid><description>&lt;p>腾讯云香港服务器蹲了半年都蹲不出台正常点的，中低端经常售罄，至少都要2C2T+4G起步，一个月就要六七十，这谁受得了？？？月初打开阿里云一看，哟嚯，2C（其实是1C2T）+2G一个月才30，试用下访问速度基本上接近国内服务器，这我直呼受不了，赶紧把之前那破腾讯云上的数据迁移咯。使用体验基本复合我的预期，但是2G跑个debian在加几个网站基本就没用想别的了，内存这块有优化的必要。&lt;/p>
&lt;hr>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]No.1 mysql[/scode]&lt;/p>
&lt;p>对于小内存的机子来说mysql跑一段时间之后内存占用会高得恐怖。我中午刚新开的服务器，到晚上11点多用&lt;code>htop&lt;/code>一看，单mysqld这个进程已经吃了18.5%的内存，也就是差不多400M，你也是真的能吃 ::acfun:01:: 。查了些资料然后进行比对，发现镜像原本的配置也已经优化的差不多了，但是我们还需要打开&lt;code>my.cnf&lt;/code>，在&lt;code>[mysqld]&lt;/code>字段添加&lt;/p>
&lt;p>&lt;code>performance_schema = off&lt;/code>&lt;/p>
&lt;p>然后保存重启mysql进程，也是有一定效果。&lt;/p>
&lt;p>[scode type=&amp;ldquo;lblue&amp;rdquo;]No.2 AliyunDun（阿里云盾）[/scode]&lt;/p>
&lt;p>这玩意是预装在系统里的，平时啥也不干也会吃掉5到6个点的内存，在官方的介绍页上，对这个产品的表述是：&lt;/p>
&lt;blockquote>
&lt;p>云盾是阿里巴巴集团多年来安全技术研究积累的成果，结合阿里云云计算平台强大的数据分析能力。为中小网站提供如安全漏洞检测、网页木马检测以及面向云服务器用户提供的主机入侵检测、防DDOS等一站式安全服务。&lt;/p>&lt;/blockquote>
&lt;p>其实平时不乱开端口，不乱往主机上塞文件问题就不大，至于DDoS，真要打我这小破站你这盾也不够用啊。。。&lt;/p>
&lt;p>以下是卸载步骤：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wget http://update.aegis.aliyun.com/download/uninstall.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sh uninstall.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget http://update.aegis.aliyun.com/download/quartz_uninstall.sh sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">quartz_uninstall.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pkill aliyun-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -fr /etc/init.d/agentwatch /usr/sbin/aliyun-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf /usr/local/aegis*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>未完待续 ::acfun:2003::&lt;/p></description></item></channel></rss>