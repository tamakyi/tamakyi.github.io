<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux on 狼的公告板 ver.Hugo</title><link>https://blog.tama.guru/tags/linux.html</link><description>Recent content in Linux on 狼的公告板 ver.Hugo</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>tamakyi</copyright><lastBuildDate>Sun, 24 Aug 2025 02:01:31 +0000</lastBuildDate><atom:link href="https://blog.tama.guru/tags/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>PVE安装后续优化</title><link>https://blog.tama.guru/record/pve_install.html</link><pubDate>Sun, 12 Mar 2023 01:43:00 +0800</pubDate><guid>https://blog.tama.guru/record/pve_install.html</guid><description>&lt;p>安装PVE并不复杂，相关操作网上一抓一大把此处不再赘述。
此处主要记录一些安装后碰上的问题以及对应的解决方案。
#####&lt;center>开启硬件直通&lt;/center>#####
1.首先确保CPU带有虚拟化能力。对于AMD平台，在&lt;code>BIOS的高级&amp;gt;CPU设置&lt;/code>查看是否有能开启&lt;code>SVM Mode&lt;/code>。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cb997ec1de.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cb997ec1de.png" alt="2023-03-11T17:25:44.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cb997ec1de.png"
loading="lazy"
alt="2023-03-11T17:25:44.png"
>确认能打开后，到&lt;code>高级&amp;gt;AMD CBS&amp;gt;NBIO Common Options&amp;gt;NB Configuration&lt;/code>下把&lt;code>IOMMU&lt;/code>打开。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cba128c724.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cba128c724.png" alt="2023-03-11T17:27:47.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cba128c724.png"
loading="lazy"
alt="2023-03-11T17:27:47.png"
>
2.进入系统控制台，修改grub启动时添加硬件直通功能。
打开&lt;code>/etc/default/grub&lt;/code>
将&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>进行修改。&lt;/p>
&lt;p>对于AMD平台修改为&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet amd_iommu=on iommu=pt video=efifb:off,vesafb:off&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>对于Intel平台修改为&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GRUB_CMDLINE_LINUX_DEFAULT=&amp;#34;quiet intel_iommu=on iommu=pt video=efifb:off,vesafb:off&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改完成后执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">update-grub
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>并添加以下模块到内核中：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo vfio &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo vfio_iommu_type1 &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo vfio_pci &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo vfio_virqfd &amp;gt;&amp;gt; /etc/modules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>添加完成后重启。
#####&lt;center>替换源&lt;/center>#####
执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#先把企业源换掉&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">rf&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pve&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">repo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;#deb https://enterprise.proxmox.com/debian/pve Bookworm pve-enterprise&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pve&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">enterprise&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#替换其他软件源&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">mirrors&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ustc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">edu&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cn&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">debian&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">release&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bookworm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">trusted&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">release&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bookworm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb https://mirrors.ustc.edu.cn/proxmox/debian/pve bookworm pve-no-subscription&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pve&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">no&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">subscription&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb https://mirrors.ustc.edu.cn/proxmox/debian/ceph-pacific bookworm main&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ceph&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> &lt;span class="s2">&amp;#34;s#http://download.proxmox.com/debian#https://mirrors.ustc.edu.cn/proxmox/debian#g&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">CLI&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pveceph&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> &lt;span class="s2">&amp;#34;s#ftp.debian.org/debian#mirrors.aliyun.com/debian#g&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="s2">&amp;#34;s#security.debian.org#mirrors.aliyun.com/debian-security#g&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sources&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>最后执行更新&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apt update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>#####&lt;center>关闭订阅提示&lt;/center>#####
修改文件：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">javascript&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmox&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">widget&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">toolkit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">proxmoxlib&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>搜索 &lt;code>data.status.toLowerCase&lt;/code>，并将框中内容删除：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbd6c8417c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbd6c8417c.png" alt="2023-03-11T17:42:05.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbd6c8417c.png"
loading="lazy"
alt="2023-03-11T17:42:05.png"
>
再次搜索 &lt;code>data.status.toLowerCase&lt;/code>，并将框中内容删除：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbda27355a.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbda27355a.png" alt="2023-03-11T17:42:59.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640cbda27355a.png"
loading="lazy"
alt="2023-03-11T17:42:59.png"
>
之后重启平台。
#####&lt;center>无法使用mkfs格式化硬盘&lt;/center>#####
如果提示：
&lt;code>apparently in use by the system; will not make a filesystem here!&lt;/code>
则先执行
&lt;code>dmsetup remove_all&lt;/code>
再执行
&lt;code>mkfs.filesystem /dev/disk&lt;/code>
#####&lt;center>手动挂载已有硬盘&lt;/center>#####
首先通过&lt;code>fdisk -l&lt;/code>查询硬盘/分区的路径
如需要挂载的设备为：
&lt;code>/dev/sdc4 83888128 468862094 384973967 183.6G Linux filesystem&lt;/code>
接下来通过&lt;code>blkid``查询设备UUID及分区类型 如查询结果为： &lt;/code>/dev/sdc4: UUID=&amp;ldquo;b958d02b-9f99-4e48-bacf-xxxxxxxx&amp;rdquo; BLOCK_SIZE=&amp;ldquo;512&amp;rdquo; TYPE=&amp;ldquo;xfs&amp;rdquo; PARTUUID=&amp;ldquo;beabe66d-07c2-2d4b-9836-xxxxxxx&amp;rdquo;&lt;code> 如果需要挂载的是硬盘，接下来需要的是UUID，如果需要的是分区，则需要PARTUUID，另一个参数`type=&amp;quot;xfs&amp;quot;`表明了文件系统类型 修改&lt;/code>/etc/fstab```添加以下内容&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">UUID=&amp;#34;b958d02b-9f99-4e48-bacf-xxxxxxxx&amp;#34; /mnt/rootfs2 xfs defaults 0 0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>第二个参数是需要挂载的目录位置。最后执行
&lt;code>mount -a&lt;/code>即可。
#####&lt;center>使用lxc安装docker&lt;/center>#####
1、首先进行换源操作&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">APLInfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">APLInfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm_back&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="s1">&amp;#39;s|http://download.proxmox.com|https://mirrors.tuna.tsinghua.edu.cn/proxmox|g&amp;#39;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">perl5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">PVE&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">APLInfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pm&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>更换完成后重启pve。
2、接下来进入PVE网页端，按如下操作安装debian软件包。（选择的目录应有CT镜像功能）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d92828b077.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d92828b077.png" alt="2023-03-12T08:51:14.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d92828b077.png"
loading="lazy"
alt="2023-03-12T08:51:14.png"
>之后等待窗口提示&lt;code>TASK OK&lt;/code>。
3、点击右上角的&lt;code>创建CT&lt;/code>，配置常规选项：特别要记住&lt;code>CT ID&lt;/code>，并把&lt;code>无特权的容器&lt;/code>的勾取消掉。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93a5acf5c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93a5acf5c.png" alt="2023-03-12T08:56:05.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93a5acf5c.png"
loading="lazy"
alt="2023-03-12T08:56:05.png"
>
模板刚才下载的目录位置以及模板。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93cd17138.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93cd17138.png" alt="2023-03-12T08:56:45.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93cd17138.png"
loading="lazy"
alt="2023-03-12T08:56:45.png"
>
磁盘空间根据实际情况给，建议20G以上。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93f8bccc7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93f8bccc7.png" alt="2023-03-12T08:57:28.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d93f8bccc7.png"
loading="lazy"
alt="2023-03-12T08:57:28.png"
>
核心数分配根据机器的实际情况配置。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9413db27b.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9413db27b.png" alt="2023-03-12T08:57:56.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9413db27b.png"
loading="lazy"
alt="2023-03-12T08:57:56.png"
>
内存设置考虑到后期我需要运行的Docker内容较多，我设置为1024，如果配置较低或者使用负载较小可以设置512，Swap同理。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9459ae6d2.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9459ae6d2.png" alt="2023-03-12T08:59:05.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d9459ae6d2.png"
loading="lazy"
alt="2023-03-12T08:59:05.png"
>
网络选项根据自己内网路由情况进行编辑，不建议使用DHCP，因为我经常找不到IP。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94b3dfa2c.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94b3dfa2c.png" alt="2023-03-12T09:00:35.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94b3dfa2c.png"
loading="lazy"
alt="2023-03-12T09:00:35.png"
>
DNS设置使用默认即可。然后确认信息无误点击完成，等待&lt;code>TASK OK&lt;/code>。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94e514dbc.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94e514dbc.png" alt="2023-03-12T09:01:25.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d94e514dbc.png"
loading="lazy"
alt="2023-03-12T09:01:25.png"
>
然后进入Docker的容器选项设置，把功能中以下内容勾选。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d953d9bdd1.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d953d9bdd1.png" alt="2023-03-12T09:02:53.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d953d9bdd1.png"
loading="lazy"
alt="2023-03-12T09:02:53.png"
>
接下来进入终端，修改配置文件，如我的lxc容器id是&lt;code>100&lt;/code>，则修改
&lt;code>/etc/pve/lxc/100.conf&lt;/code>
在文件末尾添加以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">lxc.apparmor.profile: unconfined
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.cgroup.devices.allow: a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.cap.drop:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#以上三行是必备的，以下两行是用来开启容器tun转发的，不是必须的
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.cgroup2.devices.allow: c 10:200 rwm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxc.mount.entry: /dev/net/tun dev/net/tun none bind,create=file
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改后整个文件应该看起来像：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/03/12/640d960b5a827.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d960b5a827.png" alt="2023-03-12T09:06:19.png" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/03/12/640d960b5a827.png"
loading="lazy"
alt="2023-03-12T09:06:19.png"
>
接下来点击Docker界面的启动，等待启动完成。
4、进入Docker的控制台，修改软件源：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">修改 /etc/apt/sources.list替换成以下内容：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-backports main contrib non-free
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-backports main contrib non-free
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>执行&lt;code>apt update&lt;/code>更新。
5、
执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apt&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">docker&lt;/span> &lt;span class="n">run&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">restart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">always&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;portainer&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">p&lt;/span> &lt;span class="mi">9000&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9000&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sock&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sock&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">portainer_data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span> &lt;span class="mi">6053537&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">portainer&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ce&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>进入容器IP:9000即可看到Docker控制界面。
#####&lt;center>开机提示ACPI BIOS Error(bug)&amp;hellip;&lt;/center>#####
在引导界面按e，并在linux行的最后添加&lt;code>acpi_backlight=vendor&lt;/code>
这种情况一般是修改显卡直通之后出现的，而在网上查了一圈，好像也只有华擎主板有这个问题&amp;hellip;&lt;a class="link" href="https://post.smzdm.com/p/akko88w8/" target="_blank" rel="noopener"
>参考链接&lt;/a>&lt;/p>
&lt;p>#####&lt;center>挂载现有硬盘到虚拟机或lxc容器&lt;/center>#####
先获取分区的识别符
&lt;code>ls -l /dev/disk/by-id&lt;/code>
例如本次要挂载的分区为&lt;code>ata-b958d02b-9f99-4e48-bacf-xxxxxxxx&lt;/code>
如果要挂载到虚拟机上，则执行
&lt;code>qm set 虚拟机ID -sata1 /dev/disk/by-id/硬盘识别符&lt;/code>
如果要挂载到LXC容器内，则执行
&lt;code>pct set 容器ID -mp0 /dev/disk/by-uuid/硬盘识别符,mp=/挂载路径&lt;/code>
如果已经在pve上挂载硬盘想映射进lxc容器，可以执行：
&lt;code>pct set 容器ID -mp0 /pve上挂载位置,mp=/lxc挂载路径&lt;/code>
同理可将pve上的任意路径挂载进容器中。
#####&lt;center>PVE8.0创建LXC容器之后无法进入ssh&lt;/center>#####
更新到8.0之后发现怎么创建容器都进不去SSH，具体是：控制台一片空白；XSHELL连接提示拒绝访问；宿主机使用&lt;code>ssh root@192.168.xx.xx&lt;/code>提示&lt;code>Permission denied, please try again.&lt;/code>（密码是正确的）
这种情况下可以先进入宿主机的ssh，执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">VMID Status Lock Name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">101 running docker12
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>当前我运行的lxc容器ID是101，因此执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@docker12:/etc/ssh#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这样就能进来了。
再编辑下&lt;code>/etc/ssh/sshd_config&lt;/code>，把&lt;code>PermitRootLogin&lt;/code>改成&lt;code>yes&lt;/code>，再重启下sshd服务，这次能正常登陆了。&lt;/p></description></item><item><title>解决Debian11安装慢问题的一些歪门邪道</title><link>https://blog.tama.guru/record/debian_install_slow.html</link><pubDate>Wed, 08 Mar 2023 16:02:24 +0800</pubDate><guid>https://blog.tama.guru/record/debian_install_slow.html</guid><description>&lt;p>前几天安装Debian的时候，在&lt;code>Select and install software&lt;/code>过程总是报错后终止安装进程，强制进入下一步安装引导会提示没有安装grub引导器可能会导致无法启动，查了一些资料后都在说是&lt;code>debian-security&lt;/code>这个源在国外，直接连接速度极慢（体现为这一步下载4个文件需要几个小时，而且极大可能会突然连接不上然后安装失败）。
那么就有说在这一步之前选择&lt;code>不使用网络源&lt;/code>并且按&lt;code>Ctrl+Alt+F2&lt;/code>切换到其他tty：
修改&lt;code>/target/etc/apt/sources.list&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#修改debian-security为国内源或者直接屏蔽掉这一行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#deb http://security.debian.org/debian-security bullseye-security main
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>但是实际就算是把源换成国内的或是屏蔽掉，在点击下一步之后还是会把&lt;code>security.debian.org&lt;/code>这个源还原回来，然后继续卡着&amp;hellip;
那么就有两种办法，
###一、全局代理###
这种方法我还没试过，不过觉得是可行的，需要在路由器或者上级网络配置好全局国外代理。使用手机USB网络或者热点可能有些问题，因为在这一步WIFI和USB网卡驱动还没能安装。
###二、拔网线###
在进入&lt;code>是否选择网络源&lt;/code>这个界面的时候把网线拔了再点下一步，这样就默认只使用本地介质上的资源进行更新。最好不要全程断网（进系统之后你需要自己配置网卡设置）或是在这之前断网（尝试在DHCP配置完成之后、是否选择网络源之前拔掉网线，会有可能导致安装进程卡住。），等待安装完成后再把网线接回去。&lt;/p></description></item></channel></rss>