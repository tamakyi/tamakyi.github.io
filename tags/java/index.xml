<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Java on 狼的公告板 ver.Hugo</title><link>https://blog.tama.guru/tags/java.html</link><description>Recent content in Java on 狼的公告板 ver.Hugo</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>tamakyi</copyright><lastBuildDate>Thu, 05 Feb 2026 00:51:30 +0000</lastBuildDate><atom:link href="https://blog.tama.guru/tags/java/index.xml" rel="self" type="application/rss+xml"/><item><title>搭建自己的轨迹记录程序 Traccar</title><link>https://blog.tama.guru/record/traccar.html</link><pubDate>Sun, 20 Apr 2025 05:57:00 +0800</pubDate><guid>https://blog.tama.guru/record/traccar.html</guid><description>&lt;p>今天外出玩耍的时候突发奇想我能不能每天记录一下自己每天的生活轨迹，百度了下已经有很多成熟的应用了，但是这种比较私密的数据要发送到别人的服务器上说实话我是不太想的，然后去github上找了下，发现了好几个方案，都尝试了一遍，主要是&lt;a class="link" href="https://github.com/cctyl/TrackRecord" target="_blank" rel="noopener"
>https://github.com/cctyl/TrackRecord&lt;/a>，搭完发现太简陋了，不适合我，其他几个更是已经几年没更新了，最后尝试了下traccar，感觉算是比较成熟的方案，也符合我的需求。&lt;/p>
&lt;h4 id="正常安装">正常安装
&lt;/h4>&lt;p>其官网位于：&lt;a class="link" href="https://www.traccar.org/" target="_blank" rel="noopener"
>https://www.traccar.org/&lt;/a>，项目主要仓库在Github上：&lt;a class="link" href="https://github.com/traccar/traccar" target="_blank" rel="noopener"
>https://github.com/traccar/traccar&lt;/a>。直接去release上根据服务器类型下载对应的文件就行了，目前linux支持arm和x64，windows仅支持x64。以我在树莓派上运行为例，下载之后解压执行就能自动配置好：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">wget https://bgithub.xyz/traccar/traccar/releases/download/v6.6/traccar-linux-arm-6.6.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip traccar-linux-arm-6.6.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./traccar.run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl start traccar.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>再等个几分钟（树莓派太慢了，所以会很久），就可以访问&lt;code>设备IP:8082&lt;/code>进入管理界面。初次使用需要配置服务名称、邮箱和密码，然后使用邮箱和密码登录即可。&lt;/p>
&lt;h4 id="使用docker安装">使用docker安装
&lt;/h4>&lt;p>首先执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run --rm --entrypoint cat traccar/traccar:latest /opt/traccar/conf/traccar.xml &amp;gt; /root/traccar/traccar.xml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中&lt;code>/root/traccar/traccar.xml&lt;/code>根据实际情况配置，我的配置文件放在&lt;code>/root/traccar&lt;/code>下所以这么弄了。
然后执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run -d --restart always --name traccar --hostname traccar -p 8082:8082 -p 5023:5023 -p 5023:5023/udp -p 5055:5055 -p 5055:5055/udp -v /root/traccar/traccar/logs:/opt/traccar/logs:rw -v /root/traccar/traccar.xml:/opt/traccar/conf/traccar.xml:ro -v /root/traccar/templates:/opt/traccar/templates/short -e &lt;span class="nv">TZ&lt;/span>&lt;span class="o">=&lt;/span>Asia/Shanghai traccar/traccar:latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这里所有的&lt;code>/root/traccar&lt;/code>都要根据实际情况修改，然后确保&lt;code>8082 5023 5055&lt;/code>这三个端口都是没有被占用的，有的话改到其他端口下。
同样再等个几分钟，就可以访问&lt;code>设备IP:8082&lt;/code>进入管理界面。初次使用需要配置服务名称、邮箱和密码，然后使用邮箱和密码登录即可。&lt;/p>
&lt;h4 id="修改数据库">修改数据库
&lt;/h4>&lt;p>默认情况下它使用的是h2作为数据库，这是一种开源的关系型数据库，采用Java语言编写，数据存储于内存内，为了保证数据安全建议修改为mysql连接方式。
具体操作是修改数据目录下的&lt;code>traccar.xml&lt;/code>文件，原内容是：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;lt;?xml &lt;span class="nv">version&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span> &lt;span class="nv">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;UTF-8&amp;#34;&lt;/span>?&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;!DOCTYPE properties SYSTEM &lt;span class="s1">&amp;#39;http://java.sun.com/dtd/properties.dtd&amp;#39;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;properties&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;!-- Documentation: https://www.traccar.org/configuration-file/ --&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.driver&amp;#39;&lt;/span>&amp;gt;org.h2.Driver&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.url&amp;#39;&lt;/span>&amp;gt;jdbc:h2:./data/database&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.user&amp;#39;&lt;/span>&amp;gt;sa&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.password&amp;#39;&lt;/span>&amp;gt;&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;/properties&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改为：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&amp;lt;?xml &lt;span class="nv">version&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span> &lt;span class="nv">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;UTF-8&amp;#34;&lt;/span>?&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;!DOCTYPE properties SYSTEM &lt;span class="s1">&amp;#39;http://java.sun.com/dtd/properties.dtd&amp;#39;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;properties&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;!-- Documentation: https://www.traccar.org/configuration-file/ --&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.driver&amp;#39;&lt;/span>&amp;gt;com.mysql.cj.jdbc.Driver&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.url&amp;#39;&lt;/span>&amp;gt;jdbc:mysql://sql地址:端口/数据库名称?zeroDateTimeBehavior&lt;span class="o">=&lt;/span>round&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">serverTimezone&lt;/span>&lt;span class="o">=&lt;/span>UTC&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">allowPublicKeyRetrieval&lt;/span>&lt;span class="o">=&lt;/span>true&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">useSSL&lt;/span>&lt;span class="o">=&lt;/span>false&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">allowMultiQueries&lt;/span>&lt;span class="o">=&lt;/span>true&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">autoReconnect&lt;/span>&lt;span class="o">=&lt;/span>true&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">useUnicode&lt;/span>&lt;span class="o">=&lt;/span>yes&lt;span class="p">&amp;amp;&lt;/span>amp&lt;span class="p">;&lt;/span>&lt;span class="nv">characterEncoding&lt;/span>&lt;span class="o">=&lt;/span>UTF-8&lt;span class="p">&amp;amp;&lt;/span>a&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.user&amp;#39;&lt;/span>&amp;gt;数据库用户名&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;entry &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;database.password&amp;#39;&lt;/span>&amp;gt;数据库密码&amp;lt;/entry&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;/properties&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存文件，如果使用正常方式安装的执行:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo systemctl restart traccar.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果使用的是docker则执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker restart 容器ID
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>需要注意的是修改数据库不会把h2上的数据迁移过去，所以需要重新设置密码。&lt;/p>
&lt;h4 id="添加设备">添加设备
&lt;/h4>&lt;p>Github上提供了编译好的APP，支持IOS和安卓，可以直接下载安装。
下载完后需要添加好定位权限并锁定后台，然后在APP中修改服务器地址，比如服务器IP是&lt;code>192.168.50.121&lt;/code>，那这里就要填写&lt;code>http://192.168.50.121:5055&lt;/code>。当然，这是针对没有公网的情况，如果需要在外网访问就自行做穿透。
然后记录下显示的&lt;code>设备编码&lt;/code>，是个6位数字。
&lt;code>精度&lt;/code>可选高中低，应该是越高耗电越多。
&lt;code>定位频率&lt;/code>：多久一次上报位置信息，我设置了1200秒，不需要太高。
后面&lt;code>距离&lt;/code>、&lt;code>角度&lt;/code>等我没调整。&lt;/p>
&lt;h4 id="网页端使用">网页端使用
&lt;/h4>&lt;p>要做的主要就是连接设备和配置地图信息了。&lt;/p>
&lt;h5 id="连接设备">连接设备
&lt;/h5>&lt;p>点击&lt;code>左上角的加号&lt;/code>，会跳转到&lt;code>设备页面&lt;/code>，要求的必填项有&lt;code>名称&lt;/code>和&lt;code>标识符&lt;/code>，&lt;code>名称&lt;/code>可以随意填写，&lt;code>标识符&lt;/code>就是刚才我们手机上的六位数字，如果手机端配置地址无误，几秒钟之后手机的位置和电量就显示在网页上了。可以查看到详细的经纬度、海拔和轨迹信息。&lt;/p>
&lt;h5 id="配置地图信息">配置地图信息
&lt;/h5>&lt;p>设置里的首选项第一行的地图中可选的地图很多，红色需要添加key或者付费，免费的支持LocatioIQ、谷歌、高德等地图，但是高德会因为你知道的原因产生偏移，可以通过修改编译原文件的方式解决，但我就算了，不一定用高德其他效果也还不错。&lt;/p>
&lt;h4 id="其他">其他
&lt;/h4>&lt;h5 id="添加两步验证">添加两步验证
&lt;/h5>&lt;p>如果要暴露在公网上，建议还是添加个2FA保护登录信息，具体操作是在设置的服务器选项下的属性，点击添加，属性选择启用一次性密码，然后确认添加，在出现的启用一次性密码复选框上打勾，此时到设置的账户界面会多一行一次性密码密钥，点击里面有个刷新按钮，然后就弹出密钥了，把它复制到那些两步验证APP上保存即可，网页端也要记得点击保存。&lt;/p>
&lt;h5 id="感想">感想
&lt;/h5>&lt;p>这个东西整体基本符合我的要求，该有的功能都有了，配置里还有很多个性化玩法，也看到有好多人把这东西接入hass或者rednode，后面我也会研究研究。
当然该吐槽的也要吐槽，基于JAVA的东西是真吃内存啊，光容器就吃掉了800M+的内存，mysql那边也盯着内存不放，还好树莓派买的4G版，不然真不敢玩。&lt;/p></description></item><item><title>使用ruleproject搭建自己的typecho程序客户端</title><link>https://blog.tama.guru/record/ruleproject.html</link><pubDate>Fri, 17 Nov 2023 23:12:00 +0800</pubDate><guid>https://blog.tama.guru/record/ruleproject.html</guid><description>&lt;p>卧槽牛皮，这东西牛啊！通过这个教程已经成功弄出了安卓端apk并正常使用！
本站安卓客户端：&lt;a class="link" href="https://share.tama.guru/d/App/Android/latest_release.apk" target="_blank" rel="noopener"
>https://share.tama.guru/d/App/Android/latest_release.apk&lt;/a>
&lt;/br>本站自签证iOS端：&lt;a class="link" href="https://share.tama.guru/d/App/iOS/%E7%8B%BC%E7%9A%84%E5%85%AC%E5%91%8A%E6%9D%BF.mobileconfig" target="_blank" rel="noopener"
>https://share.tama.guru/d/App/iOS/%E7%8B%BC%E7%9A%84%E5%85%AC%E5%91%8A%E6%9D%BF.mobileconfig&lt;/a>&lt;/p>
&lt;h3 id="介绍">介绍
&lt;/h3>&lt;p>RuleApi，基于typecho正式版数据库，使用JAVA语言Springboot框架，整合redis缓存数据库，COS、OSS对象存储，是目前typecho程序功能最全，接口最完善，用户体验最好，且性能最佳的API程序。集成了用户模块（登陆，注册，邮箱验证，用户查询，用户修改），文章模块，评论模块，分类模块，和上传模块（三合一上传方式，OSS，COS，本地上传均可），在安装完成后，可以进一步扩展typecho网站的功能，并实现更强大的性能，更全面的应用范围。&lt;/p>
&lt;h3 id="截图">截图
&lt;/h3>&lt;p>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65576a92ee3f8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576a92ee3f8.png" alt="安卓端安装" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576a92ee3f8.png"
loading="lazy"
alt="安卓端安装"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65576aa82e79e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576aa82e79e.png" alt="内容" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65576aa82e79e.png"
loading="lazy"
alt="内容"
>&lt;/p>
&lt;h3 id="搭建教程">搭建教程
&lt;/h3>&lt;p>以下均为安卓端app的配置，ios端个人能力有限不使用。&lt;/p>
&lt;h4 id="api端">API端
&lt;/h4>&lt;p>基本上可以参考官方项目的说明，官方提供centos使用的&lt;a class="link" href="http://shell.ruletree.club/ruleapi.sh" target="_blank" rel="noopener"
>一键脚本&lt;/a>，因为我用的debian，用的是手动安装。以下操作也是基础手动安装。&lt;/p>
&lt;h4 id="安装依赖环境">安装依赖环境
&lt;/h4>&lt;p>首先是JAVA，官方建议安装8u311版本，可以去网上找，也可以使用我下载下来的&lt;a class="link" href="https://share.tama.guru/%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%EF%BC%88%E4%BB%93%E5%BA%93%EF%BC%89/ruleproject/java" target="_blank" rel="noopener"
>文件&lt;/a>。下载之后解压到&lt;code>/opt&lt;/code>并命名为&lt;code>jdk1.8&lt;/code>，整个路径看起来应该像：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># ls /opt/jdk1.8/ bin COPYRIGHT include javafx-src.zip jmc.txt jre legal lib LICENSE man README.html release src.zip THIRDPARTYLICENSEREADME-JAVAFX.txt THIRDPARTYLICENSEREADME.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后配置环境，修改&lt;code>/etc/profile&lt;/code>，添加下面的语句到最后：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">jdk1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">CLASSPATH&lt;/span>&lt;span class="o">=.&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">jre&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jar&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jar&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tools&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jar&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">JAVA_HOME&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>并执行&lt;code>source /etc/profile&lt;/code>使其生效。
其他还需要安装Redis、Mysql和Nginx，如果安装过宝塔的直接在面板上安装，基本上没有版本限制所以此处不写过程了。
最后还需要安装&lt;code>screen&lt;/code>用于维持ruleapi后台运行。&lt;/p>
&lt;h4 id="下载所需文件">下载所需文件
&lt;/h4>&lt;p>在&lt;code>/opt&lt;/code>新建一个文件夹，比如&lt;code>ruleapi&lt;/code>，把以下文件都下载下来。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> wget -c http://shell.ruletree.club/RuleApi.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wget -c http://shell.ruletree.club/application.properties
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wget -c http://shell.ruletree.club/apiResult.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>整个路径看起来应该像：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#ls /opt/ruleapi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiResult.php application.properties RuleApi.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">然后需要把`apiResult.php`复制到typecho的根目录。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">相关文件也已经上传云盘:[https://share.tama.guru/%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%EF%BC%88%E4%BB%93%E5%BA%93%EF%BC%89/ruleproject][7]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="修改ruleapi配置">修改ruleapi配置
&lt;/h4>&lt;p>修改&lt;code>application.properties&lt;/code>，主要修改以下几项：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="c1">#ruleapi运行的端口，如果8080被占用了就手动改。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datasource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">url&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">jdbc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">mysql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">127.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3306&lt;/span>&lt;span class="o">/&amp;lt;&lt;/span>&lt;span class="n">typecho数据库名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">characterEncoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">UTF&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datasource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">typecho数据库用户名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">datasource&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">typecho数据库密码&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mybatis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">configuration&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">variables&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">prefix&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">typecho数据表前缀&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">redis密码&lt;/span>&lt;span class="err">，默认为空，如果配置了其他密码自己手动修改&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">smtp服务器&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">smtp登录名&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#spring.mail.from不支持中文，需要中文，看mail.properties&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">smtp密码&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">smtp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">smtp登录端口&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">properties&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">smtp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ssl&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">enable&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="bp">true&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">smtp是否需要ssl&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spring&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mail&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">default&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">UTF&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">8&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="err">编码格式&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">webinfo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">登录网页控制台的&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="运行程序并保持在后台运行">运行程序并保持在后台运行
&lt;/h4>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#screen -S ruleapi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#java -jar RuleApi.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> . ____ _ __ _ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /\\ / ___&amp;#39;_ __ _ _(_)_ __ __ _ \ \ \ \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">( ( )\___ | &amp;#39;_ | &amp;#39;_| | &amp;#39;_ \/ _` | \ \ \ \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \\/ ___)| |_)| | | | | || (_| | ) ) ) )
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39; |____| .__|_| |_|_| |_\__, | / / / /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> =========|_|==============|___/=/_/_/_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Spring Boot :: (v2.2.11.RELEASE)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:00 INFO 966545 --- [ main] com.RuleApi.Application 55 : Starting Application v1.3.4 on xxxxxxxxx with PID 966545 /opt/ruleapi/RuleApi.jar started by root in /opt/ruleapi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:00 INFO 966545 --- [ main] com.RuleApi.Application 651 : No active profile set, falling back to default profiles: default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:01 INFO 966545 --- [ main] .s.d.r.c.RepositoryConfigurationDelegate 249 : Multiple Spring Data modules found, entering strict repository configuration mode!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:01 INFO 966545 --- [ main] .s.d.r.c.RepositoryConfigurationDelegate 127 : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:01 INFO 966545 --- [ main] .s.d.r.c.RepositoryConfigurationDelegate 187 : Finished Spring Data repository scanning in 43ms. Found 0 Redis repository interfaces.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer 91 : Tomcat initialized with port(s): yourport (http)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.a.coyote.http11.Http11NioProtocol 173 : Initializing ProtocolHandler [&amp;#34;http-nio-yourport&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.apache.catalina.core.StandardService 173 : Starting service [Tomcat]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] org.apache.catalina.core.StandardEngine 173 : Starting Servlet engine: [Apache Tomcat/9.0.58]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] o.a.c.c.C.[Tomcat].[localhost].[/] 173 : Initializing Spring embedded WebApplicationContext
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:03 INFO 966545 --- [ main] w.s.c.ServletWebServerApplicationContext 283 : Root WebApplicationContext: initialization completed in 2660 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.s.s.concurrent.ThreadPoolTaskExecutor 181 : Initializing ExecutorService &amp;#39;applicationTaskExecutor&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.s.b.a.w.s.WelcomePageHandlerMapping 54 : Adding welcome page: class path resource [static/index.html]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.a.coyote.http11.Http11NioProtocol 173 : Starting ProtocolHandler [&amp;#34;http-nio-yourport&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer 203 : Tomcat started on port(s): yourport(http) with context path &amp;#39;&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:05 INFO 966545 --- [ main] com.RuleApi.Application 61 : Started Application in 6.022 seconds (JVM running for 6.495)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:14 INFO 966545 --- [nio-yourport-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] 173 : Initializing Spring DispatcherServlet &amp;#39;dispatcherServlet&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:14 INFO 966545 --- [nio-yourport-exec-1] o.s.web.servlet.DispatcherServlet 525 : Initializing Servlet &amp;#39;dispatcherServlet&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:14 INFO 966545 --- [nio-yourport-exec-1] o.s.web.servlet.DispatcherServlet 547 : Completed initialization in 8 ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2023-11-17 18:42:15 INFO 966545 --- [nio-yourport-exec-8] io.lettuce.core.EpollProvider 68 : Starting without optional epoll library
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果有上述提示则表示程序正常启动了，可以按&lt;code>Ctrl+A D&lt;/code>保持后台运行。&lt;/p>
&lt;h4 id="配置二级域名">配置二级域名
&lt;/h4>&lt;p>因为使用IP+端口访问并不安全，需要配置一个二级域名用以访问。比如二级域名为https://rule.tama.host，生成并解析后需要添加伪静态规则：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">location ^~ /images/ {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> alias /opt/ruleapi/static/;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ =404;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">location ^~ / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Origin&amp;#39; &amp;#39;*&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Methods&amp;#39; &amp;#39;GET, POST, OPTIONS, PUT, DELETE&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Credentials&amp;#39; &amp;#39;true&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Headers&amp;#39; &amp;#39;Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,X-Mx-ReqToken,X-Data-Type,X-Requested-With,X-Data-Type,X-Auth-Token&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if ( $request_method = &amp;#39;OPTIONS&amp;#39; ) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return 200;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_pass http://127.0.0.1:&amp;lt;你的ruleapi端口&amp;gt;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header Host $host;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Real-IP $remote_addr;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy_set_header REMOTE-HOST $remote_addr;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意修改端口。之后访问https://rule.tama.host可以进入可视化管理页面。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577208c1bb8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577208c1bb8.png" alt="可视化界面" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577208c1bb8.png"
loading="lazy"
alt="可视化界面"
>
首次进去先点击安装及更新，每次更新之后都要点这个。此处需要填写&lt;code>webinfo.key&lt;/code>中配置的key。更新完成后关闭界面可以进入管理中心。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557722f7f421.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557722f7f421.png" alt="安装及更新" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557722f7f421.png"
loading="lazy"
alt="安装及更新"
>&lt;/p>
&lt;h4 id="管理中心配置">管理中心配置
&lt;/h4>&lt;p>这里的参数很多，我的修改只为了保证程序的运行，其他细项可以自行修改。
&lt;code>安全设置&lt;/code>建议打开机器人限制模式。
&lt;code>应用模块-应用管理&lt;/code>是重要的步骤，内容可以按自己的设置添加修改：
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557734790de7.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557734790de7.png" alt="应用设置1" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557734790de7.png"
loading="lazy"
alt="应用设置1"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/655773783661e.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773783661e.png" alt="应用设置2" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773783661e.png"
loading="lazy"
alt="应用设置2"
>
之后会得到一个&lt;code>应用key&lt;/code>。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/655773af8f48f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773af8f48f.png" alt="应用key" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655773af8f48f.png"
loading="lazy"
alt="应用key"
>
之后还需要到存储模块设置一个上传文件/视频的方式，可以选择OSS/COS/FTP/本地上传。如果使用本地上传，需要把本地&amp;amp;FTP图片访问地址修改为：&lt;code>https://rule.tama.host/images/&lt;/code>，rule.tama.host修改成你ruleapi的地址。（来自：&lt;a class="link" href="https://www.ijkxs.com/9955.html" target="_blank" rel="noopener"
>https://www.ijkxs.com/9955.html&lt;/a>）
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577452b2529.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577452b2529.png" alt="本地访问图片" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577452b2529.png"
loading="lazy"
alt="本地访问图片"
>
至此api端算是配置完成了。&lt;/p>
&lt;h3 id="app端">APP端
&lt;/h3>&lt;h4 id="注册和配置dcloud">注册和配置dcloud
&lt;/h4>&lt;p>先需要注册一个&lt;a class="link" href="https://account.dcloud.net.cn/" target="_blank" rel="noopener"
>dcloud账号&lt;/a>并登录，绑定好手机号。然后到dcloud下载&lt;a class="link" href="https://dcloud.io/hbuilderx.html" target="_blank" rel="noopener"
>HBulder X&lt;/a>。&lt;/p>
&lt;h4 id="下载源码到本地并导入hbulderx">下载源码到本地并导入HBulderX
&lt;/h4>&lt;p>Gitee:&lt;a class="link" href="https://gitee.com/ruletree/RuleApp" target="_blank" rel="noopener"
>https://gitee.com/ruletree/RuleApp&lt;/a>
Github:&lt;a class="link" href="https://github.com/buxia97/RuleApi" target="_blank" rel="noopener"
>https://github.com/buxia97/RuleApp&lt;/a>
假设下载的目录是C:\Files\RuleApp，打开HBulderX，并执行&lt;code>文件&amp;gt;导入&amp;gt;从本地目录导入&lt;/code>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557762f65a2d.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557762f65a2d.png" alt="导入项目" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557762f65a2d.png"
loading="lazy"
alt="导入项目"
>&lt;/p>
&lt;h4 id="修改配置项目">修改配置项目
&lt;/h4>&lt;p>首先是&lt;code>utils\api.js&lt;/code>，这里主要填写对接到ruleapi的数据，主要修改以下内容：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">API_URL&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;ruleapi网址&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">appKey&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;应用key&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>&lt;span class="n">web网站地址&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">GroupUrl&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;qq群链接&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">var&lt;/span> &lt;span class="n">GithubUrl&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;gayhub链接&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>其他可以根据注释修改。
然后修改&lt;code>manifest.json&lt;/code>，这里是图形界面的，可以根据提示直接修改，需要注意：
1.uni-app需要重新获取，这里会提示登录dcloud账号。
2.应用版本号和应用版本名称应高于前一次配置的值，首次配置可以写1。
3.app模块配置中根据需要选择Oauth如果没有配置的话把勾取消掉。
如果不选择Push的话，每次启动app都会有弹窗提示，建议配置，配置需要到&lt;a class="link" href="https://dev.dcloud.net.cn/pages/app/detail" target="_blank" rel="noopener"
>https://dev.dcloud.net.cn/pages/app/detail&lt;/a>中&lt;code>我的应用&amp;gt; 应用名称&amp;gt;Android云端证书&lt;/code>中查看证书详情，并记录sha1 sha256和md5值。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/655778cf37399.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655778cf37399.png" alt="证书指纹" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/655778cf37399.png"
loading="lazy"
alt="证书指纹"
>
然后到&lt;code>各平台信息&lt;/code>中填写对应值，包名也要一并填写。
然后把数值填写到&lt;code>uniPush&amp;gt;1.0&amp;gt;应用信息&lt;/code>选择APPID，填写应用名称和包名、选择平台并选择Android应用签名。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/6557798cb22be.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557798cb22be.png" alt="应用信息配置" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/6557798cb22be.png"
loading="lazy"
alt="应用信息配置"
>
保存成功后进入&lt;code>uniPush&amp;gt;1.0&amp;gt;消息推送&amp;gt;配置管理&amp;gt;应用配置&lt;/code>下，把Appid Appkey MasterSectrt值填写到ruleapi的&lt;code>通知模块&amp;gt;UniPush配置&lt;/code>中。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a0903248.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a0903248.png" alt="应用配置" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a0903248.png"
loading="lazy"
alt="应用配置"
>
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a30b67f8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a30b67f8.png" alt="UniPushRuleapi端" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577a30b67f8.png"
loading="lazy"
alt="UniPushRuleapi端"
>&lt;/p>
&lt;h4 id="调试">调试
&lt;/h4>&lt;p>到HBulderX的运行中选择运行到浏览器，等几分钟会跳转到浏览器并打开页面，可以查看是否有误。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577acb6c90f.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577acb6c90f.png" alt="调试" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577acb6c90f.png"
loading="lazy"
alt="调试"
>&lt;/p>
&lt;h4 id="编译">编译
&lt;/h4>&lt;p>执行HBulderX的的发行&amp;gt;原生App-云打包。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b174db42.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b174db42.png" alt="发行" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b174db42.png"
loading="lazy"
alt="发行"
>
填写包名并选择使用云端证书，点击打包，会提示下载相关依赖，下载完成后会自动启动打包，如果没有配置错误一般三到五分钟后就能生成apk包。
&lt;div class="post-img-view">
&lt;a data-fancybox="gallery" href="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b62916d8.png">
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b62916d8.png" alt="打包" />
&lt;/a>
&lt;/div>
&lt;img src="https://r2.337845818.best/oss-to-r2/2023/11/17/65577b62916d8.png"
loading="lazy"
alt="打包"
>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:08.640 项目 &amp;#39;RuleApp-master&amp;#39; 开始编译...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:10.336 3.96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:10.336 正在编译中...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:10.337 ​已开启 uni统计1.0 版本​
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:40.332 项目 &amp;#39;RuleApp-master&amp;#39; 编译成功。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 打包成功后会自动返回下载链接。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 打包过程查询请点菜单发行-查看云打包状态。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 周五傍晚等高峰期打包排队较长，请耐心等待。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 如果是为了三方SDK调试，请使用自定义调试基座（菜单运行-手机或模拟器-制作自定义调试基座），不要反复打包。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:51.222 项目 RuleApp-master [__UNI__xxxxxxx]已成功提交到云端，正在获取打包状态...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:02:52.421
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.423 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.423 时间: 2023-11-17 23:02:50 类型: Android云端证书 准备打包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:02:52.903
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.903 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:02:52.903 时间: 2023-11-17 23:02:50 类型: Android云端证书 准备打包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:03:49.917
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:03:49.917 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:03:49.917 时间: 2023-11-17 23:02:50 类型: Android云端证书 正在云端打包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:03:49.917 预计2-5分钟完成打包。如项目使用了App原生插件，打包时间可能会更长，请耐心等待。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:04:58.053
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:04:58.054 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:04:58.054 时间: 2023-11-17 23:02:50 类型: Android云端证书 正在本地生成安装包(请勿关闭HBuilderX)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">23:05:27.519
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:05:27.519 项目 RuleApp-master [__UNI__xxxxxxx]的打包状态：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[HBuilder] 23:05:27.519 时间: 2023-11-17 23:02:50 类型: Android云端证书 打包成功 安装包位置：xxxxxxxxxxxxxxxxxxxx/apk/__UNI__xxxxx__20231117230250.apk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>打包好的文件根据提示可以找到。&lt;/p>
&lt;h3 id="注意事项">注意事项
&lt;/h3>&lt;h4 id="阿里云oss防盗链">阿里云OSS防盗链
&lt;/h4>&lt;p>需要在防盗链白名单中添加&amp;quot;-&amp;quot;，否则app端资源无法显示。&lt;/p>
&lt;h4 id="添加表情包">添加表情包
&lt;/h4>&lt;p>资源位于&lt;code>RuleApp-master\unpackage\dist\dev\app-plus\static\app-plus\owo&lt;/code>、&lt;code>RuleApp-master\static\app-plus\owo&lt;/code>以及&lt;code>C:\Users\Tamakyi Gekka\Downloads\RuleApp-master\RuleApp-master\static\h5\owo&lt;/code>下。需要修改&lt;code>OwO.js&lt;/code>并根据路径添加对应资源。&lt;/p></description></item></channel></rss>